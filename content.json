{"pages":[{"title":"å‹æƒ…é“¾æ¥","text":"","link":"/link/index.html"},{"title":"æˆ‘çš„åˆ†ç±»é¡µ","text":"","link":"/categories/index.html"},{"title":"æˆ‘çš„æ ‡ç­¾é¡µ","text":"","link":"/tags/index.html"}],"posts":[{"title":"ç¦æ­¢ç”¨æˆ·è°ƒè¯•ç½‘ç«™","text":"ç¦æ­¢ç”¨æˆ·è°ƒè¯•ç½‘ç«™ webæƒ³ç¦æ­¢è°ƒè¯•ï¼Œæ²¡æœ‰ç»å¯¹å®‰å…¨çš„æ–¹å¼ å¦™ç”¨1 debuggerç¤ºä¾‹ç”¨setIntervalæ‰§è¡Œdebuggerï¼Œæ‰“å¼€æ§åˆ¶å°å°±ä¼šæš‚åœä»£ç  12345678(() =&gt; { function ban() { setInterval(() =&gt; { debugger; }, 50); } ban();})(); å¦™ç”¨2 debuggerç¤ºä¾‹æ•ˆæœï¼šæ‰“å¼€æ§åˆ¶å°å°±è¿›å…¥debuggerï¼Œå¦‚æœè¿˜åƒ å¦™ç”¨1 çš„ç ´è§£ä¹‹æ³•è§£å†³ï¼Œæµè§ˆå™¨ä¼šè¢«å¡æ­» 12345678910111213141516(() =&gt; { let timeLimit = 50; setInterval(loop, 1); function loop() { let startTime = new Date(); debugger; if (new Date() - startTime &gt; timeLimit) { window.stop(); let total = ''; for (let i = 0; i &lt; 1000000; i++) { total = total + i.toString(); history.pushState(0, 0, total); } } }})(); åˆ†æä¸‹é¢è¿™ä¸€æ®µæ˜¯å¯¼è‡´æµè§ˆå™¨å¡æ­»çš„ç½ªé­ç¥¸é¦– 12345let total = '';for (let i = 0; i &lt; 1000000; i++) { total = total + i.toString(); history.pushState(0, 0, total);} ä½†æ˜¯é»˜è®¤åº”è¯¥å°±ä¼šæ‰§è¡Œï¼Œä¸ºä»€ä¹ˆæ‰“å¼€æ§åˆ¶å°æ‰è¿›å…¥è¿™ä¸€æ®µå‘¢ï¼Ÿç­”æ¡ˆå°±åœ¨è¿™ä¸€æ®µ 12345let startTime = new Date();debugger;if (new Date() - startTime &gt; timeLimit) { // ...} åªæœ‰è¿›å…¥debuggerçš„æƒ…å†µä¸‹ï¼Œnew Date()æ‰ä¼šæ¯”startTimeï¼ˆä¸Šä¸€æ¬¡çš„æ—¶é—´ï¼‰å¤§50ms ä¹Ÿå¯ä»¥è¿™æ ·æ“ä½œï¼šè·³è½¬è‡³ç©ºé¡µé¢ 123if (new Date() - startTime &gt; timeLimit) { window.location.href = 'about:blank';} è¿˜æœ‰å¾ˆå¤šæ–¹å¼ï¼Œåªè¦é¿å…èƒ½è°ƒè¯•å½“å‰é¡µé¢å³å¯ ç¬¬ä¸‰æ–¹åº“ï¼šdisable-devtool https://github.com/theajack/disable-devtoolï¼š**0.3.7** ä½¿ç”¨æ–¹å¼12345&lt;script disable-devtool-auto src='https://cdn.jsdelivr.net/npm/disable-devtool' stopIntervalTime=&quot;false&quot;&gt;&lt;/script&gt; é…ç½®å«ä¹‰123456789101112131415161718192021222324252627282930313233interface IConfig { md5?: string; // ç»•è¿‡ç¦ç”¨çš„md5å€¼ï¼Œç”¨äºçº¿ä¸Šï¼Œé»˜è®¤ä¸å¯ç”¨ç»•è¿‡ç¦ç”¨ url?: string; // å…³é—­é¡µé¢å¤±è´¥æ—¶çš„è·³è½¬é¡µé¢ï¼Œé»˜è®¤å€¼ä¸ºlocalhost tkName?: string; // ç»•è¿‡ç¦ç”¨æ—¶çš„urlå‚æ•°åç§°ï¼Œé»˜è®¤ä¸º ddtk ondevtoolopen?(type: DetectorType, next: Function): void; // å¼€å‘è€…é¢æ¿æ‰“å¼€çš„å›è°ƒï¼Œå¯ç”¨æ—¶urlå‚æ•°æ— æ•ˆï¼Œtype ä¸ºç›‘æµ‹æ¨¡å¼ï¼Œè¯¦è§3.5ï¼Œ nextå‡½æ•°æ˜¯å…³é—­å½“å‰çª—å£ ondevtoolclose?(): void; // å¼€å‘è€…é¢æ¿å…³é—­çš„å›è°ƒ interval?: number; // å®šæ—¶å™¨çš„æ—¶é—´é—´éš” é»˜è®¤200ms disableMenu?: boolean; // æ˜¯å¦ç¦ç”¨å³é”®èœå• é»˜è®¤ä¸ºtrue stopIntervalTime?: number; // åœ¨ç§»åŠ¨ç«¯æ—¶å–æ¶ˆç›‘è§†çš„ç­‰å¾…æ—¶é•¿ clearIntervalWhenDevOpenTrigger?: boolean; // æ˜¯å¦åœ¨è§¦å‘ä¹‹ååœæ­¢ç›‘æ§ é»˜è®¤ä¸ºfalseï¼Œ åœ¨ä½¿ç”¨ondevtoolcloseæ—¶è¯¥å‚æ•°æ— æ•ˆ detectors?: Array&lt;DetectorType&gt;; // å¯ç”¨çš„æ£€æµ‹å™¨ æ£€æµ‹å™¨è¯¦æƒ…è§ 3.5 é»˜è®¤ä¸ºå…¨éƒ¨ï¼Œå»ºè®®ä½¿ç”¨å…¨éƒ¨ clearLog?: boolean; // æ˜¯å¦æ¯æ¬¡éƒ½æ¸…é™¤log disableSelect?: boolean; // æ˜¯å¦ç¦ç”¨é€‰æ‹©æ–‡æœ¬ é»˜è®¤ä¸ºfalse disableCopy?: boolean; // æ˜¯å¦ç¦ç”¨å¤åˆ¶ é»˜è®¤ä¸ºfalse disableCut?: boolean; // æ˜¯å¦ç¦ç”¨å‰ªåˆ‡ é»˜è®¤ä¸ºfalse disablePaste: boolean; // æ˜¯å¦ç¦ç”¨ç²˜è´´ é»˜è®¤ä¸ºfalse ignore?: (string|RegExp)[] | null | (()=&gt;boolean); // æŸäº›æƒ…å†µå¿½ç•¥ç¦ç”¨ disableIframeParents?: boolean; // iframeä¸­æ˜¯å¦ç¦ç”¨æ‰€æœ‰çˆ¶çª—å£ timeOutUrl?: string; // å…³é—­é¡µé¢è¶…æ—¶è·³è½¬çš„url; rewriteHTML: string; // æ£€æµ‹åˆ°æ‰“å¼€ä¹‹åé‡å†™é¡µé¢}enum DetectorType { Unknown = -1, RegToString = 0, // æ ¹æ®æ­£åˆ™æ£€æµ‹ DefineId, // æ ¹æ®dom idæ£€æµ‹ Size, // æ ¹æ®çª—å£å°ºå¯¸æ£€æµ‹ DateToString, // æ ¹æ®Date.toString æ£€æµ‹ FuncToString, // æ ¹æ®Function.toString æ£€æµ‹ Debugger, // æ ¹æ®æ–­ç‚¹æ£€æµ‹ï¼Œä»…åœ¨ios chrome çœŸæœºæƒ…å†µä¸‹æœ‰æ•ˆ Performance, // æ ¹æ®logå¤§æ•°æ®æ€§èƒ½æ£€æµ‹ DebugLib, // æ£€æµ‹ç¬¬ä¸‰æ–¹è°ƒè¯•å·¥å…· eruda å’Œ vconsole }; å…³é”®æºç ç¦ç”¨å¿«æ·é”®12345678910111213141516171819202122232425262728293031323334353637const KEY = {J: 74, I: 73, U: 85, S: 83, F12: 123};// ç¦ç”¨ ctrl + shift + i/jconst isOpenDevToolKey = IS.macos ? ((e: KeyboardEvent, code: number) =&gt; (e.metaKey &amp;&amp; e.altKey &amp;&amp; (code === KEY.I || code === KEY.J))) : ((e: KeyboardEvent, code: number) =&gt; (e.ctrlKey &amp;&amp; e.shiftKey &amp;&amp; (code === KEY.I || code === KEY.J)));const isViewSourceCodeKey = IS.macos ? ((e: KeyboardEvent, code: number) =&gt; (e.metaKey &amp;&amp; e.altKey &amp;&amp; code === KEY.U) || (e.metaKey &amp;&amp; code === KEY.S)) : ((e: KeyboardEvent, code: number) =&gt; (e.ctrlKey &amp;&amp; (code === KEY.S || code === KEY.U)));target.addEventListener('keydown', (e) =&gt; {e = e || target.event;const keyCode = e.keyCode || e.which;if ( keyCode === KEY.F12 || // ç¦ç”¨f12 isOpenDevToolKey(e, keyCode) || // ç¦ç”¨ ctrl + shift + i isViewSourceCodeKey(e, keyCode) // ç¦ç”¨ ctrl + u å’Œ ctrl + s æŸ¥çœ‹å’Œä¿å­˜æºç ) { return preventEvent(target, e);}}, true);target.addEventListener('contextmenu', (e: Event &amp; {pointerType: string}) =&gt; { if (e.pointerType === 'touch') return; return preventEvent(target, e);});addPreventListener(target, 'selectstart');addPreventListener(target, 'copy');addPreventListener(target, 'cut');addPreventListener(target, 'paste');function addPreventListener (target: Window, name: string) { target.addEventListener(name, (e: Event) =&gt; { return preventEvent(target, e); });} æ£€æµ‹æ–¹æ³•DataToStringåˆ©ç”¨ ä¸æ‰“å¼€æ§åˆ¶ä¸ä¼šæ‰§è¡Œconsole.logï¼Œæ‰§è¡Œäº†ä¸¤æ¬¡toStringåè§†ä¸ºæ‰“å¼€äº†æ§åˆ¶å° 1234567891011121314151617init () { this.count = 0; this.date = new Date(); this.date.toString = () =&gt; { this.count ++; return ''; };}detect () { this.count = 0; log(this.date); clearLog(); if (this.count &gt;= 2) { this.onDevToolOpen(); }} definePropertyconsole.logè§¦å‘ getter çš„ç‰¹æ€§æ¥æ£€æµ‹æ˜¯å¦æ‰“å¼€äº†å¼€å‘è€…å·¥å…·ã€‚å½“æ§åˆ¶å°è¯•å›¾æ¸²æŸ“ this.div å¯¹è±¡æ—¶ï¼Œè§¦å‘äº† id å±æ€§çš„ getterï¼Œä»è€Œè°ƒç”¨ this.onDevToolOpen() æ¥å“åº”æ£€æµ‹ç»“æœã€‚ 123456789101112131415init () { this.div = document.createElement('div'); (this.div as any).__defineGetter__('id', () =&gt; { this.onDevToolOpen(); }); Object.defineProperty(this.div, 'id', { get: () =&gt; { this.onDevToolOpen(); }, });}detect () { log(this.div);} Detectoråˆ©ç”¨Functionçš„toString 1234567891011121314151617init () { this.count = 0; this.func = () =&gt; {}; this.func.toString = () =&gt; { this.count ++; return ''; };}detect () { this.count = 0; log(this.func); clearLog(); if (this.count &gt;= 2) { this.onDevToolOpen(); }} performanceé€šè¿‡æ§åˆ¶å°æ‰“å°å¤§å¯¹è±¡æ•°ç»„æ‰€èŠ±çš„å¤§é‡æ—¶é—´æ¥æ£€æµ‹å¼€å‘è€…å·¥å…·æ˜¯å¦è¢«æ‰“å¼€ 123456789101112131415161718init () { this.maxPrintTime = 0; this.largeObjectArray = createLargeObjectArray();}detect () { const tablePrintTime = calculateTime(() =&gt; {table(this.largeObjectArray);}); const logPrintTime = calculateTime(() =&gt; {log(this.largeObjectArray);}); this.maxPrintTime = Math.max(this.maxPrintTime, logPrintTime); clearLog(); if (tablePrintTime === 0 || this.maxPrintTime === 0) return false; if (tablePrintTime &gt; this.maxPrintTime * 10) { this.onDevToolOpen(); }} debuggeråŸç†åŒæœ¬æ–‡å¼€å¤´æ–¹å¼ 1234567detect () { const date = now(); (() =&gt; {debugger;})(); if (now() - date &gt; 100) { this.onDevToolOpen(); }} resizeé€šè¿‡ç›‘æµ‹å†…å¤–çª—å£å°ºå¯¸ï¼ˆå¦‚outerWidthå’ŒinnerWidthçš„å·®å€¼ï¼‰æ˜¯å¦å¼‚å¸¸å˜åŒ–æ¥æ£€æµ‹å¼€å‘è€…å·¥å…·çš„æ‰“å¼€çŠ¶æ€ 123456789101112131415161718192021222324252627282930313233343536373839init () { this.checkWindowSizeUneven(); window.addEventListener('resize', () =&gt; { setTimeout(() =&gt; { this.checkWindowSizeUneven(); }, 100); }, true);}// æ£€æµ‹å†…å¤–çª—å£çš„å¤§å°æ˜¯å¦å› devtoolè€Œäº§ç”Ÿå·®å€¼private checkWindowSizeUneven () { const screenRatio = countScreenZoomRatio(); if (screenRatio === false) { // å¦‚æœè·å–ä¸åˆ°å±å¹•ç¼©æ”¾å°ºå¯¸ åˆ™ä¸å¯ç”¨sizeDetector return true; } const widthUneven = window.outerWidth - window.innerWidth * screenRatio &gt; 200; // è°ƒå¤§ä¸€ç‚¹é˜²æ­¢è¯¯ä¼¤ const heightUneven = window.outerHeight - window.innerHeight * screenRatio &gt; 300; // è°ƒå¤§ä¸€ç‚¹é˜²æ­¢è¯¯ä¼¤ if (widthUneven || heightUneven) { this.onDevToolOpen(); return false; } clearDevToolOpenState(this.type); return true;}// è·å–åƒç´ æ¯”function countScreenZoomRatio () { if (checkExist(window.devicePixelRatio)) { return window.devicePixelRatio; } const screen = window.screen as any; if (checkExist(screen)) { return false; } if (screen.deviceXDPI &amp;&amp; screen.logicalXDPI) { return screen.deviceXDPI / screen.logicalXDPI; } return false;}; æ€»ç»“å…¶å®å°±ä¸‰ç§æ£€æµ‹ç±»å‹ resize console.log debugger ä½†äº§ç”Ÿäº†å¤šç§æ£€æµ‹å™¨ï¼Œä»è€Œå¢å¤§ç ´è§£çš„éš¾åº¦ ç ´è§£ä¹‹æ³•ç ´è§£ä¹‹æ³•1ä»…éœ€åœç”¨æ–­ç‚¹ï¼Œå³å¯ç ´è§£ ç ´è§£ä¹‹æ³•2åªè¦ä¸€å¾‹ä¸åœ¨æ­¤å¤„æš‚åœï¼ˆdebuggerï¼‰ï¼Œç”šè‡³è¿˜å¯ä»¥åŠ æ–­ç‚¹è°ƒè¯•ç½‘ç«™ ç ´è§£ä¹‹æ³•3å¯ä»¥æ·»åŠ æ¡ä»¶æ–­ç‚¹ ç ´è§£ä¹‹æ³•4å…ˆåœ¨ä¸€ä¸ªç©ºé¡µé¢æ‰“å¼€æ§åˆ¶å°ï¼Œå†è¿›å…¥é¡µé¢ï¼Œå¯ä»¥æ”»å‡»åªæœ‰debuggerçš„ç½‘ç«™ ç ´è§£ä¹‹æ³•5ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·æ›¿æ¢ä¿®æ”¹jsï¼ˆSourcesé¢æ¿ â€“&gt; Overridesï¼‰ï¼Œè¯¦æƒ…å¯çœ‹ï¼šåœ¨æœ¬åœ°æ›¿æ¢ Web å†…å®¹å’Œ HTTP å“åº”æ ‡å¤´ ç ´è§£ä¹‹æ³•5ç›´æ¥å®‰è£…æ²¹çŒ´è„šæœ¬å³å¯ï¼Œæˆ–è€…è‡ªå·±å†™ä¸€ä¸ª å‚è€ƒğŸ”åˆ«æƒ³è°ƒè¯•æˆ‘çš„å‰ç«¯é¡µé¢ä»£ç ğŸ”’âš”ï¸ä¸è®©æˆ‘åœ¨æ§åˆ¶å°ä¸Šè°ƒè¯•ï¼Œå“¼ï¼Œä¼‘æƒ³ğŸ› ï¸","link":"/2024/10/28/%E5%89%8D%E7%AB%AF%E5%AE%9E%E6%88%98%E6%8A%80%E5%B7%A7/%E7%A6%81%E6%AD%A2%E7%94%A8%E6%88%B7%E8%B0%83%E8%AF%95%E7%BD%91%E7%AB%99/"},{"title":"æ°´å¡˜æŠ½æ ·ç®—æ³•","text":"ç›®çš„æ°´å¡˜æŠ½æ ·çš„ç›®æ ‡æ˜¯ä»ä¸€ä¸ªå¾ˆå¤§çš„æˆ–æœªçŸ¥å¤§å°çš„æ•°æ®é›†ä¸­éšæœºé€‰å–kä¸ªæ ·æœ¬ã€‚ ç‰¹ç‚¹ï¼šä¸è¦æ±‚ä¸€æ¬¡æ€§è¯»å–æ‰€æœ‰æ•°æ®ï¼Œä¹Ÿä¸éœ€è¦çŸ¥é“æ•°æ®æ€»é‡ï¼Œèƒ½ä¿è¯æ¯ä¸ªå…ƒç´ è¢«é€‰ä¸­çš„æ¦‚ç‡ç›¸ç­‰ ç®—æ³•æ­¥éª¤ åˆå§‹åŒ–æ ·æœ¬æ± ï¼šå…ˆå°†æµä¸­çš„å‰kä¸ªå…ƒç´ æ”¾å…¥æ ·æœ¬æ± ã€‚ è¿­ä»£å¤„ç†å…ƒç´ ï¼šå¯¹äºç¬¬iä¸ªæ–°å…ƒç´ ï¼Œä»¥k/içš„æ¦‚ç‡å†³å®šæ˜¯å¦å°†å…¶æ›¿æ¢è¿›æ ·æœ¬æ± ã€‚ é€‰æ‹©æ›¿æ¢çš„å…ƒç´ ï¼šå¦‚æœæ–°å…ƒç´ éœ€è¦è¢«æ›¿æ¢è¿›æ ·æœ¬æ± ï¼Œéšæœºé€‰æ‹©æ ·æœ¬æ± ä¸­çš„ä¸€ä¸ªå…ƒç´ è¿›è¡Œæ›¿æ¢ã€‚ è¯æ˜è¿‡ç¨‹ å‰kä¸ªå…ƒç´ è¢«æ”¾å…¥æ ·æœ¬æ±  ç¬¬k+1ä¸ªå…ƒç´ è¢«é€‰ä¸­æ›¿æ¢çš„æ¦‚ç‡æ˜¯k / (k + 1) æ­¤æ—¶æ ·æœ¬æ± ä¸­çš„1-kä¸ªå…ƒç´ ä¿ç•™çš„æ¦‚ç‡ï¼š(1 - k / (k + 1)) + (k / (k + 1) * (k - 1) / k) = k / (k + 1)ï¼Œå³ æ²¡ä¸­k+1çš„æ¦‚ç‡ + é€‰ä¸­k+1ä½†æ²¡è¢«æ›¿æ¢çš„æ¦‚ç‡ ä»è€Œåˆ°k+1æ—¶ï¼Œæ‰€æœ‰å…ƒç´ ä¿ç•™åœ¨æ ·æœ¬æ± ä¸­ç­‰æ¦‚ç‡ ä»£ç å®ç°12345678910111213141516171819function getRandomInt(max) { return Math.floor(Math.random() * max);}function reservoir_sampling(data, k) { const reservoir = []; for (let i = 0; i &lt; k; i++) { reservoir.push(data[i]); } for (let i = k; i &lt; data.length; i++) { const j = getRandomInt(i); if (j &lt; k) { reservoir[j] = data[i]; } } return reservoir;}","link":"/2024/10/12/%E7%AE%97%E6%B3%95/%E6%B0%B4%E5%A1%98%E6%8A%BD%E6%A0%B7%E7%AE%97%E6%B3%95/"},{"title":"npm script","text":"ä¸²è¡Œ or å¹¶è¡Œå¹¶è¡Œè·‘å‘½ä»¤ï¼š&amp;ï¼Œåœ¨å‘½ä»¤ç»“å°¾åŠ &amp; waitï¼Œå¯ä»¥ä½¿ç”¨ctrl cå…³é—­å‘½ä»¤è¡Œæ¥ç»“æŸè¿›ç¨‹ä¸²è¡Œè·‘å‘½ä»¤ï¼š&amp;&amp; æ§åˆ¶æ—¥å¿—è¾“å‡º â€“silentï¼ˆ-sï¼‰ï¼šè¾“å‡ºå°½å¯èƒ½å°‘çš„æ—¥å¿— â€“verboseï¼šæ˜¾ç¤ºå°½å¯èƒ½å¤šçš„çŠ¶æ€ï¼Œæ—¥å¿—çº§åˆ«çš„è¾“å‡ºï¼Œç”¨äºè°ƒè¯• npmè‡ªåŠ¨è¡¥å…¨ ä¸æ”¯æŒworkspaceçš„ä»“åº“ npmå®˜æ–¹æ”¯æŒè¡¥å…¨ï¼šnpm-completion ç¬¬ 1 æ­¥ï¼ŒæŠŠ npm completion äº§ç”Ÿçš„å‘½ä»¤æ”¾åœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼š 1npm completion &gt;&gt; ~/.npm-completion.bash ç¬¬ 2 æ­¥ï¼Œåœ¨ .bashrc æˆ–è€… .zshrc ä¸­å¼•å…¥è¿™ä¸ªæ–‡ä»¶ï¼š 12echo &quot;[ -f ~/.npm-completion.bash ] &amp;&amp; source ~/.npm-completion.bash;&quot; &gt;&gt; ~/.bashrcecho &quot;[ -f ~/.npm-completion.bash ] &amp;&amp; source ~/.npm-completion.bash;&quot; &gt;&gt; ~/.zshrc æœ€åæ‰§è¡Œ source ~/.zshrc æˆ–è€… source ~/.bashrcï¼Œæ¥è®©è‡ªåŠ¨å®Œæˆç”Ÿæ•ˆã€‚ ä½¿ç”¨è¡¥å…¨æ–¹å¼ï¼šå°è¯•åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ npm runï¼Œç„¶åé”®å…¥ç©ºæ ¼ï¼ˆç©ºæ ¼å¾ˆé‡è¦ï¼‰ï¼Œç„¶åé”®å…¥ tab é”® ä¸€äº›è·¨å¹³å°çš„ç¬¬ä¸‰æ–¹åº“ rimraf æˆ– del-cliï¼Œç”¨æ¥åˆ é™¤æ–‡ä»¶å’Œç›®å½•ï¼Œå®ç°ç±»ä¼¼äº rm -rf çš„åŠŸèƒ½ï¼› cprï¼Œç”¨äºæ‹·è´ã€å¤åˆ¶æ–‡ä»¶å’Œç›®å½•ï¼Œå®ç°ç±»ä¼¼äº cp -r çš„åŠŸèƒ½ï¼› make-dir-cliï¼Œç”¨äºåˆ›å»ºç›®å½•ï¼Œå®ç°ç±»ä¼¼äº mkdir -p çš„åŠŸèƒ½ï¼› è·¨å¹³å°çš„å¼•ç”¨å˜é‡Linux ä¸‹ç›´æ¥å¯ä»¥ç”¨ $npm_package_nameï¼Œè€Œ Windows ä¸‹å¿…é¡»ä½¿ç”¨ %npm_package_name%ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ cross-var 1npm i cross-var -D ä½¿ç”¨æ–¹å¼1234 &quot;scripts&quot;: {- &quot;cover:open&quot;: &quot;opn http://localhost:$npm_package_config_port&quot;,+ &quot;cover:open&quot;: &quot;cross-var opn http://localhost:$npm_package_config_port&quot;, }, å¼•å…¥ cross-var ä¹‹åï¼Œå®ƒç«Ÿç„¶ç»™æˆ‘ä»¬å®‰è£…äº† babelï¼Œå¦‚æœæƒ³ä¿æŒä¾èµ–æ›´è½»é‡çš„è¯ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ cross-var-no-babel è·¨å¹³å°çš„ç¯å¢ƒå˜é‡å› ä¸ºä¸åŒå¹³å°çš„ç¯å¢ƒå˜é‡è¯­æ³•ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ cross-env æ¥å®ç° npm script çš„è·¨å¹³å°å…¼å®¹ 1npm i cross-env -D ä½¿ç”¨æ–¹å¼1234 &quot;scripts&quot;: {- &quot;test&quot;: &quot;NODE_ENV=test mocha tests/&quot;,+ &quot;test&quot;: &quot;cross-env NODE_ENV=test mocha tests/&quot;, }, æŠ½ç¦»scriptåˆ°å•ç‹¬æ–‡ä»¶å½“ npm script ä¸æ–­ç´¯ç§¯ã€è†¨èƒ€çš„æ—¶å€™ï¼Œå…¨éƒ¨æ”¾åœ¨ package.json é‡Œé¢å¯èƒ½å¹¶ä¸æ˜¯ä¸ªå¥½ä¸»æ„ï¼Œå› ä¸ºè¿™æ ·ä¼šå¯¼è‡´ package.json ç³Ÿä¹±ï¼Œå¯è¯»æ€§é™ä½ã€‚ å€ŸåŠ© scripty æˆ‘ä»¬å¯ä»¥å°† npm script å‰¥ç¦»åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼Œä»è€ŒæŠŠå¤æ‚æ€§éš”åˆ°å•ç‹¬çš„æ¨¡å—é‡Œé¢ï¼Œè®©ä»£ç æ•´ä½“çœ‹èµ·æ¥æ›´åŠ æ¸…æ™°ã€‚ 1npm i scripty -D ä½¿ç”¨æ–¹å¼æ‰§è¡Œnpm run foo:barä¼šå‘scripts/foo/barå¯»æ‰¾å¯æ‰§è¡Œè„šæœ¬å¹¶æ‰§è¡Œ 123&quot;scripts&quot;: { &quot;foo:bar&quot;: &quot;scripty&quot;} é’©å­npm script çš„è®¾è®¡è€…ä¸ºå‘½ä»¤çš„æ‰§è¡Œå¢åŠ äº†ç±»ä¼¼ç”Ÿå‘½å‘¨æœŸçš„æœºåˆ¶ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯ pre å’Œ post é’©å­è„šæœ¬ ä¸¾ä¾‹æ¥è¯´ï¼Œè¿è¡Œ npm run test çš„æ—¶å€™ï¼Œåˆ† 3 ä¸ªé˜¶æ®µï¼š æ£€æŸ¥ scripts å¯¹è±¡ä¸­æ˜¯å¦å­˜åœ¨ pretest å‘½ä»¤ï¼Œå¦‚æœæœ‰ï¼Œå…ˆæ‰§è¡Œè¯¥å‘½ä»¤ï¼› æ£€æŸ¥æ˜¯å¦æœ‰ test å‘½ä»¤ï¼Œæœ‰çš„è¯è¿è¡Œ test å‘½ä»¤ï¼Œæ²¡æœ‰çš„è¯æŠ¥é”™ï¼› æ£€æŸ¥æ˜¯å¦å­˜åœ¨ posttest å‘½ä»¤ï¼Œå¦‚æœæœ‰ï¼Œæ‰§è¡Œ posttest å‘½ä»¤ï¼› åœ¨ Git Hooks ä¸­æ‰§è¡Œ npm script1npm install -D husky åœ¨package.jsonå¢åŠ  12345{ &quot;scripts&quot;: { &quot;precommit&quot;: &quot;eslint src/**/*.js&quot; }} ä½†æ˜¯è¿™æ ·ä¼šæ£€æŸ¥åˆ°é¡¹ç›®ä¸­æ‰€æœ‰çš„linté”™è¯¯ï¼Œå¦‚ä½•åªæ£€æŸ¥æäº¤çš„æ–‡ä»¶å‘¢ï¼Ÿ éœ€è¦ç”¨åˆ°lint-staged 1npm install -D lint-staged package.jsonæ”¹ä¸ºå¦‚ä¸‹ï¼Œå°±å¯ä»¥åªlintæäº¤çš„æ–‡ä»¶å•¦ 12345678{ &quot;scripts&quot;: { &quot;precommit&quot;: &quot;lint-staged&quot; }, &quot;lint-staged&quot;: { &quot;src/**/*.js&quot;: &quot;eslint&quot; }} å‚è€ƒæ–‡ç« ç”¨ husky å’Œ lint-staged æ„å»ºè¶…æºœçš„ä»£ç æ£€æŸ¥å·¥ä½œæµ","link":"/2023/10/06/Js/npm-script/"},{"title":"Vueuseæºç è§£è¯»","text":"æœ¬æ–‡ä¸ä¼šæ”¾apiçš„ç”¨æ³•ï¼Œå»ºè®®å…ˆçœ‹çœ‹æ˜¯æ€ä¹ˆç”¨çš„ å†™æœ¬ç¯‡æ–‡ç« æ—¶é—´é—´éš”è¾ƒé•¿ï¼Œæ‰€ä»¥ä»£ç ç‰ˆæœ¬ä¸ä¸€ é¡¹ç›®æ¶æ„é‡‡ç”¨monorepoçš„å½¢å¼ï¼Œé¡¹ç›®ç›®å½•ä¸‹æœ‰å¤šä¸ªå­é¡¹ç›®ï¼Œä¸‹é¢æ”¾äº†èµ„æ–™é“¾æ¥å’Œå‡ å¤„ç”¨æ³•ï¼Œå…¶ä»–æœ¬æ–‡ä¸å¤šèµ˜è¿°ã€‚ ç°ä»£å‰ç«¯å·¥ç¨‹ä¸ºä»€ä¹ˆè¶Šæ¥è¶Šç¦»ä¸å¼€ Monorepo?ä¸ºä»€ä¹ˆä½¿ç”¨pnpmå¯ä»¥å…‰é€Ÿå»ºç«‹å¥½ç”¨çš„monorepoï¼ˆæ¯”yarn/lernaæ•ˆç‡é«˜ï¼‰pnpm workspaceæ–‡æ¡£ ä¸ºäº†ä½¿æ‰€æœ‰å­é¡¹ç›®éƒ½ä½¿ç”¨åŒä¸€ä¸ªä¾èµ–ç‰ˆæœ¬ï¼Œä½¿ç”¨pnpm.overridesé…ç½®ï¼Œå¦‚ä¸‹ 12345678{ &quot;pnpm&quot;: { &quot;overrides&quot;: { &quot;vue-demi&quot;: &quot;0.12.1&quot;, // åœ¨postinstallé’©å­ä¸­æ ¹æ®å½“å‰ç¯å¢ƒçš„vueç‰ˆæœ¬ï¼Œè·å–å…¼å®¹vue3å’Œvue2çš„api &quot;vite&quot;: &quot;^2.6.7&quot; } }} åœ¨æ­£å¸¸é…ç½®ä¸‹ï¼Œå¦‚æœç›´æ¥pnpm installå°†ä¼šåœ¨æ¯ä¸ªå­é¡¹ç›®çš„node_modulesæœ‰åŒæ ·çš„ä¾èµ–ï¼Œä½†æ˜¯æ‰€æœ‰å­é¡¹ç›®ç›¸åŒçš„ä¾èµ–å…¶å®åªéœ€è¦æå–å‡ºæ¥æ”¾åœ¨æ ¹ç›®å½•çš„node_modulesä¸‹å³å¯ï¼Œå¯é…ç½®å¦‚ä¸‹ 1234&quot;peerDependencies&quot;: { &quot;@vue/composition-api&quot;: &quot;^1.1.0&quot;, &quot;vue&quot;: &quot;^2.6.0 || ^3.2.0&quot;}, è¯¦æƒ…è¯·çœ‹å¦‚ä¸‹é“¾æ¥ æ¢è®¨npmä¾èµ–ç®¡ç†ä¹‹peerDependenciespnpm monorepoä¹‹å¤šç»„ä»¶å®ä¾‹å’ŒpeerDependencieså›°å¢ƒå›æº¯å¦‚ä½•å¤„ç† peers å‰ç½®çŸ¥è¯†unref - refçš„åæ“ä½œ å¦‚æœä¼ å…¥ä¸€ä¸ªrefï¼Œè¿”å›å…¶å€¼ å¦åˆ™åŸæ ·æ”¾å› 1234// æºç å®ç°function unref&lt;T&gt;(ref: T | Ref&lt;T&gt;): T { return isRef(ref) ? ref.value : ref} ä½¿ç”¨ä¾‹å­ï¼šå®ç°ä¸€ä¸ªå“åº”å¼çš„addå‡½æ•°ï¼Œå¯ä»¥ä¼ å…¥refæˆ–å€¼ 123456function add( a: Ref&lt;number&gt; | number, b: Ref&lt;number&gt; | number) { return computed(() =&gt; unref(a) + unref(b))} MaybeRefç±»å‹vueuseå¤§é‡ä½¿ç”¨MaybeRefæ¥æ”¯æŒå¯é€‰æ‹©æ€§çš„å“åº”å¼å‚æ•° 1type MaybeRef&lt;T&gt; = Ref&lt;T&gt; | T ä¸Šé¢çš„åŠ æ³•å‡½æ•°å°±å¯ä»¥ç®€å†™ä¸º 123function add(a: MaybeRef&lt;number&gt;, b: MaybeRef&lt;number&gt;) { return computed(() =&gt; unref(a) + unref(b))} Effectä½œç”¨åŸŸAPIVueå®˜æ–¹æ–‡æ¡£ï¼šEffect ä½œç”¨åŸŸ API åŠ¨æœº åœ¨Vueçš„setupä¸­ï¼Œå“åº”å¼effectä¼šåœ¨åˆå§‹åŒ–çš„æ—¶å€™è¢«æ”¶é›†ï¼Œåœ¨å®ä¾‹è¢«å¸è½½çš„æ—¶å€™ï¼Œå“åº”å¼effectå°±ä¼šè‡ªåŠ¨è¢«å–æ¶ˆäº†ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬åœ¨ç»„ä»¶å¤–å†™ä¸€ä¸ªç‹¬ç«‹çš„åŒ…ï¼ˆå°±å¦‚vueuseï¼‰æ—¶ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•å–æ¶ˆcomputed &amp; watchçš„å“åº”å¼ä¾èµ–å‘¢ï¼Ÿvue3.2æå‡ºäº†effectScopeï¼Œæ¥ä¸‹æ¥ä»‹ç»ç›¸å…³çš„api effectScopeåˆ©ç”¨effectScopeåˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸå¯¹è±¡ï¼Œå¦‚ä¸‹é¢æ¥å£å®šä¹‰æ‰€ç¤ºï¼Œrunæ¥å—ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªä½œç”¨åŸŸå¯¹è±¡ä¼šè‡ªåŠ¨æ•è·å‡½æ•°å†…éƒ¨çš„å“åº”å¼effect (ä¾‹å¦‚è®¡ç®—å±æ€§æˆ–ä¾¦å¬å™¨) ç±»å‹ 123456function effectScope(detached?: boolean): EffectScopeinterface EffectScope { run&lt;T&gt;(fn: () =&gt; T): T | undefined // å¦‚æœè¿™ä¸ªåŸŸä¸æ´»è·ƒåˆ™ä¸º undefined stop(): void} ç¤ºä¾‹ 12345678910const scope = effectScope()scope.run(() =&gt; { const doubled = computed(() =&gt; counter.value * 2) watch(doubled, () =&gt; console.log(doubled.value)) watchEffect(() =&gt; console.log('Count: ', doubled.value))})// ä¸¢å¼ƒ(dispose) è¯¥ä½œç”¨åŸŸå†…çš„æ‰€æœ‰ effectscope.stop() getCurrentScopeå¦‚æœæœ‰ï¼Œåˆ™è¿”å›å½“å‰æ´»è·ƒçš„ effect ä½œç”¨åŸŸã€‚ ç±»å‹ 1function getCurrentScope(): EffectScope | undefined onScopeDisposeåœ¨å½“å‰æ´»è·ƒçš„ effect ä½œç”¨åŸŸä¸Šæ³¨å†Œä¸€ä¸ªå¤„ç†å›è°ƒã€‚è¯¥å›è°ƒä¼šåœ¨ç›¸å…³çš„ effect ä½œç”¨åŸŸç»“æŸä¹‹åè¢«è°ƒç”¨ï¼Œåœ¨VCAï¼ˆVue Composition APIï¼‰å‡½æ•°ä¸­å¯ç”¨ä½œonUnmountedçš„éç»„ä»¶æ›¿ä»£å“ï¼ŒåŒºåˆ«åœ¨äºå…¶å·¥ä½œåœ¨scopeä¸­è€Œä¸æ˜¯ç»„ä»¶å®ä¾‹ 1234// å½“å‰ effectScope ç»“æŸåè°ƒç”¨onScopeDispose(() =&gt; { window.removeEventListener('mousemove', handler)}) é‚£ä¹ˆå¦‚æ­¤æŠ½è±¡çš„effectScopeåœ¨å°¤å¤§é™ä½å¿ƒæ™ºè´Ÿæ‹…çš„ä¸»å¼ ä¸‹ä¸ºä»€ä¹ˆè¦è¢«æå‡ºå‘¢ï¼Œä¸‹é¢åˆ—äº†ä¸ªå®˜æ–¹rfcä¸­çš„ä¾‹å­ ç¤ºä¾‹ åœ¨vueçš„rfcä¸­reactivity-effect-scopeæœ‰è¿™æ ·çš„ä¸€ä¸ªä¾‹å­ï¼Œå¦‚æœæœ‰ä¸ªç›‘æ§é¼ æ ‡ä½ç½®çš„hookï¼ˆuseMouseï¼‰ï¼Œéœ€è¦ç›‘å¬mousemoveäº‹ä»¶ï¼Œå¦‚æœåœ¨å¤šä¸ªç»„ä»¶è°ƒç”¨äº†è¿™ä¸ªhookï¼Œè€Œå†…éƒ¨æ˜¯é€šè¿‡åœ¨onUnmountedé’©å­æ¥ç§»é™¤mousemoveç›‘å¬å™¨ï¼ŒonUnmountedè€¦åˆåœ¨æ¯ä¸ªç»„ä»¶å®ä¾‹ï¼Œåˆ™æ— æ³•ä»¥æ›´æœ‰æ•ˆç‡çš„æ–¹å¼å…±äº«è¿™ä¸ªmousemoveç›‘å¬å™¨ï¼ˆå³ï¼‰ ä¸ºäº†åšåˆ°åœ¨ç»„ä»¶é—´å…±äº«useMouseçš„å“åº”å¼effectå’Œç›‘å¬å™¨ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥ç®¡ç†scopeå¦‚ä¸‹ï¼ˆè¿™ä¸ªhookä¹Ÿåœ¨vueuseä¸­ï¼‰ 123456789101112131415161718192021function createSharedComposable(composable) { let subscribers = 0 // è®¢é˜…è®¡æ•°å™¨ï¼Œæ¯æ¬¡è°ƒç”¨subscribers + 1 let state, scope const dispose = () =&gt; { if (scope &amp;&amp; --subscribers &lt;= 0) { scope.stop() state = scope = null } } return (...args) =&gt; { subscribers++ if (!state) { // åªåœ¨ç¬¬ä¸€æ¬¡åˆ›å»ºeffectScope scope = effectScope(true) // trueä¸ºç‹¬ç«‹çš„scopeä½œç”¨åŸŸ state = scope.run(() =&gt; composable(...args)) } onScopeDispose(dispose) // åœ¨å½“å‰æ´»è·ƒçš„effectä½œç”¨åŸŸä¸Šæ³¨å†Œä¸€ä¸ªå›è°ƒ return state }} å¯ä»¥çœ‹åˆ°disposeå‡½æ•°çš„å«ä¹‰æ˜¯ï¼Œå½“æ²¡æœ‰ä¸€ä¸ªç»„ä»¶åœ¨ä½¿ç”¨å®ƒçš„æ—¶å€™ä¼šæ³¨é”€(dispose)åˆ›å»ºçš„effectScopeï¼Œæˆ‘ä»¬åªéœ€è¦å¦‚ä¸‹æ“ä½œï¼Œå³å¯å¾—åˆ°ä¸€ä¸ªåœ¨æ‰€æœ‰ç»„ä»¶å…±äº«çš„useMouse 1const useSharedMouse = createSharedComposable(useMouse) æ›´åŠ è¯¦ç»†çš„å…³äºeffectScopeçš„è®¨è®ºåœ¨Reactivityâ€™s effectScope API #212 æœ¬æ¥æ˜¯æ‰“ç®—å®Œå…¨æŒ‰ç…§å®˜ç½‘çš„åˆ†ç±»è¿›è¡Œè§£è¯»ï¼Œä½†æ˜¯ç”±äºVCAï¼ˆVue Composition APIï¼‰çš„æ€æƒ³ï¼Œhookè¢«æ‹†çš„å¾ˆç¢å†ç»„åˆåœ¨ä¸€èµ·ï¼Œå¹¶ä¸èƒ½å•çº¯é åˆ†ç±»è¿›è¡Œè§£è¯»ï¼Œæ‰€ä»¥åœ¨è®²æŸä¸ªåˆ†ç±»çš„hookæ—¶ä¹Ÿä¼šå¸¦ä¸Šå…¶ä»–çš„hooksï¼Œæ¥ä¸‹æ¥æ˜¯å¯¹æˆ‘è§‰å¾— å¸¸ç”¨ æˆ–è€… æœ‰å­¦ä¹ åˆ°ä¸œè¥¿ çš„hookæºç è¿›è¡Œè§£è¯» StatecreateGlobalState ç”¨æ¥åšæŒ‚ç»„ä»¶å…¬å…±çŠ¶æ€ç®¡ç† ç®€å•çš„å•ä¾‹æ¨¡å¼å®ç°ï¼ŒeffectScopeçš„å‚æ•°ä¸ºtrueæ—¶ï¼Œå…¶ä¸ä¼šè¢«çˆ¶scopeæ”¶é›†å’Œå›æ”¶ï¼Œç‹¬ç«‹å­˜åœ¨ 123456789101112131415export function createGlobalState&lt;T&gt;( stateFactory: () =&gt; T,): CreateGlobalStateReturn&lt;T&gt; { let initialized = false let state: T const scope = effectScope(true) return () =&gt; { if (!initialized) { state = scope.run(stateFactory)! initialized = true } return state }} useLocalStorage12345678export function useLocalStorage&lt;T extends(string|number|boolean|object|null)&gt; ( key: string, initialValue: MaybeRef&lt;T&gt;, options: StorageOptions&lt;T&gt; = {},): RemovableRef&lt;any&gt; { const { window = defaultWindow } = options return useStorage(key, initialValue, window?.localStorage, options)} å¯ä»¥çœ‹åˆ°å°±æ˜¯ç”¨useStorageæ¥å®ç°çš„ï¼ŒuseSessionStorageä¹Ÿæ˜¯ä¸€æ ·ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹useStorage useStorageåœ¨æµè§ˆå™¨é»˜è®¤çš„Storageä¹‹ä¸Šåƒstore.jsä¸€æ ·å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ï¼ˆåºåˆ—åŒ–ï¼‰ï¼Œå¦åˆ™å¦‚æœå­˜ä¸€ä¸ªå¯¹è±¡åœ¨æµè§ˆå™¨çš„Storageå­˜çš„ä¼šæ˜¯xxx.toString()ä¹‹åçš„å€¼ã€‚ä½†æ˜¯useStorageæ¯”èµ·store.jsæ›´è¿›ä¸€æ­¥çš„å¢åŠ äº†å¯¹Mapå’ŒSetç±»å‹çš„æ•°æ®çš„å¤„ç†ï¼ˆMapå’ŒSetå­˜åœ¨é»˜è®¤çš„Storageå’Œstore.jséƒ½æ˜¯ç©ºå¯¹è±¡ï¼‰ åˆ©ç”¨é€‚é…å™¨æ¨¡å¼ï¼Œå¯¹æ¯ç§æ•°æ®ç±»å‹å®šä¹‰readã€write 123456789101112131415161718192021222324252627282930export const StorageSerializers: Record&lt;'boolean' | 'object' | 'number' | 'any' | 'string' | 'map' | 'set', Serializer&lt;any&gt;&gt; = { boolean: { read: (v: any) =&gt; v === 'true', write: (v: any) =&gt; String(v), }, object: { read: (v: any) =&gt; JSON.parse(v), write: (v: any) =&gt; JSON.stringify(v), }, number: { read: (v: any) =&gt; Number.parseFloat(v), write: (v: any) =&gt; String(v), }, any: { read: (v: any) =&gt; v, write: (v: any) =&gt; String(v), }, string: { read: (v: any) =&gt; v, write: (v: any) =&gt; String(v), }, map: { // mapåºåˆ—åŒ– read: (v: any) =&gt; new Map(JSON.parse(v)), write: (v: any) =&gt; JSON.stringify(Array.from((v as Map&lt;any, any&gt;).entries())), }, set: { // setåºåˆ—åŒ– read: (v: any) =&gt; new Set(JSON.parse(v)), write: (v: any) =&gt; JSON.stringify(Array.from((v as Set&lt;any&gt;).entries())), },} æ¥ä¸‹æ¥åˆ¤æ–­ç”¨æˆ·ä¼ å…¥çš„æ•°æ®ç±»å‹ï¼Œè¿›è¡Œé€‰æ‹©å¯¹åº”çš„readã€writeæ–¹æ³• 12345678910111213141516171819202122export function guessSerializerType&lt;T extends(string | number | boolean | object | null)&gt;(rawInit: T) { return rawInit == null ? 'any' : rawInit instanceof Set ? 'set' : rawInit instanceof Map ? 'map' : rawInit instanceof Date ? 'date' : typeof rawInit === 'boolean' ? 'boolean' : typeof rawInit === 'string' ? 'string' : typeof rawInit === 'object' ? 'object' : !Number.isNaN(rawInit) ? 'number' : 'any'}const type = guessSerializerType&lt;T&gt;(rawInit)const serializer = options.serializer ?? StorageSerializers[type] // ç”¨æˆ·è¿˜å¯ä»¥å®šä¹‰è‡ªå·±çš„åºåˆ—åŒ–æ–¹æ³•ï¼Œä½†å¿…é¡»å…·æœ‰readå’Œwriteæ–¹æ³• ä¸‹é¢æ˜¯å¯¹æ•°æ®çš„åˆå§‹åŒ– 1234567891011121314151617181920const rawInit: T = unref(initialValue) // ç”¨æˆ·ä¼ å…¥çš„åˆå§‹å€¼const data = (shallow ? shallowRef : ref)(initialValue) as Ref&lt;T&gt; // ç”¨æˆ·å¯ä»¥é…ç½®æ˜¯æµ…å“åº”å¼è¿˜æ˜¯æ·±ï¼Œæœ€åä¼šè¿”å›ç»™ç”¨æˆ·if (!storage) returntry { const rawValue = storage.getItem(key) if (rawValue == null) { // å¦‚æœkeyå¯¹åº”çš„å€¼ä¸ºç©ºï¼Œé‚£ä¹ˆæ˜¯é¦–æ¬¡ data.value = rawInit // åˆå§‹åŒ–å€¼ if (writeDefaults &amp;&amp; rawInit !== null) // ç”¨æˆ·å¯é…ç½®ï¼ˆwriteDefaultsï¼‰æ˜¯å¦é¦–æ¬¡å­˜å…¥Storage storage.setItem(key, serializer.write(rawInit)) } else { data.value = serializer.read(rawValue) // å¦‚æœStorageå­˜åœ¨å¯¹åº”å€¼ï¼Œåºåˆ—åŒ–è¯»å– }}catch (e) { onError(e) // ç”¨æˆ·ä¼ å…¥çš„é”™è¯¯å¤„ç†å‡½æ•°} ç„¶åæ˜¯æ ¹æ®ç›‘å¬dataçš„å˜åŒ–å­˜å…¥Storageï¼ŒwatchWithFilterå¯ä»¥çœ‹åšæ˜¯æ–°å¢äº†eventFilteré€‰é¡¹çš„watchï¼Œåœ¨åæ–‡ä¼šæè¿°ï¼Œä¹Ÿæ˜¯vueuseå¾ˆé‡è¦çš„ä¸€ä¸ªç‰¹æ€§ 12345678910111213141516171819watchWithFilter( data, () =&gt; { try { if (data.value == null) storage.removeItem(key) else storage.setItem(key, serializer.write(data.value)) } catch (e) { onError(e) } }, { flush, // å‡æ˜¯ç”¨æˆ·å¯é…ç½®çš„é€‰é¡¹ deep, eventFilter, },) æ˜¯ä¸æ˜¯è§‰å¾—å¾ˆOKäº†ï¼Œä½†ä»æœ‰å·¨éšè”½çš„bugï¼ˆå“ˆå“ˆå“ˆ)ï¼Œä¸ºäº†æ”¯æŒå“åº”å¼çš„å­˜å–Storageï¼Œç”¨äº†refç±»å‹çš„dataï¼Œåœ¨åŒæºä¸‹çš„å¤šä¸ªæ ‡ç­¾çš„æƒ…å†µä¸‹ï¼Œå…¶ä¸­ä¸€ä¸ªé¡µé¢å¯¹å¦ä¸€ä¸ªé¡µé¢ç”¨useStorageä¿®æ”¹äº†æ•°æ®ï¼Œä½†å¦ä¸€ä¸ªé¡µé¢useStorageå†…éƒ¨çš„dataè¿˜æ˜¯åŸæ¥çš„å€¼ è§£å†³æ–¹å¼ï¼šç›‘å¬storageäº‹ä»¶ï¼ˆå½“é¡µé¢ä½¿ç”¨çš„storageè¢«å…¶ä»–é¡µé¢ä¿®æ”¹æ—¶ä¼šè§¦å‘ï¼‰ 123456789101112131415function read(event?: StorageEvent) { // å°†ä¸Šé¢åˆå§‹åŒ–å€¼çš„é€»è¾‘å°è£…ä¸ºreadå‡½æ•° if (!storage || (event &amp;&amp; event.key !== key)) return try { const rawValue = event ? event.newValue : storage.getItem(key) // è¯»å€¼çœç•¥... } catch (e) { onError(e) }}if (window &amp;&amp; listenToStorageChanges) // ç”¨æˆ·ä¹Ÿå¯ä»¥é…ç½®ï¼ˆlistenToStorageChangesï¼‰ä¸ç›‘å¬ useEventListener(window, 'storage', e =&gt; setTimeout(() =&gt; read(e), 0)) // é‡æ–°è¯»å–å€¼ç»™data Browser æµè§ˆå™¨ç›¸å…³çš„hookï¼ŒåŸºäºwebæš´éœ²çš„apiæ¥å®ç° å¯é…ç½®å…¨å±€å¯¹è±¡Browser hookçš„æºç å¼€å¤´éƒ½æœ‰æˆ–ç±»ä¼¼ä¸‹é¢è¿™ä¸€æ®µ 1234567export const defaultWindow = /* #__PURE__ */ isClient ? window : undefinedexport function useXXX&lt;T&gt;(options: ConfigurableWindow = {}) { const { window = defaultWindow } = options window.xxx // ...} ç”¨æˆ·å¯ä»¥é…ç½®å½“å‰windowå¯¹è±¡ï¼Œè¿™ç§é…ç½®æ–¹å¼å¯¹äºä½¿ç”¨iframeå’Œæµ‹è¯•ç¯å¢ƒä¸åŒçš„windowå¯¹è±¡ååˆ†æœ‰ç”¨ useEventListenerå…ˆä¸Šä¸€ä¸ªç®€æ˜“ç‰ˆæœ¬çš„useEventListenerï¼Œåˆ©ç”¨VCAï¼Œå°†äº‹ä»¶çš„ç›‘å¬å’Œæ³¨é”€æ”¾åœ¨ä¸€ä¸ªå‡½æ•°ä¸­å¤„ç† 123456789function useEventListener (target, listener, options, target = window) { onMounted(() =&gt; { target.addEventListener(type, listener, options) }) onUnmounted(() =&gt; { target.removeEventListener(type, listener, options) })} é™¤æ­¤ä¹‹å¤–ï¼Œæºç è¿˜æä¾›äº†å½“targetçš„ç±»å‹æ˜¯refæ—¶çš„æƒ…å†µï¼Œä¸ºäº†å‡å°‘ç¯‡å¹…ï¼Œä¸‹é¢çš„ä»£ç åˆ å‡äº†å‚æ•°ä¸ºç©ºçš„è¾¹ç•Œæƒ…å†µ 12345678910111213141516171819202122232425262728293031323334353637export function useEventListener(...args: any[]) { let target: MaybeRef&lt;EventTarget&gt; | undefined = defaultWindow; let event: string let listener: any let options: any [target, event, listener, options] = args let cleanup = noop const stopWatch = watch( () =&gt; unref(target), (el) =&gt; { cleanup() if (!el) return el.addEventListener(event, listener, options) cleanup = () =&gt; { el.removeEventListener(event, listener, options) cleanup = noop } }, { immediate: true, flush: 'post' }, // ä¸ºä»€ä¹ˆflushæ˜¯postï¼Ÿä¸‹é¢ä¼šè®²è§£ ) const stop = () =&gt; { stopWatch() cleanup() } tryOnScopeDispose(stop) // è¿˜è®¾è®¡äº†è¿”å›stopå‡½æ•°ï¼Œå¯ä»¥è°ƒç”¨useEventListenerè¿”å›çš„å‡½æ•°ç›´æ¥å›æ”¶ return stop} ä¸ºä»€ä¹ˆéœ€è¦æ”¯æŒref targetç”¨unrefå¾—åˆ°refä¸­çš„domå…ƒç´ ï¼Œç›‘å¬domå…ƒç´ çš„æ”¹å˜ä»¥é‡æ–°ç›‘å¬äº‹ä»¶ï¼Œåº”ç”¨åœºæ™¯å°±æ”¾å®˜ç½‘ä¾‹å­ 1234&lt;template&gt; &lt;div v-if=&quot;cond&quot; ref=&quot;element&quot;&gt;Div1&lt;/div&gt; &lt;div v-else ref=&quot;element&quot;&gt;Div2&lt;/div&gt;&lt;/template&gt; 1234import { useEventListener } from '@vueuse/core'const element = ref&lt;HTMLDivElement&gt;()useEventListener(element, 'keydown', (e) =&gt; { console.log(e.key) }) ä¸ºä»€ä¹ˆéœ€è¦watchè®¾ç½®flushä¸ºpostè¯¦æƒ…è¯·çœ‹#356 Bug: useEventListener doesnâ€™t work correctly with v-ifï¼Œæ„æ€å°±æ˜¯æ–°ç‰ˆvueçš„watché»˜è®¤åœ¨æ‰€æœ‰ç»„ä»¶updateå‰æ‰§è¡Œï¼Œé‚£ä¹ˆrefæ²¡æœ‰æ›´æ–°å¯¼è‡´äº‹ä»¶æ²¡æœ‰æ›´æ–°ï¼Œæ‰€ä»¥éœ€è¦åœ¨ç»„ä»¶updateå®Œæ¯•åæ›´æ–°äº‹ä»¶ã€‚ tryOnScopeDisposeæ˜¯å•¥å…ˆåˆ¤æ–­æ˜¯å¦æœ‰æ´»è·ƒçš„effectScopeï¼Œæœ‰çš„è¯ç”¨onScopeDisposeåœ¨å…¶ä¸Šæ³¨å†Œfnå›è°ƒ 1234567export function tryOnScopeDispose(fn: Fn) { if (getCurrentScope()) { onScopeDispose(fn) return true } return false} v10.4.1æ›´æ–°ï¼šæ”¯æŒeventä¼ é€’æ•°ç»„ï¼Œæ–¹ä¾¿æµè§ˆå™¨å…¼å®¹äº‹ä»¶ useEyeDroppernew window.EyeDropper()å¯ä»¥è·å–å–è‰²å™¨çš„åŠŸèƒ½ usePreferredReducedMotionprefers-reduced-motionç”¨äºæ£€æµ‹ç”¨æˆ·çš„ç³»ç»Ÿæ˜¯å¦è¢«å¼€å¯äº†åŠ¨ç”»å‡å¼±åŠŸèƒ½ 1useMediaQuery('(prefers-reduced-motion: reduce)', options) usePreferredContrastprefers-contraståˆ¤æ–­ç”¨æˆ·å–œæ¬¢ä½•ç§å¯¹æ¯”åº¦ï¼ˆmoreã€lessã€customï¼‰ useMediaQuerywindow.matchMedia(query)è¿”å›MediaQueryListç±»å‹ 12345678interface MediaQueryList extends EventTarget { // æµè§ˆå™¨åŸç”Ÿç±»å‹ readonly matches: boolean; // æ˜¯å¦åŒ¹é… readonly media: string; // åª’ä½“æŸ¥è¯¢å€¼ onchange: ((this: MediaQueryList, ev: MediaQueryListEvent) =&gt; any) | null; // åª’ä½“æŸ¥è¯¢æ”¹å˜å›è°ƒ // äº‹ä»¶ç»‘å®šç›¸å…³...}let mql: MediaQueryList = window.matchMedia('(max-width: 600px)'); usePermissionnavigator.permissionså¯ä»¥è·å–ç”¨æˆ·æƒé™ï¼ˆæ‘„åƒå¤´ã€éº¦å…‹é£ç­‰ï¼‰ 123456789101112131415161718const isSupported = Boolean(navigator &amp;&amp; 'permissions' in navigator)const state = ref&lt;PermissionState | undefined&gt;() // å­˜æƒé™çŠ¶æ€const onChange = () =&gt; { if (permissionStatus) state.value = permissionStatus.state}try { permissionStatus = await navigator!.permissions.query({ name: 'camera' // https://w3c.github.io/permissions/#enumdef-permissionname }) useEventListener(permissionStatus, 'change', onChange) // æœ‰ä¸‰ä¸ªçŠ¶æ€ denied&quot; | &quot;granted&quot; | &quot;prompt&quot; onChange()}catch { state.value = 'prompt'} usePreferredLanguagesnavigator.languageså¯ä»¥è·å–ç”¨æˆ·çš„åå¥½è¯­è¨€ï¼Œå¯ä»¥é€šè¿‡languagechangeäº‹ä»¶ç›‘å¬æ”¹å˜ 12345const value = ref&lt;readonly string[]&gt;(navigator.languages)useEventListener(window, 'languagechange', () =&gt; { value.value = navigator.languages}) useSharenavigator.shareå¯ä»¥è¿›è¡Œåˆ†äº« 12345678910111213const isSupported = navigator &amp;&amp; 'canShare' in navigatorif (isSupported) { granted = navigator.canShare({ // åˆ¤æ–­æ˜¯å¦èƒ½è¢«åˆ†äº« title?: string files?: File[] text?: string url?: string }) if (granted) return navigator.share!(data)} useWakeLock Screen Wake Lock APIå¯ä»¥é˜»æ­¢è®¾å¤‡å˜æš—æˆ–é”å± 123456789101112const isSupported = navigator &amp;&amp; 'wakeLock' in navigatorfunction request(type: WakeLockType) { if (!isSupported) return wakeLock = await navigator.wakeLock.request(type)}function release() { if (!isSupported || !wakeLock) return await wakeLock.release() // é‡Šæ”¾WakeLockSentinel wakeLock = null} useVibrate Vibration APIå¯ä»¥ä½¿è®¾å¤‡æŒ¯åŠ¨ 12window.navigator.vibrate([200, 100, 200]); // è®¾å¤‡æŒ¯åŠ¨ 200 msï¼Œç„¶åæš‚åœ 100 msï¼Œç„¶åå†æ¬¡æŒ¯åŠ¨è®¾å¤‡ 200 msnavigator.vibrate(0); // åœæ­¢æŒ¯åŠ¨ useWebNotificationNotificationå¯ä»¥ç»™ç”¨æˆ·å‘é€æ¶ˆæ¯ useFullscreenFullscreen_APIç”¨ä»¥æ§åˆ¶å…¨å±å±•ç¤ºï¼Œè™½ç„¶å¸¸è§ï¼Œä½†æ˜¯çœ‹æºç å¯¹å…¼å®¹æ€§æœ‰äº†å¤šä¸€å±‚è€ƒè™‘ 1234567891011121314151617181920212223242526272829303132333435363738394041424344// è¯·æ±‚å…¨å±const requestMethod = computed&lt;'requestFullscreen' | undefined&gt;(() =&gt; { return [ 'requestFullscreen', 'webkitRequestFullscreen', 'webkitEnterFullscreen', 'webkitEnterFullScreen', 'webkitRequestFullScreen', 'mozRequestFullScreen', 'msRequestFullscreen', ].find(m =&gt; (document &amp;&amp; m in document) || (targetRef.value &amp;&amp; m in targetRef.value)) as any})// é€€å‡ºå…¨å±const exitMethod = computed&lt;'exitFullscreen' | undefined&gt;(() =&gt; { return [ 'exitFullscreen', 'webkitExitFullscreen', 'webkitExitFullScreen', 'webkitCancelFullScreen', 'mozCancelFullScreen', 'msExitFullscreen', ].find(m =&gt; (document &amp;&amp; m in document) || (targetRef.value &amp;&amp; m in targetRef.value)) as any})// å½“å‰æ˜¯å¦å¤„äºå…¨å±çŠ¶æ€çš„åˆ¤æ–­const fullscreenEnabled = computed&lt;'fullscreenEnabled' | undefined&gt;(() =&gt; { return [ 'fullScreen', 'webkitIsFullScreen', 'webkitDisplayingFullscreen', 'mozFullScreen', 'msFullscreenElement', ].find(m =&gt; (document &amp;&amp; m in document) || (targetRef.value &amp;&amp; m in targetRef.value)) as any})// è·å–å½“å‰å…¨å±å…ƒç´ çš„æ–¹æ³•åconst fullscreenElementMethod = [ 'fullscreenElement', 'webkitFullscreenElement', 'mozFullScreenElement', 'msFullscreenElement',].find(m =&gt; (document &amp;&amp; m in document)) as 'fullscreenElement' | undefined åˆ©ç”¨é€‚é…å™¨çš„æ–¹å¼è¿›è¡Œè°ƒç”¨ï¼Œtarget[requestMethod.value]() ä¸‹é¢æ˜¯ä¸åŒæµè§ˆå™¨ç›‘å¬å…¨å±€å˜åŒ–çš„äº‹ä»¶å 12345678910const eventHandlers = [ 'fullscreenchange', 'webkitfullscreenchange', 'webkitendfullscreen', 'mozfullscreenchange', 'MSFullscreenChange',]// useEventListeneræ”¯æŒä¼ æ•°ç»„useEventListener(() =&gt; unrefElement(targetRef), eventHandlers, handlerCallback, false) SensorsonStartTypingåœ¨å¼€å§‹è¾“å…¥çš„æ—¶å€™æ‰§è¡Œï¼Œæˆ‘ä»¬å¯ä»¥æ‹¿æ¥åšåˆ°ä¸ç®¡ç¼–è¾‘å™¨æ˜¯å¦èšç„¦ï¼Œåªè¦è¾“å…¥å°±èšç„¦åˆ°ç¼–è¾‘å™¨å¹¶è¾“å…¥ 1234567891011export function onStartTyping(callback: (event: KeyboardEvent) =&gt; void, options: ConfigurableDocument = {}) { const { document = defaultDocument } = options const keydown = (event: KeyboardEvent) =&gt; { isTypedCharValid(event) // æ£€æµ‹æ˜¯å¦æ˜¯æœ‰æ•ˆè¾“å…¥ 0...9 A...Z a...z &amp;&amp; callback(event) } if (document) useEventListener(document, 'keydown', keydown, { passive: true })} åœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šè¿˜éœ€è¦åšä¸€ç‚¹ï¼Œå¦‚æœå·²ç»èšç„¦åˆ°non-editable elementsï¼Œé‚£ä¹ˆå°±ä¸æ‰§è¡Œï¼Œå¦‚ä½•æ£€æµ‹non-editable elementså‘¢ï¼Œå¦‚ä¸‹ 1234567891011121314151617function isFocusedElementEditable() { const { activeElement, body } = document if (!activeElement) return false if (activeElement === body) return false switch (activeElement.tagName) { case 'INPUT': case 'TEXTAREA': return true } return activeElement.hasAttribute('contenteditable')} useMagicKeysæ°å¦‚å…¶åï¼Œmagicï¼Œå…ˆä¸Šç”¨æ³• 123456const { space, shift } = useMagicKeys()watch(space, (v) =&gt; { if (v) console.log('space has been pressed')}) åˆæ²¡ä¼ å‚ï¼Œä»–æ€ä¹ˆç›‘å¬åˆ°æˆ‘è¦çš„spaceå’Œshiftï¼Œéš¾ä¸æˆä»–è¿”å›äº†æ‰€æœ‰é”®ï¼Ÿé‚£å½“ç„¶ä¸æ˜¯ï¼Œä¸Šæºç ï¼ˆæŠ½ç¦»äº†å…³é”®é€»è¾‘ï¼‰ 12345678910111213141516171819202122232425262728293031323334export function useMagicKeys(options: UseMagicKeysOptions&lt;boolean&gt; = {}): any { const current = reactive(new Set&lt;string&gt;()) const obj = { toJSON() { return {} }, current, } const refs: Record&lt;string, any&gt; = useReactive ? reactive(obj) : obj useEventListener(target, 'keydown', (e: KeyboardEvent) =&gt; { updateRefs(e, true) // æ›´æ–°æŒ‰ä¸‹çš„é”®åˆ°refsï¼Œé”®ä¸ºe.key?.toLowerCase()ï¼Œå€¼ä¸ºtrue }, { passive }) useEventListener(target, 'keyup', (e: KeyboardEvent) =&gt; { updateRefs(e, false) // æ›´æ–°æŒ‰ä¸‹çš„é”®åˆ°refsï¼Œé”®ä¸ºe.key?.toLowerCase()ï¼Œå€¼ä¸ºfalse }, { passive }) const proxy = new Proxy( refs, { get(target, prop, rec) { if (!(prop in refs)) { // åˆå§‹å°†å¯¹åº”çš„é”®è®¾ä¸ºfalseï¼Œå¦‚'shift' refs[prop] = ref(false) } const r = Reflect.get(target, prop, rec) return useReactive ? toValue(r) : r }, }, ) return proxy as any} è¿™æ ·refsåªå­˜äº†å–çš„é”®çš„çŠ¶æ€ï¼Œè€Œä¸æ˜¯æ‰€æœ‰é”®çš„çŠ¶æ€ usePageLeaveç”¨MouseEvent.relatedTargetæ£€æµ‹æ˜¯å¦ç¦»å¼€å±å¹• 123456789101112131415export function usePageLeave(options: ConfigurableWindow = {}) { const handler = (event: MouseEvent) =&gt; { const from = event.relatedTarget || event.toElement // å¦‚æœä¸ºnullï¼Œåˆ™ç§»å‡ºå±å¹• isLeft.value = !from } if (window) { useEventListener(window, 'mouseout', handler, { passive: true }) useEventListener(window.document, 'mouseleave', handler, { passive: true }) useEventListener(window.document, 'mouseenter', handler, { passive: true }) } return isLeft} useSpeechSynthesisåˆ©ç”¨SpeechSynthesisæ¥åšåˆ°è¯­éŸ³é˜…è¯» 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960export function useSpeechSynthesis(text: MaybeRefOrGetter&lt;string&gt;, options: UseSpeechSynthesisOptions = {}) { // ... const synth = window &amp;&amp; (window as any).speechSynthesis as SpeechSynthesis; const bindEventsForUtterance = (utterance: SpeechSynthesisUtterance) =&gt; { utterance.lang = toValue(lang) utterance.voice = toValue(options.voice) || null utterance.pitch = toValue(pitch) utterance.rate = toValue(rate) utterance.volume = volume utterance.onstart = () =&gt; { isPlaying.value = true status.value = 'play' } utterance.onpause = () =&gt; { isPlaying.value = false status.value = 'pause' } utterance.onresume = () =&gt; { isPlaying.value = true status.value = 'play' } utterance.onend = () =&gt; { isPlaying.value = false status.value = 'end' } utterance.onerror = (event) =&gt; { error.value = event } } const utterance = computed(() =&gt; { isPlaying.value = false status.value = 'init' const newUtterance = new SpeechSynthesisUtterance(spokenText.value) bindEventsForUtterance(newUtterance) return newUtterance }) const speak = () =&gt; { synth!.cancel() utterance &amp;&amp; synth!.speak(utterance.value) } const stop = () =&gt; { synth!.cancel() isPlaying.value = false } tryOnScopeDispose(() =&gt; { isPlaying.value = false }) // ...} AnimationuseTransitionå¯é…ç½®é¡¹ 123456789101112131415161718type CubicBezierPoints = [number, number, number, number]type EasingFunction = (n: number) =&gt; numberexport function useTransition( source: Ref&lt;number | number[]&gt; | MaybeRef&lt;number&gt;[], options: TransitionOptions = {},): ComputedRef&lt;any&gt; { const { // æ—¶é—´ç›¸å…³å•ä½å‡ä¸ºms delay = 0, // delay åæ‰§è¡Œ disabled = false, // æ˜¯å¦å…³é—­ duration = 1000, // æŒç»­æ—¶é—´ onFinished = noop, // å®Œæˆåæ‰§è¡Œ onStarted = noop, // å¼€å§‹æ—¶æ‰§è¡Œ transition = linear, // è½¬åŒ–ç®—æ³• MaybeRef&lt;EasingFunction | CubicBezierPoints&gt;ï¼Œé»˜è®¤å€¼æ˜¯ x =&gt; x } = options // ...} é¢„å¤„ç† 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950export function useTransition( source: Ref&lt;number | number[]&gt; | MaybeRef&lt;number&gt;[], options: TransitionOptions = {},): ComputedRef&lt;any&gt; { // å¯é…ç½®é¡¹ // åˆ›å»ºå½“å‰çš„è¿‡æ¸¡å‡½æ•°ï¼Œå¦‚æœç”¨æˆ·è‡ªå®šä¹‰äº†è¿‡æ¸¡å‡½æ•°åˆ™ä¸åšå¤„ç†ï¼Œå¦åˆ™æ ¹æ®è´èµ›å°”æ›²çº¿å€¼åˆ›å»ºè¿‡æ¸¡å‡½æ•° const currentTransition = computed(() =&gt; { const t = unref(transition) return isFunction(t) ? t : createEasingFunction(t) }) // ç”¨unrefå¤„ç†sourceå‚æ•°ï¼Œå¦‚æœsourceæ˜¯æ•°ç»„åˆ™ä¾æ¬¡unref const sourceValue = computed(() =&gt; { const s = unref&lt;number | MaybeRef&lt;number&gt;[]&gt;(source) return isNumber(s) ? s : s.map(unref) as number[] }) // è§„æ ¼åŒ–sourceï¼Œæ•´æˆæ•°ç»„ const sourceVector = computed(() =&gt; isNumber(sourceValue.value) ? [sourceValue.value] : sourceValue.value) // ...}// åˆ›å»ºè¿‡æ¸¡å‡½æ•°ï¼Œçº¯æ•°å­¦function createEasingFunction([p0, p1, p2, p3]: CubicBezierPoints): EasingFunction { const a = (a1: number, a2: number) =&gt; 1 - 3 * a2 + 3 * a1 const b = (a1: number, a2: number) =&gt; 3 * a2 - 6 * a1 const c = (a1: number) =&gt; 3 * a1 const calcBezier = (t: number, a1: number, a2: number) =&gt; ((a(a1, a2) * t + b(a1, a2)) * t + c(a1)) * t const getSlope = (t: number, a1: number, a2: number) =&gt; 3 * a(a1, a2) * t * t + 2 * b(a1, a2) * t + c(a1) const getTforX = (x: number) =&gt; { let aGuessT = x for (let i = 0; i &lt; 4; ++i) { const currentSlope = getSlope(aGuessT, p0, p2) if (currentSlope === 0) return aGuessT const currentX = calcBezier(aGuessT, p0, p2) - x aGuessT -= currentX / currentSlope } return aGuessT } return (x: number) =&gt; p0 === p1 &amp;&amp; p2 === p3 ? x : calcBezier(getTforX(x), p1, p3)} æä¾›äº†å‡ ç§è¿‡æ¸¡é¢„è®¾ 12345export const TransitionPresets: Record&lt;string, CubicBezierPoints | EasingFunction&gt; = { easeInSine: [0.12, 0, 0.39, 0], easeOutSine: [0.61, 1, 0.88, 1], // ...} è¯¦æƒ…å¯ä»¥çœ‹ ç¼“åŠ¨å‡½æ•°ã€ MDNï¼šç¼“åŠ¨å‡½æ•° å…³é”®é€»è¾‘ 1234567891011121314151617181920212223242526272829303132333435363738394041424344const outputVector = ref(sourceVector.value.slice(0)) // ç”¨ä»¥å­˜å‚¨è¾“å‡º// è¿‡æ¸¡ä¸»æµç¨‹ï¼Œå¯ä»¥æš‚åœconst { resume, pause } = useRafFn(() =&gt; { // å¯ä»¥æš‚åœã€æ¢å¤çš„ requestAnimationFrame const now = Date.now() const progress = clamp(1 - ((endAt - now) / currentDuration), 0, 1) // è¿‡æ¸¡è¿›åº¦ï¼Œclampå°†å€¼é™åˆ¶åœ¨0-1ä¹‹é—´ outputVector.value = startVector.map((val, i) =&gt; val + ((diffVector[i] ?? 0) * currentTransition.value(progress))) // æ›´æ–°output if (progress &gt;= 1) { // å®Œæˆè¿‡æ¸¡ pause() // æš‚åœ requestAnimationFrame onFinished() // æ‰§è¡Œoptionsä¸­çš„å®Œæˆå›è°ƒ }}, { immediate: false })const timeout = useTimeoutFn(start, delay, { immediate: false }) // delayæ¯«ç§’åæ‰§è¡Œstartå‡½æ•°const start = () =&gt; { pause() // æš‚åœ è¿‡æ¸¡ currentDuration = unref(duration) diffVector = outputVector.value.map((n, i) =&gt; (sourceVector.value[i] ?? 0) - (outputVector.value[i] ?? 0)) // åˆå§‹å€¼å’Œå½“å‰å€¼çš„diff startVector = outputVector.value.slice(0) // æ‹·è´åˆå§‹å€¼ startAt = Date.now() // å¼€å§‹æ—¶é—´ endAt = startAt + currentDuration // ç»“æŸæ—¶é—´ï¼Œç”¨åœ¨è®¡ç®—progress resume() // å¼€å§‹è¿‡æ¸¡ onStarted() // æ‰§è¡Œoptionsä¸­çš„å¼€å§‹å›è°ƒ}watch(sourceVector, () =&gt; { // ç›‘å¬sourceVectorçš„å˜åŒ– if (unref(disabled)) { // å¦‚æœæš‚åœè¿‡æ¸¡ï¼Œå°†è¾“å‡ºè¿˜åŸå›åˆå§‹å€¼ outputVector.value = sourceVector.value.slice(0) } else { if (unref(delay) &lt;= 0) start() // å¦‚æœæ²¡æœ‰å»¶è¿Ÿï¼Œåˆ™å¼€å§‹è¿‡æ¸¡ else timeout.start() // å¦‚æœæœ‰å»¶è¿Ÿï¼Œåˆ™å¼€å§‹ä¸Šé¢åˆ›å»ºå¥½çš„timeout }}, { deep: true })return computed(() =&gt; { const targetVector = unref(disabled) ? sourceVector : outputVector // å¦‚æœæš‚åœè¿‡æ¸¡ï¼Œå°†è¾“å‡ºè¿˜åŸå›åˆå§‹å€¼ return isNumber(sourceValue.value) ? targetVector.value[0] : targetVector.value // ä¸ºå€¼è§£å¼€æ•°ç»„åŒ…è£…ï¼Œæ•°ç»„åŸæ ·è¿”å›}) @Soundå¯ä»¥ç®€å•çš„è®©ä½ çš„ç½‘ç«™å¸¦ä¸Šå£°éŸ³ 123import buttonSfx from '../assets/sounds/button.mp3'const { play } = useSound(buttonSfx) demoï¼šhttps://sound.vueuse.org/","link":"/2023/09/10/Js/%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/Vueuse%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/"},{"title":"ã€æºç è§£è¯»ã€‘p-limit é™åˆ¶å¹¶å‘æ•°","text":"github: https://github.com/sindresorhus/p-limit ä½¿ç”¨æ–¹å¼123456789101112import pLimit from 'p-limit';const limit = pLimit(1); // åªèƒ½æœ‰ä¸€ä¸ªpromiseåœ¨æ‰§è¡Œconst input = [ limit(() =&gt; fetchSomething('foo')), limit(() =&gt; fetchSomething('bar')), limit(() =&gt; doSomething())];const result = await Promise.all(input);console.log(result); å‡½æ•°æºç åˆå§‹åŒ–ï¼ˆpLimitï¼‰1234567891011121314151617181920212223242526import Queue from &quot;yocto-queue&quot;;export default function pLimit(concurrency) { const queue = new Queue(); let activeCount = 0; const enqueue = (fn, resolve, args) =&gt; { queue.enqueue(run.bind(undefined, fn, resolve, args)); (async () =&gt; { // æ€è€ƒé‡Œè®²è§£ä¸ºä»€ä¹ˆè¿™é‡Œéœ€è¦Promise.resolve() await Promise.resolve() if (activeCount &lt; concurrency &amp;&amp; queue.size &gt; 0) { queue.dequeue()(); } })(); }; const generator = (fn, ...args) =&gt; new Promise((resolve) =&gt; { enqueue(fn, resolve, args); }); return generator;} pLimitå‡½æ•°çš„å…¥å‚ concurrency æ˜¯æœ€å¤§å¹¶å‘æ•°ï¼Œè°ƒç”¨ä¸€æ¬¡ pLimit ä¼šç”Ÿæˆä¸€ä¸ªé™åˆ¶å¹¶å‘çš„å‡½æ•° generator ä¾èµ–yocto-queueçš„é˜Ÿåˆ—èƒ½åŠ›ï¼Œæ¯æ¬¡è°ƒç”¨generatorä¼šè¿”å›ä¸ªpromise ä¼šå‘é˜Ÿåˆ—å…¥é˜Ÿä¸€ä¸ªrunï¼ˆæ‰§è¡Œå‡½æ•°ï¼‰ å¦‚æœå½“å‰åœ¨æ‰§è¡Œpromiseæ•°é‡å°äºconcurrencyï¼ˆå¹¶å‘æ•°ï¼‰ï¼Œå°±å‡ºé˜Ÿå¹¶æ‰§è¡Œ æ‰§è¡Œå‡½æ•°ï¼ˆrunï¼‰123456789101112131415161718192021const next = () =&gt; { activeCount--; if (queue.size &gt; 0) { queue.dequeue()(); }};const run = async (fn, resolve, args) =&gt; { activeCount++; const result = (async () =&gt; fn(...args))(); resolve(result); try { await result; } catch {} next();}; runå‡½æ•°æ‰§è¡Œ activeCountåŠ ä¸€ æ‰§è¡Œå¼‚æ­¥å‡½æ•°fnï¼Œå¹¶å°†ç»“æœä¼ é€’ç»™resolve awaitäº†resultï¼Œä½¿å¾—nextæ‰§è¡Œæœ‰åº æ‰§è¡Œnextæ—¶è¡¨ç¤ºpromiseç»“æœå·²ç»è¿”å›ï¼ŒactiveCount-1ï¼Œå¹¶å¼€å§‹æ‰§è¡Œä¸‹ä¸€ä¸ªpromise æ€è€ƒä¸ºä»€ä¹ˆä½¿ç”¨é˜Ÿåˆ—è€Œä¸æ˜¯æ•°ç»„ç›¸å…³issusï¼šImprove performance shiftæ–¹æ³•æ¯æ¬¡è°ƒç”¨æ—¶, éƒ½éœ€è¦éå†ä¸€æ¬¡æ•°ç»„, å°†æ•°ç»„è¿›è¡Œä¸€æ¬¡å¹³ç§», æ—¶é—´å¤æ‚åº¦æ˜¯O(n)é˜Ÿåˆ—çš„dequeueæ—¶é—´å¤æ‚åº¦åˆ™æ˜¯O(1) ä¸ºä»€ä¹ˆåœ¨å…¥é˜Ÿå¹¶ä¸”æ‰§è¡Œçš„æ—¶å€™ï¼Œåˆ¤æ–­æ‰§è¡Œå‰éœ€è¦await Promise.resolve()ç›¸å…³issusï¼šAlways run limited functions asynchronously ä¸åŠ çš„è¯ï¼Œæœ‰æ—¶å€™æ‰§è¡Œæ˜¯åŒæ­¥çš„ï¼Œæœ‰æ—¶å€™æ‰§è¡Œæ˜¯å¼‚æ­¥çš„ï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´åœ¨ä¸‹ä¸€è¡Œä»£ç æ‰§è¡Œä¹‹å‰çŠ¶æ€å°±å·²ç»æ”¹å˜äº†ï¼Œè®©ç¨‹åºè¿è¡Œç»“æœä¸å¯é¢„æµ‹ 1234567(async () =&gt; { await Promise.resolve() if (activeCount &lt; concurrency &amp;&amp; queue.size &gt; 0) { queue.dequeue()(); }})(); åŠ ä¸Šå¯ä»¥ä¿è¯æ‰€æœ‰å‡ºé˜Ÿæ‰§è¡Œéƒ½æ˜¯å¼‚æ­¥çš„ å¦‚ä½•æ·»åŠ è¶…æ—¶é€»è¾‘1234567891011121314let timer = null;const timerPromise = new Promise((resolve, reject) =&gt; { timer = setTimeout(() =&gt; { reject('time out'); }, 1000);});Promise.all([ timerPromise, fetchPromise,]).then(res =&gt; clearTimeout(timer)).catch(err =&gt; console.error(err)); æ›´æ­£è§„çš„å†™æ³•å¯ä»¥å‚è€ƒï¼šp-timeout å‚è€ƒæ–‡ç« Node.js å¹¶å‘èƒ½åŠ›æ€»ç»“","link":"/2023/04/19/Js/%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/p-limit-%E9%99%90%E5%88%B6%E5%B9%B6%E5%8F%91%E6%95%B0/"},{"title":"ã€æºç è§£è¯»ã€‘arrify è½¬æ•°ç»„","text":"åŠå¹´æ²¡å†™åšå®¢ï¼Œä»ç®€å•çš„æºç å¼€å§‹å¯åŠ¨ github: https://github.com/sindresorhus/arrify åŠŸèƒ½ä»£ç æ¯”è¾ƒç®€å•ï¼Œå°±å…ˆå±•ç¤ºä¸€ä¸‹å…¨éƒ¨jsä»£ç  12345678910111213141516171819export default function arrify(value) { if (value === null || value === undefined) { return []; } if (Array.isArray(value)) { return value; } if (typeof value === 'string') { return [value]; } if (typeof value[Symbol.iterator] === 'function') { return [...value]; } return [value];} åœ¨æˆ‘çœ‹æ¥å’ŒArray.fromçš„åŒºåˆ«å¦‚ä¸‹ Array.from arrify undefined æŠ¥é”™ï¼šUncaught TypeError: undefined is not iterable (cannot read property Symbol(Symbol.iterator)) [] Null æŠ¥é”™ï¼šUncaught TypeError: undefined is not iterable (cannot read property Symbol(Symbol.iterator)) [] document.querySelector(â€˜*â€™) å¸¦æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ [document.querySelector(â€˜*â€™)] ä½œè€…å¯¹äºarray likeå¤„ç†çš„å›åº”ï¼Œç¿»è¯‘ä¸€ä¸‹ï¼šæ•…æ„è¿™ä¹ˆæ•´çš„ï¼Œarrifyåº”å½“åªæ˜¯æ•°ç»„åŒ–ï¼Œè€Œä¸æ˜¯å¯¹ç±»æ•°ç»„è¿›è¡Œè½¬æ¢ï¼Œå¯¹ç±»æ•°ç»„è½¬æ¢å¯ä»¥ç”¨Array.from psï¼šåœ¨æˆ‘å°è¯•çš„æ—¶å€™ï¼Œç”¨chromeæ§åˆ¶å°Array.from(document.querySelector(â€˜â€˜))ï¼Œä¼šå¾—åˆ°ä¸€ä¸ª*ç©ºæ•°ç»„**ï¼Œä½†æ˜¯æœ¬åœ°åˆ›å»ºçš„htmlæµ‹è¯•æ˜¯æ²¡é—®é¢˜çš„ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆ å…³äºstringçš„å¤„ç†ä¸ºä»€ä¹ˆä¸ç›´æ¥å»æ‰value === â€˜stringâ€™è¿™ä¸ªifè¯­å¥å—ï¼Œè¿™æ ·åœ¨æœ€åä¹Ÿèƒ½è¿”å›[value]ï¼Ÿ ç­”ï¼šstringæœ‰Symbol.iteratorå±æ€§ï¼Œæ‰€ä»¥ä¼šæ‰§è¡Œ[â€¦value] ç±»å‹å®šä¹‰é‡è½½å®šä¹‰ï¼Ÿæœ€å¼€å§‹çš„ç±»å‹å®šä¹‰æ˜¯ç”¨é‡è½½çš„æ–¹å¼ï¼Œå¯¹ä¸åŒå‚æ•°ç±»å‹è¿›è¡Œå¤„ç†ï¼Œä»£ç å¦‚ä¸‹ 123456declare function arrify(value: null | undefined): [];declare function arrify(value: string): [string];declare function arrify&lt;ValueType&gt;(value: ValueType[]): ValueType[];declare function arrify&lt;ValueType&gt;(value: ReadonlyArray&lt;ValueType&gt;): ReadonlyArray&lt;ValueType&gt;;declare function arrify&lt;ValueType&gt;(value: Iterable&lt;ValueType&gt;): ValueType[];declare function arrify&lt;ValueType&gt;(value: ValueType): [ValueType]; ä½†æ˜¯åœ¨è¯¥issusæå‡ºäº†ï¼Œå‚æ•°ä¸æ”¯æŒè”åˆç±»å‹ï¼Œcaseå¦‚ä¸‹ 1arrify(Boolean() ? [1, 2] : 3); å‚æ•°ä¼šè¢«tsæ¨æ–­ä¸ºnumber | number[]ï¼Œå¹¶ä¸æ»¡è¶³ä¸Šé¢æ‰€æœ‰é‡è½½æ–¹æ³•çš„å®šä¹‰ï¼Œè€ƒè™‘è”åˆç±»å‹åï¼Œå„ç§ç±»å‹ç»„åˆçš„æ•°é‡å¤ªå¤šäº†ï¼Œå‡½æ•°é‡è½½çš„å®šä¹‰æ–¹å¼æ— æ³•æ»¡è¶³éœ€æ±‚ã€‚ æ”¹è¿›ç‰ˆç±»å‹å®šä¹‰å¦‚ä¸‹ï¼Œå…¶å®ä¹Ÿå’Œjsçš„åˆ¤æ–­ä¸€ä¸€å¯¹åº” 1234567891011export default function arrify&lt;ValueType&gt;( value: ValueType): ValueType extends (null | undefined) ? [] : ValueType extends string ? [string] : ValueType extends readonly unknown[] ? ValueType : ValueType extends Iterable&lt;infer T&gt; ? T[] : [ValueType]; ä½¿ç”¨extendåï¼Œä¼šå°†è”åˆç±»å‹çš„æ¯ä¸€ä¸ªå–å‡ºæ¥æ‰§è¡Œåˆ¤æ–­ï¼Œå¾—å‡ºç»“æœåå†åˆå¹¶æˆè”åˆç±»å‹ï¼Œä¾‹å­ï¼š 1234567891011type value&lt;ValueType&gt; = ValueType extends (null | undefined) ? [] : ValueType extends string ? [string] : ValueType extends readonly unknown[] ? ValueType : ValueType extends Iterable&lt;infer T&gt; ? T[] : [ValueType];type test = value&lt;number | string[]&gt; // [number] | string[] æ€»ç»“è¿˜æ˜¯æ¯”è¾ƒè€çš„ä»“åº“ï¼Œä»–çš„ä¸€äº›è®¾è®¡ç†å¿µæˆ‘ä¸æ˜¯å¾ˆè®¤åŒï¼Œæˆ‘è§‰å¾—ç»™äººç”¨çš„ç¬¬ä¸‰æ–¹åº“å°±åº”è¯¥èƒ½å¤Ÿå¤„ç†æ‰€æœ‰çš„æƒ…å†µï¼Œè€Œä¸æ˜¯ä¸ºäº†è®¾è®¡ç†å¿µæ¥ä¸¥æ ¼å®šä¹‰ï¼Œä¸å¯¹ä¸€äº›æƒ…å†µè¿›è¡Œå¤„ç†","link":"/2022/05/21/Js/%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/arrify-%E8%BD%AC%E6%95%B0%E7%BB%84/"},{"title":"Mittæºç è§£è¯»","text":"githubåœ°å€ï¼šhttps://github.com/developit/mitt 200bå¤§å°çš„event busåº“ ç±»å‹ç³»ç»Ÿè®©äººçœ¼å‰ä¸€äº®çš„æ˜¯ï¼Œè¯¥åº“å¯¹ç±»å‹æœ‰ç€è¾ƒå¼ºè§„èŒƒï¼Œç”¨æˆ·å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç”¨ä¸‹é¢çš„æ–¹å¼å®šä¹‰äº‹ä»¶ç±»å‹ï¼Œåœ¨è¯¥issusè¢«æå‡º 12345678910type Events = { foo: string; // äº‹ä»¶å: å‚æ•°ç±»å‹ bar?: number;};const emitter = mitt&lt;Events&gt;(); // inferred as Emitter&lt;Events&gt;emitter.on('foo', (e) =&gt; {}); // 'e' has inferred type 'string'emitter.emit('foo', 42); // Error: Argument of type 'number' is not assignable to parameter of type 'string'. (2345) é‚£å®ƒæ˜¯å¦‚ä½•åšåˆ°çš„å‘¢ï¼Œå…ˆæŠŠå®ç°ä»£ç å±•ç¤ºå‡ºæ¥å†åˆ†éƒ¨è®²è§£ï¼ˆç›´æ¥çœ‹æ‡‚çš„å¯ä»¥è·³è¿‡è®²è§£ï¼‰ã€‚ 1234567891011121314151617181920212223export type EventType = string | symbol;export type Handler&lt;T = unknown&gt; = (event: T) =&gt; void;export default function mitt&lt;Events extends Record&lt;EventType, unknown&gt;&gt;( all?: EventHandlerMap&lt;Events&gt; // å¯ä»¥æš‚æ—¶å¿½ç•¥è¿™é‡Œ): Emitter&lt;Events&gt; { type GenericEventHandler = | Handler&lt;Events[keyof Events]&gt; | WildcardHandler&lt;Events&gt;; // ä¸ºäº†é€‚é…ç”¨ * return { // ... on&lt;Key extends keyof Events&gt; (type: Key, handler: GenericEventHandler) { // ... }, off&lt;Key extends keyof Events&gt; (type: Key, handler?: GenericEventHandler) { // ... }, emit&lt;Key extends keyof Events&gt;(type: Key, evt?: Events[Key]) { // ... } }} RecordRecord&lt;K, T&gt;æ˜¯typescriptå†…ç½®çš„ç±»å‹å‡½æ•° 1234// Construct a type with a set of properties K of type Ttype Record&lt;K extends keyof any, T&gt; = { [P in K]: T;}; ä»£è¡¨çš„æ„æ€æ˜¯ä»ç¬¬ä¸€ä¸ªå‚æ•°è·å–æ‰€æœ‰é”®ï¼Œå€¼ä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œæºç ä¸­Record&lt;EventType, unknown&gt;å³ä¸º 1234export type EventType = string | symbol;Record&lt;EventType, unknown&gt; === { [P in string | symbol]: unknown;} Events extends Record&lt;EventType, unknown&gt;åˆ©ç”¨æ³›å‹çº¦æŸå°†ç”¨æˆ·ä¼ å…¥çš„Eventsç±»å‹çº¦æŸä¸ºä¸Šè¿°ç±»å‹ ç±»å‹ç¼–ç¨‹å°±åƒä½™åè€å¸ˆç¡ä¸€è§‰é†’æ¥åæœ‰äº†è¿™ä¹ˆä¸€ä¸ªé¢˜ç›®å«ã€Šæ´»ç€ã€‹ï¼Œè§‰å¾—é¢˜ç›®éå¸¸å¥½å°±å¼€å§‹å†™äº†ï¼Œç¬¬ä¸€æ¬¡è§åˆ°Linbuduçš„åšå®¢ï¼Œè§åˆ°äº†ä¸€ä¸ªè¯â€”â€”ç±»å‹ç¼–ç¨‹ï¼Œæœ‰äº†è¿™ä¹ˆä¸€ä¸ªæ¦‚å¿µï¼ˆè™½ç„¶ä¸çŸ¥é“æ˜¯åœ¨ä½•æ—¶ä½•åœ°è¢«æå‡ºçš„ï¼‰ï¼Œçªç„¶å¾ˆå¤šçŸ¥è¯†å°±æœ‰äº†ä¸€ä¸ªç³»ç»Ÿçš„åç§°ï¼Œå¼•å¯¼äººä»¬æ¢ç´¢è¿™ä¸ªç³»ç»Ÿä¸‹çš„å„ç§åº”ç”¨ï¼Œä¸‹é¢å°±æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ä¸€ä¸ªä¾‹å­ã€‚ 123export type Handler&lt;T = unknown&gt; = (event: T) =&gt; void;type GenericEventHandler = Handler&lt;Events[keyof Events]&gt; Events[keyof Events]å°±æ˜¯å°†ç”¨æˆ·å®šä¹‰çš„Eventsç±»å‹çš„å€¼ç±»å‹å…¨éƒ¨å–å‡ºï¼Œåœ¨æœ€ä¸Šé¢çš„ä½¿ç”¨æ–¹å¼çš„ä¾‹å­é‡Œï¼Œä¼šæœ‰å¦‚ä¸‹çš„è½¬åŒ–ç»“æœã€‚ 1234567type Events = { foo: string; // äº‹ä»¶å: å‚æ•°ç±»å‹ bar?: number;};Events[keyof Events] === string | number;type GenericEventHandler = Handler&lt;Events[keyof Events]&gt; === (event: string | number) =&gt; void å†çœ‹onã€offã€emitå‡½æ•°å®šä¹‰ï¼Œå»é™¤äº† æ”¯æŒtypeä¸º*çš„åŠŸèƒ½ 123456789on&lt;Key extends keyof Events&gt; (type: Key, handler: Handler&lt;Events[Key]&gt;) { // ...}off&lt;Key extends keyof Events&gt; (type: Key, handler?: Handler&lt;Events[Key]&gt;) { // ...}emit&lt;Key extends keyof Events&gt;(type: Key, evt?: Events[Key]) { // ...} å› æ­¤æˆ‘ä»¬åœ¨onã€offå’Œemitåªèƒ½æ³¨å†Œæˆ–æ³¨é”€äº‹ä»¶åå’Œhandlerçš„å‚æ•°ä¸ç”¨æˆ·å®šä¹‰Eventsç±»å‹ä¸€è‡´çš„äº‹ä»¶ ä»£ç é€»è¾‘å¯æ›¿æ¢çš„allallç”¨æ¥å­˜å‚¨ç”¨æˆ·æ³¨å†Œçš„äº‹ä»¶ï¼Œmittä¼šåˆå§‹åŒ–ä¸€ä¸ªMapä½œä¸ºé»˜è®¤çš„ï¼Œä½†æ˜¯ç”¨æˆ·å¯ä»¥ä¼ å…¥è‡ªå·±çš„Mapã€‚ 12345export default function mitt&lt;Events extends Record&lt;EventType, unknown&gt;&gt;( all?: EventHandlerMap&lt;Events&gt;): Emitter&lt;Events&gt; { all = all || new Map();} on123456789on&lt;Key extends keyof Events&gt;(type: Key, handler: GenericEventHandler) { const handlers: Array&lt;GenericEventHandler&gt; | undefined = all!.get(type); if (handlers) { handlers.push(handler); } else { all!.set(type, [handler] as EventHandlerList&lt;Events[keyof Events]&gt;); }} å¦‚æœå·²ç»æ³¨å†ŒåŒåäº‹ä»¶åˆ™ç›´æ¥å°†handleræ¨è¿›æ•°ç»„ï¼Œå¦åˆ™åˆ›å»ºä¸ªæ–°æ•°ç»„å­˜æ”¾hanlderã€‚ off1234567891011off&lt;Key extends keyof Events&gt;(type: Key, handler?: GenericEventHandler) { const handlers: Array&lt;GenericEventHandler&gt; | undefined = all!.get(type); // å¯¹åº”äº‹ä»¶åçš„handleræ•°ç»„ if (handlers) { if (handler) { handlers.splice(handlers.indexOf(handler) &gt;&gt;&gt; 0, 1); } else { all!.set(type, []); } }} æœ‰ä¸€ä¸ªç§€æ“ä½œçš„ç‚¹ï¼Œå½“ç”¨æˆ·ä¼ å…¥handlerè¦åˆ é™¤å¯¹åº”äº‹ä»¶åä¸‹çš„å¯¹åº”handleræ—¶ï¼Œæœ‰è¿™ä¹ˆä¸€æ®µã€‚ 1handlers.splice(handlers.indexOf(handler) &gt;&gt;&gt; 0, 1); æˆ‘ä»¬çŸ¥é“ indexOfæ²¡æœ‰åœ¨æ•°ç»„ä¸­æ‰¾åˆ°å¯¹åº”çš„å€¼ï¼Œé‚£ä¹ˆå°±ä¼šè¿”å›-1 &gt;&gt;&gt; 0ï¼ˆ é›¶å¡«å……å³ä½ç§»0ä½ï¼‰ä¸æ˜¯æ²¡å˜ï¼Ÿ è€Œsplice(-1, 1)è¡¨ç¤ºåˆ é™¤æœ€åä¸€ä½ ç»¼åˆèµ·æ¥çœ‹ï¼Œå¦‚æœ-1 &gt;&gt;&gt; 0æ²¡å˜é‚£ä¹ˆå°±ä¼šè¯¯åˆ æœ€åä¸€ä¸ªhandlerã€‚ è®©æˆ‘ä»¬çœ‹çœ‹&gt;&gt;&gt; 0æ˜¯ä»€ä¹ˆé­”æ³• 1console.log(-1 &gt;&gt;&gt; 0); // 4294967295 js numberé‡‡ç”¨çš„æ˜¯IEEE 754åŒç²¾åº¦æµ®ç‚¹ï¼Œ&gt;&gt;&gt;ä¼šæŠŠnumberæˆªæ–­æˆ32ä½intè¿›è¡Œä½ç§»ï¼Œæ›´å…·ä½“çš„ä¸å±•å¼€ã€‚å¦‚æœæ²¡æ‰¾åˆ°å¯¹åº”çš„handlerï¼Œä»£ç å³ä¸ºhandlers.splice(4294967295, 1)ï¼Œæˆ‘ä»¬å½“ç„¶ä¸å¯èƒ½å­˜å¦‚æ­¤å¤šçš„handlerï¼Œä¹Ÿå°±ä¸å¯èƒ½åˆ é™¤4294967295ä¸‹æ ‡å¯¹åº”çš„handlerï¼Œæ¯”èµ·æˆ‘ä»¬åˆ¤æ–­indexOfæ˜¯å¦ä¸º-1ç¼©çŸ­äº†ä»£ç ï¼ˆä»€ä¹ˆå«Microscopicå•Šï¼Ÿï¼‰ emit é€‚é…typeä¸º*çš„æƒ…å†µï¼Œä¸ºæ‰€æœ‰äº‹ä»¶éƒ½æ³¨å†Œhandlerï¼Œemitæ—¶å–å‡º*ä¸­çš„æ‰€æœ‰handleræ‰§è¡Œ 12345678910111213141516171819emit&lt;Key extends keyof Events&gt;(type: Key, evt?: Events[Key]) { let handlers = all!.get(type); if (handlers) { (handlers as EventHandlerList&lt;Events[keyof Events]&gt;) .slice() .map((handler) =&gt; { handler(evt!); }); } handlers = all!.get('*'); if (handlers) { (handlers as WildCardEventHandlerList&lt;Events&gt;) .slice() .map((handler) =&gt; { handler(type, evt!); }); }} é¢˜å¤–è¯Onceè™½ç„¶æºç å¹¶æ²¡æœ‰å®ç°ï¼Œä½†æ˜¯æ—¢ç„¶æ˜¯äº‹ä»¶æ€»çº¿çš„æ–‡ç« ï¼Œè¿˜æ˜¯æä¸€æã€‚åœ¨æˆ‘ä¹‹å‰é¢è¯•çš„æ—¶å€™ç»å¸¸è¢«é—®åˆ°äº‹ä»¶æ€»çº¿æ˜¯å¦‚ä½•å®ç°çš„ï¼Œå…¶ä¸­å°±æœ‰Onceçš„å®ç°ï¼Œæˆ‘æ²¡æœ‰æ·±å…¥æ€è€ƒï¼Œåªæƒ³ç€å®ç°å°±å®Œäº‹äº†ï¼šç»™æ‰€æœ‰handlerç”¨å¯¹è±¡åŒ…è£¹ä¸€å±‚ï¼Œç„¶ååŠ ä¸€ä¸ªOnceå­—æ®µæ ‡è¯†ï¼Œåœ¨emitæ—¶åˆ¤æ–­Onceæ˜¯å¦ä¸ºtrueï¼Œtrueçš„è¯æ‰§è¡Œå®Œæ³¨é”€äº‹ä»¶ï¼Œä½†æ˜¯è¿™æ ·onå’Œemitéƒ½éœ€è¦ä¿®æ”¹ï¼Œå¤šåˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡å¹¶ä¸”ä¸ä¼˜é›…ã€‚ æˆ‘ä»¬å¯ä»¥å……åˆ†åˆ©ç”¨jsçš„çµæ´»æ€§ï¼Œç”¨ä¸€ä¸ªå‡½æ•°åŒ…è£¹ç”¨æˆ·çš„handlerï¼Œåœ¨è¯¥å‡½æ•°ä¸­offæ‰handlerã€‚ 1234567891011once(type: Key, handler: GenericEventHandler) { function on () { const self: Emitter&lt;Events&gt; = this; function listener () { self.off(type, listener); handler.apply(this, arguments); } this.on(type, listener); }} ä½†æ˜¯ä¸Šé¢çš„ä»£ç æœ‰ä¸€ä¸ªå¾ˆéšè”½çš„é—®é¢˜ï¼šç”±äºæ˜¯ç”¨ä¸€ä¸ªæ–°çš„å‡½æ•°å»åŒ…è£¹ï¼Œåœ¨offæ—¶ä¼ æ—§handlerå»æ³¨é”€onceäº‹ä»¶æ— æ³•æˆåŠŸ è§£å†³æ–¹å¼ åœ¨listenerå‡½æ•°ä¸­å­˜æ—§çš„handler 123456789101112once(type: Key, handler: GenericEventHandler) { function on () { const self: Emitter&lt;Events&gt; = this; function listener () { self.off(type, listener); handler.apply(this, arguments); } listener.fn = handler; // å¢åŠ äº†è¿™é‡Œ this.on(type, listener); }} ä¸è¿‡ç”¨è¿™ç§æ–¹å¼çš„è¯ï¼Œæˆ‘ä»¬çš„&gt;&gt;&gt;é­”æ³•å°±ä¸èƒ½ä½¿ç”¨çš„ï¼ˆè¿™æ˜¯mittæ²¡æœ‰onceçš„åŸå› ï¼Ÿï¼‰ 1234567891011121314off&lt;Key extends keyof Events&gt;(type: Key, handler?: GenericEventHandler) { const handlers: Array&lt;GenericEventHandler&gt; | undefined = all!.get(type); if (handlers) { if (handler) { for (let i = 0; i &lt; handlers.length; i++) { if (handler === handlers[i] || handler === handlers[i].fn) handlers.splice(i, 1); } } else { all!.set(type, []); } }} unknownåœ¨è¯¥Stronger typing #114commitä¸­ï¼Œå¤§é‡çš„anyè¢«æ›¿æ¢ä¸ºunknown å…³äºunknownçš„ç‰¹ç‚¹å¯çœ‹[è¯‘] TypeScript 3.0: unknown ç±»å‹","link":"/2021/12/15/Ts/Mitt%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/"},{"title":"vueuseæºç è§£æ","text":"æœ¬æ–‡ä¸ä¼šæ”¾apiçš„ç”¨æ³•ï¼Œå»ºè®®å…ˆçœ‹çœ‹æ˜¯æ€ä¹ˆç”¨çš„ é¡¹ç›®æ¶æ„é‡‡ç”¨monorepoçš„å½¢å¼ï¼Œé¡¹ç›®ç›®å½•ä¸‹æœ‰å¤šä¸ªå­é¡¹ç›®ï¼Œä¸‹é¢æ”¾äº†èµ„æ–™é“¾æ¥å’Œå‡ å¤„ç”¨æ³•ï¼Œå…¶ä»–æœ¬æ–‡ä¸å¤šèµ˜è¿°ã€‚ ç°ä»£å‰ç«¯å·¥ç¨‹ä¸ºä»€ä¹ˆè¶Šæ¥è¶Šç¦»ä¸å¼€ Monorepo?ä¸ºä»€ä¹ˆä½¿ç”¨pnpmå¯ä»¥å…‰é€Ÿå»ºç«‹å¥½ç”¨çš„monorepoï¼ˆæ¯”yarn/lernaæ•ˆç‡é«˜ï¼‰pnpm workspaceæ–‡æ¡£ ä¸ºäº†ä½¿æ‰€æœ‰å­é¡¹ç›®éƒ½ä½¿ç”¨åŒä¸€ä¸ªä¾èµ–ç‰ˆæœ¬ï¼Œä½¿ç”¨pnpm.overridesé…ç½®ï¼Œå¦‚ä¸‹ 12345678{ &quot;pnpm&quot;: { &quot;overrides&quot;: { &quot;vue-demi&quot;: &quot;0.12.1&quot;, // åœ¨postinstallé’©å­ä¸­æ ¹æ®å½“å‰ç¯å¢ƒçš„vueç‰ˆæœ¬ï¼Œè·å–å…¼å®¹vue3å’Œvue2çš„api &quot;vite&quot;: &quot;^2.6.7&quot; } }} åœ¨æ­£å¸¸é…ç½®ä¸‹ï¼Œå¦‚æœç›´æ¥pnpm installå°†ä¼šåœ¨æ¯ä¸ªå­é¡¹ç›®çš„node_modulesæœ‰åŒæ ·çš„ä¾èµ–ï¼Œä½†æ˜¯æ‰€æœ‰å­é¡¹ç›®ç›¸åŒçš„ä¾èµ–å…¶å®åªéœ€è¦æå–å‡ºæ¥æ”¾åœ¨æ ¹ç›®å½•çš„node_modulesä¸‹å³å¯ï¼Œå¯é…ç½®å¦‚ä¸‹ 1234&quot;peerDependencies&quot;: { &quot;@vue/composition-api&quot;: &quot;^1.1.0&quot;, &quot;vue&quot;: &quot;^2.6.0 || ^3.2.0&quot;}, è¯¦æƒ…è¯·çœ‹å¦‚ä¸‹é“¾æ¥ æ¢è®¨npmä¾èµ–ç®¡ç†ä¹‹peerDependenciespnpm monorepoä¹‹å¤šç»„ä»¶å®ä¾‹å’ŒpeerDependencieså›°å¢ƒå›æº¯å¦‚ä½•å¤„ç† peers å‰ç½®çŸ¥è¯†unref - refçš„åæ“ä½œ å¦‚æœä¼ å…¥ä¸€ä¸ªrefï¼Œè¿”å›å…¶å€¼ å¦åˆ™åŸæ ·æ”¾å› 1234// æºç å®ç°function unref&lt;T&gt;(ref: T | Ref&lt;T&gt;): T { return isRef(ref) ? ref.value : ref} ä½¿ç”¨ä¾‹å­ï¼šå®ç°ä¸€ä¸ªå“åº”å¼çš„addå‡½æ•°ï¼Œå¯ä»¥ä¼ å…¥refæˆ–å€¼ 123456function add( a: Ref&lt;number&gt; | number, b: Ref&lt;number&gt; | number) { return computed(() =&gt; unref(a) + unref(b))} MaybeRefç±»å‹vueuseå¤§é‡ä½¿ç”¨MaybeRefæ¥æ”¯æŒå¯é€‰æ‹©æ€§çš„å“åº”å¼å‚æ•° 1type MaybeRef&lt;T&gt; = Ref&lt;T&gt; | T ä¸Šé¢çš„åŠ æ³•å‡½æ•°å°±å¯ä»¥ç®€å†™ä¸º 123function add(a: MaybeRef&lt;number&gt;, b: MaybeRef&lt;number&gt;) { return computed(() =&gt; unref(a) + unref(b))} Effectä½œç”¨åŸŸAPIVueå®˜æ–¹æ–‡æ¡£ï¼šEffect ä½œç”¨åŸŸ API åŠ¨æœº åœ¨Vueçš„setupä¸­ï¼Œå“åº”å¼effectä¼šåœ¨åˆå§‹åŒ–çš„æ—¶å€™è¢«æ”¶é›†ï¼Œåœ¨å®ä¾‹è¢«å¸è½½çš„æ—¶å€™ï¼Œå“åº”å¼effectå°±ä¼šè‡ªåŠ¨è¢«å–æ¶ˆäº†ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬åœ¨ç»„ä»¶å¤–å†™ä¸€ä¸ªç‹¬ç«‹çš„åŒ…ï¼ˆå°±å¦‚vueuseï¼‰æ—¶ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•åœæ­¢computed &amp; watchçš„å“åº”å¼ä¾èµ–å‘¢ï¼Ÿvue3.2æå‡ºäº†effectScope effectScopeåˆ©ç”¨effectScopeåˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸå¯¹è±¡ï¼Œå¦‚ä¸‹é¢æ¥å£å®šä¹‰æ‰€ç¤ºï¼Œrunæ¥å—ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªä½œç”¨åŸŸå¯¹è±¡ä¼šè‡ªåŠ¨æ•è·å‡½æ•°å†…éƒ¨çš„å“åº”å¼effect (ä¾‹å¦‚è®¡ç®—å±æ€§æˆ–ä¾¦å¬å™¨) ç±»å‹ 123456function effectScope(detached?: boolean): EffectScopeinterface EffectScope { run&lt;T&gt;(fn: () =&gt; T): T | undefined // å¦‚æœè¿™ä¸ªåŸŸä¸æ´»è·ƒåˆ™ä¸º undefined stop(): void} ç¤ºä¾‹ 12345678910const scope = effectScope()scope.run(() =&gt; { const doubled = computed(() =&gt; counter.value * 2) watch(doubled, () =&gt; console.log(doubled.value)) watchEffect(() =&gt; console.log('Count: ', doubled.value))})// å¤„ç†(dispose) è¯¥ä½œç”¨åŸŸå†…çš„æ‰€æœ‰ effectscope.stop() getCurrentScopeå¦‚æœæœ‰ï¼Œåˆ™è¿”å›å½“å‰æ´»è·ƒçš„ effect ä½œç”¨åŸŸã€‚ ç±»å‹ 1function getCurrentScope(): EffectScope | undefined onScopeDisposeåœ¨å½“å‰æ´»è·ƒçš„ effect ä½œç”¨åŸŸä¸Šæ³¨å†Œä¸€ä¸ªå¤„ç†å›è°ƒã€‚è¯¥å›è°ƒä¼šåœ¨ç›¸å…³çš„ effect ä½œç”¨åŸŸç»“æŸä¹‹åè¢«è°ƒç”¨ï¼Œåœ¨VCAå‡½æ•°ä¸­å¯ç”¨ä½œonUnmountedçš„éç»„ä»¶æ›¿ä»£å“ï¼ŒåŒºåˆ«åœ¨äºå…¶å·¥ä½œåœ¨scopeä¸­è€Œä¸æ˜¯ç»„ä»¶å®ä¾‹ 123onScopeDispose(() =&gt; { window.removeEventListener('mousemove', handler)}) ç¤ºä¾‹ åœ¨vueçš„rfcä¸­reactivity-effect-scopeæœ‰è¿™æ ·çš„ä¸€ä¸ªä¾‹å­ï¼Œå¦‚æœæœ‰ä¸ªç›‘æ§é¼ æ ‡ä½ç½®çš„hookï¼ˆuseMouseï¼‰ï¼Œéœ€è¦ç›‘å¬mousemoveäº‹ä»¶ï¼Œå¦‚æœåœ¨å¤šä¸ªç»„ä»¶è°ƒç”¨äº†è¿™ä¸ªhookï¼Œè€Œå†…éƒ¨æ˜¯é€šè¿‡åœ¨onUnmountedé’©å­æ¥ç§»é™¤mousemoveç›‘å¬å™¨ï¼ŒonUnmountedè€¦åˆåœ¨æ¯ä¸ªç»„ä»¶å®ä¾‹ï¼Œåˆ™æ— æ³•ä»¥æ›´æœ‰æ•ˆç‡çš„æ–¹å¼å…±äº«è¿™ä¸ªmousemoveç›‘å¬å™¨ ä¸ºäº†åšåˆ°åœ¨ç»„ä»¶é—´å…±äº«useMouseçš„å“åº”å¼effectå’Œç›‘å¬å™¨ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥ç®¡ç†scopeå¦‚ä¸‹ï¼ˆè¿™ä¸ªhookä¹Ÿåœ¨vueuseä¸­ï¼‰ 123456789101112131415161718192021function createSharedComposable(composable) { let subscribers = 0 // æ¯æ¬¡è°ƒç”¨subscribers + 1 let state, scope const dispose = () =&gt; { if (scope &amp;&amp; --subscribers &lt;= 0) { scope.stop() state = scope = null } } return (...args) =&gt; { subscribers++ if (!state) { // åªåœ¨ç¬¬ä¸€æ¬¡åˆ›å»ºeffectScope scope = effectScope(true) // trueä¸ºç‹¬ç«‹çš„scopeä½œç”¨åŸŸ state = scope.run(() =&gt; composable(...args)) } onScopeDispose(dispose) // åœ¨å½“å‰æ´»è·ƒçš„effectä½œç”¨åŸŸä¸Šæ³¨å†Œä¸€ä¸ªå›è°ƒ return state }} å¯ä»¥çœ‹åˆ°disposeå‡½æ•°çš„å«ä¹‰æ˜¯ï¼Œå½“æ²¡æœ‰ä¸€ä¸ªç»„ä»¶åœ¨ä½¿ç”¨å®ƒçš„æ—¶å€™ä¼šæ³¨é”€(dispose)åˆ›å»ºçš„effectScopeï¼Œæˆ‘ä»¬åªéœ€è¦å¦‚ä¸‹æ“ä½œï¼Œå³å¯å¾—åˆ°ä¸€ä¸ªåœ¨æ‰€æœ‰ç»„ä»¶å…±äº«çš„useMouse 1const useSharedMouse = createSharedComposable(useMouse) æ›´åŠ è¯¦ç»†çš„å…³äºeffectScopeçš„è®¨è®ºåœ¨Reactivityâ€™s effectScope API #212 æœ¬æ¥æ˜¯æ‰“ç®—å®Œå…¨æŒ‰ç…§å®˜ç½‘çš„åˆ†ç±»è¿›è¡Œè§£è¯»ï¼Œä½†æ˜¯ç”±äºVCAçš„æ€æƒ³ï¼Œhookè¢«æ‹†çš„å¾ˆç¢å†ç»„åˆåœ¨ä¸€èµ·ï¼Œå¹¶ä¸èƒ½å•çº¯é åˆ†ç±»è¿›è¡Œè§£è¯»ï¼Œæ‰€ä»¥åœ¨è®²æŸä¸ªåˆ†ç±»çš„hookæ—¶ä¹Ÿä¼šå¸¦ä¸Šå…¶ä»–çš„hooksï¼Œæ¥ä¸‹æ¥æ˜¯å¯¹æˆ‘è§‰å¾— å¸¸ç”¨ æˆ–è€… æœ‰å­¦ä¹ åˆ°ä¸œè¥¿ çš„hookæºç è¿›è¡Œè§£è¯» Browser æµè§ˆå™¨ç›¸å…³çš„hookï¼ŒåŸºäºwebæš´éœ²çš„apiæ¥å®ç° å¯é…ç½®å…¨å±€å¯¹è±¡Browser hookçš„æºç å¼€å¤´éƒ½æœ‰æˆ–ç±»ä¼¼ä¸‹é¢è¿™ä¸€æ®µ 1234567export const defaultWindow = /* #__PURE__ */ isClient ? window : undefinedexport function useXXX&lt;T&gt;(options: ConfigurableWindow = {}) { const { window = defaultWindow } = options window.xxx // ...} ç”¨æˆ·å¯ä»¥é…ç½®å½“å‰windowå¯¹è±¡ï¼Œè¿™ç§é…ç½®æ–¹å¼å¯¹äºä½¿ç”¨iframeå’Œæµ‹è¯•ç¯å¢ƒä¸åŒçš„windowå¯¹è±¡ååˆ†æœ‰ç”¨ useEventListenerå…ˆä¸Šä¸€ä¸ªç®€æ˜“ç‰ˆæœ¬çš„useEventListenerï¼Œåˆ©ç”¨VCAï¼Œå°†äº‹ä»¶çš„ç›‘å¬å’Œæ³¨é”€æ”¾åœ¨ä¸€ä¸ªå‡½æ•°ä¸­å¤„ç† 123456789function useEventListener (target, listener, options, target = window) { onMounted(() =&gt; { target.addEventListener(type, listener, options) }) onUnmounted(() =&gt; { target.removeEventListener(type, listener, options) })} é™¤æ­¤ä¹‹å¤–ï¼Œæºç è¿˜æä¾›äº†å½“targetçš„ç±»å‹æ˜¯refæ—¶çš„æƒ…å†µï¼Œä¸ºäº†å‡å°‘ç¯‡å¹…ï¼Œä¸‹é¢çš„ä»£ç åˆ å‡äº†å‚æ•°ä¸ºç©ºçš„è¾¹ç•Œæƒ…å†µ 123456789101112131415161718192021222324252627282930313233343536export function useEventListener(...args: any[]) { let target: MaybeRef&lt;EventTarget&gt; | undefined = defaultWindow; let event: string let listener: any let options: any [target, event, listener, options] = args let cleanup = noop const stopWatch = watch( () =&gt; unref(target), (el) =&gt; { cleanup() if (!el) return el.addEventListener(event, listener, options) cleanup = () =&gt; { el.removeEventListener(event, listener, options) cleanup = noop } }, { immediate: true, flush: 'post' }, // ä¸ºä»€ä¹ˆflushæ˜¯postï¼Ÿä¸‹é¢ä¼šè®²è§£ ) const stop = () =&gt; { stopWatch() cleanup() } tryOnScopeDispose(stop) return stop} ä¸ºä»€ä¹ˆéœ€è¦æ”¯æŒref targetç”¨unrefå¾—åˆ°refä¸­çš„domå…ƒç´ ï¼Œç›‘å¬domå…ƒç´ çš„æ”¹å˜ä»¥é‡æ–°ç›‘å¬äº‹ä»¶ï¼Œåº”ç”¨åœºæ™¯å°±æ”¾å®˜ç½‘ä¾‹å­ 1234&lt;template&gt; &lt;div v-if=&quot;cond&quot; ref=&quot;element&quot;&gt;Div1&lt;/div&gt; &lt;div v-else ref=&quot;element&quot;&gt;Div2&lt;/div&gt;&lt;/template&gt; 1234import { useEventListener } from '@vueuse/core'const element = ref&lt;HTMLDivElement&gt;()useEventListener(element, 'keydown', (e) =&gt; { console.log(e.key) }) ä¸ºä»€ä¹ˆéœ€è¦watchè®¾ç½®flushä¸ºpostè¯¦æƒ…è¯·çœ‹#356 Bug: useEventListener doesnâ€™t work correctly with v-ifï¼Œæ„æ€å°±æ˜¯æ–°ç‰ˆvueçš„watché»˜è®¤åœ¨æ‰€æœ‰ç»„ä»¶updateå‰æ‰§è¡Œï¼Œé‚£ä¹ˆrefæ²¡æœ‰æ›´æ–°å¯¼è‡´äº‹ä»¶æ²¡æœ‰æ›´æ–°ï¼Œæ‰€ä»¥éœ€è¦åœ¨ç»„ä»¶updateå®Œæ¯•åæ›´æ–°äº‹ä»¶ã€‚ tryOnScopeDisposeæ˜¯å•¥å…ˆåˆ¤æ–­æ˜¯å¦æœ‰æ´»è·ƒçš„effectScopeï¼Œæœ‰çš„è¯ç”¨onScopeDisposeåœ¨å…¶ä¸Šæ³¨å†Œfnå›è°ƒ 1234567export function tryOnScopeDispose(fn: Fn) { if (getCurrentScope()) { onScopeDispose(fn) return true } return false} useEyeDroppernew window.EyeDropper()å¯ä»¥è·å–å–è‰²å™¨çš„åŠŸèƒ½ useMediaQuerywindow.matchMedia(query)è¿”å›MediaQueryListç±»å‹ 12345678interface MediaQueryList extends EventTarget { // æµè§ˆå™¨åŸç”Ÿç±»å‹ readonly matches: boolean; // æ˜¯å¦åŒ¹é… readonly media: string; // åª’ä½“æŸ¥è¯¢å€¼ onchange: ((this: MediaQueryList, ev: MediaQueryListEvent) =&gt; any) | null; // åª’ä½“æŸ¥è¯¢æ”¹å˜å›è°ƒ // äº‹ä»¶ç»‘å®šç›¸å…³...}let mql: MediaQueryList = window.matchMedia('(max-width: 600px)'); usePermissionnavigator.permissionså¯ä»¥è·å–ç”¨æˆ·æƒé™ï¼ˆæ‘„åƒå¤´ã€éº¦å…‹é£ç­‰ï¼‰ 123456789101112131415161718const isSupported = Boolean(navigator &amp;&amp; 'permissions' in navigator)const state = ref&lt;PermissionState | undefined&gt;() // å­˜æƒé™çŠ¶æ€const onChange = () =&gt; { if (permissionStatus) state.value = permissionStatus.state}try { permissionStatus = await navigator!.permissions.query({ name: 'camera' // https://w3c.github.io/permissions/#enumdef-permissionname }) useEventListener(permissionStatus, 'change', onChange) // æœ‰ä¸‰ä¸ªçŠ¶æ€ denied&quot; | &quot;granted&quot; | &quot;prompt&quot; onChange()}catch { state.value = 'prompt'} usePreferredLanguagesnavigator.languageså¯ä»¥è·å–ç”¨æˆ·çš„åå¥½è¯­è¨€ï¼Œå¯ä»¥é€šè¿‡languagechangeäº‹ä»¶ç›‘å¬æ”¹å˜ 12345const value = ref&lt;readonly string[]&gt;(navigator.languages)useEventListener(window, 'languagechange', () =&gt; { value.value = navigator.languages}) useSharenavigator.shareå¯ä»¥è¿›è¡Œåˆ†äº« 12345678910111213const isSupported = navigator &amp;&amp; 'canShare' in navigatorif (isSupported) { granted = navigator.canShare({ // åˆ¤æ–­æ˜¯å¦èƒ½è¢«åˆ†äº« title?: string files?: File[] text?: string url?: string }) if (granted) return navigator.share!(data)} useWakeLockScreen Wake Lock APIå¯ä»¥é˜»æ­¢è®¾å¤‡å˜æš—æˆ–é”å± 123456789101112const isSupported = navigator &amp;&amp; 'wakeLock' in navigatorfunction request(type: WakeLockType) { if (!isSupported) return wakeLock = await navigator.wakeLock.request(type)}function release() { if (!isSupported || !wakeLock) return await wakeLock.release() // é‡Šæ”¾WakeLockSentinel wakeLock = null} WatchStatecreateGlobalState ç”¨æ¥åšæŒ‚ç»„ä»¶å…¬å…±çŠ¶æ€ç®¡ç† ç®€å•çš„å•ä¾‹æ¨¡å¼å®ç°ï¼ŒeffectScopeçš„å‚æ•°ä¸ºtrueæ—¶ï¼Œå…¶ä¸ä¼šè¢«çˆ¶scopeæ”¶é›†å’Œå›æ”¶ï¼Œç‹¬ç«‹å­˜åœ¨ 123456789101112131415export function createGlobalState&lt;T&gt;( stateFactory: () =&gt; T,): CreateGlobalStateReturn&lt;T&gt; { let initialized = false let state: T const scope = effectScope(true) return () =&gt; { if (!initialized) { state = scope.run(stateFactory)! initialized = true } return state }} useLocalStorage12345678export function useLocalStorage&lt;T extends(string|number|boolean|object|null)&gt; ( key: string, initialValue: MaybeRef&lt;T&gt;, options: StorageOptions&lt;T&gt; = {},): RemovableRef&lt;any&gt; { const { window = defaultWindow } = options return useStorage(key, initialValue, window?.localStorage, options)} å¯ä»¥çœ‹åˆ°å°±æ˜¯ç”¨useStorageæ¥å®ç°çš„ï¼ŒuseSessionStorageä¹Ÿæ˜¯ä¸€æ ·ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹useStorage useStorageåœ¨æµè§ˆå™¨é»˜è®¤çš„Storageä¹‹ä¸Šåƒstore.jsä¸€æ ·å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ï¼ˆåºåˆ—åŒ–ï¼‰ï¼Œå¦åˆ™å¦‚æœå­˜ä¸€ä¸ªå¯¹è±¡åœ¨æµè§ˆå™¨çš„Storageå­˜çš„ä¼šæ˜¯xxx.toString()ä¹‹åçš„å€¼ã€‚ä½†æ˜¯useStorageæ¯”èµ·store.jsæ›´è¿›ä¸€æ­¥çš„å¢åŠ äº†å¯¹Mapå’ŒSetç±»å‹çš„æ•°æ®çš„å¤„ç†ï¼ˆMapå’ŒSetå­˜åœ¨é»˜è®¤çš„Storageå’Œstore.jséƒ½æ˜¯ç©ºå¯¹è±¡ï¼‰ åˆ©ç”¨é€‚é…å™¨æ¨¡å¼ï¼Œå¯¹æ¯ç§æ•°æ®ç±»å‹å®šä¹‰readã€write 123456789101112131415161718192021222324252627282930export const StorageSerializers: Record&lt;'boolean' | 'object' | 'number' | 'any' | 'string' | 'map' | 'set', Serializer&lt;any&gt;&gt; = { boolean: { read: (v: any) =&gt; v === 'true', write: (v: any) =&gt; String(v), }, object: { read: (v: any) =&gt; JSON.parse(v), write: (v: any) =&gt; JSON.stringify(v), }, number: { read: (v: any) =&gt; Number.parseFloat(v), write: (v: any) =&gt; String(v), }, any: { read: (v: any) =&gt; v, write: (v: any) =&gt; String(v), }, string: { read: (v: any) =&gt; v, write: (v: any) =&gt; String(v), }, map: { // mapåºåˆ—åŒ– read: (v: any) =&gt; new Map(JSON.parse(v)), write: (v: any) =&gt; JSON.stringify(Array.from((v as Map&lt;any, any&gt;).entries())), }, set: { // setåºåˆ—åŒ– read: (v: any) =&gt; new Set(JSON.parse(v)), write: (v: any) =&gt; JSON.stringify(Array.from((v as Set&lt;any&gt;).entries())), },} æ¥ä¸‹æ¥åˆ¤æ–­ç”¨æˆ·ä¼ å…¥çš„æ•°æ®ç±»å‹ï¼Œè¿›è¡Œé€‰æ‹©å¯¹åº”çš„readã€writeæ–¹æ³• 12345678910111213141516171819const type = rawInit == null ? 'any' : rawInit instanceof Set ? 'set' : rawInit instanceof Map ? 'map' : typeof rawInit === 'boolean' ? 'boolean' : typeof rawInit === 'string' ? 'string' : typeof rawInit === 'object' ? 'object' : Array.isArray(rawInit) // è¿™é‡Œä¸å¤ªè®¤åŒï¼Œtypeof [] === 'object'ï¼Œæ²¡å¿…è¦å†åŠ è¿™ä¸ªåˆ¤æ–­äº†æŠŠ ? 'object' : !Number.isNaN(rawInit) ? 'number' : 'any'const serializer = options.serializer ?? StorageSerializers[type] // ç”¨æˆ·è¿˜å¯ä»¥å®šä¹‰è‡ªå·±çš„åºåˆ—åŒ–æ–¹æ³•ï¼Œä½†å¿…é¡»å…·æœ‰readå’Œwriteæ–¹æ³• ä¸‹é¢æ˜¯å¯¹æ•°æ®çš„åˆå§‹åŒ– 1234567891011121314151617181920const rawInit: T = unref(initialValue) // ç”¨æˆ·ä¼ å…¥çš„åˆå§‹å€¼const data = (shallow ? shallowRef : ref)(initialValue) as Ref&lt;T&gt; // ç”¨æˆ·å¯ä»¥é…ç½®æ˜¯æµ…å“åº”å¼è¿˜æ˜¯æ·±ï¼Œæœ€åä¼šè¿”å›ç»™ç”¨æˆ·if (!storage) returntry { const rawValue = storage.getItem(key) if (rawValue == null) { // å¦‚æœkeyå¯¹åº”çš„å€¼ä¸ºç©ºï¼Œé‚£ä¹ˆæ˜¯é¦–æ¬¡ data.value = rawInit // åˆå§‹åŒ–å€¼ if (writeDefaults &amp;&amp; rawInit !== null) // ç”¨æˆ·å¯é…ç½®æ˜¯å¦é¦–æ¬¡å­˜å…¥Storage storage.setItem(key, serializer.write(rawInit)) } else { data.value = serializer.read(rawValue) // å¦‚æœStorageå­˜åœ¨å¯¹åº”å€¼ï¼Œåºåˆ—åŒ–è¯»å– }}catch (e) { onError(e) // ç”¨æˆ·ä¼ å…¥çš„é”™è¯¯å¤„ç†å‡½æ•°} ç„¶åæ˜¯æ ¹æ®ç›‘å¬dataçš„å˜åŒ–å­˜å…¥Storageï¼ŒwatchWithFilterå¯ä»¥çœ‹åšæ˜¯æ–°å¢äº†eventFilteré€‰é¡¹çš„watchï¼Œåœ¨åæ–‡ä¼šæè¿°ï¼Œä¹Ÿæ˜¯vueuseå¾ˆé‡è¦çš„ä¸€ä¸ªç‰¹æ€§ 12345678910111213141516171819watchWithFilter( data, () =&gt; { try { if (data.value == null) storage.removeItem(key) else storage.setItem(key, serializer.write(data.value)) } catch (e) { onError(e) } }, { flush, // å‡æ˜¯ç”¨æˆ·å¯é…ç½®çš„é€‰é¡¹ deep, eventFilter, },) ä½†ä»æœ‰å·¨éšè”½çš„bugï¼ˆå“ˆå“ˆå“ˆ)ï¼Œä¸ºäº†æ”¯æŒå“åº”å¼çš„å­˜å–Storageï¼Œç”¨äº†refç±»å‹çš„dataï¼Œåœ¨åŒæºä¸‹çš„å¤šä¸ªæ ‡ç­¾çš„æƒ…å†µä¸‹ï¼Œå…¶ä¸­ä¸€ä¸ªé¡µé¢å¯¹å¦ä¸€ä¸ªé¡µé¢ç”¨useStorageä¿®æ”¹äº†æ•°æ®ï¼Œä½†å¦ä¸€ä¸ªé¡µé¢useStorageå†…éƒ¨çš„dataè¿˜æ˜¯åŸæ¥çš„å€¼ è§£å†³æ–¹å¼ï¼šç›‘å¬storageäº‹ä»¶ï¼ˆå½“é¡µé¢ä½¿ç”¨çš„storageè¢«å…¶ä»–é¡µé¢ä¿®æ”¹æ—¶ä¼šè§¦å‘ï¼‰ 123456789101112131415function read(event?: StorageEvent) { // å°†ä¸Šé¢åˆå§‹åŒ–å€¼çš„é€»è¾‘å°è£…ä¸ºreadå‡½æ•° if (!storage || (event &amp;&amp; event.key !== key)) return try { const rawValue = event ? event.newValue : storage.getItem(key) // è¯»å€¼çœç•¥... } catch (e) { onError(e) }}if (window &amp;&amp; listenToStorageChanges) // ç”¨æˆ·ä¹Ÿå¯ä»¥é…ç½®ä¸ç›‘å¬ useEventListener(window, 'storage', e =&gt; setTimeout(() =&gt; read(e), 0)) // é‡æ–°è¯»å–å€¼ç»™data SensorsonClickOutside1 AnimationuseRafFn å¯ä»¥æš‚åœã€æ¢å¤ã€è·å–å½“å‰çŠ¶æ€çš„requestAnimationFrame 1234567891011121314151617181920212223242526272829303132333435363738export function useRafFn(fn: Fn, options: RafFnOptions = {}): Pausable { const { immediate = true, window = defaultWindow, } = options const isActive = ref(false) function loop() { if (!isActive.value) return fn() if (window) window.requestAnimationFrame(loop) } function resume() { if (!isActive.value) { // å¦‚æœæ˜¯éæ´»è·ƒçŠ¶æ€æ‰å¯ä»¥æ¢å¤ isActive.value = true loop() } } function pause() { isActive.value = false // æš‚åœå°±ç›´æ¥è®¾ç½®ä¸ºfalseï¼Œåœ¨loopä¸­å¦‚æœfalseåˆ™ç›´æ¥è·³è¿‡fnæ‰§è¡Œ } if (immediate) resume() tryOnScopeDispose(pause) return { isActive, pause, resume, }} ç•™æœ‰ç–‘é—®ï¼šä¸ºä»€ä¹ˆpauseä¸­ä¸ç”¨cancelAnimationFrameæ¥å–æ¶ˆrequestAnimationFrame useTransitionå¯é…ç½®é¡¹ 123456789101112131415161718type CubicBezierPoints = [number, number, number, number]type EasingFunction = (n: number) =&gt; numberexport function useTransition( source: Ref&lt;number | number[]&gt; | MaybeRef&lt;number&gt;[], options: TransitionOptions = {},): ComputedRef&lt;any&gt; { const { // æ—¶é—´ç›¸å…³å•ä½å‡ä¸ºms delay = 0, // delay åæ‰§è¡Œ disabled = false, // æ˜¯å¦å…³é—­ duration = 1000, // æŒç»­æ—¶é—´ onFinished = noop, // å®Œæˆåæ‰§è¡Œ onStarted = noop, // å¼€å§‹æ—¶æ‰§è¡Œ transition = linear, // è½¬åŒ–ç®—æ³• MaybeRef&lt;EasingFunction | CubicBezierPoints&gt;ï¼Œé»˜è®¤å€¼æ˜¯ x =&gt; x } = options // ...} é¢„å¤„ç† 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950export function useTransition( source: Ref&lt;number | number[]&gt; | MaybeRef&lt;number&gt;[], options: TransitionOptions = {},): ComputedRef&lt;any&gt; { // å¯é…ç½®é¡¹ // åˆ›å»ºå½“å‰çš„è¿‡æ¸¡å‡½æ•°ï¼Œå¦‚æœç”¨æˆ·è‡ªå®šä¹‰äº†è¿‡æ¸¡å‡½æ•°åˆ™ä¸åšå¤„ç†ï¼Œå¦åˆ™æ ¹æ®è´èµ›å°”æ›²çº¿å€¼åˆ›å»ºè¿‡æ¸¡å‡½æ•° const currentTransition = computed(() =&gt; { const t = unref(transition) return isFunction(t) ? t : createEasingFunction(t) }) // ç”¨unrefå¤„ç†sourceå‚æ•°ï¼Œå¦‚æœsourceæ˜¯æ•°ç»„åˆ™ä¾æ¬¡unref const sourceValue = computed(() =&gt; { const s = unref&lt;number | MaybeRef&lt;number&gt;[]&gt;(source) return isNumber(s) ? s : s.map(unref) as number[] }) // è§„æ ¼åŒ–sourceï¼Œæ•´æˆæ•°ç»„ const sourceVector = computed(() =&gt; isNumber(sourceValue.value) ? [sourceValue.value] : sourceValue.value) // ...}// åˆ›å»ºè¿‡æ¸¡å‡½æ•°ï¼Œçº¯æ•°å­¦function createEasingFunction([p0, p1, p2, p3]: CubicBezierPoints): EasingFunction { const a = (a1: number, a2: number) =&gt; 1 - 3 * a2 + 3 * a1 const b = (a1: number, a2: number) =&gt; 3 * a2 - 6 * a1 const c = (a1: number) =&gt; 3 * a1 const calcBezier = (t: number, a1: number, a2: number) =&gt; ((a(a1, a2) * t + b(a1, a2)) * t + c(a1)) * t const getSlope = (t: number, a1: number, a2: number) =&gt; 3 * a(a1, a2) * t * t + 2 * b(a1, a2) * t + c(a1) const getTforX = (x: number) =&gt; { let aGuessT = x for (let i = 0; i &lt; 4; ++i) { const currentSlope = getSlope(aGuessT, p0, p2) if (currentSlope === 0) return aGuessT const currentX = calcBezier(aGuessT, p0, p2) - x aGuessT -= currentX / currentSlope } return aGuessT } return (x: number) =&gt; p0 === p1 &amp;&amp; p2 === p3 ? x : calcBezier(getTforX(x), p1, p3)} æä¾›äº†å‡ ç§è¿‡æ¸¡é¢„è®¾ 12345export const TransitionPresets: Record&lt;string, CubicBezierPoints | EasingFunction&gt; = { easeInSine: [0.12, 0, 0.39, 0], easeOutSine: [0.61, 1, 0.88, 1], // ...} è¯¦æƒ…å¯ä»¥çœ‹ ç¼“åŠ¨å‡½æ•°ã€ MDNï¼šç¼“åŠ¨å‡½æ•° å…³é”®é€»è¾‘ 1234567891011121314151617181920212223242526272829303132333435363738394041424344const outputVector = ref(sourceVector.value.slice(0)) // ç”¨ä»¥å­˜å‚¨è¾“å‡º// è¿‡æ¸¡ä¸»æµç¨‹ï¼Œå¯ä»¥æš‚åœconst { resume, pause } = useRafFn(() =&gt; { // å¯ä»¥æš‚åœã€æ¢å¤çš„ requestAnimationFrame const now = Date.now() const progress = clamp(1 - ((endAt - now) / currentDuration), 0, 1) // è¿‡æ¸¡è¿›åº¦ï¼Œclampå°†å€¼é™åˆ¶åœ¨0-1ä¹‹é—´ outputVector.value = startVector.map((val, i) =&gt; val + ((diffVector[i] ?? 0) * currentTransition.value(progress))) // æ›´æ–°output if (progress &gt;= 1) { // å®Œæˆè¿‡æ¸¡ pause() // æš‚åœ requestAnimationFrame onFinished() // æ‰§è¡Œoptionsä¸­çš„å®Œæˆå›è°ƒ }}, { immediate: false })const timeout = useTimeoutFn(start, delay, { immediate: false }) // delayæ¯«ç§’åæ‰§è¡Œstartå‡½æ•°const start = () =&gt; { pause() // æš‚åœ è¿‡æ¸¡ currentDuration = unref(duration) diffVector = outputVector.value.map((n, i) =&gt; (sourceVector.value[i] ?? 0) - (outputVector.value[i] ?? 0)) // åˆå§‹å€¼å’Œå½“å‰å€¼çš„diff startVector = outputVector.value.slice(0) // æ‹·è´åˆå§‹å€¼ startAt = Date.now() // å¼€å§‹æ—¶é—´ endAt = startAt + currentDuration // ç»“æŸæ—¶é—´ï¼Œç”¨åœ¨è®¡ç®—progress resume() // å¼€å§‹è¿‡æ¸¡ onStarted() // æ‰§è¡Œoptionsä¸­çš„å¼€å§‹å›è°ƒ}watch(sourceVector, () =&gt; { // ç›‘å¬sourceVectorçš„å˜åŒ– if (unref(disabled)) { // å¦‚æœæš‚åœè¿‡æ¸¡ï¼Œå°†è¾“å‡ºè¿˜åŸå›åˆå§‹å€¼ outputVector.value = sourceVector.value.slice(0) } else { if (unref(delay) &lt;= 0) start() // å¦‚æœæ²¡æœ‰å»¶è¿Ÿï¼Œåˆ™å¼€å§‹è¿‡æ¸¡ else timeout.start() // å¦‚æœæœ‰å»¶è¿Ÿï¼Œåˆ™å¼€å§‹ä¸Šé¢åˆ›å»ºå¥½çš„timeout }}, { deep: true })return computed(() =&gt; { const targetVector = unref(disabled) ? sourceVector : outputVector // å¦‚æœæš‚åœè¿‡æ¸¡ï¼Œå°†è¾“å‡ºè¿˜åŸå›åˆå§‹å€¼ return isNumber(sourceValue.value) ? targetVector.value[0] : targetVector.value // ä¸ºå€¼è§£å¼€æ•°ç»„åŒ…è£…ï¼Œæ•°ç»„åŸæ ·è¿”å›}) æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚","link":"/2021/12/11/Vue/vueuse%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"},{"title":"ã€æºç è§£è¯»ã€‘æ¨¡å—æ‡’åŠ è½½(åœ¨ä½¿ç”¨æ—¶)","text":"åœ¨çœ‹ä¸ºä»€ä¹ˆvueæ–‡æ¡£èƒ½åšåˆ°æ–°å†…å®¹å¯ç”¨æ›´æ–°ï¼ˆåˆ©ç”¨service workerï¼‰çš„æ—¶å€™ï¼Œé¡ºä¾¿çœ‹åˆ°äº†update-notifierï¼ˆæç¤ºç‰ˆæœ¬æ›´æ–°çš„åº“ï¼Œå®ç°æ–¹å¼ï¼šå®šæ—¶æ£€æŸ¥npmä¸Šçš„ç‰ˆæœ¬å’Œæœ¬åœ°package.jsonçš„ç‰ˆæœ¬å¯¹æ¯”ï¼Œæœ‰å·®å¼‚å°±æç¤ºç”¨æˆ·æ›´æ–°ï¼‰ï¼Œçœ‹update-notifieræºç çš„æ—¶å€™å‘ç°æœ‰å¾ˆå¤šlazyImportï¼Œè§‰å¾—æŒºæ–°å¥‡ï¼Œäºæ˜¯æœ‰äº†è¿™ç¯‡æ–‡ç«  æ€æƒ³ä¸ºäº†æé«˜åº”ç”¨çš„å¯åŠ¨æ—¶é—´ï¼Œåœ¨æ²¡æœ‰ç”¨åˆ°ä»“åº“çš„é¢å¤–åŠŸèƒ½æ—¶ä¸åŠ è½½æ¨¡å—ï¼Œæ‰€ä»¥å°†æ¨¡å—åŠ è½½å»¶è¿Ÿåˆ°ä½¿ç”¨ä¹‹å‰ ä½¿ç”¨æ–¹å¼1234const importLazy = require('import-lazy')(require);const _ = importLazy('lodash');_.isNumber(2); // åœ¨ä½¿ç”¨çš„æ—¶å€™æ‰è§¦å‘æ¨¡å—åŠ è½½ å®ç°æ–¹å¼å®é™…ä¸Šæ˜¯ç”¨proxyä»£ç†äº†getæ“ä½œï¼Œåœ¨getçš„æ—¶å€™æ‰è§¦å‘æ¨¡å—åŠ è½½ 1234567891011121314151617181920212223242526const lazy = (importedModule, importFn, moduleId) =&gt; importedModule === undefined ? importFn(moduleId) : importedModule;module.exports = importFn =&gt; { return moduleId =&gt; { let importedModule; const handler = { get: (target, property) =&gt; { importedModule = lazy(importedModule, importFn, moduleId); return Reflect.get(importedModule, property); }, apply: (target, thisArgument, argumentsList) =&gt; { importedModule = lazy(importedModule, importFn, moduleId); return Reflect.apply(importedModule, thisArgument, argumentsList); }, construct: (target, argumentsList) =&gt; { importedModule = lazy(importedModule, importFn, moduleId); return Reflect.construct(importedModule, argumentsList); } }; // eslint-disable-next-line prefer-arrow-callback return new Proxy(function () {}, handler); };}; è¿™ä¹Ÿå¯¼è‡´æˆ‘ä»¬åœ¨ä½¿ç”¨import-lazyçš„æ—¶å€™ä¸èƒ½æŒ‰éœ€åŠ è½½ 1const {isNumber, isString} = importLazy('lodash'); // ä¸æ”¯æŒ","link":"/2021/09/23/Js/%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/%E6%A8%A1%E5%9D%97%E6%87%92%E5%8A%A0%E8%BD%BD/"},{"title":"è·¨å¹³å°çš„æ‹–æ‹½","text":"crossventï¼šå°è£…è·¨å¹³å°äº‹ä»¶ç»‘å®šçš„åº“ è·¨å¹³å°çš„è§¦æ‘¸äº‹ä»¶åˆ©ç”¨crossventå°è£…ç»‘å®šè·¨å¹³å°æ‹–æ‹½äº‹ä»¶çš„æ–¹æ³•touchyï¼Œä»¥ä¾¿æ”¯æŒç§»åŠ¨ç«¯å’Œpcç«¯ æ ¹æ®ç¯å¢ƒè·å–çš„è§¦æ‘¸äº‹ä»¶åï¼Œç”¨æ‡’åŠ è½½çš„æ–¹å¼æ›¿æ¢æ‰touchyå‡½æ•°ï¼Œä¹‹åç»‘å®šäº‹ä»¶ä¸éœ€è¦å†åˆ¤æ–­ 1234567891011121314151617181920212223242526272829303132333435import { add as addEvent } from 'crossvent';let touchy = function (el, type, fn) { const touch = { mouseup: 'touchend', mousedown: 'touchstart', mousemove: 'touchmove' }; const pointers = { mouseup: 'pointerup', mousedown: 'pointerdown', mousemove: 'pointermove' }; const microsoft = { mouseup: 'MSPointerUp', mousedown: 'MSPointerDown', mousemove: 'MSPointerMove' }; if (window.navigator.pointerEnabled) { touchy = function (el, type, fn) { addEvent(el, pointers[type], fn); }; } else if (window.navigator.msPointerEnabled) { touchy = function (el, type, fn) { addEvent(el, microsoft[type], fn); }; } else { touchy = function (el, type, fn) { addEvent(el, touch[type], fn); addEvent(el, type, fn); }; } touchy(el, type, fn);}; åˆå§‹åŒ–äº‹ä»¶ 12345678910111213const documentElement = document.documentElement;function draggable (dom) { initEvents(); function initEvents () { touchy(dom, 'mousedown', mousedown); touchy(documentElement, 'mousemove', mousemove); touchy(documentElement, 'mouseup', mouseup); } //...} è¿™é‡Œåœ¨documentElementä¸Šç»‘å®šmousemoveå’Œmouseupäº‹ä»¶ï¼Œæ˜¯å› ä¸ºé¿å…æ¸²æŸ“é€Ÿåº¦ä½äºæ‹–æ‹½é€Ÿåº¦ï¼Œå¯¼è‡´é¼ æ ‡è¶…å‡ºæ‹–æ‹½èŒƒå›´è€Œæ— æ³•æ‹–æ‹½å’Œé‡Šæ”¾ è¿™é‡Œæä¸€ä¸‹ç»‘å®šäº‹ä»¶æ—¶æœ‰ä¸€ä¸ªpassiveé€‰é¡¹ï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹ ä½¿ç”¨ passive æ”¹å–„çš„æ»šå±æ€§èƒ½ï¼Œå¯ä»¥è®¾ç½®ä¸ºfalseï¼Œä½¿äº‹ä»¶å›è°ƒå¯ä»¥ä½¿ç”¨e.preventDefaultç¦ç”¨é»˜è®¤çš„è¡Œä¸º mousedown123456function mousedown (e) { active = true; e = getEventHost(e); _moveX = e.clientX; _moveY = e.clientY;} åœ¨documentElementä¸Šç»‘å®šmousemoveå’Œmouseupäº‹ä»¶ï¼Œæ‰€ä»¥éœ€è¦æ ‡è®°æ˜¯å¦æ˜¯å¤„äºæ‹–æ‹½çŠ¶æ€ï¼Œç„¶åmousemoveå’Œmouseupä¸­åˆ¤æ–­å¦‚æœä¸æ˜¯æ‹–æ‹½çŠ¶æ€åˆ™è·³å‡ºå‡½æ•°ã€‚ ä¸ºäº†é€‚é…ç§»åŠ¨ç«¯ï¼ˆtouchEventæ²¡æœ‰clientXã€clientYã€xã€yï¼‰ï¼Œå¼•å‡ºäº†getEventHost 123456789function getEventHost (e) { if (e.targetTouches &amp;&amp; e.targetTouches.length) { return e.targetTouches[0]; } if (e.changedTouches &amp;&amp; e.changedTouches.length) { return e.changedTouches[0]; } return e;} æˆ‘ä»¬çœ‹çœ‹touchã€targetTouchesã€changedTouchesçš„å®šä¹‰ touches: å½“å‰å±å¹•ä¸Šæ‰€æœ‰è§¦æ‘¸ç‚¹çš„åˆ—è¡¨ targetTouches: å½“å‰å¯¹è±¡ä¸Šæ‰€æœ‰è§¦æ‘¸ç‚¹çš„åˆ—è¡¨ changedTouches: æ¶‰åŠå½“å‰(å¼•å‘)äº‹ä»¶çš„è§¦æ‘¸ç‚¹çš„åˆ—è¡¨ mousemoveè¿™é‡Œå®ç°çš„æ˜¯å¯æ‹–æ‹½èŒƒå›´ä¸ºdocumentçš„å¯è§†åŒºåŸŸ 12345678910111213141516171819function mousemove (e) { if (!active) { // å¦‚æœä¸æ˜¯å‡ºäºæ‹–æ‹½çŠ¶æ€ç›´æ¥æ”¾å› return; } e = getEventHost(e); const { x, y, height, width } = dom.getBoundingClientRect(); const curLeft = x + e.clientX - _moveX; const curTop = y + e.clientY - _moveY; dom.style.left = `${clamp(curLeft, 0, documentElement.clientWidth - width - 1)}px`; dom.style.top = `${clamp(curTop, 0, documentElement.clientHeight - height)}px`; _moveX = e.clientX; _moveY = e.clientY;}// å°†valueé™åˆ¶åœ¨[min, max]ä¹‹é—´function clamp (value, min, max) { return Math.min(Math.max(value, min), max);} mouseup123function mouseup () { active = false;} æ€»ç»“æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰mousemoveçš„è¡Œä¸ºï¼Œä½†æ•´ä½“çš„æ¡†æ¶ä¸ä¼šå˜","link":"/2021/09/12/Js/%E8%B7%A8%E5%B9%B3%E5%8F%B0%E7%9A%84%E6%8B%96%E6%8B%BD/"},{"title":"ã€æºç è§£è¯»ã€‘Axiosæºç è§£æ","text":"å·¥å…·ç±»bind123456789function bind(fn, thisArg) { return function wrap() { var args = new Array(arguments.length); for (var i = 0; i &lt; args.length; i++) { args[i] = arguments[i]; } return fn.apply(thisArg, args); };}; extend12345678910function extend(a, b, thisArg) { forEach(b, function assignValue(val, key) { if (thisArg &amp;&amp; typeof val === 'function') { a[key] = bind(val, thisArg); } else { a[key] = val; } }); return a;} merge12345678910111213141516171819function merge(/* obj1, obj2, obj3, ... */) { var result = {}; function assignValue(val, key) { if (isPlainObject(result[key]) &amp;&amp; isPlainObject(val)) { result[key] = merge(result[key], val); } else if (isPlainObject(val)) { result[key] = merge({}, val); } else if (isArray(val)) { result[key] = val.slice(); } else { result[key] = val; } } for (var i = 0, l = arguments.length; i &lt; l; i++) { forEach(arguments[i], assignValue); } return result;} ä»ä½¿ç”¨æ–¹å¼çœ‹èµ·å¯¹å‡ ç§è°ƒç”¨æ–¹å¼åšäº†ç¼–å· axios(option) axios(url[, option]) axios[method](url[, option])ï¼ˆgetã€deleteç­‰æ–¹æ³•ï¼‰ axios[method](url[, data[, option]])ï¼ˆpostã€putç­‰æ–¹æ³•ï¼‰ axios.request(option) è®©æˆ‘ä»¬çœ‹çœ‹æºç ä»–æ˜¯æ€ä¹ˆåšåˆ°èƒ½å¤Ÿæ”¯æŒè¿™ä¹ˆå¤šè°ƒç”¨æ–¹å¼çš„ 1234567891011121314151617181920212223// /lib/axios.jsfunction createInstance(defaultConfig) { var context = new Axios(defaultConfig); // ç­‰åŒäº Axios.prototype.request.bind(context) // requestæ–¹æ³•ä¸­å¯¹ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¦ä¸º string åšäº†åˆ¤æ–­ï¼Œä½¿æ”¯æŒ1ã€2ç§è°ƒç”¨æ–¹å¼ var instance = bind(Axios.prototype.request, context); // æŠŠAxios.prototypeä¸Šçš„æ–¹æ³•æ‰©å±•åˆ°instanceå¯¹è±¡ä¸Šï¼Œ // è¿™æ · instance å°±æœ‰äº† getã€postã€putã€requestç­‰æ–¹æ³•ï¼Œä½¿æ”¯æŒ3ã€4ã€5è°ƒç”¨æ–¹å¼ // å¹¶æŒ‡å®šä¸Šä¸‹æ–‡ä¸ºcontextï¼Œè¿™æ ·æ‰§è¡ŒAxiosåŸå‹é“¾ä¸Šçš„æ–¹æ³•æ—¶ï¼Œthisä¼šæŒ‡å‘context utils.extend(instance, Axios.prototype, context); // æŠŠcontextå¯¹è±¡ä¸Šçš„è‡ªèº«å±æ€§å’Œæ–¹æ³•æ‰©å±•åˆ°instanceä¸Š // è¿™æ ·ï¼Œinstance å°±æœ‰äº† defaultsã€interceptors å±æ€§ã€‚ï¼ˆè¿™ä¸¤ä¸ªå±æ€§åé¢æˆ‘ä»¬ä¼šä»‹ç»ï¼‰ utils.extend(instance, context); return instance;}// æ¥æ”¶é»˜è®¤é…ç½®é¡¹ä½œä¸ºå‚æ•°ï¼ˆåé¢ä¼šä»‹ç»é…ç½®é¡¹ï¼‰ï¼Œåˆ›å»ºä¸€ä¸ªAxioså®ä¾‹ï¼Œæœ€ç»ˆä¼šè¢«ä½œä¸ºå¯¹è±¡å¯¼å‡ºvar axios = createInstance(defaults); ä¸»è¦æ˜¯ä¸ºäº†èƒ½å¤Ÿåšåˆ°1ã€2ç§è°ƒç”¨æ–¹å¼ï¼Œæ‰€ä»¥æ˜¯è¿”å›requestå‡½æ•°ï¼Œå¹¶åœ¨å…¶ä¸ŠæŒ‚è½½Axioså®ä¾‹çš„æ–¹æ³• æ¥ä¸‹æ¥çœ‹çœ‹ä¸Šè¿°ä»£ç æ“ä½œçš„ä¸»ä½“ï¼šAxiosã€Axios.prototype.request ä»¥åŠ Axios.prototypeä¸Šçš„è¯·æ±‚æ–¹æ³• 1234567891011121314151617181920212223242526272829303132333435363738// /lib/core/Axios.jsfunction Axios(instanceConfig) { this.defaults = instanceConfig; this.interceptors = { request: new InterceptorManager(), response: new InterceptorManager() };}Axios.prototype.request = function request(config) { if (typeof config === 'string') { // ä½¿æ”¯æŒ1ã€2ä¸¤ç§è°ƒç”¨æ–¹å¼ config = arguments[1] || {}; config.url = arguments[0]; } else { config = config || {}; } // ...};// Provide aliases for supported request methodsutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) { Axios.prototype[method] = function(url, config) { return this.request(mergeConfig(config || {}, { method: method, url: url, data: (config || {}).data })); };});utils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) { Axios.prototype[method] = function(url, data, config) { return this.request(mergeConfig(config || {}, { method: method, url: url, data: data })); };}); ç»“åˆä¸Šé¢createInstanceçš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šç§æ–¹å¼è°ƒç”¨axios æˆ‘ä»¬å…ˆä¸çœ‹å…·ä½“è¯·æ±‚é€»è¾‘æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œå…ˆçœ‹çœ‹æ‹¦æˆªå™¨æ˜¯æ€ä¹ˆåšåˆ°åœ¨è¯·æ±‚å‰åé¢„å¤„ç†çš„ã€‚ æ‹¦æˆªå™¨ï¼ˆinterceptorï¼‰åœ¨ä¸Šæ–‡Axiosçš„æ„é€ å™¨ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ° 1234this.interceptors = { request: new InterceptorManager(), response: new InterceptorManager()}; InterceptorManagerç±»ç”¨ä»¥ç®¡ç†æ‹¦æˆªå™¨ InterceptorManagerç±»123456789101112131415161718192021222324252627282930function InterceptorManager() { this.handlers = []; // å­˜å‚¨æ‹¦æˆªå™¨å‡½æ•°}// ç”¨ä»¥æ·»åŠ æ‹¦æˆªå™¨InterceptorManager.prototype.use = function use(fulfilled, rejected, options) { this.handlers.push({ fulfilled: fulfilled, rejected: rejected, synchronous: options ? options.synchronous : false, // æ˜¯å¦æ˜¯åŒæ­¥æ‰§è¡Œ runWhen: options ? options.runWhen : null // æŒ‡å®šæ‹¦æˆªå™¨åœ¨æŸç§æƒ…å†µä¸‹æ‰§è¡Œ }); return this.handlers.length - 1;};// åˆ é™¤æ‹¦æˆªå™¨InterceptorManager.prototype.eject = function eject(id) { if (this.handlers[id]) { this.handlers[id] = null; }};// å°†handlerçš„æ¯ä¸€é¡¹äº¤ç”±fnå¤„ç†InterceptorManager.prototype.forEach = function forEach(fn) { utils.forEach(this.handlers, function forEachHandler(h) { if (h !== null) { fn(h); } });}; requestä¸­InterceptorManagerä½¿ç”¨æ–¹å¼123456789101112131415161718192021222324252627282930313233343536373839404142Axios.prototype.request = function request(config) { // è¿™é‡Œæœ‰åˆå¹¶ config çš„æ“ä½œï¼Œä¼˜å…ˆçº§æ˜¯ defaults -&gt; { method: &quot;get&quot; } -&gt; this.defaults -&gt; config // ä¹Ÿå°±æ˜¯ åº“é»˜è®¤çš„é…ç½® -&gt; é»˜è®¤ä¸ºgetè¯·æ±‚ -&gt; åˆ›å»ºAxioså®ä¾‹è®¾ç½®çš„é…ç½® -&gt; è¯·æ±‚çš„é…ç½® var requestInterceptorChain = []; // è¯·æ±‚æ‹¦æˆªå™¨é“¾ this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) { // æ— æ³•é€šè¿‡runWhenæ¡ä»¶çš„åˆ™ä¸æ‰§è¡Œ if (typeof interceptor.runWhen === 'function' &amp;&amp; interceptor.runWhen(config) === false) { return; } // ä»¥ fulfilledã€rejected æˆå¯¹unshiftåˆ° requestInterceptorChain requestInterceptorChain.unshift(interceptor.fulfilled, interceptor.rejected); }); var responseInterceptorChain = []; // å“åº”æ‹¦æˆªå™¨é“¾ this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) { // ä»¥ fulfilledã€rejected æˆå¯¹unshiftåˆ° responseInterceptorChain responseInterceptorChain.push(interceptor.fulfilled, interceptor.rejected); }); var promise; // dispatchRequestæ˜¯å‘é€è¯·æ±‚ï¼Œç¬¬äºŒä¸ªundefinedæ˜¯ä¸ºäº†ç¬¦åˆæå–æ–¹å¼çš„å ä½å€¼ var chain = [dispatchRequest, undefined]; // å°† è¯·æ±‚æ‹¦æˆªå™¨ æ”¾ç½®åœ¨dispatchRequestå‰é¢ Array.prototype.unshift.apply(chain, requestInterceptorChain); // å°† å“åº”æ‹¦æˆªå™¨ æ”¾ç½®åœ¨dispatchRequeståé¢ chain.concat(responseInterceptorChain); // é€šè¿‡æ­¤æ–¹å¼å°†configä¼ å…¥åˆ°è¯·æ±‚æ‹¦æˆªå™¨çš„ç¬¬ä¸€ä¸ªfulfilled promise = Promise.resolve(config); while (chain.length) { // å› ä¸ºåœ¨chainä¸­fulfilledã€rejectedæ˜¯æˆå¯¹å­˜åœ¨çš„ // è€Œ è¯·æ±‚æ‹¦æˆªå™¨ å¿…é¡»è¿”å›configï¼Œä¸‹ä¸€ä¸ª è¯·æ±‚æ‹¦æˆªå™¨ å°±ä¼šæ¥å—ä¸Šä¸€ä¸ªconfig // å“åº”æ‹¦æˆªå™¨ ä¼šæ¥å— dispatchRequest çš„å“åº”ä½“æˆ–é”™è¯¯ promise = promise.then(chain.shift(), chain.shift()); } return promise;} å¤§è‡´æµç¨‹å°±æ˜¯å¦‚æ­¤ synchronousä½†æ˜¯axiosè¿˜ä¸ºè¯·æ±‚æ‹¦æˆªå™¨æä¾›äº†synchronousé€‰é¡¹ï¼Œéœ€è¦å…¨éƒ¨è¯·æ±‚æ‹¦æˆªå™¨è®¾ç½®synchronousä¸ºtrueï¼Œé‚£ä¹ˆå°±ä»¥åŒæ­¥çš„æ–¹å¼è¿è¡Œ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162Axios.prototype.request = function request(config) { // ... var requestInterceptorChain = []; // æ–°å¢ï¼šç”¨ä»¥æ ‡è®°æ˜¯å¦æ˜¯åŒæ­¥æ‰§è¡Œè¯·æ±‚æ‹¦æˆªå™¨ var synchronousRequestInterceptors = true; this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) { if (typeof interceptor.runWhen === 'function' &amp;&amp; interceptor.runWhen(config) === false) { return; } // æ–°å¢ï¼šéœ€è¦ å…¨éƒ¨è¯·æ±‚æ‹¦æˆªå™¨ è®¾ç½®synchronousæˆtrueæ‰ä¼šåŒæ­¥æ‰§è¡Œ synchronousRequestInterceptors = synchronousRequestInterceptors &amp;&amp; interceptor.synchronous; requestInterceptorChain.unshift(interceptor.fulfilled, interceptor.rejected); }); var responseInterceptorChain = []; this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) { responseInterceptorChain.push(interceptor.fulfilled, interceptor.rejected); }); var promise; // æ–°å¢ï¼šé»˜è®¤æ˜¯å¼‚æ­¥çš„æ–¹å¼æ‰§è¡Œ if (!synchronousRequestInterceptors) { var chain = [dispatchRequest, undefined]; Array.prototype.unshift.apply(chain, requestInterceptorChain); chain.concat(responseInterceptorChain); promise = Promise.resolve(config); while (chain.length) { promise = promise.then(chain.shift(), chain.shift()); } return promise; } // æ–°å¢ï¼šåŒæ­¥çš„æ–¹å¼æ‰§è¡Œè¯·æ±‚æ‹¦æˆªå™¨ var newConfig = config; while (requestInterceptorChain.length) { var onFulfilled = requestInterceptorChain.shift(); var onRejected = requestInterceptorChain.shift(); try { newConfig = onFulfilled(newConfig); } catch (error) { onRejected(error); break; } } try { promise = dispatchRequest(newConfig); } catch (error) { return Promise.reject(error); } while (responseInterceptorChain.length) { promise = promise.then(responseInterceptorChain.shift(), responseInterceptorChain.shift()); } return promise;}; å¯å‘ï¼šé“¾å¼è°ƒç”¨1234new Man(&quot;Hank&quot;).sleep(1).eat(&quot;supper&quot;).sleep(1).eat(&quot;me&quot;).sleepFirst(2);// æ‰“å°ç»“æœ// 'This is Hank' -(ç­‰å¾…2s)--&gt; 'Wale up after 2' -(ç­‰å¾…1s)--&gt; 'Wale up after 1' 'Eat supper' -(ç­‰å¾…1s)--&gt; 'Eat me' å†™æ³•æ”¾åœ¨æ–‡æœ« å‘èµ·è¯·æ±‚dispatchRequeståœ¨æ‹¿åˆ°è¯·æ±‚æ‹¦æˆªå™¨å¤„ç†åçš„configå 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748// /lib/core/dispatchRequest.jsfunction dispatchRequest(config) { // 1.è¯·æ±‚å¦‚æœè¢«å–æ¶ˆåˆ™ throw cancel Error throwIfCancellationRequested(config); // 2.ç¡®ä¿headerså­˜åœ¨ config.headers = config.headers || {}; // 3.åé¢ä¼šè®²ï¼šæ•°æ®è½¬åŒ–å™¨è½¬åŒ–è¯·æ±‚dataï¼Œä¹Ÿå¯ä»¥åœ¨configè‡ªå®šä¹‰é…ç½®transformRequest config.data = transformData.call( config, config.data, config.headers, config.transformRequest ); // 4.æ‰å¹³headerè®¾ç½®ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨config.headers.get = {}è®¾ç½®æŸç§è¯·æ±‚ç±»å‹çš„headers config.headers = utils.merge( config.headers.common || {}, config.headers[config.method] || {}, config.headers ); // 5.åˆ é™¤æ— ç”¨headerï¼Œå› ä¸ºåœ¨ç¬¬å››æ­¥æ—¶æ‰å¹³åŒ–å®šä¹‰åœ¨headersäº† utils.forEach( ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'], function cleanHeaderConfig(method) { delete config.headers[method]; } ); // å¯ä»¥è‡ªå®šä¹‰é€‚é…å™¨ï¼Œé»˜è®¤ä¸ºXHRï¼ˆwebï¼‰æˆ–httpï¼ˆnodeï¼‰é€‚é…å™¨ var adapter = config.adapter || defaults.adapter; return adapter(config).then(function onAdapterResolution(response) { // ... return response; }, function onAdapterRejection(reason) { // ... return Promise.reject(reason); });};function throwIfCancellationRequested(config) { if (config.cancelToken) { config.cancelToken.throwIfRequested(); }} è·¨ç«¯å®ç°ï¼ˆadapterï¼‰é€‚é…å™¨æ¨¡å¼ æ˜¯å¦æœ‰XMLHttpRequestå¯¹è±¡æ¥åˆ¤æ–­æ˜¯å¦æ˜¯webç¯å¢ƒ æ˜¯å¦æœ‰processå¯¹è±¡æ¥åˆ¤æ–­nodeç¯å¢ƒ 12345678910// /lib/defaults.jsfunction getDefaultAdapter() { var adapter; if (typeof XMLHttpRequest !== 'undefined') { adapter = require('./adapters/xhr'); } else if (typeof process !== 'undefined' &amp;&amp; Object.prototype.toString.call(process) === '[object process]') { adapter = require('./adapters/http'); } return adapter;} å°è£…xhrè¿”å›ä¸€ä¸ªpromise 123456789101112131415161718192021222324252627282930// /lib/adapters/xhr.jsfunction xhrAdapter(config) { return new Promise(function dispatchXhrRequest(resolve, reject) { // ... var request = new XMLHttpRequest(); var fullPath = buildFullPath(config.baseURL, config.url); // buildURL: æ ¼å¼åŒ–url; config.paramsSerializer: åºåˆ—åŒ–æ–¹å¼ï¼› request.open(config.method.toUpperCase(), buildURL(fullPath, config.params, config.paramsSerializer), true); request.timeout = config.timeout; request.onloadend = function onloadend() { // ... settle(resolve, reject, response); // ä¸‹é¢æœ‰ä»£ç  request = null; }; request.onabort = function handleError() { reject(/**/); request = null; }; request.onerror = function handleError() { reject(/**/); request = null; }; request.ontimeout = function handleTimeout() { reject(/**/); request = null; }; request.send(requestData); });}; éªŒè¯æœåŠ¡ç«¯çš„è¿”å›ç»“æœæ˜¯å¦é€šè¿‡éªŒè¯ï¼š 123456789// /lib/core/settle.jsfunction settle(resolve, reject, response) { var validateStatus = response.config.validateStatus; // å¯ä»¥è‡ªå®šä¹‰æˆåŠŸè§„åˆ™ if (!response.status || !validateStatus || validateStatus(response.status)) { resolve(response); } else { reject(/**/); }}; åŒç†å°†httpå°è£…æˆpromise å–æ¶ˆè¯·æ±‚ï¼ˆcancelTokenï¼‰å¦‚ä½•ä½¿ç”¨12345678910111213141516171819import axios from 'axios'// ç¬¬ä¸€ç§å–æ¶ˆæ–¹æ³•axios.get(url, { cancelToken: new axios.CancelToken(cancel =&gt; { if (/* å–æ¶ˆæ¡ä»¶ */) { cancel('å–æ¶ˆæ—¥å¿—'); } })});// ç¬¬äºŒç§å–æ¶ˆæ–¹æ³•const CancelToken = axios.CancelToken;const source = CancelToken.source();axios.get(url, { cancelToken: source.token});source.cancel('å–æ¶ˆæ—¥å¿—'); æºç 1234567891011121314151617181920212223242526272829303132333435363738394041424344function CancelToken(executor) { if (typeof executor !== 'function') { throw new TypeError('executor must be a function.'); } var resolvePromise; this.promise = new Promise(function promiseExecutor(resolve) { resolvePromise = resolve; }); var token = this; executor(function cancel(message) { // ç­‰åˆ°executorè°ƒç”¨cancelæ–¹æ³•ï¼Œä¸Šé¢çš„this.promiseå°±ä¼šæ‰§è¡Œä¸‹é¢çš„thenå›è°ƒ if (token.reason) { return; } token.reason = new Cancel(message); resolvePromise(token.reason); });}// ç¬¬äºŒç§æ–¹æ³•çš„å®ç°CancelToken.source = function source() { var cancel; var token = new CancelToken(function executor(c) { cancel = c; }); return { token: token, cancel: cancel };};// /lib/adapters/xhr.js åœ¨sendä¹‹å‰æ‰§è¡Œif (config.cancelToken) { config.cancelToken.promise.then(function onCanceled(cancel) { if (!request) { return; } request.abort(); // xhrçš„å–æ¶ˆè¯·æ±‚ reject(cancel); request = null; });} å¯å‘é“¾å¼è°ƒç”¨1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950class Man { constructor (name) { this.name = name; this.arr = []; console.log(`This is ${name}`); const executor = i =&gt; { if (i &lt; this.arr.length) { this.arr[i]().then(value =&gt; { console.log(value); executor(i + 1); }); } } Promise.resolve().then(()=&gt; { executor(0) }, 0); } sleep(sec) { this.arr.push(() =&gt; { return new Promise(resolve =&gt; { setTimeout(() =&gt; { resolve(`Wale up after ${sec}`); }, sec * 1000); }) }) return this; } eat(food) { this.arr.push(() =&gt; { return Promise.resolve(`Eat ${food}`); }) return this; } sleepFirst(sec) { this.arr.unshift(() =&gt; { return new Promise(resolve =&gt; { setTimeout(() =&gt; { resolve(`Wale up after ${sec}`); }, sec * 1000); }) }) return this; }} å‚è€ƒAxiosæºç æ·±åº¦å‰–æ","link":"/2021/08/25/Js/%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/Axios%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"},{"title":"eggå…¥é—¨","text":"å¿«é€Ÿåˆå§‹åŒ–ç”¨npm 1npm init egg --type=simple ç›®å½•ç»“æ„12345678910111213141516171819202122232425262728293031323334353637egg-projectâ”œâ”€â”€ package.jsonâ”œâ”€â”€ app.js (å¯é€‰) # ç”¨äºè‡ªå®šä¹‰å¯åŠ¨æ—¶çš„åˆå§‹åŒ–å·¥ä½œâ”œâ”€â”€ agent.js (å¯é€‰) # ç”¨äºè‡ªå®šä¹‰å¯åŠ¨æ—¶çš„åˆå§‹åŒ–å·¥ä½œâ”œâ”€â”€ app| â”œâ”€â”€ router.js # ç”¨äºé…ç½® URL è·¯ç”±è§„åˆ™â”‚ â”œâ”€â”€ controller # ç”¨äºè§£æç”¨æˆ·çš„è¾“å…¥ï¼Œå¤„ç†åè¿”å›ç›¸åº”çš„ç»“æœâ”‚ | â””â”€â”€ home.jsâ”‚ â”œâ”€â”€ service (å¯é€‰) # ç”¨äºç¼–å†™ä¸šåŠ¡é€»è¾‘å±‚â”‚ | â””â”€â”€ user.jsâ”‚ â”œâ”€â”€ middleware (å¯é€‰) # ç”¨äºç¼–å†™ä¸­é—´ä»¶â”‚ | â””â”€â”€ response_time.jsâ”‚ â”œâ”€â”€ schedule (å¯é€‰) # ç”¨äºå®šæ—¶ä»»åŠ¡â”‚ | â””â”€â”€ my_task.jsâ”‚ â”œâ”€â”€ public (å¯é€‰) # ç”¨äºæ”¾ç½®é™æ€èµ„æºâ”‚ | â””â”€â”€ reset.cssâ”‚ â”œâ”€â”€ view (å¯é€‰) # ç”¨äºæ”¾ç½®æ¨¡æ¿æ–‡ä»¶â”‚ | â””â”€â”€ home.tplâ”‚ â””â”€â”€ extend (å¯é€‰) # ç”¨äºæ¡†æ¶çš„æ‰©å±•â”‚ â”œâ”€â”€ helper.js (å¯é€‰)â”‚ â”œâ”€â”€ request.js (å¯é€‰)â”‚ â”œâ”€â”€ response.js (å¯é€‰)â”‚ â”œâ”€â”€ context.js (å¯é€‰)â”‚ â”œâ”€â”€ application.js (å¯é€‰)â”‚ â””â”€â”€ agent.js (å¯é€‰)â”œâ”€â”€ config # ç”¨äºç¼–å†™é…ç½®æ–‡ä»¶| â”œâ”€â”€ plugin.js # ç”¨äºé…ç½®éœ€è¦åŠ è½½çš„æ’ä»¶| â”œâ”€â”€ config.default.jsâ”‚ â”œâ”€â”€ config.prod.js| â”œâ”€â”€ config.test.js (å¯é€‰)| â”œâ”€â”€ config.local.js (å¯é€‰)| â””â”€â”€ config.unittest.js (å¯é€‰)â””â”€â”€ test # ç”¨äºå•å…ƒæµ‹è¯• â”œâ”€â”€ middleware | â””â”€â”€ response_time.test.js â””â”€â”€ controller â””â”€â”€ home.test.js è·¯ç”±ï¼ˆRouterï¼‰ å°†ç”¨æˆ·çš„è¯·æ±‚åŸºäº method å’Œ URL åˆ†å‘åˆ°äº†å¯¹åº”çš„ Controller ä¸Šï¼Œæ„Ÿè§‰apiå’ŒKoaå·®ä¸å¤šã€‚ å‚æ•°è·å–queryå°±åˆ—ä¸€ä¸ªqueryå‚æ•°çš„è·å–ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œapp.controller.searchä¸æ–‡ä»¶ç›¸å¯¹åº”ï¼ˆä¹Ÿå°±æ˜¯app/controller/search.jsï¼‰ 1234567891011// curl http://127.0.0.1:7001/search?name=egg// app/router.jsmodule.exports = app =&gt; { app.router.get('/search', app.controller.search.index);};// app/controller/search.jsexports.index = async ctx =&gt; { ctx.body = `search: ${ctx.query.name}`; }; ä¸ºäº†é¿å…ç”¨æˆ·æ¶æ„ä¼ é€’é‡å¤keyçš„queryå‚æ•°å¯¼è‡´ç³»ç»ŸæŠ¥é”™ï¼Œctx.queryåªå–ç¬¬ä¸€æ¬¡å‡ºç°çš„å€¼ï¼Œå¹¶ä¸”ä¿è¯ä¸€å®šæ˜¯å­—ç¬¦ä¸²ç±»å‹ å¦‚æœå¿…é¡»è¦é‡å¤çš„keyï¼Œæ¯”å¦‚éœ€è¦ä¼ é€’æ•°ç»„ï¼šid=1&amp;id=2&amp;id=3ï¼Œå¯ä»¥ç”¨ctx.queriesï¼Œå…¶ä¹Ÿä¿è¯äº†ä¸€å®šæ˜¯æ•°ç»„ç±»å‹ bodyæ¡†æ¶å†…ç½®äº† bodyParser ä¸­é—´ä»¶æ¥å¯¹JSONå’ŒForm-Dataçš„è¯·æ±‚ body è§£ææˆ object æŒ‚è½½åˆ° ctx.request.body ä¸Šã€‚ body æœ€å¤§é•¿åº¦ä¸º 100kbï¼Œè¶…å‡ºé•¿åº¦413çŠ¶æ€ç ï¼Œå¯ä»¥åœ¨ config/config.default.js ä¸­è¦†ç›–æ¡†æ¶çš„é»˜è®¤å€¼ 123456module.exports = { bodyParser: { jsonLimit: '1mb', formLimit: '1mb', },}; ctx.bodyæ˜¯ctx.response.bodyçš„ç®€å†™ headerå¯ä»¥é€šè¿‡ctx.get(name)è·å–ï¼Œå…¶ä¼šè‡ªåŠ¨å¤„ç†å¤§å°å†™ Cookieè·å–ã€è®¾ç½®æ–¹å¼å’ŒKoaä¸€æ ·ï¼Œé…ç½®æ–¹å¼å¦‚ä¸‹ 123456module.exports = { cookies: { // httpOnly: true | false, // sameSite: 'none|lax|strict', },}; Sessionæ¡†æ¶å†…ç½® Session æ’ä»¶ï¼Œå¯ä»¥é€šè¿‡ctx.sessionï¼Œå…·ä½“é…ç½®å¯ä»¥çœ‹ Cookie ä¸ Session å‚æ•°æ ¡éªŒå€ŸåŠ© Validate æ’ä»¶æä¾›ä¾¿æ·çš„å‚æ•°æ ¡éªŒæœºåˆ¶ï¼Œé…ç½®æ–¹å¼å¦‚ä¸‹ 12345// config/plugin.jsexports.validate = { enable: true, package: 'egg-validate',}; ctxä¸Šæœ‰ä¸€ä¸ªvalidateæ–¹æ³•ï¼Œå¯ä»¥ä¼ å…¥æ ¡éªŒé…ç½®æ¥å¯¹å‚æ•°è¿›è¡Œæ ¡éªŒ 1234567891011121314151617181920212223// curl -X POST http://127.0.0.1:7001/user --data 'username=abc@abc.com&amp;password=111111&amp;re-password=111111'// app/router.jsmodule.exports = app =&gt; { app.router.post('/user', app.controller.user);};// app/controller/user.jsconst createRule = { username: { type: 'email', }, password: { type: 'password', compare: 're-password', // ä¸re-passwordæ¯”è¾ƒï¼Œæ˜¯å¦ä¸€è‡´ },};exports.create = async ctx =&gt; { // å¦‚æœæ ¡éªŒæŠ¥é”™ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ ctx.validate(createRule); ctx.body = ctx.request.body;}; é‡å®šå‘å†…éƒ¨é‡å®šå‘1app.router.redirect('/', '/home/index', 302); å¤–éƒ¨é‡å®šå‘1ctx.redirect(`http://cn.bing.com`); resourcesç”ŸæˆCRUDè·¯ç”±ç»“æ„12345// app/router.jsmodule.exports = app =&gt; { const { router, controller } = app; router.resources('posts', '/api/posts', controller.posts);}; æ¥ä¸‹æ¥åœ¨å¯¹åº”æ–‡ä»¶ä¸‹å®ç°å¯¹åº”å‡½æ•°å°±å¯ä»¥äº† 1234567891011121314// app/controller/posts.jsexports.index = async () =&gt; {};exports.new = async () =&gt; {};exports.create = async () =&gt; {};exports.show = async () =&gt; {};exports.edit = async () =&gt; {};exports.update = async () =&gt; {};exports.destroy = async () =&gt; {}; Method Path Route Name Controller.Action GET /posts posts app.controllers.posts.index GET /posts/new new_post app.controllers.posts.new GET /posts/:id post app.controllers.posts.show GET /posts/:id/edit edit_post app.controllers.posts.edit POST /posts posts app.controllers.posts.create PUT /posts/:id post app.controllers.posts.update DELETE /posts/:id post app.controllers.posts.destroy æ¨¡å—åŒ–123456789101112131415// app/router.jsmodule.exports = app =&gt; { require('./router/news')(app); require('./router/admin')(app);};// app/router/news.jsmodule.exports = app =&gt; { app.router.get('/news/list', app.controller.news.list);};// app/router/admin.jsmodule.exports = app =&gt; { app.router.get('/admin/user', app.controller.admin.user);}; æ§åˆ¶å™¨ï¼ˆControllerï¼‰ è§£æç”¨æˆ·çš„è¾“å…¥ï¼Œå¤„ç†åè¿”å›ç›¸åº”çš„ç»“æœï¼Œæ¡†æ¶å»ºè®®åœ¨ controller å¯¹è¯·æ±‚å‚æ•°è¿›è¡Œå¤„ç†ï¼ˆæ ¡éªŒã€è½¬æ¢ï¼‰ï¼Œç„¶åè°ƒç”¨å¯¹åº”çš„ service æ–¹æ³•å¤„ç†ä¸šåŠ¡ 12345678910111213141516171819202122232425// app/controller/post.jsconst Controller = require('egg').Controller;class PostController extends Controller { async create() { const { ctx, service } = this; const createRule = { title: { type: 'string' }, content: { type: 'string' }, }; // æ ¡éªŒå‚æ•° ctx.validate(createRule); // ç»„è£…å‚æ•° const author = ctx.session.userId; const req = Object.assign(ctx.request.body, { author }); // è°ƒç”¨ Service è¿›è¡Œä¸šåŠ¡å¤„ç† const res = await service.post.create(req); // è®¾ç½®å“åº”å†…å®¹å’Œå“åº”çŠ¶æ€ç  ctx.body = { id: res.id }; ctx.status = 201; }}module.exports = PostController; è·å–ä¸Šä¼ çš„æ–‡ä»¶fileæ¨¡å¼åœ¨configä¸­é…ç½®fileæ¨¡å¼ 1234// config/config.default.jsexports.multipart = { mode: 'file',}; controllerå±‚ä»£ç  123456789101112131415161718192021222324252627// app/controller/upload.jsconst Controller = require('egg').Controller;const fs = require('mz/fs');module.exports = class extends Controller { async upload() { const { ctx } = this; console.log(ctx.request.body); console.log('got %d files', ctx.request.files.length); for (const file of ctx.request.files) { // filesè·å–ä¸Šä¼ çš„å¤šæ–‡ä»¶ console.log('field: ' + file.fieldname); console.log('filename: ' + file.filename); console.log('encoding: ' + file.encoding); console.log('mime: ' + file.mime); console.log('tmp filepath: ' + file.filepath); let result; try { // å¤„ç†æ–‡ä»¶ï¼Œæ¯”å¦‚ä¸Šä¼ åˆ°äº‘ç«¯ result = await ctx.oss.put('egg-multipart-test/' + file.filename, file.filepath); } finally { // éœ€è¦åˆ é™¤ä¸´æ—¶æ–‡ä»¶ await fs.unlink(file.filepath); } console.log(result); } }}; streamæ¨¡å¼12345678910111213141516171819202122232425262728const path = require('path');const sendToWormhole = require('stream-wormhole');const Controller = require('egg').Controller;class UploaderController extends Controller { async upload() { const ctx = this.ctx; const stream = await ctx.getFileStream(); const name = 'egg-multipart-test/' + path.basename(stream.filename); // æ–‡ä»¶å¤„ç†ï¼Œä¸Šä¼ åˆ°äº‘å­˜å‚¨ç­‰ç­‰ let result; try { result = await ctx.oss.put(name, stream); } catch (err) { // å¿…é¡»å°†ä¸Šä¼ çš„æ–‡ä»¶æµæ¶ˆè´¹æ‰ï¼Œè¦ä¸ç„¶æµè§ˆå™¨å“åº”ä¼šå¡æ­» await sendToWormhole(stream); throw err; } ctx.body = { url: result.url, // æ‰€æœ‰è¡¨å•å­—æ®µéƒ½èƒ½é€šè¿‡ `stream.fields` è·å–åˆ° fields: stream.fields, }; }}module.exports = UploaderController; Serviceå±‚å…¶ä¸æ˜¯å•ä¾‹ï¼Œåœ¨æ¯æ¬¡è¯·æ±‚æ—¶è®¿é—®ctx.service.xx æ—¶å»¶è¿Ÿå®ä¾‹åŒ–ï¼Œæ‰€ä»¥å¯ä»¥ç”¨this.ctxè·å–æ¯ä¸€æ¬¡è¯·æ±‚çš„ä¸Šä¸‹æ–‡ 1234567891011// app/service/user.jsconst Service = require('egg').Service;class UserService extends Service { async find(uid) { const user = await this.ctx.db.query('select * from user where uid = ?', uid); return user; }}module.exports = UserService; å‡½æ•°returnçš„å€¼ä¼šè¿”å›ç»™å‰ç«¯ å®šæ—¶ä»»åŠ¡æ‰€æœ‰çš„å®šæ—¶ä»»åŠ¡éƒ½ç»Ÿä¸€å­˜æ”¾åœ¨ app/schedule ç›®å½•ä¸‹ 123456789101112131415161718192021const Subscription = require('egg').Subscription;class UpdateCache extends Subscription { // é€šè¿‡ schedule å±æ€§æ¥è®¾ç½®å®šæ—¶ä»»åŠ¡çš„æ‰§è¡Œé—´éš”ç­‰é…ç½® static get schedule() { return { interval: '1m', // 1 åˆ†é’Ÿé—´éš” type: 'all', // æŒ‡å®šæ‰€æœ‰çš„ worker éƒ½éœ€è¦æ‰§è¡Œ }; } // subscribe æ˜¯çœŸæ­£å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¶è¢«è¿è¡Œçš„å‡½æ•° async subscribe() { const res = await this.ctx.curl('http://www.api.com/cache', { dataType: 'json', }); this.ctx.app.cache = res.data; }}module.exports = UpdateCache; è¿˜å¯ä»¥ç®€å†™ä¸º 123456789101112module.exports = { schedule: { interval: '1m', // 1 åˆ†é’Ÿé—´éš” type: 'all', // æŒ‡å®šæ‰€æœ‰çš„ worker éƒ½éœ€è¦æ‰§è¡Œ }, async task(ctx) { const res = await ctx.curl('http://www.api.com/cache', { dataType: 'json', }); ctx.app.cache = res.data; },}; æ²¡æœ‰ç”¨è¿‡ï¼Œå…·ä½“é…ç½®çœ‹å®˜æ–¹æ–‡æ¡£ å®šæ—¶ä»»åŠ¡ egg-mysqlå®‰è£…ä¸é…ç½®1npm i --save egg-mysql å¼€å¯æ’ä»¶ 12345// config/plugin.jsexports.mysql = { enable: true, package: 'egg-mysql',}; æ•°æ®åº“é…ç½® 123456789101112131415161718192021222324252627// config/config.${env}.jsexports.mysql = { // å•æ•°æ®åº“ä¿¡æ¯é…ç½® clients: { // clientId, è·å–clientå®ä¾‹ï¼Œéœ€è¦é€šè¿‡ app.mysql.get('clientId') è·å– db1: { host: 'mysql.com', port: '3306', user: 'test_user', password: 'test_password', database: 'test', }, db2: { host: 'mysql2.com', port: '3307', user: 'test_user', password: 'test_password', database: 'test', }, } // æ‰€æœ‰æ•°æ®åº“é…ç½®çš„é»˜è®¤å€¼ default: {}, // æ˜¯å¦åŠ è½½åˆ° app ä¸Šï¼Œé»˜è®¤å¼€å¯ app: true, // æ˜¯å¦åŠ è½½åˆ° agent ä¸Šï¼Œé»˜è®¤å…³é—­ agent: false,}; ä½¿ç”¨æ–¹å¼ï¼š12345const client1 = app.mysql.get('db1');await client1.query(sql, values);const client2 = app.mysql.get('db2');await client2.query(sql, values);","link":"/2021/07/18/node.js/egg%E5%85%A5%E9%97%A8/"},{"title":"reduxå…¥é—¨","text":"Redux å®˜æ–¹æ–‡æ¡£å¯¹ Redux çš„å®šä¹‰æ˜¯ï¼šä¸€ä¸ªå¯é¢„æµ‹çš„ JavaScript åº”ç”¨çŠ¶æ€ç®¡ç†å®¹å™¨ å®‰è£…1npm install --save redux Store Reduxåº”ç”¨åªæœ‰å•ä¸€çš„ store é€šè¿‡createStore()åˆ›å»ºä¸€ä¸ªstore 123import { createStore } from 'redux'import todoApp from './reducers' // è¿™ä¸ªåœ¨ä¸‹é¢ä¼šè®²let store = createStore(todoApp) createStore()çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯é€‰çš„, ç”¨äºè®¾ç½® state åˆå§‹çŠ¶æ€ã€‚è¿™å¯¹å¼€å‘åŒæ„åº”ç”¨æ—¶éå¸¸æœ‰ç”¨ï¼ŒæœåŠ¡å™¨ç«¯ redux åº”ç”¨çš„ state ç»“æ„å¯ä»¥ä¸å®¢æˆ·ç«¯ä¿æŒä¸€è‡´, é‚£ä¹ˆå®¢æˆ·ç«¯å¯ä»¥å°†ä»ç½‘ç»œæ¥æ”¶åˆ°çš„æœåŠ¡ç«¯ state ç›´æ¥ç”¨äºæœ¬åœ°æ•°æ®åˆå§‹åŒ–ã€‚ æä¾›å››ä¸ªå‡½æ•° getState()æ–¹æ³•è·å– state dispatch(action)æ–¹æ³•åˆ†å‘ action æ›´æ–° state subscribe(listener)æ³¨å†Œç›‘å¬å™¨ï¼Œè¿”å›çš„å‡½æ•°æ³¨é”€ç›‘å¬å™¨ replaceReducer(nextReducer) ä¸€èˆ¬åœ¨ Webpack Code-Splitting æŒ‰éœ€åŠ è½½çš„æ—¶å€™ç”¨ reduxè§„å®šç¦æ­¢ç›´æ¥ä¿®æ”¹ stateï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢çš„å†™æ³• 12var state = store.getState()state.counter = state.counter + 1 // ç¦æ­¢åœ¨ä¸šåŠ¡é€»è¾‘ä¸­ç›´æ¥ä¿®æ”¹ state åªèƒ½é€šè¿‡ dispatch ä¸€ä¸ª action æ¥ä¿®æ”¹ Actionæ˜¯æŠŠæ•°æ®ä»åº”ç”¨ä¼ åˆ° store çš„æœ‰æ•ˆè½½è·ã€‚å®ƒæ˜¯ store æ•°æ®çš„å”¯ä¸€æ¥æºã€‚ä¸€èˆ¬æ¥è¯´ä½ ä¼šé€šè¿‡ store.dispatch() å°† action ä¼ åˆ° storeã€‚ 1 Actionæ ¼å¼é™¤äº†typeå­—æ®µå¤–ï¼Œactionçš„ç»“æ„å®Œå…¨ç”±ä½ è‡ªå·±å†³å®šï¼Œä¸€èˆ¬å‚ç…§ Flux æ ‡å‡† Action è·å–å…³äºå¦‚ä½•æ„é€  action çš„å»ºè®®ã€‚ 123456const ADD_TODO = 'ADD_TODO'// ä¸‹é¢æ˜¯å¸¸è§çš„actionæ ¼å¼{ type: ADD_TODO, text: 'Build my first Redux app'} 2 Actionåˆ›å»ºå‡½æ•°å°±æ˜¯ç”Ÿæˆactionçš„æ–¹æ³• 123456function addTodo(text) { return { type: ADD_TODO, text }} 3 dispatchåªéœ€æŠŠ action åˆ›å»ºå‡½æ•°çš„ç»“æœä¼ ç»™ dispatch() æ–¹æ³•å³å¯å‘èµ·ä¸€æ¬¡ dispatch è¿‡ç¨‹ 1dispatch(addTodo(text)) ReduceræŒ‡å®šäº†åº”ç”¨çŠ¶æ€çš„å˜åŒ–å¦‚ä½•å“åº” actions å¹¶å‘é€çŠ¶æ€åˆ° store çš„ï¼Œè®°ä½ actions åªæ˜¯æè¿°äº†æœ‰äº‹æƒ…å‘ç”Ÿäº†è¿™ä¸€äº‹å®ï¼Œå¹¶æ²¡æœ‰æè¿°åº”ç”¨å¦‚ä½•æ›´æ–° stateã€‚ reducerå°±æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œæ¥æ”¶æ—§çš„ state å’Œ actionï¼Œè¿”å›æ–°çš„ stateã€‚ 1;(previousState, action) =&gt; newState 123456789101112131415161718192021222324var initState = { counter: 0, todos: []}function reducer(state, action) { // åº”ç”¨çš„åˆå§‹çŠ¶æ€æ˜¯åœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œ reducer æ—¶è®¾ç½®çš„ â€» if (!state) state = initState switch (action.type) { case 'ADD_TODO': var nextState = _.cloneDeep(state) // ç”¨åˆ°äº† lodash çš„æ·±å…‹éš† nextState.todos.push(action.payload) return nextState case 'ADD_COUNT': return Object.assign({}, state, { visibilityFilter: action.filter }) default: // ç”±äº nextState ä¼šæŠŠåŸ state æ•´ä¸ªæ›¿æ¢æ‰ // è‹¥æ— ä¿®æ”¹ï¼Œå¿…é¡»è¿”å›åŸ stateï¼ˆå¦åˆ™å°±æ˜¯ undefinedï¼‰ return state }} æ³¨æ„ï¼š ä¸è¦ä¿®æ”¹ stateã€‚ ä½¿ç”¨ Object.assign() æ–°å»ºäº†ä¸€ä¸ªå‰¯æœ¬ã€‚ä¸èƒ½è¿™æ ·ä½¿ç”¨ Object.assign(state, { visibilityFilter: action.filter })ï¼Œå› ä¸ºå®ƒä¼šæ”¹å˜ç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼ åœ¨ default æƒ…å†µä¸‹è¿”å›æ—§çš„ stateã€‚å¦åˆ™ state ä¼šå˜æˆundefined æ‹†åˆ†Reducerå½“ä¸šåŠ¡é€»è¾‘å¤æ‚æ—¶ï¼Œæ‰€æœ‰çŠ¶æ€èšåˆåœ¨ä¸€ä¸ªreducerå‡½æ•°é‡Œå¤„ç†ï¼Œé€»è¾‘ä¼šå˜å¾—ç›¸å½“å¤æ‚ã€‚ æˆ‘ä»¬å¯ä»¥æå‡ºä¸€ä¸ªä¸»reducerå‡½æ•°ï¼Œå®ƒè°ƒç”¨å¤šä¸ªå­ reducer åˆ†åˆ«å¤„ç†å­ state ä¸­çš„æ•°æ®ï¼Œç„¶åå†æŠŠè¿™äº›æ•°æ®åˆæˆä¸€ä¸ªå¤§çš„å•ä¸€å¯¹è±¡ã€‚ ä¸» reducer å¹¶ä¸éœ€è¦è®¾ç½®åˆå§‹åŒ–æ—¶å®Œæ•´çš„ stateã€‚åˆå§‹æ—¶ï¼Œå¦‚æœä¼ å…¥ undefined, å­ reducer å°†è´Ÿè´£è¿”å›å®ƒä»¬çš„é»˜è®¤å€¼ 12345678910111213141516171819202122232425262728293031323334353637383940function todos(state = [], action) { switch (action.type) { case ADD_TODO: return [ ...state, { text: action.text, completed: false } ] case TOGGLE_TODO: return state.map((todo, index) =&gt; { if (index === action.index) { return Object.assign({}, todo, { completed: !todo.completed }) } return todo }) default: return state }}function visibilityFilter(state = SHOW_ALL, action) { switch (action.type) { case SET_VISIBILITY_FILTER: return action.filter default: return state }}// ä¸»reducerfunction todoApp(state = {}, action) { return { visibilityFilter: visibilityFilter(state.visibilityFilter, action), todos: todos(state.todos, action) }} å¯ä»¥åˆ©ç”¨combineReducers()æ¥ç®€åŒ–ä»£ç  12345678import { combineReducers } from 'redux'const todoApp = combineReducers({ visibilityFilter, a: todos})export default todoApp æ³¨æ„ä¸Šé¢çš„å†™æ³•å’Œä¸‹é¢å®Œå…¨ç­‰ä»·ï¼š 123456export default function todoApp(state = {}, action) { return { visibilityFilter: visibilityFilter(state.visibilityFilter, action), todos: todos(state.todos, action) }} å¼‚æ­¥æ•°æ®æµå¦‚æœåªæ˜¯ç®€å•çš„redux storeæ˜¯ä¸æ”¯æŒç”¨dispatchå¼‚æ­¥æ›´æ–°storeï¼Œå¯ä»¥ä½¿ç”¨react-thunkæ¥å¢å¼º å®‰è£…1npm install redux-thunk ä½¿ç”¨applyMiddlewareå¼•å…¥ä¸­é—´ä»¶ ä¸Koaå’ŒExpressç±»ä¼¼ï¼Œreduxä¹Ÿæä¾›äº†æ³¨å†Œä¸­é—´ä»¶çš„æ–¹æ³•ï¼šapplyMiddlewareï¼Œè¿™ä¸ªä¸­é—´ä»¶æ‰§è¡Œæ—¶é—´æ˜¯åœ¨dispatchä¸€ä¸ªactionä¹‹åï¼Œåˆ°è¾¾reducerä¹‹å‰ï¼Œæ‰§è¡Œé¡ºåºæ˜¯ä»ä¸Šåˆ°ä¸‹ï¼Œä¼ é€’action 12345678910import thunk from 'redux-thunk'import { createStore, applyMiddleware } from 'redux'import rootReducer from './reducers'const store = createStore( rootReducer, applyMiddleware( thunk, // å…è®¸æˆ‘ä»¬ dispatch() å‡½æ•° )) åŠ¨æœºå¼•å…¥åå…è®¸æˆ‘ä»¬dispatchä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å†…éƒ¨å¯ä»¥dispatchï¼Œè¿™ä¸ªå‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯dispatchï¼Œç¬¬äºŒä¸ªæ˜¯getStateï¼Œå‡½æ•°å†…éƒ¨å…è®¸æ”¾ä¸€äº›å¼‚æ­¥æ“ä½œï¼Œæ¥è§£å†³reduxåªèƒ½åŒæ­¥dispatch(action)çš„é—®é¢˜ react-thunk æºç å‡ºä¹æ„æ–™çš„ç®€å• 1234567891011121314function createThunkMiddleware(extraArgument) { return ({ dispatch, getState }) =&gt; (next) =&gt; (action) =&gt; { if (typeof action === 'function') { // å¦‚æœæ˜¯å‡½æ•°ï¼Œå½“ä½œå‡½æ•°æ‰§è¡Œ return action(dispatch, getState, extraArgument); } return next(action); };}const thunk = createThunkMiddleware();thunk.withExtraArgument = createThunkMiddleware;export default thunk; å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨redux-promiseè¿™ä¸ªä¸­é—´ä»¶æ¥dispatchä¸€ä¸ªpromise redux-promise æºç 1234567891011121314151617181920import isPromise from 'is-promise';import { isFSA } from 'flux-standard-action';export default function promiseMiddleware({ dispatch }) { return next =&gt; action =&gt; { // åˆ¤æ–­æ˜¯ä¸æ˜¯ flux æ ‡å‡†çš„action if (!isFSA(action)) { return isPromise(action) ? action.then(dispatch) : next(action); } return isPromise(action.payload) ? action.payload .then(result =&gt; dispatch({ ...action, payload: result })) .catch(error =&gt; { dispatch({ ...action, payload: error, error: true }); return Promise.reject(error); }) : next(action); };} ä¸reacté…åˆä½¿ç”¨å®‰è£…1npm install --save react-redux ä½¿ç”¨æ–¹å¼åˆ©ç”¨ Provider ç»„ä»¶åˆ†å‘storeçŠ¶æ€ 12345678910// ...import store from './app/store'import { Provider } from 'react-redux'ReactDOM.render( &lt;Provider store={store}&gt; &lt;App /&gt; &lt;/Provider&gt;, document.getElementById('root')) åœ¨ç»„ä»¶ä¸­ä½¿ç”¨useSelectorï¼ŒuseDispatchæ¥è·å– state å’Œåˆ†å‘ action 1234567891011121314151617181920// ...import { useSelector, useDispatch } from 'react-redux'import { decrement, increment } from './counterSlice'export function Counter() { const count = useSelector((state) =&gt; state.counter.value) // ä»stateä¸­è·å–countçš„å€¼ const dispatch = useDispatch() // è·å–dispatchæ–¹æ³• return ( &lt;div&gt; &lt;button onClick={() =&gt; dispatch(increment())}&gt; Increment &lt;/button&gt; &lt;span&gt;{count}&lt;/span&gt; &lt;button onClick={() =&gt; dispatch(decrement())}&gt; Decrement &lt;/button&gt; &lt;/div&gt; )} æˆ–è€…ç”¨connectå‡½æ•°åŒ…è£¹ç»„ä»¶ï¼Œå°†stateå’Œdispatchæ˜ å°„åˆ°propsä¸­ 1connect(mapStateToProps, mapDispatchToProps)(MyComponent) 1234567891011121314151617181920212223242526272829303132const mapStateToProps = (state) =&gt; { return { // prop : state.xxx | æ„æ€æ˜¯å°†stateä¸­çš„æŸä¸ªæ•°æ®æ˜ å°„åˆ°propsä¸­ foo: state.bar }}const mapDispatchToProps = (dispatch) =&gt; { // é»˜è®¤ä¼ é€’å‚æ•°å°±æ˜¯dispatch return { onClick: () =&gt; { dispatch({ type: 'increatment' }); } };}class Foo extends Component { constructor(props){ super(props); } render () { return ( &lt;&gt; &lt;div&gt;this.props.foo&lt;/div&gt; &lt;button onClick = {this.props.onClick}&gt;ç‚¹å‡»increase&lt;/button&gt; &lt;/&gt; ) }}Foo = connect(mapStateToProps, mapDispatchToProps)(Foo);export default Foo; åŒæ­¥react-routerå®‰è£…1npm install --save connected-react-router ä½¿ç”¨1.åˆ›å»ºä¸€ä¸ªä»¥historyä½œä¸ºå‚æ•°ï¼Œè¿”å›æ ¹reducerçš„å‡½æ•° 123456789// reducers.jsimport { combineReducers } from 'redux'import { connectRouter } from 'connected-react-router'const createRootReducer = (history) =&gt; combineReducers({ router: connectRouter(history), ... // rest of your reducers})export default createRootReducer; 2.åˆ›å»ºä¸€ä¸ªhistoryå¯¹è±¡ï¼Œå°†è¿™ä¸ªå¯¹è±¡ç»™ä¸Šè¿°çš„reducerå’ŒcreateRootReducer 12345678910111213141516171819202122// configureStore.jsimport { createBrowserHistory } from 'history'import { applyMiddleware, compose, createStore } from 'redux'import { routerMiddleware } from 'connected-react-router'import createRootReducer from './reducers'export const history = createBrowserHistory()export default function configureStore(preloadedState) { const store = createStore( createRootReducer(history), // root reducer with router state preloadedState, compose( applyMiddleware( routerMiddleware(history), // for dispatching history actions // ... ), ), ) return store} 3.åˆ©ç”¨ ConnectedRouterç»„ä»¶ï¼Œä¼ é€’ç»™ä»–historyå¯¹è±¡ä½œä¸ºpropï¼Œå¹¶å°†è¯¥ç»„ä»¶ä½œä¸º react-reduxçš„Providerç»„ä»¶çš„å­ç»„ä»¶ 1234567891011121314151617181920// index.jsimport { Provider } from 'react-redux'import { Route, Switch } from 'react-router' // react-router v4/v5import { ConnectedRouter } from 'connected-react-router'import configureStore, { history } from './configureStore'const store = configureStore(/* æä¾›åˆå§‹state */)ReactDOM.render( &lt;Provider store={store}&gt; &lt;ConnectedRouter history={history}&gt; { /* place ConnectedRouter under Provider */ } &lt;&gt; &lt;Switch&gt; &lt;Route exact path=&quot;/&quot; render={() =&gt; (&lt;div&gt;Match&lt;/div&gt;)} /&gt; &lt;Route render={() =&gt; (&lt;div&gt;Miss&lt;/div&gt;)} /&gt; &lt;/Switch&gt; &lt;/&gt; &lt;/ConnectedRouter&gt; &lt;/Provider&gt;, document.getElementById('react-root')) ç¼–ç¨‹å¼å¯¼èˆªconnect-react-routerä¹Ÿæä¾›äº†è·¯ç”±è·³è½¬çš„æ–¹æ³•ï¼Œæ¯”å¦‚ push å’Œ replaceï¼Œä½†æ˜¯è¿™äº›æ–¹æ³•åªæ˜¯åˆ›å»ºäº†actionï¼Œéœ€è¦dispatchè¿™äº›æ–¹æ³•äº§ç”Ÿçš„action 123456import {push, replace} from &quot;connected-react-router&quot;;function XXX() { dispatch(push(&quot;/page1&quot;)) // ...} å‚è€ƒreactå­¦ä¹ ç¬”è®°6-reduxä¸€ç¯‡æ–‡ç« æ€»ç»“reduxã€react-reduxã€redux-sagaReduxä¸­æ–‡æ–‡æ¡£","link":"/2021/06/15/React/redux%E5%85%A5%E9%97%A8/"},{"title":"React Hook","text":"å‡½æ•°å¼ç»„ä»¶åªèƒ½ä½¿ç”¨propsï¼ŒHookèƒ½å¤Ÿåœ¨å‡½æ•°å¼ç»„ä»¶çš„æƒ…å†µä¸‹ä½¿ç”¨stateã€ç”Ÿå‘½å‘¨æœŸä»¥åŠå…¶ä»–çš„Reactç‰¹æ€§ ä¸ºä»€ä¹ˆéœ€è¦å¼•å…¥React Hookï¼Œå¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼šhttps://zh-hans.reactjs.org/docs/hooks-intro.html#motivation 1. æ³¨æ„äº‹é¡¹ åªèƒ½åœ¨å‡½æ•°å†…éƒ¨çš„æœ€å¤–å±‚è°ƒç”¨ Hookï¼Œä¸è¦åœ¨å¾ªç¯ã€æ¡ä»¶åˆ¤æ–­æˆ–è€…å­å‡½æ•°ä¸­è°ƒç”¨ åªèƒ½åœ¨ React çš„å‡½æ•°ç»„ä»¶æˆ–è‡ªå®šä¹‰Hookä¸­è°ƒç”¨ Hookï¼Œä¸è¦åœ¨å…¶ä»– JavaScript å‡½æ•°ä¸­è°ƒç”¨ Hook åœ¨ class å†…éƒ¨æ˜¯ä¸èµ·ä½œç”¨çš„ 2. useStateuseStateåœ¨ç»„ä»¶å†…åˆ›å»ºçš„å†…éƒ¨stateï¼ŒReact ä¼šåœ¨é‡å¤æ¸²æŸ“æ—¶ä¿ç•™è¿™ä¸ª stateï¼Œè¯¥å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åˆå§‹å€¼ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œæ­¤å‡½æ•°åªåœ¨åˆå§‹æ¸²æŸ“ä¸­è¢«è°ƒç”¨ã€‚è°ƒç”¨è¯¥å‡½æ•°ä¼šè¿”å›ä¸€å¯¹å€¼ï¼š[å½“å‰çŠ¶æ€ï¼Œæ›´æ–°å½“å‰çŠ¶æ€çš„å‡½æ•°]ã€‚ è¿™ä¸ªæ›´æ–°çŠ¶æ€çš„å‡½æ•°ä¸ä¼šå¯¹stateè¿›è¡Œåˆå¹¶ï¼Œè€Œæ˜¯ç›´æ¥æ›¿æ¢ï¼Œå¯ä»¥ä¼ é€’ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæºå¸¦å‚æ•°æ˜¯ä¸Šä¸€æ¬¡çš„state 123456789101112import React, { useState } from 'react'; 2:function Example() { const [count, setCount] = useState(0); 5: return ( &lt;div&gt; &lt;p&gt;You clicked {count} times&lt;/p&gt; &lt;button onClick={() =&gt; setCount(count + 1)}&gt; Click me &lt;/button&gt; &lt;/div&gt; );} å†…éƒ¨ä½¿ç”¨Object.jsï¼ˆæµ…ï¼‰æ¥æ¯”è¾ƒæ–°/æ—§stateæ˜¯å¦ç›¸ç­‰ï¼Œåœ¨ä¿®æ”¹çŠ¶æ€æ—¶ï¼Œä¼ çš„çŠ¶æ€å€¼æ²¡æœ‰å˜åŒ–ï¼Œåˆ™ä¸é‡æ–°æ¸²æŸ“ æƒ°æ€§åˆå§‹å€¼ä¸‹é¢çš„ä»£ç ä¸­ï¼ŒinitialStateæ˜¯åªåœ¨åˆå§‹åŒ–æ—¶æœ‰å…¶å­˜åœ¨ä»·å€¼ï¼Œä½†æ˜¯å¦‚æœçœŸå¦‚ä¸‹é¢ä¸€æ ·å†™äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªè®¡ç®—å‡ºinitialStateæ˜‚è´µçš„æ“ä½œåœ¨æ¯æ¬¡renderéƒ½ä¼šæ‰§è¡Œã€‚ 12const initialState = someExpensiveComputation(props); // è¿™æ˜¯ä¸€ä¸ªè€—æ—¶çš„æ“ä½œconst [state, setState] = useState(initialState); æˆ‘ä»¬å¯ä»¥è®©someExpensiveComputation è¿è¡Œåœ¨ä¸€ä¸ªuseStateåŒ¿åå‡½æ•°å‚æ•°ä¸‹ï¼Œè¯¥å‡½æ•°å½“ä¸”ä»…å½“åˆå§‹åŒ–æ—¶è¢«è°ƒç”¨ï¼Œä»è€Œä¼˜åŒ–æ€§èƒ½ã€‚ 1234const [state, setState] = useState(() =&gt; { const initialState = someExpensiveComputation(props); return initialState;}); 2. useEffectç”¨æ¥åœ¨å‡½æ•°å¼ç»„ä»¶å†…ä½¿ç”¨classç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œå¯ä»¥ä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªæ˜¯ç›‘å¬çš„å˜é‡æ•°ç»„ã€‚ ä½¿ç”¨æ–¹å¼1.åªåœ¨ç¬¬ä¸€æ¬¡çš„componentDidMountæ‰§è¡Œç¬¬äºŒä¸ªå‚æ•°ä¸º [] 123useEffect(()=&gt;{ // ...}, []) 2. åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“å’Œæ¯æ¬¡æ›´æ–°åæ‰§è¡Œç¬¬äºŒä¸ªå‚æ•°ä¸ºç©º 123useEffect(()=&gt;{ // ...}) 3. ç›‘å¬å˜é‡çš„å˜åŒ–æ‰§è¡Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå˜é‡æ•°ç»„ï¼Œåªè¦æœ‰ä¸€ä¸ªå˜é‡å˜åŒ–äº†å°±ä¼šæ‰§è¡Œ 123useEffect(() =&gt; { // countæ”¹å˜æ‰ä¼šæ‰§è¡Œ}, [count]) 4. åœ¨componentWillUnmountä¸­æ‰§è¡Œç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°å¯ä»¥returnä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªreturnçš„å‡½æ•°ä¼šåœ¨componentWillUnmountè¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ‰§è¡Œã€‚ 12345useEffect(() =&gt; { console.log('use effect...', count) const timer = setInterval(() =&gt; setCount(count +1), 1000) return () =&gt; clearInterval(timer)}) 3. useRefuseRef è¿”å›ä¸€ä¸ªå¯å˜çš„ ref å¯¹è±¡ï¼Œå…¶ .current å±æ€§è¢«åˆå§‹åŒ–ä¸ºä¼ å…¥çš„å‚æ•°ï¼ˆinitialValueï¼‰ã€‚è¿”å›çš„ ref å¯¹è±¡åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ä¿æŒä¸å˜ã€‚ å½“ ref å¯¹è±¡å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒuseRef å¹¶ä¸ä¼šé€šçŸ¥ä½ ã€‚å˜æ›´ .current å±æ€§ä¸ä¼šå¼•å‘ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚ å’ŒcreateRefçš„åŒºåˆ«ï¼šcreateRef æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å¼•ç”¨ï¼Œè€Œ useRef æ¯æ¬¡éƒ½ä¼šè¿”å›ç›¸åŒçš„å¼•ç”¨ï¼ˆå¯ä»¥è§£å†³æ¯æ¬¡æ¸²æŸ“å¼•ç”¨ä¸åŒçš„useStateï¼Œå¯¼è‡´çŠ¶æ€å¼‚å¸¸çš„bugï¼‰ 1234567891011121314151617181920212223function App () { const [renderIndex, setRenderIndex] = useState(1); const refFromUseRef = useRef(); const refFromCreateRef = createRef(); if (!refFromUseRef.current) { console.log(&quot;useRef&quot;) refFromUseRef.current = renderIndex; } if (!refFromCreateRef.current) { console.log(&quot;createRef&quot;) refFromCreateRef.current = renderIndex; } return ( &lt;div className=&quot;App&quot;&gt; Current render index: {renderIndex} &lt;p&gt;refFromUseRef value: {refFromUseRef.current}&lt;/p&gt; &lt;p&gt;refFromCreateRef value: {refFromCreateRef.current}&lt;/p&gt; &lt;button onClick={() =&gt; setRenderIndex(prev =&gt; prev + 1)}&gt; Cause re-render &lt;/button&gt; &lt;/div&gt; );} ![image-20210606235123989](D:\\OneDrive - mail2.gdut.edu.cn\\typora_img\\React Hook\\image-20210606235123989.png) 4. useImperativeHandleuseImperativeHandleå¯ä»¥è®©ä½ åœ¨ä½¿ç”¨ ref æ—¶ï¼Œè‡ªå®šä¹‰æš´éœ²ç»™çˆ¶ç»„ä»¶çš„å®ä¾‹å€¼ï¼Œä¸èƒ½è®©çˆ¶ç»„ä»¶æƒ³å¹²å˜›å°±å¹²å˜› useImperativeHandle åº”å½“ä¸ forwardRef ä¸€èµ·ä½¿ç”¨ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647function Child (props, parentRef) { // å­ç»„ä»¶å†…éƒ¨è‡ªå·±åˆ›å»º ref let focusRef = useRef(); let inputRef = useRef(); useImperativeHandle(parentRef, () =&gt; { // è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ // è¯¥å¯¹è±¡ä¼šä½œä¸ºçˆ¶ç»„ä»¶ current å±æ€§çš„å€¼ // é€šè¿‡è¿™ç§æ–¹å¼ï¼Œçˆ¶ç»„ä»¶å¯ä»¥ä½¿ç”¨æ“ä½œå­ç»„ä»¶ä¸­çš„å¤šä¸ª ref return { focusRef, inputRef, name: 'è®¡æ•°å™¨', focus () { focusRef.current.focus(); }, changeText (text) { inputRef.current.value = text; } } }); return ( &lt;React.Fragment&gt; &lt;input ref={focusRef}/&gt; &lt;input ref={inputRef}/&gt; &lt;/React.Fragment&gt; )}Child = forwardRef(Child);function Parent () { const parentRef = useRef();//{current:''} function getFocus () { parentRef.current.focus(); // å› ä¸ºå­ç»„ä»¶ä¸­æ²¡æœ‰å®šä¹‰è¿™ä¸ªå±æ€§ï¼Œå®ç°äº†ä¿æŠ¤ï¼Œæ‰€ä»¥è¿™é‡Œçš„ä»£ç æ— æ•ˆ // parentRef.current.addNumber(666); parentRef.current.changeText('777'); console.log(parentRef.current.name); } return ( &lt;React.Fragment&gt; &lt;Child ref={parentRef}/&gt; &lt;button onClick={getFocus}&gt;è·å¾—ç„¦ç‚¹&lt;/button&gt; &lt;/React.Fragment&gt; )} 5.useMemo çˆ¶ç»„ä»¶çš„stateæ”¹å˜ï¼Œå­ç»„ä»¶ä¹Ÿä¼šéšä¹‹é‡æ–°renderï¼Œå³ä½¿å­ç»„ä»¶å†…éƒ¨stateæ²¡æœ‰æ”¹å˜ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨useMemoæ¥è¿›è¡Œæ€§èƒ½ä¼˜åŒ– å‚æ•°åˆ—è¡¨ å›è°ƒå‡½æ•°ï¼Œreturnå‡ºæ¥çš„å€¼ä½œä¸ºuseMemoçš„è¿”å›å€¼ ä¾èµ–é¡¹æ•°ç»„ï¼Œåªè¦æœ‰ä¸€ä¸ªå˜é‡æ”¹å˜ï¼Œå°±ä¼šé‡æ–°æ‰§è¡Œå›è°ƒï¼Œä½†ä¸ä¼šè§¦å‘æ¸²æŸ“ï¼Œå¦‚æœæ²¡æœ‰æä¾›ä¾èµ–æ•°ç»„ï¼Œåˆ™useMemo åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½ä¼šè®¡ç®—æ–°çš„å€¼ useMemoè¿”å›ä¸€ä¸ª memoized å€¼ï¼Œå®ƒä»…ä¼šåœ¨ä¼šåœ¨æŸä¸ªä¾èµ–é¡¹æ”¹å˜æ—¶æ‰é‡æ–°è®¡ç®— memoized å€¼ã€‚ 12345678910111213141516171819202122232425262728293031const Child = memo(({data}) =&gt; { console.log('child render...', data.name) return ( &lt;div&gt; &lt;div&gt;child&lt;/div&gt; &lt;div&gt;{data.name}&lt;/div&gt; &lt;/div&gt; );})const Hook = () =&gt; { console.log('Hook render...') const [count, setCount] = useState(0) const [name, setName] = useState('rose') const data = useMemo(() =&gt; { return { name } }, [name]) return( &lt;div&gt; &lt;div&gt; {count} &lt;/div&gt; &lt;button onClick={() =&gt; setCount(count + 1)}&gt;update count &lt;/button&gt; &lt;Child data={data}/&gt; &lt;/div&gt; )} 6. useCallback useCallbackä¸useMemoçš„å·®åˆ«æ˜¯ï¼Œå‰è€…æ˜¯ç¼“å­˜å‡½æ•°ï¼Œåè€…æ˜¯ç¼“å­˜å€¼ 123const onChange = useCallback((e) =&gt; { setText(e.target.value)}, []) useCallback(fn, deps)ç›¸å½“äºuseMemo(() =&gt; fn, deps) 7. useContextæ¥æ”¶ä¸€ä¸ª context å¯¹è±¡ï¼ˆç”±React.createContext æ‰€åˆ›å»ºï¼‰å¹¶è¿”å›è¯¥ context çš„å½“å‰å€¼ï¼Œå½“å‰çš„ context å€¼ç”±ä¸Šå±‚ç»„ä»¶ä¸­è·ç¦»å½“å‰ç»„ä»¶æœ€è¿‘çš„ &lt;MyContext.Provider&gt; çš„ value prop å†³å®š 1234567891011121314151617181920212223242526const TextContext = React.createContext();function App() { return ( &lt;TextContext.Provider value={666}&gt; &lt;Toolbar /&gt; &lt;/TextContext.Provider&gt; );}function Toolbar(props) { return ( &lt;div&gt; &lt;xxxButton /&gt; &lt;/div&gt; );}function xxxButton() { const text = useContext(ThemeContext); return ( &lt;button style={{ color: text }}&gt; I am styled by theme context! &lt;/button&gt; );} å½“ç»„ä»¶ä¸Šå±‚æœ€è¿‘çš„ &lt;MyContext.Provider&gt; æ›´æ–°æ—¶ï¼Œè¯¥ Hook ä¼šè§¦å‘é‡æ¸²æŸ“ï¼Œå¹¶ä½¿ç”¨æœ€æ–°ä¼ é€’ç»™ MyContext provider çš„ context value å€¼ã€‚å³ä½¿ç¥–å…ˆä½¿ç”¨ React.memo æˆ– shouldComponentUpdateï¼Œä¹Ÿä¼šåœ¨ç»„ä»¶æœ¬èº«ä½¿ç”¨ useContext æ—¶é‡æ–°æ¸²æŸ“ 8. useLayoutEffect useLayoutEffectä¼šåœ¨æµè§ˆå™¨ layout ä¹‹åï¼Œpainting ä¹‹å‰æ‰§è¡Œ å…¶å‡½æ•°ç­¾åä¸ useEffect ç›¸åŒï¼Œä½†å®ƒä¼šåœ¨æ‰€æœ‰çš„ DOM å˜æ›´ä¹‹ååŒæ­¥è°ƒç”¨ effect å¯ä»¥ä½¿ç”¨å®ƒæ¥è¯»å– DOM å¸ƒå±€å¹¶åŒæ­¥è§¦å‘é‡æ¸²æŸ“ å°½å¯èƒ½ä½¿ç”¨æ ‡å‡†çš„ useEffect ä»¥é¿å…é˜»å¡è§†å›¾æ›´æ–° 1234567891011121314151617function LayoutEffect () { const [color, setColor] = useState('red'); useLayoutEffect(() =&gt; { alert(color); }); useEffect(() =&gt; { console.log('color', color); }); return ( &lt;React.Fragment&gt; &lt;div id=&quot;myDiv&quot; style={{ background: color }}&gt;é¢œè‰²&lt;/div&gt; &lt;button onClick={() =&gt; setColor('red')}&gt;çº¢&lt;/button&gt; &lt;button onClick={() =&gt; setColor('yellow')}&gt;é»„&lt;/button&gt; &lt;button onClick={() =&gt; setColor('blue')}&gt;è“&lt;/button&gt; &lt;/React.Fragment&gt; );} å…ˆalertå‡ºredï¼Œå†æ¸²æŸ“å‡ºé¡µé¢ï¼Œé˜»å¡æ¸²æŸ“ 9. è‡ªå®šä¹‰Hookå…¶å®å°±æ˜¯å†™ä¸€ä¸ªå‡½æ•°å†…éƒ¨è°ƒç”¨å…¶ä»–Hookï¼Œæ¯æ¬¡ä½¿ç”¨è‡ªå®šä¹‰Hookæ—¶ï¼Œæ‰€æœ‰çš„stateå’Œå‰¯ä½œç”¨éƒ½æ˜¯å®Œå…¨éš”ç¦»çš„ ä¾‹å¦‚ï¼šæˆ‘ä»¬å¯ä»¥å¯¹useRefå°è£…æˆè‡ªå®šä¹‰Hookæ¥è·å–ä¸Šä¸€æ¬¡çš„å€¼ 123456789const usePrevious = state =&gt; { const ref = useRef(); useEffect(() =&gt; { ref.current = state; }) return ref.current;} 12345678910111213function App () { const [count, setCount] = useState(0); const prevCount = usePrevious(count); return ( &lt;div className=&quot;App&quot;&gt; &lt;button onClick={() =&gt; setCount(count + 1)}&gt; Cause re-render &lt;/button&gt; &lt;p&gt; {count} {prevCount}&lt;/p&gt; &lt;/div&gt; );} æ¯æ¬¡ç‚¹å‡»buttonï¼ŒprevCountéƒ½æ˜¯ä¸Šä¸€æ¬¡countçš„å€¼ æ˜“é”™ç‚¹1. ä¸ºä»€ä¹ˆæˆ‘çš„countæ²¡æœ‰æ›´æ–°12345678function ErrorDemo() { const [count, setCount] = useState(0); const dom = useRef(null); useEffect(() =&gt; { dom.current.addEventListener('click', () =&gt; setCount(count + 1)); }, []); return &lt;div ref={dom}&gt;{count}&lt;/div&gt;;} ä¸Šé¢è¿™æ®µä»£ç ï¼Œç”¨æˆ·ç‚¹å‡»divï¼Œcountåªä¼šåŠ åˆ°1ï¼Œåé¢å°±ä¸ä¼šå†åŠ äº†ã€‚ åŸå› æ˜¯ï¼šæ¯æ¬¡ count éƒ½æ˜¯é‡æ–°å£°æ˜çš„å˜é‡ï¼ŒæŒ‡å‘ä¸€ä¸ªå…¨æ–°çš„æ•°æ®ï¼›æ¯æ¬¡çš„ setCount è™½ç„¶æ˜¯é‡æ–°å£°æ˜çš„ï¼Œä½†æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå¼•ç”¨ã€‚ è§£å†³æ–¹å¼ä¸€ï¼šå‡½æ•°å¼æ›´æ–°ç”¨å›è°ƒå‡½æ•°çš„å½¢å¼ï¼Œ() =&gt; setCount(prevCount =&gt; ++prevCount)ï¼Œæ¥æ¶ˆé™¤å¯¹å¤–éƒ¨countçš„å¼•ç”¨ã€‚ è§£å†³æ–¹å¼äºŒï¼šé‡æ–°ç»‘å®šäº‹ä»¶12345useEffect(() =&gt; { dom.current.addEventListener('click', () =&gt; setCount(count + 1)); return () =&gt; dom.current.removeEventListener('click', () =&gt; setCount(count + 1));}, [count]); // åœ¨è¿™é‡Œå¯¹countè¿›è¡Œç›‘å¬ï¼Œæ¯æ¬¡æ”¹å˜éƒ½ä¼šé‡æ–°ç»‘å®šäº‹ä»¶return &lt;div&gt;{count}&lt;/div&gt;; è§£å†³æ–¹å¼ä¸‰ï¼šç”¨refé‡æ–°è·å–å¼•ç”¨12345678const dom = useRef(null);const countRef = useRef(count);useEffect(() =&gt; { dom.current.addEventListener('click', () =&gt; { countRef.current++; setCount(countRef.current); });}, []); å‚è€ƒå†™React Hookså‰å¿…è¯»ç»ˆäºææ‡‚ React Hooksäº†ï¼ï¼ï¼ï¼ï¼","link":"/2021/06/08/React/React%20Hook/"},{"title":"React Router","text":"react-routerï¼šè·¯ç”±æ ¸å¿ƒåº“ï¼ŒåŒ…å«è¯¸å¤šå’Œè·¯ç”±åŠŸèƒ½ç›¸å…³çš„æ ¸å¿ƒä»£ç  react-router-domï¼šåˆ©ç”¨è·¯ç”±æ ¸å¿ƒåº“ï¼Œç»“åˆå®é™…çš„é¡µé¢ï¼Œå®ç°è·Ÿé¡µé¢è·¯ç”±å¯†åˆ‡ç›¸å…³çš„åŠŸèƒ½ å®‰è£…123# react-router-domä¾èµ–react-router# å®‰è£…çš„æ—¶å€™ä¼šæŠŠreact-routerä¸€èµ·å®‰è£…äº†npm install react-router-dom -S 1.ä¸¤ç§è·¯ç”±æ¨¡å¼ Hashã€History HashRouterï¼šä½¿ç”¨ hash æ¨¡å¼åŒ¹é… BrowserRouterï¼šä½¿ç”¨ BrowserHistory æ¨¡å¼åŒ¹é… ä¸¤è€…åŒºåˆ«1.åº•å±‚åŸç†ä¸ä¸€æ ·ï¼š BrowserRouterä½¿ç”¨çš„æ˜¯H5çš„history APIï¼Œä¸å…¼å®¹IE9åŠä»¥ä¸‹ç‰ˆæœ¬ã€‚ HashRouterä½¿ç”¨çš„æ˜¯URLçš„å“ˆå¸Œå€¼ã€‚2.pathè¡¨ç°å½¢å¼ä¸ä¸€æ · BrowserRouterçš„è·¯å¾„ä¸­æ²¡æœ‰#ï¼Œä¾‹å¦‚ï¼šlocalhost:3000/demo/test HashRouterçš„è·¯å¾„åŒ…å«#,ä¾‹å¦‚ï¼šlocalhost:3000/#/demo/test3.åˆ·æ–°åå¯¹è·¯ç”±stateå‚æ•°çš„å½±å“ BrowserRouteræ²¡æœ‰ä»»ä½•å½±å“ï¼Œå› ä¸ºstateä¿å­˜åœ¨historyå¯¹è±¡ä¸­ã€‚ HashRouteråˆ·æ–°åä¼šå¯¼è‡´è·¯ç”±stateå‚æ•°çš„ä¸¢å¤±ï¼ï¼ï¼4.å¤‡æ³¨ï¼šHashRouterå¯ä»¥ç”¨äºè§£å†³ä¸€äº›è·¯å¾„é”™è¯¯ç›¸å…³çš„é—®é¢˜ã€‚ 2. è·³è½¬ç»„ä»¶ Linkå’ŒNavLinkLinkç»„ä»¶ 1&lt;Link to=&quot;/xxxxx&quot;&gt;Demo&lt;/Link&gt; Linkç»„ä»¶é…ç½®æ–¹å¼ toï¼šè¦è·³è½¬çš„é“¾æ¥ï¼ˆString | Object | Functionï¼‰ replaceï¼šè®¾ç½®ä¸ºtrueï¼Œåˆ™è·³è½¬æ›¿æ¢è·¯ç”±æ ˆé¡¶ innerRefï¼šå¯ä»¥å°†å†…éƒ¨çš„aå…ƒç´ çš„refé™„ç€åœ¨ä¼ é€’çš„å¯¹è±¡æˆ–å‡½æ•°å‚æ•°ä¸Šï¼ˆFunction | RefObjectï¼‰ componentï¼šå¯ä»¥è®¾ç½®è‡ªå®šä¹‰çš„å¯¼èˆªç»„ä»¶ 12345const FancyLink = React.forwardRef((props, ref) =&gt; ( &lt;a ref={ref} {...props}&gt;ğŸ’… {props.children}&lt;/a&gt;))&lt;Link to=&quot;/&quot; component={FancyLink} /&gt; NavLinkå¯ä»¥å®ç°è·¯ç”±é“¾æ¥çš„é«˜äº®ï¼Œé€šè¿‡activeClassNameæŒ‡å®šæ ·å¼ç±»å 1&lt;NavLink to=&quot;/xxxxx&quot;&gt;Demo&lt;/NavLink&gt; 3. routeç»„ä»¶é…ç½®æ–¹å¼ pathï¼šåŒ¹é…çš„è·¯å¾„ é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸åŒºåˆ†å¤§å°å†™ï¼Œå¯ä»¥è®¾ç½®sensitiveå±æ€§ä¸ºtrueï¼Œæ¥åŒºåˆ†å¤§å°å†™ é»˜è®¤æƒ…å†µä¸‹ï¼ŒåªåŒ¹é…åˆå§‹ç›®å½•ï¼Œå¦‚æœè¦ç²¾ç¡®åŒ¹é…ï¼Œé…ç½®exactå±æ€§ä¸ºtrue å¦‚æœä¸å†™pathï¼Œåˆ™ä¼šåŒ¹é…ä»»æ„è·¯å¾„ componentï¼šåŒ¹é…æˆåŠŸåè¦æ˜¾ç¤ºçš„ç»„ä»¶ children ä¼ é€’Reactå…ƒç´ ï¼Œæ— è®ºæ˜¯å¦åŒ¹é…ï¼Œä¸€å®šä¼šæ˜¾ç¤ºchildrenï¼Œå¹¶ä¸”ä¼šå¿½ç•¥componentå±æ€§ ä¼ é€’ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°æœ‰å¤šä¸ªå‚æ•°ï¼Œè¿™äº›å‚æ•°æ¥è‡ªäºä¸Šä¸‹æ–‡ï¼Œè¯¥å‡½æ•°è¿”å›reactå…ƒç´ ï¼Œåˆ™ä¸€å®šä¼šæ˜¾ç¤ºè¿”å›çš„å…ƒç´ ï¼Œå¹¶ä¸”å¿½ç•¥componentå±æ€§ renderï¼šåŒ¹é…æˆåŠŸæ¸²æŸ“çš„ç»„ä»¶ï¼Œå†…è”ä¹¦å†™renderï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªReactå…ƒç´  sensitiveï¼štrueåˆ™å¯¹pahtçš„å¤§å°å†™æ•æ„Ÿ exactï¼šç²¾ç¡®åŒ¹é… routeåµŒå¥—ä¸‹è¿°ä»£ç ä¸­ï¼Œç”¨æˆ·è®¿é—®/reposæ—¶ï¼Œä¼šå…ˆåŠ è½½Appç»„ä»¶ï¼Œç„¶ååœ¨å®ƒçš„å†…éƒ¨å†åŠ è½½Reposç»„ä»¶ã€‚ 123456&lt;BrowserRouter history={hashHistory}&gt; &lt;Route path=&quot;/&quot; component={App}&gt; &lt;Route path=&quot;/repos&quot; component={Repos}/&gt; &lt;Route path=&quot;/about&quot; component={About}/&gt; &lt;/Route&gt;&lt;/BrowserRouter&gt; åŒ¹é…è§„åˆ™ :paramName :paramNameåŒ¹é…URLçš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ª/ã€?ã€#ä¸ºæ­¢ã€‚è¿™ä¸ªè·¯å¾„å‚æ•°å¯ä»¥é€šè¿‡this.props.params.paramNameå–å‡ºã€‚ () ()è¡¨ç¤ºURLçš„è¿™ä¸ªéƒ¨åˆ†æ˜¯å¯é€‰çš„ã€‚ * *åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œç›´åˆ°æ¨¡å¼é‡Œé¢çš„ä¸‹ä¸€ä¸ªå­—ç¬¦ä¸ºæ­¢ã€‚åŒ¹é…æ–¹å¼æ˜¯éè´ªå©ªæ¨¡å¼ã€‚ ** ** åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œç›´åˆ°ä¸‹ä¸€ä¸ª/ã€?ã€#ä¸ºæ­¢ã€‚åŒ¹é…æ–¹å¼æ˜¯è´ªå©ªæ¨¡å¼ã€‚ æ­¤å¤–ï¼ŒURLçš„æŸ¥è¯¢å­—ç¬¦ä¸²/foo?bar=bazï¼Œå¯ä»¥ç”¨this.props.location.query.barè·å–ã€‚ 12345678import { BrowserRouter, Route } from &quot;react-router-dom&quot;;&lt;BrowserRouter&gt; &lt;Route path=&quot;/a&quot; component={A} /&gt; &lt;Route path=&quot;/a/d&quot; exact component={D}/&gt; // ç²¾ç¡®åŒ¹é… &lt;Route component={C} /&gt; &lt;Route path='/abc' children={E}/&gt;&lt;/BrowserRouter&gt; ä¸Šè¿°ä»£ç ï¼Œå¦‚æœè·¯ç”±æ˜¯ /a/dï¼Œåˆ™ä¼šæ¸²æŸ“ Aã€Dã€Cã€Eï¼Œreact routeræ˜¯ä¼šä»ä¸Šè‡³ä¸‹å®Œå…¨åŒ¹é…ä¸€éï¼Œè€Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¼•å…¥äº†Switchç»„ä»¶ã€‚ 4. Switchç»„ä»¶ä¼šå¾ªç¯æ‰€æœ‰å­å…ƒç´ ï¼Œå½“åŒ¹é…åˆ°ç¬¬ä¸€ä¸ªRouteåï¼Œä¼šç«‹å³åœæ­¢åŒ¹é…å¹¶æ¸²æŸ“ï¼Œå› æ­¤ä¸èƒ½åœ¨Switchç»„ä»¶çš„å­å…ƒç´ ä¸­ä½¿ç”¨é™¤Routeå¤–çš„å…¶ä»–ç»„ä»¶ 1234567&lt;Router&gt; &lt;Switch&gt; &lt;Route path=&quot;/a&quot; component={A} /&gt; &lt;Route path=&quot;/a/b&quot; component={B} /&gt; &lt;Route component={C} /&gt; &lt;/Switch&gt;&lt;/Router&gt; 5. Redirectç»„ä»¶ä¸€èˆ¬å†™åœ¨æ‰€æœ‰è·¯ç”±æ³¨å†Œçš„æœ€ä¸‹æ–¹ï¼Œå½“æ‰€æœ‰è·¯ç”±éƒ½æ— æ³•åŒ¹é…æ—¶ï¼Œè·³è½¬åˆ°RedirectæŒ‡å®šçš„è·¯ç”± 1&lt;Redirect to=&quot;/about/&quot; /&gt; 6. è·¯ç”±ä¿¡æ¯Routerç»„ä»¶ä¼šåˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”å‘ä¸Šä¸‹æ–‡ä¸­æ³¨å…¥ä¸€äº›ä¿¡æ¯ï¼Œè¯¥ä¸Šä¸‹æ–‡å¯¹å¼€å‘è€…æ˜¯éšè—çš„ï¼ŒRouteç»„ä»¶è‹¥åŒ¹é…åˆ°äº†åœ°å€ï¼Œåˆ™ä¼šå°†è¿™äº›ä¸Šä¸‹æ–‡ä¸­çš„ä¿¡æ¯ä½œä¸ºå±æ€§ä¼ å…¥å¯¹åº”çš„ç»„ä»¶ 12345678910111213141516171819import React from 'react'import { BrowserRouter as Router, Route, Switch } from &quot;react-router-dom&quot;// afunction A(props) { console.log(props) return &lt;h1&gt;ç»„ä»¶A&lt;/h1&gt;}export default function App() { return ( &lt;Router&gt; &lt;Switch&gt; &lt;Route path=&quot;/a&quot; component={A} /&gt; &lt;/Switch&gt; &lt;/Router&gt; )} æ‰“å°ä¸€ä¸‹props 12345678910111213141516history: go: Æ’ go(n) goBack: Æ’ goBack() goForward: Æ’ goForward() push: Æ’ push(path, state) replace: Æ’ replace(path, state)location: hashï¼šé¡µé¢hash pathnameï¼šé¡µé¢çš„path stateï¼špushæ—¶ä¼ å…¥çš„æ•°æ® searchï¼šä¼ å…¥çš„å‚æ•°match: isExactï¼šäº‹å®ä¸Šï¼Œå½“å‰çš„è·¯å¾„å’Œè·¯ç”±é…ç½®çš„è·¯å¾„æ˜¯å¦æ˜¯ç²¾ç¡®åŒ¹é…çš„ paramsï¼šè·å–è·¯å¾„ä¸­å¯¹åº”çš„æ•°æ® pathï¼šè·¯å¾„è§„åˆ™ urlï¼šé¡µé¢è·¯å¾„ 7.è·¯ç”±ä¼ å‚5.1 params å‚æ•°è·¯ç”±é“¾æ¥(æºå¸¦å‚æ•°)ï¼š&lt;Link to='/demo/test/tom/18'}&gt;è¯¦æƒ…&lt;/Link&gt;æ³¨å†Œè·¯ç”±(å£°æ˜æ¥æ”¶)ï¼š&lt;Route path=&quot;/demo/test/:name/:age&quot; component={Test}/&gt;æ¥æ”¶å‚æ•°ï¼šthis.props.match.params 5.2 searchå‚æ•°è·¯ç”±é“¾æ¥(æºå¸¦å‚æ•°)ï¼š&lt;Link to='/demo/test?name=tom&amp;age=18'}&gt;è¯¦æƒ…&lt;/Link&gt;æ³¨å†Œè·¯ç”±(æ— éœ€å£°æ˜ï¼Œæ­£å¸¸æ³¨å†Œå³å¯)ï¼š&lt;Route path=&quot;/demo/test&quot; component={Test}/&gt;æ¥æ”¶å‚æ•°ï¼šthis.props.location.searchå¤‡æ³¨ï¼šè·å–åˆ°çš„searchæ˜¯urlencodedç¼–ç å­—ç¬¦ä¸²ï¼Œéœ€è¦å€ŸåŠ©querystringè§£æ 5.3 stateå‚æ•°è·¯ç”±é“¾æ¥(æºå¸¦å‚æ•°)ï¼š&lt;Link to={{pathname:'/demo/test',state:{name:'tom',age:18}}}&gt;è¯¦æƒ…&lt;/Link&gt;æ³¨å†Œè·¯ç”±(æ— éœ€å£°æ˜ï¼Œæ­£å¸¸æ³¨å†Œå³å¯)ï¼š&lt;Route path=&quot;/demo/test&quot; component={Test}/&gt;æ¥æ”¶å‚æ•°ï¼šthis.props.location.stateå¤‡æ³¨ï¼šåˆ·æ–°ä¹Ÿå¯ä»¥ä¿ç•™ä½å‚æ•° 8. ç¼–ç¨‹å¼å¯¼èˆªå€ŸåŠ©this.props.historyä¸Šçš„æ–¹æ³•ï¼ŒåŸºæœ¬å’ŒH5çš„historyä¸€è‡´ï¼Œå°±åªæ˜¯åˆ—ä¸€ä¸‹äº† 12345this.props.history.push()this.props.history.replace()this.props.history.goBack()this.props.history.goForward()this.props.history.go() 9. withRouter ç”±äºåªèƒ½åœ¨è·³è½¬çš„ç»„ä»¶ä¸­è·å–è·¯ç”±ä¿¡æ¯ï¼Œæ‰€ä»¥æå‡ºwithRouterï¼Œç”¨withRouteråŒ…è£¹çš„ç»„ä»¶èƒ½è·å–è·¯ç”±ä¿¡æ¯ 1234567891011121314function ButtonContainer(props) { let history = props.history; return ( &lt;div className={&quot;container&quot;}&gt; &lt;button onClick={() =&gt; {history.push(&quot;/a?key=a&quot;, &quot;AçŠ¶æ€æ•°æ®&quot;)}}&gt;A&lt;/button&gt; &lt;button onClick={() =&gt; {history.push(&quot;/a/b?key=b&quot;, &quot;BçŠ¶æ€æ•°æ®&quot;)}}&gt;B&lt;/button&gt; &lt;button onClick={() =&gt; {history.push(&quot;/a/c?key=c&quot;, &quot;CçŠ¶æ€æ•°æ®&quot;)}}&gt;C&lt;/button&gt; &lt;button onClick={() =&gt; {history.push(&quot;/a/d?key=d&quot;, &quot;DçŠ¶æ€æ•°æ®&quot;)}}&gt;D&lt;/button&gt; &lt;button onClick={() =&gt; {history.push(&quot;/a/news/2020/12/21&quot;)}}&gt;News&lt;/button&gt; &lt;/div&gt; )}const WithRouterButtonContainer = withRouter(ButtonContainer) å…¶è¿”å›å€¼æ˜¯ä¸€ä¸ªæ–°ç»„ä»¶ å‚è€ƒreactå­¦ä¹ ç¬”è®°5-React Router[React Router ä½¿ç”¨æ•™ç¨‹](","link":"/2021/05/28/React/React%20Router/"},{"title":"Reactä»å…¥é—¨åˆ°çœŸé¦™","text":"1. è®¾è®¡æ€æƒ³ React è®¾è®¡æ€æƒ³ Reactçš„è®¾è®¡å“²å­¦ - ç®€å•ä¹‹ç¾ é¢ è¦†å¼å‰ç«¯UIå¼€å‘æ¡†æ¶:React 2. å®‰è£… 2.1 CDNçš„æ–¹å¼å¼•å…¥123&lt;script src=&quot;https://unpkg.com/react@17/umd/react.development.js&quot; crossorigin&gt;&lt;/script&gt;&lt;script src=&quot;https://unpkg.com/react-dom@17/umd/react-dom.development.js&quot; crossorigin&gt;&lt;/script&gt;&lt;script src=&quot;https://unpkg.com/babel-standalone@6/babel.min.js&quot;&gt;&lt;/script&gt; react.jsï¼šReactæ ¸å¿ƒåº“ react-dom.jsï¼šæä¾›æ“ä½œ DOM çš„ react æ‰©å±•åº“ babel.min.jsï¼šè§£æ JSX è¯­æ³•ä»£ç è½¬ä¸º JS ä»£ç çš„åº“ 2.2 create-react-appå®‰è£…create-react-app 1npm isntall -g create-react-app åˆ›å»ºé¡¹ç›® 1create-react-app my-app 3. JSXjsx å…è®¸åœ¨æ¨¡æ¿ä¸­ç”¨{}æ’å…¥JavaScriptè¡¨è¾¾å¼ï¼Œå¦‚æœ{}ä¸­çš„å˜é‡æ˜¯æ•°ç»„ï¼Œåˆ™ä¼šå±•å¼€è¿™ä¸ªæ•°ç»„çš„æ‰€æœ‰æˆå‘˜ 123456789101112131415161718192021var arr = [ &lt;h1&gt;Hello world!&lt;/h1&gt;, &lt;h2&gt;React is awesome&lt;/h2&gt;,];ReactDOM.render( &lt;div&gt;{arr}&lt;/div&gt;, document.getElementById('example'));var names = ['Alice', 'Emily', 'Kate'];ReactDOM.render( &lt;div&gt; { names.map(function (name) { // åˆ—è¡¨æ¸²æŸ“ return &lt;div&gt;Hello, {name}!&lt;/div&gt; }) } &lt;/div&gt;, document.getElementById('example2')); ReactDOM.renderç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¸²æŸ“çš„ç»„ä»¶ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æŒ‚è½½å®ä¾‹çš„ä½ç½®ã€‚ classNameæ›¿æ¢class å†…è”æ ·å¼â€”â€”style= åªèƒ½å«æœ‰ä¸€ä¸ªæœ€å¤–å±‚æ ‡ç­¾ å¯¹äºæœ€åä¸€ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨React.Fragmentç»„ä»¶ï¼Œå®ƒèƒ½å¤Ÿåœ¨ä¸é¢å¤–åˆ›å»º DOM å…ƒç´ çš„æƒ…å†µä¸‹ï¼Œè®©renderè¿”å›å¤šä¸ªå…ƒç´  12345678render() { return ( &lt;React.Fragment&gt; Some text. &lt;h2&gt;A heading&lt;/h2&gt; &lt;/React.Fragment&gt; );} 4.ç»„ä»¶4.1 ç±»ç»„ä»¶ï¼ˆæœ‰çŠ¶æ€ï¼‰ ç»„ä»¶ç±»çš„ç¬¬ä¸€ä¸ªåå­—å¿…é¡»å¤§å†™ é€šè¿‡ç»§æ‰¿React.Componentæ¥å®ç°ç±»ç»„ä»¶ï¼Œéœ€è¦å®ç°ä¸€ä¸ªrenderæ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªæ¨¡æ¿ 12345678910class Clock React.Component { render () { return ( &lt;div onClick={this.clickFunc.bind(this)}&gt; // å°†clickFuncå†…éƒ¨thisæŒ‡å‘ç»„ä»¶å®ä¾‹ &lt;h1&gt;Hello, world!&lt;/h1&gt; &lt;h2&gt;It is {this.props.date.toLocaleTimeString()}&lt;/h2&gt; &lt;/div&gt; ) }} é€šè¿‡React.createClassç”Ÿæˆä¸€ä¸ªç»„ä»¶ç±» 12345678910var Clock = React.createClass({ render: function() { return ( &lt;div&gt; &lt;h1&gt;Hello, world!&lt;/h1&gt; &lt;h2&gt;It is {this.props.date.toLocaleTimeString()}&lt;/h2&gt; &lt;/div&gt; ) }}); ä¸¤ç§æ–¹å¼çš„åŒºåˆ«æ˜¯ï¼Œå‰è€…ä¸ä¼šè‡ªåŠ¨ç»‘å®šthis 4.2 å‡½æ•°å¼ç»„ä»¶ï¼ˆæ— çŠ¶æ€ï¼‰12345678910function Person (props) { const {name, age, sex} = props; return { &lt;ul&gt; &lt;li&gt;å§“åï¼š{name}&lt;/li&gt; &lt;li&gt;æ€§åˆ«ï¼š{sex}&lt;/li&gt; &lt;li&gt;å¹´é¾„ï¼š{age}&lt;/li&gt; &lt;/ul&gt; }} 5. State5.1 stateåˆå§‹åŒ–12345678910111213class Clock React.Component { // ç¬¬ä¸€ç§ ç›´æ¥åœ¨å®ä¾‹ä¸Šå®šä¹‰stateå±æ€§ state = { value: 6, } // ç¬¬äºŒç§ åœ¨æ„é€ å™¨ä¸­è®¾ç½®state constructor () { this.state = { value: 6 } }} 5.2 stateä¿®æ”¹ç›´æ¥ä¿®æ”¹æ•°æ®æ˜¯ä¸ä¼šè§¦å‘è§†å›¾æ›´æ–°çš„ï¼Œåªæœ‰ä½¿ç”¨setStateæ¥ä¿®æ”¹æ•°æ®ï¼Œä¼šé‡æ–°è§¦å‘ç»„ä»¶çš„renderå‡½æ•° setStateç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ä¿®æ”¹åçš„stateå¯¹è±¡ï¼Œå¯ä»¥ä¿®æ”¹æŸä¸€ä¸ªå€¼ï¼ŒsetStateæ˜¯æµ…åˆå¹¶ã€‚ å¦‚æœsetStateçš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡è€Œæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°åœ¨æ‰§è¡Œæ—¶ä¼šé€šè¿‡å‚æ•°è¢«ä¼ å…¥prevStateï¼Œä¹Ÿå°±æ˜¯ä¹‹å‰çš„çŠ¶æ€ï¼Œè€Œè¿”å›å€¼å°±ä¼šå’Œstateè¿›è¡Œåˆå¹¶ 1234567this.setState((prevState : any) =&gt; { return { num : prevState.num + 1 }}, () =&gt; { console.log(this.state.num)}) ä½†æ˜¯setStateæœ‰ä¸¤ä¸ªé—®é¢˜ setStateå¯¹çŠ¶æ€çš„ä¿®æ”¹ï¼Œå¯èƒ½æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼ˆå¦‚æœæ”¹å˜çŠ¶æ€çš„ä»£ç å¤„äºæŸä¸ªHTMLå…ƒç´ çš„äº‹ä»¶ä¸­ï¼Œåˆ™å…¶æ˜¯å¼‚æ­¥çš„ï¼Œå¦åˆ™æ˜¯åŒæ­¥ï¼‰ Reactä¼šå¯¹å¼‚æ­¥çš„setStateè¿›è¡Œä¼˜åŒ–ï¼Œå°†å¤šæ¬¡setStateè¿›è¡Œåˆå¹¶ï¼ˆå°†å¤šæ¬¡çŠ¶æ€æ”¹å˜å®Œæˆåï¼Œå†ç»Ÿä¸€å¯¹stateè¿›è¡Œæ”¹å˜ï¼Œç„¶åè§¦å‘renderï¼‰ ä¸‹é¢ç»™å‡ºç¬¬ä¸€ä¸ªé—®é¢˜çš„ä¾‹å­ 123456789101112131415161718192021class Comp extends React.Component { state = { num: 0 } handleClick = () =&gt; { this.setState({ num: this.state.num + 1 }) console.log(this.state.num) // ç¬¬ä¸€ä¸‹ç‚¹å‡»è¾“å‡º 0 } render () { return ( &lt;React.Fragment&gt; &lt;p&gt;{this.state.num}&lt;/p&gt; &lt;button onClick={this.handleClick}&gt;ç‚¹æˆ‘&lt;/button&gt; &lt;/React.Fragment&gt; ) }} åœ¨ç¬¬ä¸€ä¸‹ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™ï¼Œconsole.logè¾“å‡º 0ï¼Œè¯´æ˜setStateåœ¨DOMäº‹ä»¶ä¸­æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ã€‚ è§£å†³æ–¹å¼ï¼šsetStateæœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ¥æ”¾ç½®renderæ‰§è¡Œåæ¥ç€æ‰§è¡Œçš„å›è°ƒå‡½æ•° 6. Props6.1 ä¼ é€’å‚æ•°çˆ¶ç»„ä»¶åœ¨ä½¿ç”¨å­ç»„ä»¶çš„æ—¶å€™ï¼Œé€šè¿‡ç»™å­ç»„ä»¶å…ƒç´ è®¾ç½®å±æ€§çš„æ–¹å¼ä¼ é€’å‚æ•°ç»™å­ç»„ä»¶ 12345678910111213141516171819202122232425262728// çˆ¶ç»„ä»¶è®¾ç½®å±æ€§ç»™å­ç»„ä»¶ä¼ å‚ï¼Œè¿™é‡Œå±æ€§åç”¨value2ç”¨ä½œåŒºåˆ†class Board extends React.Component { render () { return ( &lt;Square value2={0}/&gt; ); }}// ç±»ç»„ä»¶ é€šè¿‡ this.props.[å±æ€§] æ¥è·å–å‚æ•°class Square extends React.Component { render() { return ( &lt;button className=&quot;square&quot;&gt; {this.props.value2} &lt;/button&gt; ); }}// å‡½æ•°å¼ç»„ä»¶é€šè¿‡ props.[å±æ€§] æ¥è·å–å‚æ•°function Square (props) { return ( &lt;button className=&quot;square&quot;&gt; {props.value2} &lt;/button&gt; )} 6.2 propsä¼ é€’äº‹ä»¶é€šè¿‡this.props.[äº‹ä»¶å]è°ƒç”¨ 1234567891011121314151617class Board extends React.Component { render () { return ( &lt;Square click={() =&gt; {alert(&quot;click event&quot;)}}/&gt; ); }}class Square extends React.Component { render() { return ( &lt;button onClick={this.props.click} className=&quot;square&quot;&gt; button &lt;/button&gt; ); }} 6.3 propsæ ¡éªŒ1.éœ€è¦å¼•å…¥ä¸€ä¸ªåº“prop-types.js cdn 1&lt;script src=&quot;https://unpkg.com/prop-types@15.6/prop-types.js&quot;&gt;&lt;/script&gt; npm 1npm install --save prop-types 2.ä½¿ç”¨æ–¹å¼ åœ¨ç»„ä»¶ä¸Šå®šä¹‰ PropTypeså¯¹è±¡ï¼Œé”®å°±æ˜¯propsçš„åï¼Œå€¼å°±æ˜¯é™åˆ¶ã€‚ 1234567891011121314151617181920212223class Square extends React.Component { render() { // ... do things with the props } // æ–¹å¼ä¸€ static propTypes = { value1: PropTypes.number.isRequired, value2: PropTypes.string } // æŒ‡å®špropsé»˜è®¤å€¼ static defaultProps = { value1: 666, value2: &quot;6&quot;, }}// æ–¹å¼äºŒSquare.propTypes = { value1: PropTypes.number.isRequired, value2: PropTypes.string} æ›´å¤šä½¿ç”¨æ–¹å¼å‚è€ƒï¼šhttps://github.com/facebook/prop-types 6.4 this.props.children è·å–ç»„ä»¶æ‰€æœ‰å­èŠ‚ç‚¹ 123456789101112131415161718192021class NotesList extends React.Component { render() { return ( &lt;ol&gt; { React.Children.map(this.props.children, function (child) { return &lt;li&gt;{child}&lt;/li&gt;; }) } &lt;/ol&gt; ); }}ReactDOM.render( &lt;NotesList&gt; &lt;span&gt;hello&lt;/span&gt; &lt;span&gt;world&lt;/span&gt; &lt;/NotesList&gt;, document.getElementById('example')); æ²¡æœ‰å­èŠ‚ç‚¹ï¼šundefined ä¸€ä¸ªå­èŠ‚ç‚¹ï¼šobject å¤šä¸ªå­èŠ‚ç‚¹ï¼šarray å¯ä»¥ç”¨React.Children.mapæ¥éå†å­èŠ‚ç‚¹ï¼Œåˆ™ä¸éœ€è¦æ‹…å¿ƒå­å…ƒç´ ä¸ªæ•° 6.5 propsä¼ é€’ç»„ä»¶Reactç»„ä»¶æœ¬è´¨å°±æ˜¯å¯¹è±¡ï¼Œå½“ä½œpropsåƒå…¶ä»–æ•°æ®ä¸€æ ·ä¼ é€’ä¹Ÿæ˜¯å¯ä»¥çš„ 7. Reactç”Ÿå‘½å‘¨æœŸ æ„Ÿè§‰å’Œvueå·®ä¸å¤šï¼Œç›´æ¥ç®€å•å¸¦è¿‡æŠŠ componentWillMount()ç»„ä»¶å³å°†è¢«æ¸²æŸ“åˆ°é¡µé¢ä¹‹å‰è§¦å‘ï¼Œæ­¤æ—¶å¯ä»¥è¿›è¡Œå¼€å¯å®šæ—¶å™¨ã€å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ç­‰æ“ä½œ componentDidMount()ç»„ä»¶å·²ç»è¢«æ¸²æŸ“åˆ°é¡µé¢ä¸­åè§¦å‘ï¼Œå¯ä»¥é€šè¿‡this.getDOMNode()æ¥è¿›è¡Œè®¿é—®DOMã€‚ componentWillReceiveProps()åœ¨ç»„ä»¶æ¥æ”¶åˆ°ä¸€ä¸ªæ–°çš„ prop (æ›´æ–°å)æ—¶è¢«è°ƒç”¨ã€‚è¿™ä¸ªæ–¹æ³•åœ¨åˆå§‹åŒ–renderæ—¶ä¸ä¼šè¢«è°ƒç”¨ã€‚ shouldComponentUpdate()è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚åœ¨ç»„ä»¶æ¥æ”¶åˆ°æ–°çš„propsæˆ–è€…stateæ—¶è¢«è°ƒç”¨ã€‚åœ¨åˆå§‹åŒ–æ—¶æˆ–è€…ä½¿ç”¨forceUpdateæ—¶ä¸è¢«è°ƒç”¨ã€‚ 12345// è¯¥é’©å­å‡½æ•°å¯ä»¥æ¥æ”¶åˆ°ä¸¤ä¸ªå‚æ•°ï¼Œæ–°çš„å±æ€§å’ŒçŠ¶æ€ï¼Œè¿”å›true/falseæ¥æ§åˆ¶ç»„ä»¶æ˜¯å¦éœ€è¦æ›´æ–°ã€‚shouldComponentUpdate(newProps, newState) { if (newProps.number &lt; 5) return true; return false} ä¸€ä¸ªReacté¡¹ç›®éœ€è¦æ›´æ–°ä¸€ä¸ªå°ç»„ä»¶æ—¶ï¼Œå¾ˆå¯èƒ½éœ€è¦çˆ¶ç»„ä»¶æ›´æ–°è‡ªå·±çš„çŠ¶æ€ã€‚è€Œä¸€ä¸ªçˆ¶ç»„ä»¶çš„é‡æ–°æ›´æ–°ä¼šé€ æˆå®ƒæ——ä¸‹æ‰€æœ‰çš„å­ç»„ä»¶é‡æ–°æ‰§è¡Œrender()æ–¹æ³•ï¼ˆå³ä½¿æ²¡æœ‰ä½¿ç”¨çˆ¶ç»„ä»¶çš„stateï¼‰ï¼Œå½¢æˆæ–°çš„è™šæ‹ŸDOMï¼Œå†ç”¨diffç®—æ³•å¯¹æ–°æ—§è™šæ‹ŸDOMè¿›è¡Œç»“æ„å’Œå±æ€§çš„æ¯”è¾ƒï¼Œå†³å®šç»„ä»¶æ˜¯å¦éœ€è¦é‡æ–°æ¸²æŸ“ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä¸‹é¢è¯´äº†PureComponent componentWillUpdate()åœ¨ç»„ä»¶æ¥æ”¶åˆ°æ–°çš„propsæˆ–è€…stateä½†è¿˜æ²¡æœ‰renderæ—¶è¢«è°ƒç”¨ã€‚åœ¨åˆå§‹åŒ–æ—¶ä¸ä¼šè¢«è°ƒç”¨ã€‚ componentDidUpdate()åœ¨ç»„ä»¶å®Œæˆæ›´æ–°åç«‹å³è°ƒç”¨ã€‚åœ¨åˆå§‹åŒ–æ—¶ä¸ä¼šè¢«è°ƒç”¨ã€‚ componentWillUnMount()ç»„ä»¶è¢«é”€æ¯æ—¶è§¦å‘ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œä¸€äº›æ¸…ç†æ“ä½œï¼Œä¾‹å¦‚æ¸…ç†å®šæ—¶å™¨ï¼Œå–æ¶ˆReduxçš„è®¢é˜…äº‹ä»¶ç­‰ç­‰ã€‚ getDerivedStateFromError()è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•åœ¨ErrorBoundaryç±»ä¸­ä½¿ç”¨ã€‚å®é™…ä¸Šï¼Œå¦‚æœä½¿ç”¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œä»»ä½•ç±»éƒ½ä¼šå˜æˆErrorBoundaryã€‚è¿™ç”¨äºåœ¨ç»„ä»¶æ ‘ä¸­å‡ºç°é”™è¯¯æ—¶å‘ˆç°å›é€€UIï¼Œè€Œä¸æ˜¯åœ¨å±å¹•ä¸Šæ˜¾ç¤ºä¸€äº›å¥‡æ€ªçš„é”™è¯¯ã€‚ componentDidCatch()è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•åœ¨ErrorBoundaryç±»ä¸­ä½¿ç”¨ã€‚å®é™…ä¸Šï¼Œå¦‚æœä½¿ç”¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œä»»ä½•ç±»éƒ½ä¼šå˜æˆErrorBoundaryã€‚è¿™ç”¨äºåœ¨ç»„ä»¶æ ‘ä¸­å‡ºç°é”™è¯¯æ—¶è®°å½•é”™è¯¯ã€‚ 8. Refç”¨æ¥è®¿é—®DOMå…ƒç´ æˆ–renderä¸­çš„reactå…ƒç´ ï¼ŒRefçš„ä½¿ç”¨è§„åˆ™å¦‚ä¸‹ refä½œç”¨äºå†…ç½®çš„htmlç»„ä»¶æ—¶ï¼Œå¾—åˆ°çš„å°†æ˜¯çœŸå®çš„domå¯¹è±¡ refä½œç”¨äºç±»ç»„ä»¶æ—¶ï¼Œå¾—åˆ°çš„å°†æ˜¯ç±»çš„å®ä¾‹ refä¸èƒ½ä½œç”¨äºå‡½æ•°ç»„ä»¶ï¼ˆå› ä¸ºæ²¡æœ‰å®ä¾‹ï¼‰ï¼Œä½†æ˜¯å‡½æ•°ç»„ä»¶å†…éƒ¨å¯ä»¥ 8.1 åˆ›å»ºrefrefçš„å¯é€‰å€¼ä¸º å­—ç¬¦ä¸²ï¼ˆä¸å»ºè®®ï¼‰ åŸå› ï¼šreact refæ³¨æ„äº‹é¡¹ å›è°ƒå‡½æ•° è§¦å‘æ—¶æœºï¼šrefä¸­çš„å›è°ƒå‡½æ•°ä¼šåœ¨å¯¹åº”çš„æ™®é€šç»„ä»¶ï¼ˆæˆ–å…ƒç´ ï¼‰componentDidMountï¼ŒComponentDidUpdateä¹‹å‰ï¼Œæˆ–è€…componentWillUnmountä¹‹åæ‰§è¡Œ æ³¨æ„ï¼šå¦‚æœ ref å›è°ƒå‡½æ•°æ˜¯ä»¥å†…è”å‡½æ•°çš„æ–¹å¼å®šä¹‰çš„ï¼Œåœ¨æ›´æ–°è¿‡ç¨‹ä¸­å®ƒä¼šè¢«æ‰§è¡Œä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡ä¼ å…¥å‚æ•° nullï¼Œç„¶åç¬¬äºŒæ¬¡ä¼šä¼ å…¥å‚æ•° DOM å…ƒç´ ã€‚è¿™æ˜¯å› ä¸ºåœ¨æ¯æ¬¡æ¸²æŸ“æ—¶ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°å®ä¾‹ï¼Œæ‰€ä»¥ React æ¸…ç©ºæ—§çš„ ref å¹¶ä¸”è®¾ç½®æ–°çš„ createRef 123456789101112131415161718class MyComponent extends React.Component { constructor(props) { super(props); this.textInput = React.createRef(); } focusTextInput() { // æ³¨æ„ï¼šæˆ‘ä»¬é€šè¿‡ &quot;current&quot; æ¥è®¿é—® DOM èŠ‚ç‚¹ this.textInput.current.focus(); } render() { return ( &lt;React.Fragment&gt; &lt;input type=&quot;text&quot; ref={this.textInput} /&gt; &lt;input type=&quot;button&quot; value=&quot;Focus the text input&quot; onClick={this.focusTextInput.bind(this)}/&gt; &lt;/React.Fragment&gt; ); }} 8.2 è½¬å‘ref ç”¨äºè·å–ç»„ä»¶å†…éƒ¨çš„æŸä¸ªå…ƒç´ ï¼Œæœ‰äº›é«˜åº¦å¤ç”¨çš„åŸºç¡€ç»„ä»¶ä¸å¯é¿å…çš„éœ€è¦åœ¨çˆ¶ç»„ä»¶è·å–ï¼Œç”¨ä»¥ç®¡ç†ç„¦ç‚¹ç­‰ React.forwardRefç”¨ä»¥è·å–ä¼ é€’ç»™å®ƒçš„refï¼Œç„¶åè½¬å‘åˆ°æ¸²æŸ“å®ƒçš„DOMã€‚ å¯¹äºå‡½æ•°å¼ç»„ä»¶ï¼ŒReact.forwardRefç›´æ¥åŒ…è£¹å‡½æ•°å°±å¯ä»¥æ¥æ”¶åˆ°ref 123456789const FancyButton = React.forwardRef((props, ref) =&gt; ( &lt;button ref={ref} className=&quot;FancyButton&quot;&gt; {props.children} &lt;/button&gt;));// ä½ å¯ä»¥ç›´æ¥è·å– DOM button çš„ refï¼šconst ref = React.createRef();&lt;FancyButton ref={ref}&gt;Click me!&lt;/FancyButton&gt;; ä½¿ç”¨ FancyButton çš„ç»„ä»¶å¯ä»¥è·å–åº•å±‚ DOM èŠ‚ç‚¹ button çš„ ref è€Œå¯¹äºç±»ç»„ä»¶ï¼Œéœ€è¦ä½¿ç”¨HOCçš„å½¢å¼ï¼Œç”¨React.forwardRefåŒ…è£¹è¿”å›çš„å‡½æ•°å¼ç»„ä»¶ 1234567891011121314151617function logProps(Component) { class LogProps extends React.Component { render() { const {forwardedRef, ...rest} = this.props; // å°†è‡ªå®šä¹‰çš„ prop å±æ€§ â€œforwardedRefâ€ å®šä¹‰ä¸º ref return &lt;input ref={forwardedRef} {...rest} /&gt;; } } // æ³¨æ„ React.forwardRef å›è°ƒçš„ç¬¬äºŒä¸ªå‚æ•° â€œrefâ€ã€‚ // æˆ‘ä»¬å¯ä»¥å°†å…¶ä½œä¸ºå¸¸è§„ prop å±æ€§ä¼ é€’ç»™ LogPropsï¼Œä¾‹å¦‚ â€œforwardedRefâ€ // ç„¶åå®ƒå°±å¯ä»¥è¢«æŒ‚è½½åˆ°è¢« LogProps åŒ…è£¹çš„å­ç»„ä»¶ä¸Šã€‚ return React.forwardRef((props, ref) =&gt; { return &lt;LogProps {...props} forwardedRef={ref} /&gt;; });} ç”¨React.forwardRefåŒ…è£¹çš„ç»„ä»¶åœ¨DevToolsä¸­æ˜¾ç¤ºä¸ºâ€ForwardRefâ€ï¼Œå¯ä»¥æŠŠåŒ…è£¹çš„å‡½æ•°ç”¨æ™®é€šå‡½æ•°çš„å½¢å¼å‘½åï¼ŒDevToolsä¹Ÿå°†åŒ…å«å…¶åç§°ï¼ˆä¾‹å¦‚ â€œForwardRef(myFunction)â€ï¼‰ï¼Œä¹Ÿå¯ä»¥è®¾ç½®å‡½æ•°çš„displayNameå±æ€§æ¥è®¾ç½®DevToolsä¸­æ˜¾ç¤ºçš„åå­— 9.Context è·¨ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Œç­‰åŒVueçš„provideã€inject ä½¿ç”¨1.åˆ›å»ºContextå®¹å™¨å¯¹è±¡ 12// åªæœ‰å½“ç»„ä»¶æ‰€å¤„çš„æ ‘ä¸­æ²¡æœ‰åŒ¹é…åˆ° Provider æ—¶ï¼Œå…¶ defaultValue å‚æ•°æ‰ä¼šç”Ÿæ•ˆconst xxxContext = React.createContext(defaultValue) 2.æ¸²æŸ“å­ç»„æ—¶ï¼Œå¤–é¢åŒ…è£¹xxxContext.Providerï¼Œé€šè¿‡valueå±æ€§ç»™åä»£ç»„ä»¶ä¼ é€’æ•°æ® 123&lt;xxxContext.Provider value={æ•°æ®}&gt; &lt;å­ç»„ä»¶&gt;&lt;/å­ç»„ä»¶&gt;&lt;/xxxContext.Provider&gt; psï¼šå¦‚æœè¦ä¼ å¤šä¸ªæ•°æ®ï¼Œéœ€è¦å¥—å¤šå±‚ 3.åä»£ç»„ä»¶è·å–æ•°æ® 12345678// ç¬¬ä¸€ç§ï¼šä»…é€‚ç”¨äºç±»ç»„ä»¶static contextType = xxxContext // å£°æ˜æ¥å—contextthis.context; // è¯»å–contextä¸­çš„valueæ•°æ®// ç¬¬äºŒç§ï¼šå‡½æ•°ç»„ä»¶ä¸ç±»ç»„ä»¶éƒ½å¯ä»¥&lt;xxxContext.Consumer&gt; {value}&lt;/xxxContext.Consumer&gt; ä¸å»ºè®®ä½¿ç”¨è¯¥apiï¼Œä»–æé«˜äº†ç»„ä»¶å¤ç”¨çš„éš¾åº¦ 10.PureComponent çˆ¶ç»„ä»¶setStateä¼šè§¦å‘å­ç»„ä»¶renderï¼ŒPureComponenté€šè¿‡propå’Œstateçš„æµ…æ¯”è¾ƒæ¥å®ç°shouldComponentUpdateï¼Œç®—æ˜¯ä¸€ç§è¯­æ³•ç³–ï¼Œå¸®æˆ‘ä»¬åº”è¯¥åœ¨shouldComponentUpdateä¸­åº”è¯¥æ‰‹åŠ¨æ¯”è¾ƒçš„ç»™åšäº† å¦‚æœæ˜¯æµ…å±‚stateæˆ–propæ²¡æ”¹å˜ï¼Œé‚£ä¹ˆä¸ä¼šè§¦å‘è§†å›¾æ›´æ–°ï¼Œä¹¦å†™æ–¹å¼å¦‚ä¸‹ 123class IndexPage extends PureComponent { // ...} ç”±äºæ˜¯æµ…æ¯”è¾ƒï¼Œæ‰€ä»¥ç›´æ¥ä¿®æ”¹å¯¹è±¡å†…éƒ¨çš„å€¼æ˜¯æ— æ³•æ›´æ–°è§†å›¾çš„ åœ¨å‡½æ•°å¼ç»„ä»¶åˆ™æ˜¯ç”¨React.memoåŒ…è£¹å‡½æ•°å¼ç»„ä»¶æ¥åšåˆ°PureComponentçš„æ•ˆæœ å‚è€ƒReactå­¦ä¹ èµ„æºæ±‡æ€»React å…¥é—¨å®ä¾‹æ•™ç¨‹reactå­¦ä¹ ç¬”è®°2-reactåŸºæœ¬ä½¿ç”¨reactå­¦ä¹ ç¬”è®°3-reactå…¶ä»–ä½¿ç”¨æŠ€å·§å›¾è§£ES6ä¸­çš„Reactç”Ÿå‘½å‘¨æœŸä½ è¦çš„ React é¢è¯•çŸ¥è¯†ç‚¹ï¼Œéƒ½åœ¨è¿™äº†","link":"/2021/05/27/React/React%E5%85%A5%E9%97%A8/"},{"title":"jså‡†ç¡®å€’è®¡æ—¶","text":"å¼•å…¥å¦‚æœç”¨æœ€åˆå§‹çš„setTimeouté€’å½’å®ç°å®šæ—¶å™¨ï¼Œä¸€ç§’æ‰§è¡Œä¸€æ¬¡å›è°ƒï¼Œåˆ™ä»£ç å¦‚ä¸‹ 12345678910111213141516171819202122232425262728// æ¨¡æ‹Ÿæ‰§è¡Œå¤§é‡ä»£ç setInterval(() =&gt; { let i = 0; while (i++ &lt; 100000000) { }}, 0);function countDown (fn, time) { let startTime = new Date().getTime(), count = 0, second = 1000; let timeCounter = null; return function interFunc () { let offset = new Date().getTime() - (startTime + count * second); console.log(&quot;è¯¯å·®ï¼š&quot; + offset + &quot;msï¼Œä¸‹ä¸€æ¬¡æ‰§è¡Œï¼š&quot; + 1000 + &quot;msåï¼Œç¦»æ´»åŠ¨å¼€å§‹è¿˜æœ‰ï¼š&quot; + time + &quot;ms&quot;); time -= second; count++; if (time &lt; 0) { clearTimeout(timeCounter); } else { timeCounter = setTimeout(() =&gt; { fn.apply(this, arguments); interFunc(); }, 1000); } }}countDown(function () {}, 10000)(); // æµ‹è¯•ä»£ç  å¯ä»¥çœ‹åˆ°è¯¯å·®æ˜¯ä¼šè¶Šæ¥è¶Šå¤šçš„ã€‚ è§£å†³æ ¸å¿ƒæ€æƒ³å°±æ˜¯é€šè¿‡è®¡ç®— å½“å‰æ—¶é—´ - åº”è¯¥åˆ°çš„æ—¶é—´ è®¡ç®—å‡ºæ—¶é—´åç§»é‡ï¼Œä¸‹ä¸€æ¬¡å»¶è¿Ÿæ—¶é—´å°±æ˜¯ 1s - åç§»é‡ 123456789101112131415161718192021222324252627282930313233// æ¨¡æ‹Ÿæ‰§è¡Œå¤§é‡ä»£ç setInterval(() =&gt; { let i = 0; while (i++ &lt; 100000000) { }}, 0);// å€’è®¡æ—¶function countDown (fn, time) { let startTime = new Date().getTime(), count = 0, second = 1000; let timeCounter = null; return function interFunc () { let offset = new Date().getTime() - (startTime + count * second); let nextTime = second - offset; if (nextTime &lt; 0) { nextTime = 0 } console.log(&quot;è¯¯å·®ï¼š&quot; + offset + &quot;msï¼Œä¸‹ä¸€æ¬¡æ‰§è¡Œï¼š&quot; + nextTime + &quot;msåï¼Œç¦»æ´»åŠ¨å¼€å§‹è¿˜æœ‰ï¼š&quot; + time + &quot;ms&quot;); time -= second; count++; if (time &lt; 0) { clearTimeout(timeCounter); } else { timeCounter = setTimeout(() =&gt; { fn.apply(this, arguments); interFunc(); }, nextTime); } }}countDown(function () {}, 10000)(); // æµ‹è¯•ä»£ç  å¯ä»¥çœ‹åˆ°è™½ç„¶ä»æœ‰è¯¯å·®ï¼Œä½†ä¸ä¼šéšç€æ—¶é—´å¢å¤§","link":"/2021/05/25/Js/js%E5%87%86%E7%A1%AE%E5%80%92%E8%AE%A1%E6%97%B6/"},{"title":"å¦‚ä½•ç»™å¯¹è±¡è®¾ç½®é»˜è®¤å€¼","text":"1.ç”¨ â€¦ è§£æ„è®¾ç½®åœ¨çœ‹compressor.jsçš„æ—¶å€™ï¼Œä»–ç”¨ä¸€ä¸ªæ–‡ä»¶æ¥å­˜é»˜è®¤å€¼ï¼Œç„¶åå¯¼å‡ºï¼Œæœ€åç”¨è§£æ„çš„æ–¹å¼ï¼Œåé¢çš„å€¼è¦†ç›–å‰é¢çš„æ–¹å¼è®¾ç½®é»˜è®¤å€¼ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ç”¨Object.assignéƒ½æ˜¯ä¸€æ ·çš„ 123456789101112131415161718// defaults.jsexport default { maxWidth: Infinity, maxHeight: Infinity, // ... }// index.jsimport DEFAULTS from './defaults';export default class Compressor { constructor (option) { this.option = { ...DEFAULTS, ...option, } }} ä¸Šé¢çš„æ–¹æ³•çœ‹ç€æŒºæ–¹ä¾¿çš„ï¼Œä½†æ˜¯è¿˜æœ‰ç¼ºé™·ï¼Œè§£å†³ä¸äº†ä¸‹é¢çš„é—®é¢˜ 123456789101112131415161718192021let user = { a: &quot;a1&quot;, b: { c: &quot;c1&quot; }}let defaults = { a: &quot;a2&quot;, b: { c: &quot;c2&quot;, d: &quot;d1&quot; // ä¸¢å¤±äº† },}let option = { ...defaults, ...user}console.log(option) // { a: 'a1', b: { c: 'c1' } } å¯ä»¥çœ‹åˆ°é»˜è®¤é…ç½®ä¸­ dä¸¢å¤±äº†ï¼Œä¸‹é¢çš„æ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ 2.extendæ–¹æ³•Mescroll.jså®ç°çš„æ–¹æ³•ï¼Œé€‚åˆå¤šä¸ªæ–¹æ³•éƒ½éœ€è¦é»˜è®¤å€¼çš„æ—¶å€™ï¼Œå¹¶ä¸”å¯ä»¥æ·±åº¦åŒ¹é…é»˜è®¤å€¼ï¼Œé»˜è®¤å€¼ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ï¼Œ 1234567891011MeScroll.extend = function (userOption, defaultOption) { if (!userOption) return defaultOption; for (var key in defaultOption) { if (userOption[key] == null) { // å¦‚æœç”¨æˆ·æ²¡è®¾ç½®ï¼Œåˆ™ç”¨é»˜è®¤å€¼ userOption[key] = defaultOption[key]; } else if (typeof userOption[key] === 'object') { MeScroll.extend(userOption[key], defaultOption[key]); // æ·±åº¦åŒ¹é… } } return userOption;} ä½†æ˜¯æœ‰äº›åœºæ™¯æˆ‘ä»¬æ˜¯éœ€è¦æœ‰å¤šä¸ªé…ç½®è¿›è¡Œåˆå¹¶ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒjqueryçš„extendå®ç°æ–¹å¼ 3.$.extend$.extend([deep,] [target,] object1 [,objectN]) deep: Boolenç±»å‹ï¼Œå¯é€‰ï¼Œè¡¨ç¤ºæ˜¯å¦è¿›è¡Œé€’å½’åˆå¹¶ï¼ˆæ·±/æµ…å¤åˆ¶ï¼‰ï¼Œä¸ºtrueæ˜¯ä¸ºæ·±å¤åˆ¶ï¼›é»˜è®¤å€¼ä¸ºfalseï¼Œæµ…å¤åˆ¶ã€‚target:æ‰©å±•å¯¹è±¡ï¼Œå¯é€‰ï¼Œå°†æ¥æ”¶æ–°çš„å±æ€§ã€‚objectN:ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«é¢å¤–çš„å±æ€§ï¼Œæ‰©å±•åˆ°ç›®æ ‡å¯¹è±¡ï¼ˆæ‰©å±•å¯¹è±¡ï¼‰ã€‚ æˆ‘ä»¬å¯ä»¥ç æ‰ä¸€ä¸ªæ²¡å¿…è¦çš„åŠŸèƒ½ï¼Œå°±æ˜¯$.extendå¦‚æœå‚æ•°ä¸­åªæœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™æ‰©å±•jqueryå¯¹è±¡ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162// æ­¤æ–¹æ³•ä¼šæ”¹å˜åŸå¯¹è±¡jQuery.extend = jQuery.fn.extend = function () { var options, name, src, copy, copyIsArray, clone, target = arguments[0] || {}, i = 1, // iè¡¨ç¤ºä»ç¬¬å‡ ä¸ªå‚æ•°å¼€å§‹å‘ç›®æ ‡å‚æ•°è¿›è¡Œåˆå¹¶ï¼Œé»˜è®¤ä»ç¬¬2ä¸ªå‚æ•°å¼€å§‹å‘ç¬¬1ä¸ªå‚æ•°è¿›è¡Œåˆå¹¶ length = arguments.length, deep = false; // é»˜è®¤ä¸ºæµ…åº¦æ‹·è´ // å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç”¨æ¥è®¾ç½®deepçš„booleanå€¼ï¼Œåˆ™å°†targetè®¾ç½®ä¸ºä¸‹ä¸€ä¸ªå‚æ•° if (typeof target === &quot;boolean&quot;) { deep = target; target = arguments[i] || {}; i++; } // åˆ¤æ–­ç›®æ ‡å‚æ•°çš„ç±»å‹ï¼Œè‹¥ç›®æ ‡å‚æ•°æ—¢ä¸æ˜¯objectç±»å‹ï¼Œä¹Ÿä¸æ˜¯functionç±»å‹ï¼Œåˆ™ä¸ºç›®æ ‡å‚æ•°é‡æ–°èµ‹å€¼ if (typeof target !== &quot;object&quot; &amp;&amp; typeof target !== &quot;function&quot;) { target = {}; } // ä»ç¬¬iä¸ªå‚æ•°å¼€å§‹ for (; i &lt; length; i++) { // è·å–ç¬¬iä¸ªä¸ä¸ºnullæˆ–undefinedçš„å‚æ•° if ((options = arguments[i]) != null) { for (name in options) { src = target[name]; copy = options[name]; // é˜²æ­¢å¾ªç¯å¼•ç”¨ if (name === &quot;__proto__&quot; || target === copy) { continue; } // è‹¥deepä¸ºtrueï¼Œä¸”å½“å‰å‚æ•°ä¸­nameå­—æ®µçš„å€¼å­˜åœ¨ä¸”ä¸ºobjectç±»å‹æˆ–Arrayç±»å‹ï¼Œåˆ™è¿›è¡Œæ·±åˆå¹¶ if (deep &amp;&amp; copy &amp;&amp; (isPlainObject(copy) || (copyIsArray = Array.isArray(copy)))) { // å¦‚æœcopyæ˜¯æ•°ç»„ç±»å‹ï¼Œåˆ™åˆ¤æ–­ç›®æ ‡å‚æ•°ä¸­nameå­—æ®µçš„å€¼æ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨åˆ™ä½¿ç”¨åŸæ¥çš„ï¼Œå¦åˆ™è¿›è¡Œåˆå§‹åŒ– if (copyIsArray &amp;&amp; !Array.isArray(src)) { clone = []; } else if (!copyIsArray &amp;&amp; !isPlainObject(src)) { clone = {}; } else { clone = src; } copyIsArray = false; target[name] = merge(deep, clone, copy); // deepä¸ºfalseï¼Œè¡¨ç¤ºæµ…æ‹·è´ï¼Œç›´æ¥è¿›è¡Œèµ‹å€¼ // æˆ–è€…copyä¸ä¸ºObjectå¯¹è±¡ã€æ•°ç»„ï¼Œåˆ™ç›´æ¥èµ‹å€¼ } else if (copy !== undefined) { // è‹¥åŸå¯¹è±¡å­˜åœ¨nameå±æ€§ï¼Œåˆ™ç›´æ¥è¦†ç›–æ‰ï¼›è‹¥ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–°çš„å±æ€§ target[name] = copy; } } } } // è¿”å›ä¿®æ”¹åçš„ç›®æ ‡å‚æ•° return target;}; é™„1ï¼šjqueryé‡æ„äº†çš„ä¸€æ®µä»£ç 123456789101112if (deep &amp;&amp; copy &amp;&amp; (jQuery.isPlainObject(copy) || (copyIsArray = Array.isArray(copy)))) { if (copyIsArray) { copyIsArray = false; clone = src &amp;&amp; Array.isArray(src) ? src : []; } else { clone = src &amp;&amp; jQuery.isPlainObject(src) ? src : {}; } target[name] = jQuery.extend(deep, clone, copy);} else if ( copy !== undefined ) { target[name] = copy;} 1234567891011121314if (deep &amp;&amp; copy &amp;&amp; (isPlainObject(copy) || (copyIsArray = Array.isArray(copy)))) { if (copyIsArray &amp;&amp; !Array.isArray(src)) { clone = []; } else if (!copyIsArray &amp;&amp; !isPlainObject(src)) { clone = {}; } else { clone = src; } copyIsArray = false; target[name] = merge(deep, clone, copy);} else if (copy !== undefined) { target[name] = copy;} ä»£ç æ˜æ˜¾ä¸‹é¢å¥½çœ‹äº†è®¸å¤šï¼Œå¯ä»¥å­¦ä¹ ä¸€ä¸‹è¿™ç§é‡æ„æ–¹å¼ é™„2ï¼šisEmptyObjectã€isPlainObject1.isEmptyObject1234567891011isEmptyObject: function (obj) { var name; for (name in obj) { return false; } return true;}// è¿˜å¯ä»¥åˆ©ç”¨JSON.stringifyJSON.stringify(obj) == &quot;{}&quot; 2.isPlainObject123456789101112function isPlainObject (target) { // 1.å…ˆæ’é™¤æ˜æ˜¾ä¸æ˜¯Objectçš„ if (!target || Object.prototype.toString.call(target) !== &quot;[object Object]&quot;) return false; // 2.åˆ¤æ–­æ˜¯å¦æœ‰åŸå‹ï¼Œæ²¡æœ‰åŸå‹çš„æ˜¯ç®€å•å¯¹è±¡ const proto = Object.getPrototypeOf(target); if (!proto) return true; // 3.åˆ¤æ–­å…¶æ„é€ å‡½æ•°æ˜¯å¦ä¸º Object const ctor = proto.constructor; return typeof ctor === &quot;function&quot; &amp;&amp; ctor === Object;} å‚è€ƒhttps://blog.csdn.net/weixin_33694172/article/details/89369987","link":"/2021/05/06/Js/%E5%A6%82%E4%BD%95%E7%BB%99%E5%AF%B9%E8%B1%A1%E8%AE%BE%E7%BD%AE%E9%BB%98%E8%AE%A4%E5%80%BC/"},{"title":"ã€æºç è§£è¯»ã€‘crossventæºç è§£è¯»","text":"å…¶å®å°±æ˜¯ä¸€ä¸ªå°è£…äº‹ä»¶ç»‘å®šçš„åº“ï¼Œä½†æ˜¯çœ‹åˆ°äº†ä¸€äº›æŠ€å·§è®°å½•ä¸‹æ¥githubåœ°å€ï¼šhttps://github.com/bevacqua/crossvent/blob/master/src/crossvent.js ä»å‡ºå£å¼€å§‹12345module.exports = { add: addEvent, remove: removeEvent, fabricate: fabricateEvent}; addå’Œremoveå‡½æ•°addEventå®é™…ä¸Šå°±æ˜¯åˆ¤æ–­windowæ˜¯å¦æœ‰addEventListenerï¼Œå¦‚æœæ²¡æœ‰å°±ç”¨attachEventï¼ŒremoveåŒç† 1234567891011121314151617181920212223242526var addEvent = addEventEasy;var removeEvent = removeEventEasy;if (!global.addEventListener) { addEvent = addEventHard; removeEvent = removeEventHard;}function addEventEasy (el, type, fn, capturing) { return el.addEventListener(type, fn, capturing); // capturingå¦‚æœä¸ºtrueåˆ™åœ¨äº‹ä»¶æ•è·é˜¶æ®µæ‰§è¡Œï¼Œé»˜è®¤ä¸ºfalse}function addEventHard (el, type, fn) { return el.attachEvent('on' + type, wrap(el, type, fn));}function removeEventEasy (el, type, fn, capturing) { return el.removeEventListener(type, fn, capturing);}function removeEventHard (el, type, fn) { var listener = unwrap(el, type, fn); if (listener) { return el.detachEvent('on' + type, listener); }} è¿™é‡Œéœ€è¦æ³¨æ„ï¼šåœ¨ä¸æ”¯æŒaddEventListenerçš„æ—¶å€™ï¼Œä½¿ç”¨attachEventå’ŒdetachEventäº‹ä»¶å›è°ƒå‡½æ•°å¤šåšäº†ä¸€å±‚wrapå’Œunwrapå¤„ç† wrapå’Œunwrap1234567891011121314151617181920212223242526272829303132var hardCache = [];function wrap (el, type, fn) { // å¦‚æœå·²ç»æ³¨å†Œè¿‡è¿™ä¸ªtypeçš„äº‹ä»¶ï¼Œåˆ™unwrapå³ä»hardCacheåˆ é™¤äº‹ä»¶ï¼Œå¹¶åœ¨ä¸‹é¢é‡æ–°æ·»åŠ åˆ°hardCacheæ•°ç»„é‡Œ var wrapper = unwrap(el, type, fn) || wrapperFactory(el, type, fn); hardCache.push({ wrapper: wrapper, element: el, type: type, fn: fn }); return wrapper;}function unwrap (el, type, fn) { var i = find(el, type, fn); if (i) { var wrapper = hardCache[i].wrapper; hardCache.splice(i, 1); // free up a tad of memory return wrapper; }}function find (el, type, fn) { var i, item; for (i = 0; i &lt; hardCache.length; i++) { item = hardCache[i]; if (item.element === el &amp;&amp; item.type === type &amp;&amp; item.fn === fn) { return i; } }} å¯ä»¥çœ‹åˆ°æ˜¯åˆ©ç”¨ä¸€ä¸ªæ•°ç»„å­˜å‚¨äº‹ä»¶å›è°ƒï¼Œåœ¨ç»‘å®šäº‹ä»¶å’Œè§£ç»‘äº‹ä»¶åŒæ—¶å¯¹hardCacheæ•°ç»„è¿›è¡Œæ“ä½œï¼Œä½†æ˜¯ä¸ºå•¥è¦è¿™æ ·å‘¢ã€‚å¯ä»¥çœ‹åˆ°åœ¨wrapå‡½æ•°çš„ç¬¬ä¸€è¡Œvar wrapper = unwrap(el, type, fn) || wrapperFactory(el, type, fn); ï¼Œå®é™…ä¸Šå°±æ˜¯å¦‚æœä¹‹å‰æ²¡æœ‰ç»‘å®šè¿™ä¸ªtypeçš„äº‹ä»¶ï¼Œå°±è°ƒç”¨wrapperFactoryå¯¹fnè¿›è¡ŒäºŒæ¬¡å°è£…ï¼ŒwrapperFactoryè¿™ä¸ªå°è£…ä¸»è¦æ˜¯ä¸ºäº†è§£å†³eventå‚æ•°å†…çš„å±æ€§çš„å…¼å®¹æ€§ã€‚ è¿™å°±è§£é‡Šäº†åˆšæ‰æå‡ºçš„ç–‘é—®ï¼Œå°±æ˜¯å› ä¸ºå¤šäº†è¿™å±‚è§£å†³æµè§ˆå™¨å…¼å®¹æ€§çš„åŒ…è£…ï¼Œåœ¨è§£ç»‘äº‹ä»¶çš„æ—¶å€™ï¼Œå¦‚æœåªæ˜¯ä¼ é€’åŸæ¥çš„fnï¼Œåˆ™ä¸èƒ½è§£ç»‘äº‹ä»¶ï¼Œéœ€è¦ä¸€ä¸ªhardCacheæ•°ç»„æ¥å­˜å–äº‹ä»¶å›è°ƒã€‚ wrapperFactory12345678910function wrapperFactory (el, type, fn) { return function wrapper (originalEvent) { var e = originalEvent || global.event; e.target = e.target || e.srcElement; e.preventDefault = e.preventDefault || function preventDefault () { e.returnValue = false; }; e.stopPropagation = e.stopPropagation || function stopPropagation () { e.cancelBubble = true; }; e.which = e.which || e.keyCode; fn.call(el, e); };} è¿™å±‚å°è£…å¯ä»¥ä½¿eventçš„å„ä¸ªå±æ€§åœ¨ä¸åŒæµè§ˆå™¨ä¸‹è¡Œä¸ºä¸€è‡´ã€‚ addå’Œrevomeå°±è®²å®Œäº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¯¼å‡ºçš„æœ€åä¸€ä¸ªå‡½æ•°fabricate fabricate123456789101112131415161718192021function fabricateEvent (el, type, model) { var e = eventmap.indexOf(type) === -1 ? makeCustomEvent() : makeClassicEvent(); // åˆ¤æ–­äº‹ä»¶ç±»å‹ å¹¶ åˆ›å»º if (el.dispatchEvent) { // è§¦å‘äº‹ä»¶ el.dispatchEvent(e); } else { el.fireEvent('on' + type, e); } function makeClassicEvent () { // åˆ›å»ºåŸç”Ÿäº‹ä»¶ var e; if (doc.createEvent) { e = doc.createEvent('Event'); e.initEvent(type, true, true); } else if (doc.createEventObject) { e = doc.createEventObject(); } return e; } function makeCustomEvent () { // åˆ›å»ºè‡ªå®šä¹‰äº‹ä»¶ return new customEvent(type, { detail: model }); }} eventmapæ˜¯åŸç”Ÿäº‹ä»¶åçš„é›†åˆï¼Œå¦‚æœæ²¡æœ‰åœ¨eventmapæ‰¾åˆ°åˆ™åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œå¦åˆ™åˆ›å»ºä¸€ä¸ªåŸç”Ÿäº‹ä»¶ï¼Œç„¶åè§¦å‘äº‹ä»¶ã€‚ é‚£ä¹ˆeventmapæ˜¯æ€ä¹ˆç”Ÿæˆçš„å‘¢ï¼Œæˆ‘ä»¬ä¸‹é¢æ¥çœ‹çœ‹ è·å–åŸç”Ÿäº‹ä»¶åé›†åˆ1234567891011var eventmap = [];var eventname = '';var ron = /^on/;for (eventname in global) { if (ron.test(eventname)) { eventmap.push(eventname.slice(2)); }}module.exports = eventmap; å…¶å®å°±æ˜¯æ­£åˆ™åŒ¹é…windowä¸Šçš„å¼€å¤´ä¸ºonçš„å±æ€§å æ€»ç»“çœ‹åˆ°äº†æŒºå¤šæµè§ˆå™¨å…¼å®¹çš„å¤„ç†æ–¹å¼ï¼Œä»¥åŠåŸç”Ÿäº‹ä»¶åè·å–çš„éªšæ“ä½œï¼Œä¸è¿‡ä»æœ‰ä¸€äº›å…¼å®¹æ–¹å¼æ²¡çœ‹æ‡‚æ˜¯å…¼å®¹å“ªäº›æµè§ˆå™¨çš„ã€‚","link":"/2021/04/06/Js/%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/crossvent%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/"},{"title":"Koaæ´‹è‘±åŸå‹æºç è§£è¯»","text":"ç‰ˆæœ¬ï¼š2.13.1 application.jsæ„é€ å‡½æ•°12345constructor(options) { ... this.middleware = []; ...} æœ‰ä¸€ä¸ªmiddlewareå­˜å‡½æ•° useæ–¹æ³•12345use(fn) { ... this.middleware.push(fn); return this;} æ¯æ¬¡ä½¿ç”¨app.use()å°±ä¼šå§å›è°ƒå‡½æ•°pushåˆ°middlewareé‡Œ listenæ–¹æ³•1234listen(...args) { const server = http.createServer(this.callback()); return server.listen(...args);} åˆ›å»ºä¸€ä¸ªæœåŠ¡ï¼Œæ‰§è¡Œcallbackæ–¹æ³• callbackå’ŒhandleRequestæ–¹æ³•1234567891011121314151617181920callback() { const fn = compose(this.middleware); if (!this.listenerCount('error')) this.on('error', this.onerror); const handleRequest = (req, res) =&gt; { const ctx = this.createContext(req, res); // node åŸç”Ÿçš„ reqã€res å¯¹è±¡æŠŠå…¶ä¸­çš„å±æ€§æŒ‚è½½åˆ° ctx ä¸Š return this.handleRequest(ctx, fn); // è°ƒç”¨ }; return handleRequest;}handleRequest(ctx, fnMiddleware) { const res = ctx.res; const onerror = err =&gt; ctx.onerror(err); // å¤„ç†å“åº” const handleResponse = () =&gt; respond(ctx); return fnMiddleware(ctx).then(handleResponse).catch(onerror);} compseå‡½æ•°è¿”å›ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°ï¼Œåœ¨handleRequestæ‰§è¡Œä¸­é—´ä»¶å‡½æ•°ï¼Œå¦‚æœå…¨éƒ¨ resolve äº†å°±å¯ä»¥è°ƒç”¨ handleResponse å‘é€ç»™å®¢æˆ·ç«¯ æœ¬ç‰‡åšå®¢çš„é‡ç‚¹å°±æ˜¯composeæ˜¯æ€ä¹ˆå®ç°koaçš„æ´‹è‘±æ¨¡å‹çš„ koa-compose.js1234567891011app.use(async (ctx, next) =&gt; { console.log(&quot;1&quot;); await next(); console.log(&quot;4&quot;);});app.use(async (ctx, next) =&gt; { console.log(&quot;2&quot;); await next(); console.log(&quot;3&quot;);}); composeå‡½æ•°123456789101112131415161718192021222324252627function compose (middleware) { ... /** * @param {Object} context * @return {Promise} * @api public */ return function (context, next) { // last called middleware # let index = -1 return dispatch(0) function dispatch (i) { if (i &lt;= index) return Promise.reject(new Error('next() called multiple times')) index = i let fn = middleware[i] if (i === middleware.length) fn = next if (!fn) return Promise.resolve() try { return Promise.resolve(fn(context, dispatch.bind(null, i + 1))); } catch (err) { return Promise.reject(err) } } }} composeå‡½æ•°æ¥æ”¶middlewareæ•°ç»„ï¼Œdispatch(0)å³å¼€å§‹åˆ†å‘ä¸€å·ä¸­é—´ä»¶ã€‚ dispatch(0)å†…éƒ¨ï¼Œæ­¤æ—¶ fn ä¸ºä¸€å·ä¸­é—´ä»¶ï¼Œä¼šèµ°åˆ° try/catch å—ï¼Œå°è¯•æ‰§è¡ŒPromise.resolve(fn(context, dispatch.bind(null, i + 1)))ï¼Œå³ä¸€å·ä¸­é—´ä»¶æ­¤æ—¶è·å¾—å…¥å‚contextã€dispatch(1)ã€‚ ä¸€å·ä¸­é—´ä»¶å¼€å§‹æ‰§è¡Œï¼Œé‡åˆ° next()ï¼ˆå³dispatch(1)ï¼‰ï¼Œæ§åˆ¶æƒç§»äº¤ï¼Œæ‰§è¡Œ dispatch(1)ï¼Œæ­¤æ—¶äºŒå·ä¸­é—´ä»¶è·å¾—å…¥å‚contextã€dispatch(2)ã€‚ äºŒå·ä¸­é—´ä»¶å¼€å§‹æ‰§è¡Œï¼Œæ‰§è¡Œåˆ°await next()æ—¶ï¼Œå†é‡å¤ä¸Šè¿°é€»è¾‘ï¼Œdispatch(2)ï¼Œä½†æ˜¯è¿™ä¸€æ¬¡ä¼šåœåœ¨è¿™é‡Œï¼š 123let fn = middleware[i];if (i === middleware.length) fn = next;if (!fn) return Promise.resolve(); fn = nextï¼Œè¿™é‡Œçš„ next ç”±äºå¹¶æ²¡æœ‰å€¼ï¼Œæ‰€ä»¥ä¼šç›´æ¥ return ä¸€ä¸ªç«‹å³ resolve çš„ Promiseã€‚ä¹Ÿå°±æ˜¯è¯´äºŒå·ä¸­é—´ä»¶å†…éƒ¨çš„ await next()ä¼šç«‹åˆ»è¿”å›ã€‚ äºŒå·ä¸­é—´ä»¶åšå®Œè‡ªå·±çš„äº‹åï¼Œç›¸å½“äºä¸€å·ä¸­é—´ä»¶å†…éƒ¨çš„await next()è¿”å›äº†ï¼Œå› æ­¤æ§åˆ¶æƒå°±å½’è¿˜ç»™ä¸€å·ä¸­é—´ä»¶ã€‚ å¦‚æœä¸­é—´ä»¶ä¸­çš„next()æ–¹æ³•æŠ¥é”™äº†æ€ä¹ˆåŠã€‚123456789101112131415ctx.onerror = function { this.app.emit('error', err, this);};listen(){ const fnMiddleware = compose(this.middleware); if (!this.listenerCount('error')) this.on('error', this.onerror); const onerror = err =&gt; ctx.onerror(err); fnMiddleware(ctx).then(handleResponse).catch(onerror);}onerror(err) { // ä»£ç çœç•¥ // ...} ç­”ï¼šä¸­é—´ä»¶é“¾é”™è¯¯ä¼šç”±ctx.onerroræ•è·ï¼Œè¯¥å‡½æ•°ä¸­ä¼šè°ƒç”¨this.app.emit('error', err, this)ï¼ˆå› ä¸ºkoaç»§æ‰¿è‡ªEmitterï¼Œæ‰€ä»¥æœ‰emitå’Œonç­‰æ–¹æ³•ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨app.on('error', (err) =&gt; {})ï¼Œæˆ–è€…app.onerror = (err) =&gt; {}è¿›è¡Œæ•è·ã€‚ å‚è€ƒæ–‡ç« https://juejin.cn/post/6844904088220467213#heading-16https://linbudu.top/posts/2020/02/25/koa%E6%BA%90%E7%A0%81%E7%B2%BE%E8%AF%BB.html#new-%E4%B8%80%E4%B8%AA-koa-%EF%BC%8C%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88%EF%BC%9F","link":"/2021/02/28/node.js/Koa%E6%B4%8B%E8%91%B1%E5%8E%9F%E5%9E%8B%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/"},{"title":"å°¤é›¨æºªfrontend Masterè¯¾ç¨‹ç¬”è®°","text":"1.å“åº”å¼ç›®çš„å®ç°ä¸€ä¸ªç¥å¥‡çš„å‡½æ•°autoï¼Œä¼šåœ¨state.countæ”¹å˜åï¼Œè‡ªåŠ¨è¿è¡Œé‡Œé¢çš„å‡½æ•° 12345autoRun(() =&gt; { document.getElementById(&quot;app&quot;).innerText = state.count;})state.count++; // é‡æ–°æ‰§è¡ŒautoRunå†…çš„å‡½æ•° ç¬¬ä¸€æ­¥ getterå’Œsetteréœ€è¦èƒ½ç›‘å¬åˆ°å¯¹è±¡å†…å±æ€§çš„æ”¹å˜ å®ç°æ•ˆæœ12345const obj = { foo: 123 }observer(obj);obj.foo // éœ€è¦æ‰“å°: 'getting key &quot;foo&quot;: 123'obj.foo = 234 // éœ€è¦æ‰“å°: 'setting key &quot;foo&quot; to 234'obj.foo // éœ€è¦æ‰“å°: 'getting key &quot;foo&quot;: 234' å®ç°æ–¹å¼12345678910111213141516function observer (obj) { Object.keys(obj).forEach(key =&gt; { // ä¿å­˜å±æ€§åˆå§‹å€¼ let internalValue = obj[key] Object.defineProperty(obj, key, { get () { console.log(`getting key &quot;${key}&quot;: ${internalValue}`) return internalValue }, set (newValue) { console.log(`setting key &quot;${key}&quot; to: ${newValue}`) internalValue = newValue } }) })} ç¬¬äºŒæ­¥ ä¾èµ–æ”¶é›† Depå®ç°æ•ˆæœå³ä¸€ä¸ªå‘å¸ƒè®¢é˜…æ¨¡å¼ 12345678910const dep = new Dep()autoRun(() =&gt; { dep.depend() console.log('updated')})// æ‰“å°: &quot;updated&quot;dep.notify()// æ‰“å°: &quot;updated&quot; å®ç°æ–¹å¼123456789101112131415161718192021222324252627class Dep { constructor() { this.subs = [] }; depend() { // è®¢é˜…å‡½æ•° if (activeUpdate) { this.subs.push(activeUpdate); // æŠŠå…¨å±€å˜é‡activeUpdateå­˜çš„å‡½æ•°æ”¾å…¥è®¢é˜…è€…åˆ—è¡¨ } } notify() { // å‘å¸ƒå‡½æ•° this.subs.forEach(sub =&gt; sub()); }}let activeUpdate = null // æ”¾ç½®ä¾èµ–å‡½æ•°function autoRun (update) { const wrappedUpdate = () =&gt; { activeUpdate = wrappedUpdate // æŠŠwrappedUpdateå­˜èµ·æ¥ update() // åœ¨updateå†…éƒ¨è°ƒç”¨dep.depend()æ”¶é›†ä¾èµ– activeUpdate = null } wrappedUpdate()} ç¬¬ä¸‰æ­¥ æ•´åˆä¸€ã€äºŒ1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859class Dep { constructor() { this.subs = [] }; depend() { if (activeUpdate) { this.subs.push(activeUpdate); } } notify() { this.subs.forEach(sub =&gt; sub()); }}export class Observer { constructor(obj) { this.dep = new Dep(); this.walk(obj); } walk(obj) { Object.keys(obj).forEach(key =&gt; { this.defineReactive(obj, key); }) } defineReactive(obj, key) { let that = this; let internalValue = obj[key]; Object.defineProperty(obj, key, { enumerable: false, configurable: false, get() { that.dep.depend(); return internalValue; }, set(newVal) { const isChanged = internalValue !== newVal; if (isChanged) { internalValue = newVal; that.dep.notify(); } } }) }}let activeUpdate = null;export function autoRun (update) { const wrappedUpdate = () =&gt; { activeUpdate = wrappedUpdate // æŠŠwrappedUpdateå­˜èµ·æ¥ update() // åœ¨updateå†…éƒ¨è°ƒç”¨dep.depend()æ”¶é›†ä¾èµ– activeUpdate = null } wrappedUpdate()} 2. è™šæ‹ŸDOM2.1è™šæ‹ŸDOMå’ŒçœŸå®çš„DOMçš„å·®å¼‚1.èµ„æºæ¶ˆè€—é—®é¢˜ ä½¿ç”¨javascriptæ“ä½œçœŸå®DOMæ˜¯éå¸¸æ¶ˆè€—èµ„æºçš„ï¼Œè™½ç„¶å¾ˆå¤šæµè§ˆå™¨åšäº†ä¼˜åŒ–ä½†æ˜¯æ•ˆæœä¸å¤§ã€‚ä½ çœ‹åˆ°è™šæ‹ŸDOMæ˜¯ä¸€ä¸ªçº¯javascriptå¯¹è±¡ã€‚è€ŒDOMèŠ‚ç‚¹æœ‰70ï¼‹ä¸ªå±æ€§ï¼Œç»§æ‰¿å±‚çº§æœ‰6ï¼Œ7å±‚ï¼ˆæ–‡æœ¬èŠ‚ç‚¹6å±‚ï¼Œå…ƒç´ èŠ‚ç‚¹7å±‚ï¼‰,è®¿é—®ä¸€ä¸ªå±æ€§ï¼Œå¯èƒ½ä¼šè¿½æº¯å‡ é‡åŸå‹é“¾ã€‚ 2.æ‰§è¡Œæ•ˆç‡é—®é¢˜ å¦‚æœä½ è¦ä¿®æ”¹ä¸€ä¸ªçœŸå®DOMï¼Œä¸€èˆ¬è°ƒç”¨innerHTMLæ–¹æ³•ï¼Œé‚£æµè§ˆå™¨ä¼šæŠŠæ—§çš„èŠ‚ç‚¹ç§»é™¤å†æ·»åŠ æ–°çš„èŠ‚ç‚¹ï¼Œä½†æ˜¯åœ¨è™šæ‹ŸDOMä¸­ï¼Œåªéœ€è¦ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œå†æŠŠè™šæ‹ŸDOMæ¸²æŸ“åˆ°çœŸå®DOMä¸Šã€‚å¾ˆå¤šäººä¼šè¯¯è§£è™šæ‹ŸDOMæ¯”çœŸå®DOMé€Ÿåº¦å¿«ï¼Œå…¶å®è™šæ‹ŸDOMåªæ˜¯æŠŠDOMå˜æ›´çš„é€»è¾‘æå–å‡ºæ¥ï¼Œä½¿ç”¨javascriptè®¡ç®—å·®å¼‚ï¼Œå‡å°‘äº†æ“ä½œçœŸå®DOMçš„æ¬¡æ•°ï¼Œåªåœ¨æœ€åä¸€æ¬¡æ‰æ“ä½œçœŸå®DOMï¼Œæ‰€ä»¥å¦‚æœä½ çš„åº”ç”¨æœ‰å¤æ‚çš„DOMå˜æ›´æ“ä½œï¼Œè™šæ‹ŸDOMä¼šæ¯”è¾ƒå¿«ã€‚ 3.è™šæ‹ŸDOMè¿˜æœ‰å…¶ä»–å¥½å¤„ å…¶å®è™šæ‹ŸDOMè¿˜å¯ä»¥åº”ç”¨åœ¨å…¶ä»–åœ°æ–¹ï¼Œå› ä¸ºä»–ä»¬åªæ˜¯æŠ½è±¡èŠ‚ç‚¹ï¼Œå¯ä»¥æŠŠå®ƒç¼–è¯‘æˆå…¶ä»–å¹³å°ï¼Œä¾‹å¦‚androidã€iosã€‚å¸‚é¢ä¸Šåˆ©ç”¨å½¢åŒæ¶æ„æ¨¡å¼çš„åº”ç”¨æœ‰React Nativeï¼ŒWeeksï¼ŒNative scriptï¼Œå°±æ˜¯åˆ©ç”¨è™šæ‹ŸDOMçš„ç‰¹ç‚¹å®ç°çš„ã€‚ 2.2 è™šæ‹ŸDOMåœ¨çº¿æŸ¥çœ‹ä½¿ç”¨Vue Template Explorerå¯ä»¥æŸ¥çœ‹Vueæ˜¯å¦‚ä½•è½¬æ¢è™šæ‹ŸDOMçš„ã€‚ è®¿é—®åœ°å€ 3.templateå’Œjsxå¯¹æ¯”æ¨¡ç‰ˆçš„ä¼˜åŠ¿ï¼šæ¨¡ç‰ˆæ˜¯ä¸€ç§æ›´é™æ€æ›´å…·æœ‰çº¦æŸçš„è¡¨ç°å½¢æ€ï¼Œå®ƒå¯ä»¥é¿å…å‘æ˜æ–°è¯­æ³•ï¼Œä»»ä½•å¯ä»¥è§£æHTMLçš„å¼•æ“éƒ½å¯ä»¥ä½¿ç”¨å®ƒï¼Œè¿ç§»æˆæœ¬æ›´ä½ï¼›å¦å¤–æœ€é‡è¦çš„æ˜¯é™æ€æ¨¡ç‰ˆå¯ä»¥åœ¨ç¼–è¯‘è¿›è¡Œæ¯”è¾ƒå¤šçš„ä¼˜åŒ–ï¼Œè€ŒåŠ¨æ€è¯­è¨€å°±æ²¡æ³•å®ç°äº†ã€‚ jsxçš„ä¼˜åŠ¿ï¼šæ›´çµæ´»ï¼Œä»»ä½•çš„jsä»£ç éƒ½å¯ä»¥æ”¾åœ¨jsxä¸­æ‰§è¡Œå®ç°ä½ æƒ³è¦çš„æ•ˆæœï¼Œä½†æ˜¯ä¹Ÿç”±äºä»–çš„çµæ´»æ€§å¯¼è‡´åœ¨ç¼–è¯‘é˜¶æ®µä¼˜åŒ–æ¯”è¾ƒå›°éš¾ï¼Œåªèƒ½é€šè¿‡å¼€å‘è€…è‡ªå·±ä¼˜åŒ–ã€‚ 4. å‡½æ•°ç»„ä»¶å‡½æ•°ç»„ä»¶å°±æ˜¯ä¸åŒ…å«stateå’Œpropsçš„ç»„ä»¶ï¼Œå°±åƒå®ƒçš„åå­—ä¸€æ ·ï¼Œä½ å¯ä»¥ç†è§£ä¸ºä»–å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨Vueä¸­å£°æ˜ä¸€ä¸ªå‡½æ•°ç»„ä»¶ä»£ç å¦‚ä¸‹ï¼š 1234const foo = { functional: true, render: h =&gt; h('div', 'foo')} ç‰¹ç‚¹ ç»„ä»¶ä¸æ”¯æŒå®ä¾‹åŒ–ã€‚ ä¼˜åŒ–æ›´ä¼˜ï¼Œå› ä¸ºåœ¨Vueä¸­å®ƒçš„æ¸²æŸ“å‡½æ•°æ¯”çˆ¶çº§ç»„ä»¶æ›´æ—©è¢«è°ƒç”¨ï¼Œä½†æ˜¯ä»–å¹¶ä¸ä¼šå ç”¨å¾ˆå¤šèµ„æºï¼Œå› ä¸ºå®ƒæ²¡æœ‰ä¿å­˜æ•°æ®å’Œå±æ€§ï¼Œæ‰€ä»¥å®ƒå¸¸ç”¨äºä¼˜åŒ–ä¸€ä¸ªæœ‰å¾ˆå¤šèŠ‚ç‚¹çš„ç»„ä»¶ã€‚ å®¹æ˜“æ‰©å±•ï¼Œå¦‚æœä½ çš„ç»„ä»¶åªæ˜¯ç”¨æ¥æ¥æ”¶ propç„¶åæ˜¾ç¤ºæ•°æ®ï¼Œæˆ–è€…ä¸€ä¸ªæ²¡æœ‰çŠ¶æ€çš„æŒ‰é’®ï¼Œå»ºè®®ä½¿ç”¨å‡½æ•°ç»„ä»¶ã€‚ å‡½æ•°ç»„ä»¶æ²¡æœ‰thisï¼Œè·å–propå¯ä»¥é€šè¿‡renderå‡½æ•°çš„ç¬¬äºŒå‚æ•°å¾—åˆ°render(h, context) 12345678910111213Vue.component('example', { functional: true, // å£°æ˜æ˜¯å‡½æ•°ç»„ä»¶ // å› ä¸ºå‡½æ•°ç»„ä»¶æ²¡æœ‰this,å¯ä»¥é€šè¿‡renderç¬¬äºŒå‚æ•°è·å–ç›¸å…³ä¿¡æ¯ render(h, { props: { tags } }) { // context.slots() é€šè¿‡slotsæ–¹æ³•è·å–å­èŠ‚ç‚¹ // context.children è·å–å­ç»„ä»¶ // context.parent çˆ¶ç»„ä»¶ï¼Œå› ä¸ºå‡½æ•°ç»„ä»¶å®æŒ‚è½½åˆ°æ ¹èŠ‚ç‚¹ä¸Šï¼Œä¹Ÿå°±æ˜¯&lt;div id=&quot;app&quot;&gt;&lt;/div&gt; // context.props ç»„ä»¶å±æ€§ï¼Œè¿™é‡Œå¾—åˆ°tagså±æ€§ // return h('div', this.tags.map((tag, i) =&gt; h(tag, i))) // é€šè¿‡å‡½æ•°ç»„ä»¶å®ç°æ ‡ç­¾åŠ¨æ€æ¸²æŸ“ return h('div', tags.map((tag, i) =&gt; h(tag, i))) }}) 5.HOC é«˜é˜¶ç»„ä»¶ é«˜é˜¶ç»„ä»¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ”¶ä¸€ä¸ªç»„ä»¶ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œç±»ä¼¼è£…é¥°è€…æ¨¡å¼ è¿™é‡Œä¸å±•å¼€è¯´äº†ï¼Œå¤§æ¦‚åˆ—ä¸€ä¸‹å†™æ³•ï¼Œä¸‹é¢æ¨¡æ‹Ÿäº†ä¸€ä¸ªå›¾ç‰‡éª¨æ¶ 123456789101112131415161718192021222324252627282930313233343536373839// mock APIfunction fetchURL (username, cb) { setTimeout(() =&gt; { // hard coded, bonus: exercise: make it fetch from gravatar! cb('https://avatars3.githubusercontent.com/u/6128107?v=4&amp;s=200') }, 500)}const Avatar = { props: ['src'], template: `&lt;img :src=&quot;src&quot;&gt;`}function withAvatarURL (InnerComponent) { return { props: { attrs: this.$attrs, // 2.4 only username: String }, data () { return { url: 'http://via.placeholder.com/200x200' } }, created () { fetchURL(this.username, (url) =&gt; { this.url = url }) }, render (h) { return h(InnerComponent, { props: { src: this.url } }) } }}const SmartAvatar = withAvatarURL(Avatar)new Vue({ el: '#app', components: { SmartAvatar }}) é‡ç”¨æ€§ï¼šå› ä¸ºminxinå¯¹åŸç»„ä»¶å…·æœ‰ä¾µå…¥æ€§ï¼Œè¿™ä¼šå¯¼è‡´åŸæ¥ç»„ä»¶çš„å¯é‡ç”¨æ€§é™ä½ï¼Œè€Œé«˜é˜¶ç»„ä»¶ä¸ä¼šï¼Œé«˜é˜¶ç»„ä»¶å¯¹åŸç»„ä»¶åªæ˜¯ä¸€ä¸ªè°ƒç”¨å…³ç³»ï¼Œå¹¶æ²¡æœ‰ä¿®æ”¹åŸæ¥ç»„ä»¶ä»»ä½•å†…å®¹ã€‚ å¯æµ‹è¯•æ€§ï¼šå› ä¸ºé«˜é˜¶ç»„ä»¶åªæ˜¯ä¸€ä¸ªåµŒå¥—å…³ç³»ï¼Œåœ¨ç»„ä»¶æµ‹è¯•çš„æ—¶å€™ï¼Œå¯ä»¥å•ç‹¬çš„æµ‹è¯•åŸå§‹ç»„ä»¶å’Œé«˜é˜¶ç»„ä»¶ã€‚ å±‚çº§é—®é¢˜ï¼šé«˜é˜¶ç»„ä»¶ä¹Ÿæœ‰ä»–çš„å¼Šç«¯ï¼Œå¦‚æœä½ é«˜é˜¶ç»„ä»¶åµŒå¥—å±‚çº§å¤ªæ·±ï¼Œä¼šå¯¼è‡´å‡ºé”™çš„æ—¶å€™è°ƒè¯•å›°éš¾çš„é—®é¢˜ï¼Œæ‰€ä»¥åˆ°åº•ä½¿ç”¨é«˜é˜¶ç»„ä»¶å’Œminxinéœ€è¦çœ‹å®é™…åœºæ™¯ã€‚ 6. è·¯ç”±å®ç°æ ¹æ®è·¯ç”±åŒ¹é…æ˜¾ç¤ºç»„ä»¶ï¼Œå¹¶è·¯ç”±åŒ¹é…å‚æ•° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869// ç»„ä»¶const Foo = { props: ['id'], template: `&lt;div&gt;foo with id: {{ id }}&lt;/div&gt;`}const Bar = { template: `&lt;div&gt;bar&lt;/div&gt;` }const NotFound = { template: `&lt;div&gt;not found!&lt;/div&gt;` }// è·¯ç”±è¡¨const routeTable = { '/foo/:id': Foo, '/bar': Bar}// å°†è·¯ç”±è¡¨çš„é”®é€šè¿‡ path-to-regexpåº“ è¿›è¡Œæ­£åˆ™å°è£…// ä¸‹é¢è¿™ä¸ªæ•°ç»„å‚¨å­˜ï¼šç»„ä»¶ã€æ­£åˆ™å¯¹è±¡ã€åŒ¹é…çš„nameconst compiledRoutes = []Object.keys(routeTable).forEach(key =&gt; { const dynamicSegments = [] const regex = pathToRegexp(key, dynamicSegments) const component = routeTable[key] compiledRoutes.push({ component, regex, dynamicSegments })})// ç›‘å¬hashchangeï¼Œå°†æ”¹å˜çš„è·¯ç”±èµ‹å€¼ç»™urlwindow.addEventListener('hashchange', () =&gt; { app.url = window.location.hash.slice(1)})const app = new Vue({ el: '#app', data: { url: window.location.hash.slice(1) }, render (h) { const path = '/' + this.url let componentToRender // è¦æ¸²æŸ“çš„ç»„ä»¶ let props = {} // è·¯ç”±åŒ¹é…åˆ°çš„å€¼ compiledRoutes.some(route =&gt; { const match = route.regex.exec(path) // æ‰§è¡ŒåŒ¹é… componentToRender = NotFound if (match) { componentToRender = route.component // è®¾ç½®å‚æ•° route.dynamicSegments.forEach((segment, index) =&gt; { props[segment.name] = match[index + 1] }) return true } }) return h('div', [ h(componentToRender, { props }), h('a', { attrs: { href: '#foo/123' }}, 'foo 123'), ' | ', h('a', { attrs: { href: '#foo/234' }}, 'foo 234'), ' | ', h('a', { attrs: { href: '#bar' }}, 'bar'), ' | ', h('a', { attrs: { href: '#garbage' }}, 'garbage') ]) }})","link":"/2021/02/18/Vue/%E5%B0%A4%E9%9B%A8%E6%BA%AAfrontend%20Master%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"title":"MPAé¦–å±åŠ è½½é€Ÿç‡ä¼˜åŒ–å®æˆ˜","text":"èƒŒæ™¯â€‹ å­¦æ ¡å®éªŒå®¤çš„é¡¹ç›®ï¼Œå› ä¸ºå­¦æ ¡åªå¼€æ”¾ç»™æˆ‘ä»¬ä¸€ä¸ªç«¯å£ï¼Œæ‰€ä»¥åªèƒ½æŠŠåå°ç®¡ç†å’Œå­¦ç”Ÿç«¯åˆå¹¶æˆå¤šé¡µåº”ç”¨ï¼Œæˆ‘æ˜¯åšåå°ç®¡ç†çš„ï¼Œè€å¸ˆè¦æ±‚æŸä¸ªåŠŸèƒ½è¦åŠ ä¸Šä»£ç é«˜äº®ï¼Œåœ¨å…¨å±€å¼•å…¥highlight.jsåå‘ç°é¦–å±åŠ è½½é€Ÿç‡ä¸è¡Œäº†ï¼Œè®°å½•ä¸€ä¸‹å‘ç°æ›´å¤šé—®é¢˜å¹¶ä¼˜åŒ–çš„è¿‡ç¨‹ã€‚ æœ‰ç”¨çš„ä¼˜åŒ–1. HighLight.jsè¢«æ”¾åœ¨é¦–å±åŠ è½½äº†é¦–å…ˆç”¨webpack-bundle-analyerè¿›è¡Œæ„å»ºåˆ†æ å‘ç°äº†ä¸¤ä¸ªå·¨å¤§çš„åŒ…chunk-vendors.44cd6d2c.jsæœ‰2.4MBï¼Œchunk-94715762.bb0c42f0.jsæœ‰1.4MBï¼Œä¸å¹¸çš„æ˜¯cç«¯éœ€è¦åœ¨é¦–å±åŒæ—¶ä¸‹è½½ä¸¤ä¸ªå¤§åŒ…ï¼ˆæ­¤å¤„æœ‰è¯¯ï¼Œåé¢è®²è§£ï¼Œæ­£ç¡®çš„æ˜¯å·¦è¾¹è¿™ä¸ªåŒ…åŠ å…¥å£ï¼‰æ‰å¼€å§‹æ¸²æŸ“ï¼Œè€Œcç«¯å¹¶æ²¡æœ‰ç”¨åˆ°highlight.jsä½†æ˜¯ä»–ä¹Ÿå¾—ç­‰å¾…ä¸‹è½½ã€‚ ç„¶åæŠŠhighlight.jsæ”¾åˆ°å°è£…çš„ç»„ä»¶é‡Œå¼•ç”¨ï¼Œç„¶åæ‰“åŒ…åˆ†æ å‘ç°å°±åˆ†ç¦»äº†ï¼Œ2.4MBçš„åŒ…å˜æˆäº†1.5MB 2. ä¸¤ä¸ªåº”ç”¨ä½¿ç”¨çš„elementç»„ä»¶æ²¡æœ‰åˆ†ç¦»ä½†æ˜¯åˆå‘ç°äº†æ–°çš„é—®é¢˜â€”â€”element-uiä¸¤ä¸ªåº”ç”¨ä½¿ç”¨çš„ç»„ä»¶è¢«æ‰“åŒ…åˆ°äº†ä¸€èµ·ï¼Œå³æ—¶cç«¯æ²¡æœ‰ä½¿ç”¨åˆ°è¯¸å¦‚el-uploadã€el-paginationç­‰ç»„ä»¶ï¼Œä½†æ˜¯ä¹Ÿè¦é¦–å±ä¹Ÿè¦ä¸‹è½½ï¼Œæƒ³äº†æƒ³highlight.jsè¢«æ”¾åˆ°bç«¯å…¥å£æ–‡ä»¶å¼•å…¥å°±è¢«æ‰“è¿›è¿™ä¸ªåŒ…é‡Œã€‚ æ˜¯ä¸æ˜¯ä¸¤ä¸ªå…¥å£ä½¿ç”¨äº†åŒä¸€ä¸ªelementæŒ‰éœ€å¼•å…¥æ–‡ä»¶çš„åŸå› ï¼Œç„¶åæˆ‘ç»™ä¸¤ä¸ªåº”ç”¨å„å¼€äº†è‡ªå·±çš„æŒ‰éœ€å¼•å…¥æ–‡ä»¶ã€‚æ‰“åŒ…åˆ†ææ²¡å•¥å˜åŒ–ã€‚ é—®äº†å¤§å“¥ï¼Œå¤§å“¥ç”©æ‰‹å°±æ˜¯ä¸€ä¸ªè¿æ¥https://www.cnblogs.com/HYZhou2018/p/10419703.html å¤§æ¦‚å°±æ˜¯vue-cli3çš„è„šæ‰‹æ¶é…ç½®è‡ªåŠ¨åˆ†åŒ…çš„æ—¶å€™æ˜¯é’ˆå¯¹å•é¡µåº”ç”¨çš„ï¼Œä¸‹é¢æ˜¯vue-cli3çš„é…ç½®é¡¹ splitChunksé»˜è®¤minChunksæ˜¯1ï¼Œä½†æ˜¯æˆ‘ä»¬æ˜¯å¤šé¡µåº”ç”¨å•Šï¼Œæ‰€ä»¥ä¸¤ä¸ªåº”ç”¨ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“å…¨è¢«æŠ½ç¦»åˆ°ä¸€ä¸ªchunk-vendor.jsäº†ã€‚ 123456789101112config.optimization.splitChunks({ cacheGroups: { vendors: { name: 'chunk-vendors', minChunks: 2, // è®¾ç½®ä¸º2ï¼Œä¸¤ä¸ªåº”ç”¨åŒæ—¶ä½¿ç”¨æ‰æŠ½ç¦» test: /node_modules/, priority: -10, chunks: 'initial' }, common: {} }}); å†æ¬¡æ‰“åŒ…åˆ†æ ä¸ä»…åˆ†ç¦»äº†ä¸€äº›ç»„ä»¶ï¼Œè¿˜æŠŠä¸€äº›ä½¿ç”¨åˆ°çš„ç¬¬ä¸‰æ–¹åº“ç»™åˆ†ç¦»äº†ï¼Œè¿™ä¸ª2.4MBçš„æ‰“åŒ…åˆ°æ­¤ä¸ºæ­¢å°±å˜æˆäº†1.2MBçš„åŒ…ã€‚ 2021/9/2 æ›´æ–°åœ¨ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼Œä¸€äº›node_modulesé‡Œçš„ç¬¬ä¸‰æ–¹åº“è¢«æ‰“åŒ…åˆ°ä¸šåŠ¡ä»£ç ä¸­äº†ï¼Œè¿™å°±å¯¼è‡´äº†æˆ‘ä»¬å°±ç®—åªæ˜¯æ›´æ–°ä¸šåŠ¡ä»£ç ï¼Œä½†æ˜¯ç”¨æˆ·ä¹Ÿéœ€è¦é‡æ–°ä¸‹è½½å½“å‰ç»„ä»¶å¼•ç”¨åˆ°çš„ç¬¬ä¸‰æ–¹åº“ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®æ›´ç»†ç²’åº¦çš„åˆ†åŒ…ï¼Œåœ¨cacheGroupsä¸­æ·»åŠ å¦‚ä¸‹é…ç½® 123456789101112131415161718teacher: { name: &quot;chunk-teacher&quot;, test: /node_modules/, minChunks: 1, chunks(chunk) { return chunk.name === &quot;teacher&quot;; }, priority: -1,},student: { name: &quot;chunk-student&quot;, test: /node_modules/, minChunks: 1, chunks(chunk) { return chunk.name === &quot;student&quot;; }, priority: -1,}, å¯ä»¥çœ‹åˆ°çº¢æ¡†åœˆèµ·æ¥çš„å°±æ˜¯æ–°åˆ†å‡ºæ¥çš„åŒ…ï¼Œé‡Œé¢åªæœ‰è¢«å¼•æ¬¡æ•°ä¸º1çš„ç¬¬ä¸‰æ–¹åº“ï¼Œä¿è¯äº†ä¸šåŠ¡å’Œä¾èµ–çš„æŠ½ç¦» èµ°è¿‡çš„å‘1.æ€ä¹ˆcodingåŒ…è¿˜æ˜¯åœ¨é¦–å±ä¸‹è½½äº†å·²ç»ä½¿ç”¨äº†è·¯ç”±æ‡’åŠ è½½ï¼Œä¸ºä»€ä¹ˆcodingåŒ…è¿˜æ˜¯åœ¨é¦–å±ä¸‹è½½äº†ï¼Œæˆ‘æ›¾ä¸€åº¦ä»¥ä¸ºæ˜¯æ²¡æœ‰syntax-dynamic-importè¿™ä¸ªæ’ä»¶çš„åŸå› ï¼Œè¿˜è£…è¿‡äº†è¯•äº†ä¸‹ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œè€Œä¸”webpackå·²ç»ä½¿ç”¨åŠ¨æ€importæ¥åšåˆ°æ‡’åŠ è½½äº†ã€‚ æŸ¥é˜…æ–‡ç« å‘ç° åŸæ¥ vue-cli3 é»˜è®¤ä¼šæŠŠæ‰€æœ‰é€šè¿‡import()æŒ‰éœ€åŠ è½½çš„javascriptæ–‡ä»¶åŠ ä¸Š prefetch ã€‚ prefetchæ˜¯ä»€ä¹ˆï¼Ÿåœ¨æ‰“åŒ…åçš„æ–‡ä»¶ä¸­ï¼ŒæŸ¥çœ‹index.htmlæˆ‘ä»¬ä¼šå‘ç°ç±»ä¼¼è¿™ä¸ª ã€‚ä¼šåœ¨é¡µé¢åŠ è½½å®Œæˆåï¼Œåˆ©ç”¨ç©ºé—²æ—¶é—´æå‰åŠ è½½è·å–ç”¨æˆ·æœªæ¥å¯èƒ½ä¼šè®¿é—®çš„å†…å®¹ã€‚ prefetché“¾æ¥ä¼šæ¶ˆè€—å®½å¸¦ï¼Œå¦‚æœæ˜¯åœ¨ç§»åŠ¨ç«¯ï¼Œè€Œä¸”å­˜åœ¨å¤§é‡çš„chunkï¼Œé‚£ä¹ˆå¯ä»¥å…³æ‰ prefetch é“¾æ¥ï¼Œæ‰‹åŠ¨é€‰æ‹©è¦æå‰è·å–çš„ä»£ç åŒºå—ã€‚ 12//æ‰‹åŠ¨é€‰å®šè¦æå‰è·å–çš„ä»£ç import(webpackPrefetch: true, './someAsyncComponent.vue') å…³é—­prefetch: (å®˜ç½‘ç¤ºä¾‹) 123456789101112131415// vue.config.jsmodule.exports = { chainWebpack: config =&gt; { // ç§»é™¤ prefetch æ’ä»¶ config.plugins.delete('prefetch') // æˆ–è€… // ä¿®æ”¹å®ƒçš„é€‰é¡¹ï¼š config.plugin('prefetch').tap(options =&gt; { options[0].fileBlacklist = options[0].fileBlacklist || [] options[0].fileBlacklist.push(/myasyncRoute(.)+?\\.js$/) return options }) }} 2. ç¬¬ä¸‰æ–¹åº“æ€ä¹ˆè¿™ä¹ˆå¤šé‡å¤çš„bn.js å¯ä»¥çœ‹åˆ°æœ‰8ä¸ªé‡å¤çš„bn.jsï¼Œä¸€ä¸ª40KBï¼Œgzipå10KBï¼Œç¦»è°±ã€‚ ä½†æ˜¯å¤§å°æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¯èƒ½ç”¨çš„ç‰ˆæœ¬ä¸åŒï¼Œç›®å‰æ²¡æœ‰å¥½çš„æ–¹æ³•æŠ½ç¦»ã€‚ã€‚ å…¶å®å¯ä»¥ç”¨cdnæ¥æï¼Œä½†æ˜¯ç¬¬ä¸‰æ–¹çš„cdnä¸ç¨³å®šï¼Œå°±æ²¡æã€‚ 3. æ‰“åŒ…åmini-css-extract-pluginè­¦å‘ŠConflicting orderå¯¹åº”çš„issusï¼šhttps://github.com/webpack-contrib/mini-css-extract-plugin/issues/250 æ˜¯ç”±äºç»„ä»¶ä½¿ç”¨é¡ºåºä¸ä¸€è‡´å¯¼è‡´çš„ã€‚","link":"/2021/02/14/Webpack/MPA%E9%A6%96%E5%B1%8F%E5%8A%A0%E8%BD%BD%E9%80%9F%E7%8E%87%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98/"},{"title":"é€‚é…å™¨æ¨¡å¼","text":"é€‚é…å™¨æ¨¡å¼çš„ä½œç”¨æ˜¯è§£å†³ä¸¤ä¸ªè½¯ä»¶å®ä½“é—´çš„æ¥å£ä¸å…¼å®¹çš„é—®é¢˜ã€‚ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ä¹‹åï¼ŒåŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½å·¥ä½œçš„ä¸¤ä¸ªè½¯ä»¶å®ä½“å¯ä»¥ä¸€èµ·å·¥ä½œã€‚ é€‚é…å™¨çš„åˆ«åæ˜¯åŒ…è£…å™¨(wrapper)ï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å¯¹ç®€å•çš„æ¨¡å¼ åœ¨ç¨‹åºå¼€å‘ä¸­æœ‰è®¸å¤šè¿™æ ·çš„åœºæ™¯ï¼šå½“æˆ‘ä»¬è¯•å›¾è°ƒç”¨æ¨¡å—æˆ–è€…å¯¹è±¡çš„æŸä¸ªæ¥å£æ—¶ï¼Œå´å‘ç°è¿™ä¸ªæ¥å£çš„æ ¼å¼å¹¶ä¸ç¬¦åˆç›®å‰çš„éœ€æ±‚ã€‚ è¿™æ—¶å€™æœ‰ä¸¤ç§è§£å†³åŠæ³•ï¼Œç¬¬ä¸€ç§æ˜¯ä¿®æ”¹åŸæ¥çš„æ¥å£å®ç°ï¼Œä½†å¦‚æœåŸæ¥çš„æ¨¡å—å¾ˆå¤æ‚ï¼Œæˆ–è€…æˆ‘ä»¬æ‹¿åˆ°çš„æ¨¡å—æ˜¯ä¸€æ®µåˆ«äººç¼–å†™çš„ç»è¿‡å‹ç¼©çš„ä»£ç ï¼Œä¿®æ”¹åŸæ¥å£å°±æ˜¾å¾—ä¸å¤ªç°å®äº†ã€‚ç¬¬äºŒç§åŠæ³•æ˜¯åˆ›å»ºä¸€ä¸ªé€‚é…å™¨ï¼Œå°†åŸæ¥å£è½¬æ¢ä¸ºå®¢æˆ·å¸Œæœ›çš„å¦ä¸€ä¸ªæ¥å£ï¼Œå®¢æˆ·åªéœ€è¦å’Œé€‚é…å™¨æ‰“äº¤é“ã€‚ æ•…äº‹èƒŒæ™¯ç°åœ¨ä½¿ç”¨ è°·æ­Œåœ°å›¾ å’Œ ç™¾åº¦åœ°å›¾ åœ¨é¡µé¢å±•ç°åœ°å›¾ 1234567891011121314151617let googleMap = { show: function () { console.log(&quot;å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾&quot;); },};let baiduMap = { show: function () { console.log(&quot;å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾&quot;); },};let renderMap = function (map) { if (map.show instanceof Function) { map.show(); }};renderMap(googleMap); // è¾“å‡º:å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾renderMap(baiduMap); // è¾“å‡º:å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾ ä¸Šé¢çš„ä»£ç èƒ½å¤Ÿè¿è¡ŒæˆåŠŸæ˜¯å› ä¸ºä¸¤ä¸ªç¬¬ä¸‰æ–¹å‡ä¸ºshowæ–¹æ³•ï¼Œå¦‚æœä¸¤ä¸ªæ¥å£æä¾›è°ƒç”¨çš„æ–¹å¼ä¸ä¸€æ ·ï¼Œé‚£ä¹ˆå°±ä¸èƒ½è¿è¡Œäº† é‡æ„1234567891011121314151617181920212223let googleMap = { show: function () { console.log(&quot;å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾&quot;); },};let baiduMap = { display: function () { console.log(&quot;å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾&quot;); },};let baiduMapAdapter = { show: function () { return baiduMap.display(); },};let renderMap = function (map) { if (map.show instanceof Function) { map.show(); }};renderMap(googleMap); // è¾“å‡º:å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾renderMap(baiduMapAdapter); // è¾“å‡º:å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾ æ€»ç»“ é€‚é…å™¨æ¨¡å¼ä¸»è¦ç”¨æ¥è§£å†³ä¸¤ä¸ªå·²æœ‰æ¥å£ä¹‹é—´ä¸åŒ¹é…çš„é—®é¢˜ï¼Œå®ƒä¸è€ƒè™‘è¿™äº›æ¥å£æ˜¯æ€æ ·å®ç°çš„ï¼Œä¹Ÿä¸è€ƒè™‘å®ƒä»¬å°†æ¥å¯èƒ½ä¼šå¦‚ä½•æ¼”åŒ–ã€‚é€‚é…å™¨æ¨¡å¼ä¸éœ€è¦æ”¹å˜å·²æœ‰çš„æ¥å£ï¼Œå°±èƒ½å¤Ÿä½¿å®ƒä»¬ååŒä½œç”¨ã€‚ è£…é¥°è€…æ¨¡å¼å’Œä»£ç†æ¨¡å¼ä¹Ÿä¸ä¼šæ”¹å˜åŸæœ‰å¯¹è±¡çš„æ¥å£ï¼Œä½†è£…é¥°è€…æ¨¡å¼çš„ä½œç”¨æ˜¯ä¸ºäº†ç»™å¯¹è±¡å¢åŠ åŠŸèƒ½ã€‚è£…é¥°è€…æ¨¡å¼å¸¸å¸¸å½¢æˆä¸€æ¡é•¿çš„è£…é¥°é“¾ï¼Œè€Œé€‚é…å™¨æ¨¡å¼é€šå¸¸åªåŒ…è£…ä¸€æ¬¡ã€‚ä»£ç†æ¨¡å¼æ˜¯ä¸ºäº†æ§åˆ¶å¯¹å¯¹è±¡çš„è®¿é—®ï¼Œé€šå¸¸ä¹ŸåªåŒ…è£…ä¸€æ¬¡ã€‚ å¤–è§‚æ¨¡å¼çš„ä½œç”¨å€’æ˜¯å’Œé€‚é…å™¨æ¯”è¾ƒç›¸ä¼¼ï¼Œæœ‰äººæŠŠå¤–è§‚æ¨¡å¼çœ‹æˆä¸€ç»„å¯¹è±¡çš„é€‚é…å™¨ï¼Œä½†å¤–è§‚æ¨¡å¼æœ€æ˜¾è‘—çš„ç‰¹ç‚¹æ˜¯å®šä¹‰äº†ä¸€ä¸ªæ–°çš„æ¥å£ã€‚ å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹","link":"/2021/02/11/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/"},{"title":"çŠ¶æ€æ¨¡å¼","text":"å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±» çŠ¶æ€æ¨¡å¼çš„å…³é”®æ˜¯åŒºåˆ†äº‹ç‰©å†…éƒ¨çš„çŠ¶æ€ï¼Œäº‹ç‰©å†…éƒ¨çŠ¶æ€çš„æ”¹å˜å¾€å¾€ä¼šå¸¦æ¥äº‹ç‰©çš„è¡Œä¸ºæ”¹å˜ æ•…äº‹èƒŒæ™¯æˆ‘ä»¬æ¥æƒ³è±¡è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šæœ‰ä¸€ä¸ªç”µç¯ï¼Œç”µç¯ä¸Šé¢åªæœ‰ä¸€ä¸ªå¼€å…³ã€‚å½“ç”µç¯å¼€ç€çš„æ—¶å€™ï¼Œæ­¤æ—¶ æŒ‰ä¸‹å¼€å…³ï¼Œç”µç¯ä¼šåˆ‡æ¢åˆ°å…³é—­çŠ¶æ€;å†æŒ‰ä¸€æ¬¡å¼€å…³ï¼Œç”µç¯åˆå°†è¢«æ‰“å¼€ã€‚åŒä¸€ä¸ªå¼€å…³æŒ‰é’®ï¼Œåœ¨ä¸åŒ çš„çŠ¶æ€ä¸‹ï¼Œè¡¨ç°å‡ºæ¥çš„è¡Œä¸ºæ˜¯ä¸ä¸€æ ·çš„ æœªä½¿ç”¨çŠ¶æ€æ¨¡å¼123456789101112131415161718192021222324252627let Light = function () { this.state = &quot;off&quot;; // ç»™ç”µç¯è®¾ç½®åˆå§‹çŠ¶æ€ off this.button = null;// ç”µç¯å¼€å…³æŒ‰é’®};Light.prototype.init = function () { let button = document.createElement(&quot;button&quot;), self = this; button.innerHTML = &quot;å¼€å…³&quot;; this.button = document.body.appendChild(button); this.button.onclick = function () { self.buttonWasPressed(); };};Light.prototype.buttonWasPressed = function () { if (this.state === &quot;off&quot;) { console.log(&quot;å¼€ç¯&quot;); this.state = &quot;on&quot;; } else if (this.state === &quot;on&quot;) { console.log(&quot;å…³ç¯&quot;); this.state = &quot;off&quot;; }};let light = new Light();light.init(); ä½†æ˜¯å¦‚æœéœ€è¦åœ¨æ–°å¢çŠ¶æ€ï¼Œé‚£ä¹ˆå°±å¾—ç›´æ¥åœ¨buttonWasPressedé‡Œä¿®æ”¹ï¼Œä¸ç¬¦åˆå¼€é—­åŸåˆ™ã€‚ çŠ¶æ€æ¨¡å¼é‡æ„12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849let OffLightState = function (light) { this.light = light;};OffLightState.prototype.buttonWasPressed = function () { console.log(&quot;å¼±å…‰&quot;); // offLightState å¯¹åº”çš„è¡Œä¸º this.light.setState(this.light.weakLightState);// åˆ‡æ¢çŠ¶æ€åˆ° weakLightState};let WeakLightState = function (light) { this.light = light;};WeakLightState.prototype.buttonWasPressed = function () { console.log(&quot;å¼ºå…‰&quot;); // weakLightState å¯¹åº”çš„è¡Œä¸º this.light.setState(this.light.strongLightState); //åˆ‡æ¢çŠ¶æ€åˆ° strongLightState};let StrongLightState = function (light) { this.light = light;};StrongLightState.prototype.buttonWasPressed = function () { console.log(&quot;å…³ç¯&quot;); // strongLightState å¯¹åº”çš„è¡Œä¸º this.light.setState(this.light.offLightState); // åˆ‡æ¢çŠ¶æ€åˆ° offLightState};// æ”¹å†™ Light ç±»ï¼Œä½¿ç”¨çŠ¶æ€å¯¹è±¡è®°å½•å½“å‰çš„çŠ¶æ€let Light = function () { this.offLightState = new OffLightState(this); this.weakLightState = new WeakLightState(this); this.strongLightState = new StrongLightState(this); this.button = null;};// æä¾›ä¸€ä¸ª æ–¹æ³•æ¥åˆ‡æ¢ light å¯¹è±¡çš„çŠ¶æ€Light.prototype.init = function () { let button = document.createElement(&quot;button&quot;), self = this; this.button = document.body.appendChild(button); this.button.innerHTML = &quot;å¼€å…³&quot;; this.currState = this.offLightState; this.button.onclick = function () { self.currState.buttonWasPressed(); };};Light.prototype.setState = function (newState) { this.currState = newState;};let light = new Light();light.init(); å®ƒå¯ä»¥ä½¿æ¯ä¸€ç§çŠ¶æ€å’Œå®ƒå¯¹åº”çš„è¡Œä¸ºä¹‹é—´çš„å…³ç³»å±€éƒ¨åŒ–ï¼Œè¿™äº›è¡Œä¸ºè¢«åˆ†æ•£å’Œå°è£…åœ¨å„è‡ªå¯¹åº”çš„çŠ¶æ€ç±»ä¹‹ä¸­ï¼Œä¾¿äºé˜…è¯»å’Œç®¡ç†ä»£ç ã€‚ çŠ¶æ€ä¹‹é—´çš„åˆ‡æ¢éƒ½è¢«åˆ†å¸ƒåœ¨çŠ¶æ€ç±»å†…éƒ¨ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬æ— éœ€ç¼–å†™è¿‡å¤šçš„ ifã€else æ¡ä»¶ åˆ†æ”¯è¯­è¨€æ¥æ§åˆ¶çŠ¶æ€ä¹‹é—´çš„è½¬æ¢ ç”¨å¯¹è±¡ä»£æ›¿å­—ç¬¦ä¸²æ¥è®°å½•å½“å‰çŠ¶æ€ï¼Œä½¿å¾—çŠ¶æ€çš„åˆ‡æ¢æ›´åŠ ä¸€ç›®äº†ç„¶ã€‚ å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹","link":"/2021/02/10/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/"},{"title":"è£…é¥°è€…æ¨¡å¼","text":"åœ¨ä¼ ç»Ÿçš„é¢å‘å¯¹è±¡è¯­è¨€ä¸­ï¼Œç»™å¯¹è±¡æ·»åŠ åŠŸèƒ½å¸¸å¸¸ä½¿ç”¨ç»§æ‰¿çš„æ–¹å¼ï¼Œä½†æ˜¯ç»§æ‰¿çš„æ–¹å¼å¹¶ä¸çµæ´»ï¼Œ è¿˜ä¼šå¸¦æ¥è®¸å¤šé—®é¢˜ï¼šä¸€æ–¹é¢ä¼šå¯¼è‡´è¶…ç±»å’Œå­ç±»ä¹‹é—´å­˜åœ¨å¼ºè€¦åˆæ€§ï¼Œå½“è¶…ç±»æ”¹å˜æ—¶ï¼Œå­ç±»ä¹Ÿä¼šéšä¹‹æ”¹å˜ï¼›å¦ä¸€æ–¹é¢ï¼Œç»§æ‰¿è¿™ç§åŠŸèƒ½å¤ç”¨æ–¹å¼é€šå¸¸è¢«ç§°ä¸ºâ€œç™½ç®±å¤ç”¨â€ï¼Œâ€œç™½ç®±â€æ˜¯ç›¸å¯¹å¯è§æ€§è€Œè¨€çš„ï¼Œ åœ¨ç»§æ‰¿æ–¹å¼ä¸­ï¼Œè¶…ç±»çš„å†…éƒ¨ç»†èŠ‚æ˜¯å¯¹å­ç±»å¯è§çš„ï¼Œç»§æ‰¿å¸¸å¸¸è¢«è®¤ä¸ºç ´åäº†å°è£…æ€§ã€‚è£…é¥°è€…æ¨¡å¼èƒ½å¤Ÿåœ¨ä¸æ”¹å˜å¯¹è±¡è‡ªèº«çš„åŸºç¡€ä¸Šï¼Œåœ¨ç¨‹åºè¿è¡ŒæœŸé—´ç»™å¯¹è±¡åŠ¨æ€åœ°æ·»åŠ èŒè´£ã€‚è·Ÿç»§æ‰¿ç›¸æ¯”ï¼Œè£…é¥°è€…æ˜¯ä¸€ç§æ›´è½»ä¾¿çµæ´»çš„åšæ³•ï¼Œè¿™æ˜¯ä¸€ç§â€œå³ç”¨å³ä»˜â€çš„æ–¹å¼ æ•…äº‹èƒŒæ™¯å‡è®¾æˆ‘ä»¬åœ¨ç¼–å†™ä¸€ä¸ªé£æœºå¤§æˆ˜çš„æ¸¸æˆï¼Œéšç€ç»éªŒå€¼çš„å¢åŠ ï¼Œæˆ‘ä»¬æ“ä½œçš„é£æœºå¯¹è±¡å¯ä»¥å‡çº§æˆæ›´å‰å®³çš„é£æœºï¼Œä¸€å¼€å§‹è¿™äº›é£æœºåªèƒ½å‘å°„æ™®é€šçš„å­å¼¹ï¼Œå‡åˆ°ç¬¬äºŒçº§æ—¶å¯ä»¥å‘å°„å¯¼å¼¹ï¼Œå‡åˆ°ç¬¬ä¸‰çº§æ—¶å¯ä»¥å‘å°„åŸå­å¼¹ã€‚ ä¼ ç»Ÿé¢å‘å¯¹è±¡å®ç°123456789101112131415161718192021222324252627let Plane = function () {};Plane.prototype.fire = function () { console.log(&quot;å‘å°„æ™®é€šå­å¼¹&quot;);};// å¯¼å¼¹ç±»let MissileDecorator = function (plane) { this.plane = plane;};MissileDecorator.prototype.fire = function () { this.plane.fire(); console.log(&quot;å‘å°„å¯¼å¼¹&quot;);};// åŸå­å¼¹ç±»let AtomDecorator = function (plane) { this.plane = plane;};AtomDecorator.prototype.fire = function () { this.plane.fire(); console.log(&quot;å‘å°„åŸå­å¼¹&quot;);};let plane = new Plane();plane = new MissileDecorator(plane);plane = new AtomDecorator(plane);plane.fire(); è£…é¥°è€…å¯¹è±¡å’Œå®ƒæ‰€è£…é¥°çš„å¯¹è±¡æ‹¥æœ‰ä¸€è‡´çš„æ¥å£ï¼Œé€šè¿‡ä¼ å…¥è¢«è£…é¥°å¯¹è±¡ï¼Œè°ƒç”¨å…¶å¯¹åº”æ–¹æ³•ï¼Œå¹¶æ·»åŠ èŒè´£å½¢æˆèšåˆå¯¹è±¡ã€‚ åŠ¨æ€è¯­è¨€å®ç°1234567891011121314151617181920212223242526let plane = { fire: function () { console.log(&quot;å‘å°„æ™®é€šå­å¼¹&quot;); },};let missileDecorator = function () { console.log(&quot;å‘å°„å¯¼å¼¹&quot;);};let atomDecorator = function () { console.log(&quot;å‘å°„åŸå­å¼¹&quot;);};let fire1 = plane.fire;plane.fire = function () { fire1(); missileDecorator();};let fire2 = plane.fire;plane.fire = function () { fire2(); atomDecorator();};plane.fire(); å› ä¸ºjså¯ä»¥ç›´æ¥ä¿®æ”¹å¯¹è±¡æˆ–è€…å¯¹è±¡çš„æŸä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡ä¸€ä¸ªå˜é‡aæš‚å­˜è¢«è£…é¥°å‡½æ•°ï¼Œç„¶åæ›¿æ¢æ—§æ–¹æ³•ï¼Œåœ¨æ–°æ–¹æ³•å†…é€šè¿‡aè°ƒç”¨æ—§æ–¹æ³•ã€‚ ä½†æ˜¯ç›´æ¥æ›¿æ¢æœ‰thisæŒ‡å‘é—®é¢˜ã€‚ AOPå®ç°12345678910111213141516Function.prototype.before = function (beforefn) { let _self = this; // ä¿å­˜åŸå‡½æ•°çš„å¼•ç”¨ return function () { // è¿”å›åŒ…å«äº†åŸå‡½æ•°å’Œæ–°å‡½æ•°çš„&quot;ä»£ç†&quot;å‡½æ•° beforefn.apply(this, arguments); // æ‰§è¡Œæ–°å‡½æ•°ï¼Œä¸”ä¿è¯ this ä¸è¢«åŠ«æŒï¼Œæ–°å‡½æ•°æ¥å—çš„å‚æ•° // ä¹Ÿä¼šè¢«åŸå°ä¸åŠ¨åœ°ä¼ å…¥åŸå‡½æ•°ï¼Œæ–°å‡½æ•°åœ¨åŸå‡½æ•°ä¹‹å‰æ‰§è¡Œ return _self.apply(this, arguments); // æ‰§è¡ŒåŸå‡½æ•°å¹¶è¿”å›åŸå‡½æ•°çš„æ‰§è¡Œç»“æœï¼Œ // å¹¶ä¸”ä¿è¯ this ä¸è¢«åŠ«æŒ };};Function.prototype.after = function (afterfn) { let _self = this; return function () { let ret = _self.apply(this, arguments); afterfn.apply(this, arguments); return ret; };}; ç¼ºç‚¹ é€šè¿‡AOPå®é™…ä¸Šæ”¾å›çš„æ˜¯æ–°å‡½æ•°ï¼Œåœ¨åŸå‡½æ•°ä¸Šä¿å­˜çš„å±æ€§åˆ™ä¼šä¸¢å¤± å åŠ äº†ä½œç”¨åŸŸï¼Œå¦‚æœè£…é¥°çš„é“¾æ¡è¿‡é•¿ï¼Œæ€§èƒ½ä¸Šä¼šå—åˆ°å½±å“ ä¸ä»£ç†æ¨¡å¼çš„åŒºåˆ«ä»£ç†æ¨¡å¼çš„ç›®çš„ï¼šå½“ç›´æ¥è®¿é—®æœ¬ä½“ä¸æ–¹ä¾¿æˆ–è€…ä¸ç¬¦åˆéœ€è¦æ—¶ï¼Œä¸ºè¿™ä¸ªæœ¬ä½“æä¾›ä¸€ä¸ªæ›¿ä»£è€…ã€‚æœ¬ä½“å®šä¹‰äº†å…³é”®åŠŸèƒ½ï¼Œè€Œä»£ç†æä¾›æˆ–æ‹’ç»å¯¹å®ƒçš„è®¿é—®ï¼Œæˆ–è€…åœ¨è®¿é—®æœ¬ä½“ä¹‹å‰åšä¸€äº›é¢å¤–çš„äº‹æƒ…ã€‚ è£…é¥°è€…æ¨¡å¼çš„ä½œç”¨ï¼šä¸ºå¯¹è±¡åŠ¨æ€çš„åŠ å…¥è¡Œä¸ºã€‚ æ¢å¥è¯è¯´ï¼Œä»£ç†æ¨¡å¼çš„å…³ç³»ä¸€å¼€å§‹å°±å¯ä»¥è¢«ç¡®å®šï¼Œè€Œè£…é¥°è€…æ¨¡å¼ç”¨äºä¸€å¼€å§‹ä¸èƒ½ç¡®å®šå¯¹è±¡çš„å…¨éƒ¨åŠŸèƒ½æ—¶ å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹","link":"/2021/02/09/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/"},{"title":"ä¸­ä»‹è€…æ¨¡å¼","text":"ä¸­ä»‹è€…æ¨¡å¼çš„ä½œç”¨å°±æ˜¯è§£é™¤å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„ç´§è€¦åˆå…³ç³»ã€‚å¢åŠ ä¸€ä¸ªä¸­ä»‹è€…å¯¹è±¡åï¼Œæ‰€æœ‰çš„ç›¸å…³å¯¹è±¡éƒ½é€šè¿‡ä¸­ä»‹è€…å¯¹è±¡æ¥é€šä¿¡ï¼Œè€Œä¸æ˜¯äº’ç›¸å¼•ç”¨ï¼Œæ‰€ä»¥å½“ä¸€ä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜æ—¶ï¼Œåªéœ€è¦é€šçŸ¥ä¸­ä»‹è€…å¯¹è±¡å³å¯ã€‚ä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¹‹é—´è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚ä¸­ä»‹è€…æ¨¡å¼ä½¿ç½‘çŠ¶çš„å¤šå¯¹å¤šå…³ç³»å˜æˆäº†ç›¸å¯¹ç®€å•çš„ä¸€å¯¹å¤šå…³ç³» æ•…äº‹èƒŒæ™¯å‡å¦‚åœ¨ç©æ³¡æ³¡å ‚çš„æ¸¸æˆï¼Œä½¿ç”¨æ³¡æ³¡å‡»è´¥å¯¹æ–¹æ‰€æœ‰ç©å®¶æ‰èƒ½è·å¾—èƒœåˆ©ã€‚ç°åœ¨å°†é˜Ÿä¼åˆ†æˆä¸¤ä¸ªç»„è¿›è¡Œæ¸¸æˆ ä»£ç å®ç°(æœªä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼)12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970// ç©å®¶function Player(name, teamColor) { this.partners = []; // é˜Ÿå‹åˆ—è¡¨ this.enemies = []; // æ•Œäººåˆ—è¡¨ this.state = &quot;live&quot;; // ç©å®¶çŠ¶æ€ this.name = name; // è§’è‰²åå­— this.teamColor = teamColor; // é˜Ÿä¼é¢œè‰²}Player.prototype.win = function () { // ç©å®¶å›¢é˜Ÿèƒœåˆ© console.log(&quot;winner: &quot; + this.name);};Player.prototype.lose = function () { // ç©å®¶å›¢é˜Ÿå¤±è´¥ console.log(&quot;loser: &quot; + this.name);};// ç©å®¶æ­»äº¡çš„æ–¹æ³•Player.prototype.die = function () { // ç©å®¶æ­»äº¡ let all_dead = true; this.state = &quot;dead&quot;; // è®¾ç½®ç©å®¶çŠ¶æ€ä¸ºæ­»äº¡ for (let i = 0, partner; partner = this.partners[i++];) { // éå†é˜Ÿå‹åˆ—è¡¨ if (partner.state !== &quot;dead&quot;) { // å¦‚æœè¿˜æœ‰ä¸€ä¸ªé˜Ÿå‹æ²¡æœ‰æ­»äº¡ï¼Œåˆ™æ¸¸æˆè¿˜æœªå¤±è´¥ all_dead = false; break; } } if (all_dead === true) { // å¦‚æœé˜Ÿå‹å…¨éƒ¨æ­»äº¡ this.lose(); // é€šçŸ¥è‡ªå·±æ¸¸æˆå¤±è´¥ for (let i = 0, partner; partner = this.partners[i++];) { partner.lose(); } for (let i = 0, enemy; enemy = this.enemies[i++];) { enemy.win(); } }};// å®šä¹‰ä¸€ä¸ªå·¥å‚æ¥åˆ›å»ºç©å®¶let playerFactory = function (name, teamColor) { let newPlayer = new Player(name, teamColor); for (let i = 0, player; player = players[i++];) { // é€šçŸ¥æ‰€æœ‰çš„ç©å®¶ï¼Œæœ‰æ–°è§’è‰²åŠ å…¥ if (player.teamColor === newPlayer.teamColor) { // å¦‚æœæ˜¯åŒä¸€é˜Ÿçš„ç©å®¶ player.partners.push(newPlayer); // ç›¸äº’æ·»åŠ åˆ°é˜Ÿå‹åˆ—è¡¨ newPlayer.partners.push(player); } else { player.enemies.push(newPlayer); // ç›¸äº’æ·»åŠ åˆ°æ•Œäººåˆ—è¡¨ newPlayer.enemies.push(player); } } players.push(newPlayer); return newPlayer;};let players = [];//çº¢é˜Ÿ:let player1 = playerFactory(&quot;çš®è›‹&quot;, &quot;red&quot;), player2 = playerFactory(&quot;å°ä¹–&quot;, &quot;red&quot;), player3 = playerFactory(&quot;å®å®&quot;, &quot;red&quot;), player4 = playerFactory(&quot;å°å¼º&quot;, &quot;red&quot;);//è“é˜Ÿ:let player5 = playerFactory(&quot;é»‘å¦&quot;, &quot;blue&quot;), player6 = playerFactory(&quot;è‘±å¤´&quot;, &quot;blue&quot;), player7 = playerFactory(&quot;èƒ–å¢©&quot;, &quot;blue&quot;), player8 = playerFactory(&quot;æµ·ç›—&quot;, &quot;blue&quot;);// è®©çº¢é˜Ÿç©å®¶å…¨éƒ¨æ­»äº¡:player1.die();player2.die();player4.die();player3.die(); æ¯ä¸ªç©å®¶æ·»åŠ æˆ–è€…æ­»äº¡ï¼Œéƒ½å¿…é¡»ä¿®æ”¹æ‰€æœ‰å…¶ä»–ç©å®¶å†…éƒ¨çš„é˜Ÿå‹åˆ—è¡¨å’Œæ•Œäººåˆ—è¡¨ã€‚è€¦åˆåº¦å¾ˆé«˜ã€‚ ä»£ç é‡æ„(ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114// ç©å®¶function Player(name, teamColor) { this.state = &quot;live&quot;; // ç©å®¶çŠ¶æ€ this.name = name; // è§’è‰²åå­— this.teamColor = teamColor; // é˜Ÿä¼é¢œè‰²}Player.prototype.win = function(){ console.log( this.name + ' won ' );};Player.prototype.lose = function(){ console.log( this.name +' lost' );};/*******************ç©å®¶æ­»äº¡*****************/Player.prototype.die = function () { this.state = &quot;dead&quot;; playerDirector.receiveMessage(&quot;playerDead&quot;, this);// ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œç©å®¶æ­»äº¡};/*******************ç§»é™¤ç©å®¶*****************/Player.prototype.remove = function () { // ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œç§»é™¤ä¸€ä¸ªç©å®¶ playerDirector.receiveMessage(&quot;removePlayer&quot;, this);};/*******************ç©å®¶æ¢é˜Ÿ*****************/Player.prototype.changeTeam = function (color) { playerDirector.receiveMessage(&quot;changeTeam&quot;, this, color); // ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œç©å®¶æ¢é˜Ÿ};/*******************å®šä¹‰ä¸­ä»‹è€…å¯¹è±¡*****************/let playerDirector = (function () { let players = {}, // ä¿å­˜æ‰€æœ‰ç©å®¶ operations = {}; // ä¸­ä»‹è€…å¯ä»¥æ‰§è¡Œçš„æ“ä½œ /****************æ–°å¢ä¸€ä¸ªç©å®¶***************************/ operations.addPlayer = function (player) { let teamColor = player.teamColor; // ç©å®¶çš„é˜Ÿä¼é¢œè‰² players[teamColor] = players[teamColor] || []; // å¦‚æœè¯¥é¢œè‰²çš„ç©å®¶è¿˜æ²¡æœ‰æˆç«‹é˜Ÿä¼ï¼Œåˆ™æ–°æˆç«‹ä¸€ä¸ªé˜Ÿä¼ players[teamColor].push(player); // æ·»åŠ ç©å®¶è¿›é˜Ÿä¼ }; /****************ç§»é™¤ä¸€ä¸ªç©å®¶***************************/ operations.removePlayer = function (player) { let teamColor = player.teamColor, // ç©å®¶çš„é˜Ÿä¼é¢œè‰² teamPlayers = players[teamColor] || []; // è¯¥é˜Ÿä¼æ‰€æœ‰æˆå‘˜ for (let i = teamPlayers.length - 1; i &gt;= 0; i--) { // éå†åˆ é™¤ if (teamPlayers[i] === player) { teamPlayers.splice(i, 1); } } }; /****************ç©å®¶æ¢é˜Ÿ***************************/ operations.changeTeam = function (player, newTeamColor) { // ç©å®¶æ¢é˜Ÿ operations.removePlayer(player); // ä»åŸé˜Ÿä¼ä¸­åˆ é™¤ player.teamColor = newTeamColor; // æ”¹å˜é˜Ÿä¼é¢œè‰² operations.addPlayer(player);// å¢åŠ åˆ°æ–°é˜Ÿä¼ä¸­ }; /****************ç©å®¶æ­»äº¡***************************/ operations.playerDead = function (player) { // ç©å®¶æ­»äº¡ let teamColor = player.teamColor, teamPlayers = players[teamColor]; // ç©å®¶æ‰€åœ¨é˜Ÿä¼ let all_dead = true; for (let i = 0, player; player = teamPlayers[i++];) { if (player.state !== &quot;dead&quot;) { all_dead = false; break; } } if (all_dead === true) {// å…¨éƒ¨æ­»äº¡ for (let i = 0, player; player = teamPlayers[i++];) { player.lose(); // æœ¬é˜Ÿæ‰€æœ‰ç©å®¶ lose } for (let color in players) { if (color !== teamColor) { let teamPlayers = players[color]; // å…¶ä»–é˜Ÿä¼çš„ç©å®¶ for (let i = 0, player; player = teamPlayers[i++];) { player.win(); // å…¶ä»–é˜Ÿä¼æ‰€æœ‰ç©å®¶ win } } } } }; let receiveMessage = function () { let message = Array.prototype.shift.call(arguments); operations[message].apply(this, arguments); }; return { receiveMessage: receiveMessage, };})();/*******************è®¾ç½®å·¥å‚å‡½æ•°*****************/let playerFactory = function (name, teamColor) { let newPlayer = new Player(name, teamColor); // åˆ›é€ ä¸€ä¸ªæ–°çš„ç©å®¶å¯¹è±¡ playerDirector.receiveMessage(&quot;addPlayer&quot;, newPlayer); // ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œæ–°å¢ç©å®¶ return newPlayer;};//çº¢é˜Ÿlet player1 = playerFactory(&quot;çš®è›‹&quot;, &quot;red&quot;), player2 = playerFactory(&quot;å°ä¹–&quot;, &quot;red&quot;), player3 = playerFactory(&quot;å®å®&quot;, &quot;red&quot;), player4 = playerFactory(&quot;å°å¼º&quot;, &quot;red&quot;);// è“é˜Ÿ:let player5 = playerFactory(&quot;é»‘å¦&quot;, &quot;blue&quot;), player6 = playerFactory(&quot;è‘±å¤´&quot;, &quot;blue&quot;), player7 = playerFactory(&quot;èƒ–å¢©&quot;, &quot;blue&quot;), player8 = playerFactory(&quot;æµ·ç›—&quot;, &quot;blue&quot;);player1.die();player2.die();player3.die();player4.die(); ç°åœ¨ç©å®¶ä¸ç©å®¶ä¹‹é—´çš„è€¦åˆæ¶ˆé™¤äº†ï¼Œæ‰€æœ‰æ“ä½œé€»è¾‘åœ¨ä¸­ä»‹è€…å¯¹è±¡ä¸­å®ç°ï¼Œç©å®¶åªéœ€è¦å‘ä¸­ä»‹è€…å‘ç”Ÿæ¶ˆæ¯ï¼Œä¸­ä»‹è€…ä¼šæŠŠå¤„ç†ç»“æœåé¦ˆç»™å…¶ä»–ç©å®¶å¯¹è±¡ã€‚ ä½¿ç”¨æ—¶æœºä¸­ä»‹è€…æ¨¡å¼å¯ä»¥éå¸¸æ–¹ä¾¿åœ°å¯¹æ¨¡å—æˆ–è€…å¯¹è±¡è¿›è¡Œè§£è€¦ï¼Œä½†å¯¹è±¡ä¹‹é—´å¹¶éä¸€å®šéœ€è¦è§£è€¦ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæ¨¡å—æˆ–å¯¹è±¡ä¹‹é—´æœ‰ä¸€äº›ä¾èµ–å…³ç³»æ˜¯å¾ˆæ­£å¸¸çš„ã€‚æ¯•ç«Ÿæˆ‘ä»¬å†™ç¨‹åºæ˜¯ä¸ºäº†å¿«é€Ÿå®Œæˆé¡¹ç›®äº¤ä»˜ç”Ÿäº§ï¼Œè€Œä¸æ˜¯å †ç Œæ¨¡å¼å’Œè¿‡åº¦è®¾è®¡ã€‚å…³é”®å°±åœ¨äºå¦‚ä½•å»è¡¡é‡å¯¹è±¡ä¹‹é—´çš„è€¦åˆç¨‹åº¦ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œ å¦‚æœå¯¹è±¡ä¹‹é—´çš„å¤æ‚è€¦åˆç¡®å®å¯¼è‡´è°ƒç”¨å’Œç»´æŠ¤å‡ºç°äº†å›°éš¾ï¼Œè€Œä¸”è¿™äº›è€¦åˆåº¦éšé¡¹ç›®çš„å˜åŒ–å‘ˆæŒ‡æ•°å¢é•¿æ›²çº¿ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘ç”¨ä¸­ä»‹è€…æ¨¡å¼æ¥é‡æ„ä»£ç ã€‚ å°ç»“ä¸­ä»‹è€…æ¨¡å¼æ˜¯è¿åˆè¿ªç±³ç‰¹æ³•åˆ™çš„ä¸€ç§å®ç°ã€‚è¿ªç±³ç‰¹æ³•åˆ™ä¹Ÿå«æœ€å°‘çŸ¥è¯†åŸåˆ™ï¼Œæ˜¯æŒ‡ä¸€ä¸ªå¯¹è±¡åº”è¯¥å°½å¯èƒ½å°‘åœ°äº†è§£å¦å¤–çš„å¯¹è±¡ã€‚å¦‚æœå¯¹è±¡ä¹‹é—´çš„è€¦åˆæ€§å¤ªé«˜ï¼Œä¸€ä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜ä¹‹åï¼Œéš¾å…ä¼šå½±å“åˆ°å…¶ä»–çš„å¯¹è±¡ï¼Œè€Œåœ¨ä¸­ä»‹è€…æ¨¡å¼é‡Œï¼Œå¯¹è±¡ä¹‹é—´å‡ ä¹ä¸çŸ¥é“å½¼æ­¤çš„å­˜åœ¨ï¼Œå®ƒä»¬åªèƒ½é€šè¿‡ä¸­ä»‹è€…å¯¹è±¡æ¥äº’ç›¸å½±å“å¯¹æ–¹ã€‚ ä¸­ä»‹è€…æ¨¡å¼ä¹Ÿå­˜åœ¨ä¸€äº›ç¼ºç‚¹ã€‚å…¶ä¸­æœ€å¤§çš„ç¼ºç‚¹æ˜¯ç³»ç»Ÿä¸­ä¼šæ–°å¢ä¸€ä¸ªä¸­ä»‹è€…å¯¹è±¡ï¼Œå›  ä¸ºå¯¹è±¡ä¹‹é—´äº¤äº’çš„å¤æ‚æ€§ï¼Œè½¬ç§»æˆäº†ä¸­ä»‹è€…å¯¹è±¡çš„å¤æ‚æ€§ï¼Œä½¿å¾—ä¸­ä»‹è€…å¯¹è±¡ç»å¸¸æ˜¯å·¨å¤§çš„ã€‚ä¸­ä»‹è€…å¯¹è±¡è‡ªèº«å¾€å¾€å°±æ˜¯ä¸€ä¸ªéš¾ä»¥ç»´æŠ¤çš„å¯¹è±¡ã€‚ å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹","link":"/2021/02/08/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/"},{"title":"èŒè´£é“¾æ¨¡å¼","text":"èŒè´£é“¾æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼Œå°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚ èŒè´£é“¾æ¨¡å¼çš„åå­—éå¸¸å½¢è±¡ï¼Œä¸€ç³»åˆ—å¯èƒ½ä¼šå¤„ç†è¯·æ±‚çš„å¯¹è±¡è¢«è¿æ¥æˆä¸€æ¡é“¾ï¼Œè¯·æ±‚åœ¨è¿™äº›å¯¹ è±¡ä¹‹é—´ä¾æ¬¡ä¼ é€’ï¼Œç›´åˆ°é‡åˆ°ä¸€ä¸ªå¯ä»¥å¤„ç†å®ƒçš„å¯¹è±¡ï¼Œæˆ‘ä»¬æŠŠè¿™äº›å¯¹è±¡ç§°ä¸ºé“¾ä¸­çš„èŠ‚ç‚¹ åœºæ™¯â€‹ å‡è®¾æˆ‘ä»¬è´Ÿè´£ä¸€ä¸ªå”®å–æ‰‹æœºçš„ç”µå•†ç½‘ç«™ï¼Œç»è¿‡åˆ†åˆ«äº¤çº³ 500 å…ƒå®šé‡‘å’Œ 200 å…ƒå®šé‡‘çš„ä¸¤è½®é¢„å®šå(è®¢å•å·²åœ¨æ­¤æ—¶ç”Ÿæˆ)ï¼Œç°åœ¨å·²ç»åˆ°äº†æ­£å¼è´­ä¹°çš„é˜¶æ®µã€‚ â€‹ åœ¨æ­£å¼è´­ä¹°åï¼Œå·²ç»æ”¯ä»˜è¿‡ 500 å…ƒå®šé‡‘çš„ç”¨æˆ·ä¼šæ”¶åˆ° 100 å…ƒçš„å•†åŸä¼˜æƒ åˆ¸ï¼Œ200 å…ƒå®šé‡‘çš„ç”¨æˆ·å¯ä»¥æ”¶åˆ° 50 å…ƒçš„ä¼˜æƒ åˆ¸ï¼Œè€Œä¹‹å‰æ²¡æœ‰æ”¯ä»˜å®šé‡‘çš„ç”¨æˆ·åªèƒ½è¿›å…¥æ™®é€šè´­ä¹°æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ä¼˜æƒ åˆ¸ï¼Œä¸”åœ¨åº“å­˜æœ‰é™çš„æƒ…å†µä¸‹ä¸ä¸€å®šä¿è¯èƒ½ä¹°åˆ°ã€‚ orderTypeï¼šè®¢å•ç±»å‹ payï¼šç”¨æˆ·æ˜¯å¦å·²ç»æ”¯ä»˜å®šé‡‘ stockï¼šç”¨äºæ™®é€šç”¨æˆ·ï¼Œæ™®é€šè´­ä¹°çš„æ‰‹æœºåº“å­˜æ•°é‡ ä»£ç å®ç°ï¼ˆæœªä½¿ç”¨èŒè´£é“¾æ¨¡å¼ï¼‰123456789101112131415161718192021222324252627282930let order = function (orderType, pay, stock) { if (orderType === 1) { // 500 å…ƒå®šé‡‘è´­ä¹°æ¨¡å¼ if (pay === true) { // å·²æ”¯ä»˜å®šé‡‘ console.log(&quot;500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 100 ä¼˜æƒ åˆ¸&quot;); } else { // æœªæ”¯ä»˜å®šé‡‘ï¼Œé™çº§åˆ°æ™®é€šè´­ä¹°æ¨¡å¼ if (stock &gt; 0) { // ç”¨äºæ™®é€šè´­ä¹°çš„æ‰‹æœºè¿˜æœ‰åº“å­˜ console.log(&quot;æ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸&quot;); } else { console.log(&quot;æ‰‹æœºåº“å­˜ä¸è¶³&quot;); } } } else if (orderType === 2) { if (pay === true) { // 200 å…ƒå®šé‡‘è´­ä¹°æ¨¡å¼ console.log(&quot;200 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 50 ä¼˜æƒ åˆ¸&quot;); } else { if (stock &gt; 0) { console.log(&quot;æ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸&quot;); } else { console.log(&quot;æ‰‹æœºåº“å­˜ä¸è¶³&quot;); } } } else if (orderType === 3) { if (stock &gt; 0) { console.log(&quot;æ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸&quot;); } else { console.log(&quot;æ‰‹æœºåº“å­˜ä¸è¶³&quot;); } }};order(1, true, 500); // è¾“å‡º: 500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 100 ä¼˜æƒ åˆ¸ ç”¨èŒè´£é“¾æ¨¡å¼é‡æ„ä»£ç â€‹ å…ˆæŠŠ 500 å…ƒè®¢å•ã€200 å…ƒè®¢å•ä»¥åŠæ™®é€šè´­ä¹°åˆ†æˆ 3 ä¸ªå‡½æ•°ã€‚ â€‹ æ¥ä¸‹æ¥æŠŠ orderTypeã€payã€stock è¿™ 3 ä¸ªå­—æ®µå½“ä½œå‚æ•°ä¼ é€’ç»™ 500 å…ƒè®¢å•å‡½æ•°ï¼Œå¦‚æœè¯¥å‡½æ•°ä¸ç¬¦åˆå¤„ç†æ¡ä»¶ï¼Œåˆ™æŠŠè¿™ä¸ªè¯·æ±‚ä¼ é€’ç»™åé¢çš„ 200 å…ƒè®¢å•å‡½æ•°ï¼Œå¦‚æœ 200 å…ƒè®¢å•å‡½æ•°ä¾ç„¶ä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œåˆ™ç»§ç»­ä¼ é€’è¯·æ±‚ç»™æ™®é€šè´­ä¹°å‡½æ•°ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354let order500 = function (orderType, pay, stock) { if (orderType === 1 &amp;&amp; pay === true) { console.log(&quot;500 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 100 ä¼˜æƒ åˆ¸&quot;); } else { return &quot;nextSuccessor&quot;; // æˆ‘ä¸çŸ¥é“ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯è°ï¼Œåæ­£æŠŠè¯·æ±‚å¾€åé¢ä¼ é€’ }};let order200 = function (orderType, pay, stock) { if (orderType === 2 &amp;&amp; pay === true) { console.log(&quot;200 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 50 ä¼˜æƒ åˆ¸&quot;); } else { return &quot;nextSuccessor&quot;; // æˆ‘ä¸çŸ¥é“ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯è°ï¼Œåæ­£æŠŠè¯·æ±‚å¾€åé¢ä¼ é€’ }};let orderNormal = function (orderType, pay, stock) { if (stock &gt; 0) { console.log(&quot;æ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸&quot;); } else { console.log(&quot;æ‰‹æœºåº“å­˜ä¸è¶³&quot;); }};// Chain.prototype.setNextSuccessor æŒ‡å®šåœ¨é“¾ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹// Chain.prototype.passRequest ä¼ é€’è¯·æ±‚ç»™æŸä¸ªèŠ‚ç‚¹let Chain = function (fn) { this.fn = fn; this.successor = null;};Chain.prototype.setNextSuccessor = function (successor) { return this.successor = successor;};Chain.prototype.passRequest = function () { let ret = this.fn.apply(this, arguments); if (ret === &quot;nextSuccessor&quot;) { return this.successor &amp;&amp; this.successor.passRequest.apply(this.successor, arguments); } return ret;};let chainOrder500 = new Chain(order500);let chainOrder200 = new Chain(order200);let chainOrderNormal = new Chain(orderNormal);chainOrder500.setNextSuccessor(chainOrder200);chainOrder200.setNextSuccessor(chainOrderNormal);chainOrder500.passRequest(1, true, 500); // è¾“å‡º:500 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 100 ä¼˜æƒ åˆ¸chainOrder500.passRequest(2, true, 500); // è¾“å‡º:200 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 50 ä¼˜æƒ åˆ¸chainOrder500.passRequest(3, true, 500); // è¾“å‡º:æ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸chainOrder500.passRequest(1, false, 0); // è¾“å‡º:æ‰‹æœºåº“å­˜ä¸è¶³ å¼‚æ­¥çš„èŒè´£é“¾â€‹ åœ¨ç°å®å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸€äº›å¼‚æ­¥çš„é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦åœ¨èŠ‚ç‚¹å‡½æ•°ä¸­å‘èµ·ä¸€ä¸ª ajax å¼‚æ­¥è¯·æ±‚ï¼Œå¼‚æ­¥è¯·æ±‚è¿”å›çš„ç»“æœæ‰èƒ½å†³å®šæ˜¯å¦ç»§ç»­åœ¨èŒè´£é“¾ä¸­ passRequestã€‚ è¿™æ—¶å€™è®©èŠ‚ç‚¹å‡½æ•°åŒæ­¥è¿”å› â€œnextSuccessorâ€ å·²ç»æ²¡æœ‰æ„ä¹‰äº†ï¼Œæ‰€ä»¥è¦ç»™ Chain ç±»å†å¢åŠ ä¸€ä¸ªåŸå‹æ–¹æ³• Chain.prototype.nextï¼Œè¡¨ç¤ºæ‰‹åŠ¨ä¼ é€’è¯·æ±‚ç»™èŒè´£é“¾ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ 1234567891011121314151617181920212223Chain.prototype.next = function () { return this.successor &amp;&amp; this.successor.passRequest.apply(this.successor, arguments);};// å¼‚æ­¥èŒè´£é“¾let fn1 = new Chain(function () { console.log(1); return &quot;nextSuccessor&quot;;});let fn2 = new Chain(function () { console.log(2); let self = this; setTimeout(function () { self.next(); }, 1000);});let fn3 = new Chain(function () { console.log(3);});fn1.setNextSuccessor(fn2).setNextSuccessor(fn3);fn1.passRequest(); ç°åœ¨æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªç‰¹æ®Šçš„é“¾æ¡ï¼Œè¯·æ±‚åœ¨é“¾ä¸­çš„èŠ‚ç‚¹é‡Œä¼ é€’ï¼Œä½†èŠ‚ç‚¹æœ‰æƒåˆ©å†³å®šä»€ä¹ˆæ—¶å€™æŠŠ è¯·æ±‚äº¤ç»™ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚å¯ä»¥æƒ³è±¡ï¼Œå¼‚æ­¥çš„èŒè´£é“¾åŠ ä¸Šå‘½ä»¤æ¨¡å¼(æŠŠ ajax è¯·æ±‚å°è£…æˆå‘½ä»¤å¯¹è±¡)ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åˆ›å»ºä¸€ä¸ªå¼‚æ­¥ ajax é˜Ÿåˆ—åº“ã€‚ AOPå®ç°èŒè´£é“¾123456789101112131415Function.prototype.after = function (fn) { let self = this; return function () { let ret = self.apply(this, arguments); if (ret === &quot;nextSuccessor&quot;) { return fn.apply(this, arguments); } return ret; };};let order = order500.after(order200).after(orderNormal);order(1, true, 500); // è¾“å‡º:500 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 100 ä¼˜æƒ åˆ¸order(2, true, 500); // è¾“å‡º:200 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 50 ä¼˜æƒ åˆ¸order(1, false, 500); // è¾“å‡º:æ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸ ç¼ºç‚¹ä½†æ˜¯èŒè´£é“¾æ¨¡å¼å¹¶ä¸èƒ½ä¿è¯æŸä¸ªè¯·æ±‚ä¸€å®šä¼šè¢«é“¾ä¸­çš„èŠ‚ç‚¹å¤„ç†ï¼Œè€Œæ˜¯å¾„ç›´çš„ä»é“¾å°¾ç¦»å¼€ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é“¾å°¾å¢åŠ ä¸€ä¸ªä¿åº•çš„æ¥å—è€…èŠ‚ç‚¹æ¥å¤„ç†è¿™ç§å³å°†ç¦»å¼€é“¾å°¾çš„è¯·æ±‚ã€‚ å¹¶ä¸”èŒè´£é“¾æ¨¡å¼ä½¿å¾—ç¨‹åºä¸­å¤šäº†ä¸€äº›èŠ‚ç‚¹å¯¹è±¡ï¼Œå¯èƒ½åœ¨æŸä¸€æ¬¡çš„è¯·æ±‚ä¼ é€’è¿‡ç¨‹ä¸­ï¼Œå¹¶æ²¡æœ‰èµ·åˆ°å®è´¨æ€§çš„ä½œç”¨ï¼Œå®ƒä»¬çš„ä½œç”¨ä»…ä»…æ˜¯è®©è¯·æ±‚ä¼ é€’ä¸‹å»ï¼Œä»æ€§èƒ½æ–¹é¢è€ƒè™‘ï¼Œæˆ‘ä»¬è¦é¿å…è¿‡é•¿çš„èŒè´£é“¾ å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹","link":"/2021/02/07/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F/"},{"title":"äº«å…ƒæ¨¡å¼","text":"äº«å…ƒ(flyweight)æ¨¡å¼æ˜¯ä¸€ç§ç”¨äºæ€§èƒ½ä¼˜åŒ–çš„æ¨¡å¼ï¼Œâ€œflyâ€åœ¨è¿™é‡Œæ˜¯è‹è‡çš„æ„æ€ï¼Œæ„ä¸ºâ€œè‡é‡çº§â€ã€‚äº«å…ƒæ¨¡å¼çš„æ ¸å¿ƒæ˜¯è¿ç”¨å…±äº«æŠ€æœ¯æ¥æœ‰æ•ˆæ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚ å¦‚æœç³»ç»Ÿä¸­å› ä¸ºåˆ›å»ºäº†å¤§é‡ç±»ä¼¼çš„å¯¹è±¡è€Œå¯¼è‡´å†…å­˜å ç”¨è¿‡é«˜ï¼Œäº«å…ƒæ¨¡å¼å°±éå¸¸æœ‰ç”¨äº†ã€‚åœ¨ JavaScript ä¸­ï¼Œæµè§ˆå™¨ç‰¹åˆ«æ˜¯ç§»åŠ¨ç«¯çš„æµè§ˆå™¨åˆ†é…çš„å†…å­˜å¹¶ä¸ç®—å¤šï¼Œå¦‚ä½•èŠ‚çœå†…å­˜å°±æˆäº†ä¸€ä»¶éå¸¸æœ‰æ„ä¹‰çš„äº‹æƒ…ã€‚ æ•…äº‹èƒŒæ™¯â€‹ å‡è®¾æœ‰ä¸ªå†…è¡£å·¥å‚ï¼Œç›®å‰çš„äº§å“æœ‰ 50 ç§ç”·å¼å†…è¡£å’Œ 50 ç§å¥³å£«å†…è¡£ï¼Œä¸ºäº†æ¨é”€äº§å“ï¼Œå·¥å‚å†³å®šç”Ÿäº§ä¸€äº›å¡‘æ–™æ¨¡ç‰¹æ¥ç©¿ä¸Šä»–ä»¬çš„å†…è¡£æ‹æˆå¹¿å‘Šç…§ç‰‡ã€‚ æ­£å¸¸æƒ…å†µä¸‹éœ€è¦ 50ä¸ªç”·æ¨¡ç‰¹å’Œ50ä¸ªå¥³æ¨¡ç‰¹ï¼Œç„¶åè®©ä»–ä»¬æ¯äººåˆ†åˆ«ç©¿ä¸Šä¸€ä»¶å†…è¡£æ¥æ‹ç…§ã€‚ ä»£ç å®ç°(æœªä½¿ç”¨äº«å…ƒæ¨¡å¼)1234567891011121314151617181920class Model { constructor(sex, underwear) { this.sex = sex; this.underwear = underwear; } takePhoto() { console.log('sex= ' + this.sex + ' underwear=' + this.underwear); };}for (let i = 1; i &lt;= 50; i++) { let maleModel = new Model('male', 'underwear' + i); maleModel.takePhoto();}for (let j = 1; j &lt;= 50; j++) { let femaleModel = new Model('female', 'underwear' + j); femaleModel.takePhoto();} æ€è€ƒï¼šçœŸçš„éœ€è¦å¦‚æ­¤å¤šæ•°é‡çš„å¯¹è±¡å—ï¼Ÿâ€‹ å¦‚ä¸Šæ‰€è¿°ï¼Œç°åœ¨ä¸€å…±æœ‰ 50 ç§ç”·å†… è¡£å’Œ 50 ç§å¥³å†…è¡£ï¼Œæ‰€ä»¥ä¸€å…±ä¼šäº§ç”Ÿ 100 ä¸ªå¯¹è±¡ã€‚å¦‚æœå°†æ¥ç”Ÿäº§äº† 10000 ç§å†…è¡£ï¼Œé‚£è¿™ä¸ªç¨‹åºå¯èƒ½ä¼šå› ä¸ºå­˜åœ¨å¦‚æ­¤å¤šçš„å¯¹è±¡å·²ç»æå‰å´©æºƒã€‚ ä¸‹é¢æˆ‘ä»¬æ¥è€ƒè™‘ä¸€ä¸‹å¦‚ä½•ä¼˜åŒ–è¿™ä¸ªåœºæ™¯ã€‚è™½ç„¶æœ‰ 100 ç§å†…è¡£ï¼Œä½†å¾ˆæ˜¾ç„¶å¹¶ä¸éœ€è¦ 50 ä¸ªç”·æ¨¡ç‰¹å’Œ 50 ä¸ªå¥³æ¨¡ç‰¹ã€‚å…¶å®ç”·æ¨¡ç‰¹å’Œå¥³æ¨¡ç‰¹å„è‡ªæœ‰ä¸€ä¸ªå°±è¶³å¤Ÿäº†ï¼Œä»–ä»¬å¯ä»¥åˆ†åˆ«ç©¿ä¸Šä¸åŒçš„å†…è¡£æ¥æ‹ç…§ã€‚ ä»£ç é‡æ„(äº«å…ƒæ¨¡å¼)123456789101112131415161718192021222324252627// åªéœ€è¦åŒºåˆ«ç”·å¥³æ¨¡ç‰¹// é‚£æˆ‘ä»¬å…ˆæŠŠ underwear å‚æ•°ä»æ„é€ å‡½æ•°ä¸­ ç§»é™¤ï¼Œæ„é€ å‡½æ•°åªæ¥æ”¶ sex å‚æ•°class Model { constructor(sex) { this.sex = sex; } takePhoto() { console.log('sex= ' + this.sex + ' underwear=' + this.underwear); };}// åˆ†åˆ«åˆ›å»ºä¸€ä¸ªç”·æ¨¡ç‰¹å¯¹è±¡å’Œä¸€ä¸ªå¥³æ¨¡ç‰¹å¯¹è±¡let maleModel = new Model('male'), femaleModel = new Model('female');// ç»™ç”·æ¨¡ç‰¹ä¾æ¬¡ç©¿ä¸Šæ‰€æœ‰çš„ç”·è£…ï¼Œå¹¶è¿›è¡Œæ‹ç…§for (let i = 1; i &lt;= 50; i++) { maleModel.underwear = 'underwear' + i; // è®¾ç½®å¤–éƒ¨çŠ¶æ€ maleModel.takePhoto();}// ç»™å¥³æ¨¡ç‰¹ä¾æ¬¡ç©¿ä¸Šæ‰€æœ‰çš„å¥³è£…ï¼Œå¹¶è¿›è¡Œæ‹ç…§for (let j = 1; j &lt;= 50; j++) { femaleModel.underwear = 'underwear' + j; // è®¾ç½®å¤–éƒ¨çŠ¶æ€ femaleModel.takePhoto();} åªéœ€è¦ä¸¤ä¸ªå¯¹è±¡ä¾¿å®Œæˆäº†åŒæ ·çš„åŠŸèƒ½ å¦‚ä½•ä½¿ç”¨äº«å…ƒæ¨¡å¼äº«å…ƒæ¨¡å¼è¦æ±‚å°†å¯¹è±¡çš„å±æ€§åˆ’åˆ†ä¸ºå†…éƒ¨çŠ¶æ€ä¸å¤–éƒ¨çŠ¶æ€(çŠ¶æ€åœ¨è¿™é‡Œé€šå¸¸æŒ‡å±æ€§)ã€‚äº«å…ƒæ¨¡å¼çš„ç›®æ ‡æ˜¯å°½é‡å‡å°‘å…±äº«å¯¹è±¡çš„æ•°é‡ï¼Œå…³äºå¦‚ä½•åˆ’åˆ†å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€ï¼Œä¸‹é¢çš„å‡ æ¡ç»éªŒæä¾›äº†ä¸€äº›æŒ‡å¼• å†…éƒ¨çŠ¶æ€å¯ä»¥è¢«ä¸€äº›å¯¹è±¡å…±äº« å†…éƒ¨çŠ¶æ€ç‹¬ç«‹äºå…·ä½“çš„åœºæ™¯ï¼Œé€šå¸¸ä¸ä¼šæ”¹å˜ å¤–éƒ¨çŠ¶æ€å–å†³äºå…·ä½“çš„åœºæ™¯ï¼Œå¹¶æ ¹æ®åœºæ™¯è€Œå˜åŒ–ï¼Œå¤–éƒ¨çŠ¶æ€ä¸èƒ½è¢«å…±äº« åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ€§åˆ«æ˜¯å†…éƒ¨çŠ¶æ€ï¼Œå†…è¡£æ˜¯å¤–éƒ¨çŠ¶æ€ï¼Œé€šè¿‡åŒºåˆ†è¿™ä¸¤ç§çŠ¶æ€ï¼Œå¤§å¤§å‡å°‘äº†ç³»ç»Ÿä¸­çš„å¯¹è±¡æ•°é‡ã€‚é€šå¸¸æ¥è®²ï¼Œå†…éƒ¨çŠ¶æ€æœ‰å¤šå°‘ç§ç»„åˆï¼Œç³»ç»Ÿä¸­ä¾¿æœ€å¤šå­˜åœ¨å¤šå°‘ä¸ªå¯¹è±¡ï¼Œå› ä¸ºæ€§åˆ«é€šå¸¸åªæœ‰ç”·å¥³ä¸¤ç§ï¼Œæ‰€ä»¥è¯¥å†…è¡£å‚å•†æœ€å¤šåªéœ€è¦ 2 ä¸ªå¯¹è±¡ã€‚ äº«å…ƒæ¨¡å¼çš„é€šç”¨ç»“æ„é—®é¢˜å¼•å…¥ æˆ‘ä»¬é€šè¿‡æ„é€ å‡½æ•°æ˜¾ç¤ºnewå‡ºäº†ç”·å¥³ä¸¤ä¸ªmodelå¯¹è±¡ï¼Œåœ¨å…¶ä»–ç³»ç»Ÿä¸­ï¼Œä¹Ÿè®¸å¹¶ä¸æ˜¯ä¸€å¼€å§‹å°±éœ€è¦æ‰€æœ‰çš„å…±äº«å¯¹è±¡ ç»™modelå¯¹è±¡æ‰‹åŠ¨è®¾ç½®äº†underwearå¤–éƒ¨çŠ¶æ€ï¼Œåœ¨æ›´å¤æ‚çš„ç³»ç»Ÿä¸­ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªæœ€å¥½çš„æ–¹å¼ï¼Œå› ä¸ºå¤–éƒ¨çŠ¶æ€å¯èƒ½ç›¸å½“å¤æ‚ï¼Œå®ƒä»¬ä¸å…±äº«å¯¹è±¡çš„è”ç³»ä¼šå˜å¾—å›°éš¾ è§£å†³æ–¹æ¡ˆç¬¬ä¸€ä¸ªé—®é¢˜å¯ä»¥ç”¨å·¥å‚æ¨¡å¼è§£å†³ï¼Œå¦‚æœæŸç§å†…éƒ¨çŠ¶æ€å¯¹åº”çš„å…±äº«å¯¹è±¡å·²ç»è¢«åˆ›å»ºè¿‡ï¼Œé‚£ä¹ˆç›´æ¥è¿”å›è¿™ä¸ªå¯¹è±¡ ç¬¬äºŒä¸ªé—®é¢˜å¯ä»¥ç”¨ä¸€ä¸ªç®¡ç†å™¨è®°å½•å¯¹è±¡ç›¸å…³çš„å¤–éƒ¨çŠ¶æ€ï¼Œä½¿è¿™äº›å¤–éƒ¨çŠ¶æ€é€šè¿‡æŸä¸ªé’©å­å’Œå…±äº«å¯¹è±¡è”ç³»èµ·æ¥ äº«å…ƒæ¨¡å¼çš„æ›¿ä»£æ–¹æ¡ˆ â€”â€” å¯¹è±¡æ± â€‹ å¯¹è±¡æ± æ˜¯å¦å¤–ä¸€ç§æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆï¼Œå®ƒè·Ÿäº«å…ƒæ¨¡å¼æœ‰ä¸€äº›ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†æ²¡æœ‰åˆ†ç¦»å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€è¿™ä¸ªè¿‡ç¨‹ã€‚å¯¹è±¡æ± ç»´æŠ¤ä¸€ä¸ªè£…è½½ç©ºé—²å¯¹è±¡çš„æ± å­ï¼Œå¦‚æœéœ€è¦å¯¹è±¡çš„æ—¶å€™ï¼Œä¸æ˜¯ç›´æ¥ newï¼Œè€Œæ˜¯è½¬ä»å¯¹è±¡æ± é‡Œè·å–ã€‚å¦‚æœå¯¹è±¡æ± é‡Œæ²¡æœ‰ç©ºé—²å¯¹è±¡ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå½“è·å–å‡ºçš„å¯¹è±¡å®Œæˆå®ƒçš„èŒè´£ä¹‹åï¼Œ å†è¿›å…¥æ± å­ç­‰å¾…è¢«ä¸‹æ¬¡è·å–ã€‚ é€šç”¨çš„å¯¹è±¡æ± å®ç°123456789101112131415// é€šç”¨çš„å¯¹è±¡æ± let objectPoolFactory = function (createObjFn) { let objectPool = []; return { create: function () { return objectPool.length === 0 ? createObjFn.apply(this, arguments) : objectPool.shift(); }, recover: function (obj) { objectPool.push(obj); }, };}; ç°åœ¨åˆ©ç”¨objectPoolFactoryæ¥åˆ›å»ºä¸€ä¸ªè£…è½½ä¸€äº› iframe çš„å¯¹è±¡æ±  1234567891011121314151617181920let iframeFactory = objectPoolFactory(function () { let iframe = document.createElement(&quot;iframe&quot;); document.body.appendChild(iframe); iframe.onload = function () { iframe.onload = null; // é˜²æ­¢ iframe é‡å¤åŠ è½½çš„ bug iframeFactory.recover(iframe);// iframe åŠ è½½å®Œæˆä¹‹åå›æ”¶èŠ‚ç‚¹ }; return iframe;});let iframe1 = iframeFactory.create();iframe1.src = &quot;http:// baidu.com&quot;;let iframe2 = iframeFactory.create();iframe2.src = &quot;http:// QQ.com&quot;;setTimeout(function () { let iframe3 = iframeFactory.create(); iframe3.src = &quot;http:// 163.com&quot;;}, 3000); å¯¹è±¡æ± çš„åº”ç”¨éå¸¸å¹¿æ³›ï¼ŒHTTPè¿æ¥æ± å’Œæ•°æ®åº“è¿æ¥æ± éƒ½æ˜¯å…¶ä»£è¡¨åº”ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨åœ¨domçš„é‡å¤åˆ©ç”¨ä¸Šã€‚ å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹","link":"/2021/02/06/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/"},{"title":"æ¨¡æ¿æ–¹æ³•æ¨¡å¼","text":"åœ¨æ¨¡æ¿æ¨¡å¼ï¼ˆTemplate Patternï¼‰ä¸­ï¼Œä¸€ä¸ªæŠ½è±¡ç±»å…¬å¼€å®šä¹‰äº†æ‰§è¡Œå®ƒçš„æ–¹æ³•çš„æ–¹å¼/æ¨¡æ¿ã€‚å®ƒçš„å­ç±»å¯ä»¥æŒ‰éœ€è¦é‡å†™æ–¹æ³•å®ç°ï¼Œä½†è°ƒç”¨å°†ä»¥æŠ½è±¡ç±»ä¸­å®šä¹‰çš„æ–¹å¼è¿›è¡Œ Coffee or Teaæˆ‘ä»¬ç°åœ¨éœ€è¦å†²æ³¡ä¸€æ¯å’–å•¡å’Œä¸€å£¶èŒ¶ï¼Œå®ƒä»¬çš„æ“ä½œæ­¥éª¤åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œå¦‚ä¸‹æ‰€ç¤º æ³¡å’–å•¡ æ³¡èŒ¶ æŠŠæ°´ç…®æ²¸ æŠŠæ°´ç…®æ²¸ ç”¨æ²¸æ°´å†²æ³¡å’–å•¡ ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶ æŠŠå’–å•¡å€’è¿›æ¯å­ æŠŠèŒ¶æ°´å€’è¿›æ¯å­ åŠ ç³–å’Œç‰›å¥¶ åŠ æŸ æª¬ åŸºæœ¬çš„æ­¥éª¤æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æŠ½è±¡ç±»çš„å½¢å¼ï¼ŒæŠŠæ­¥éª¤æ¡†æ¶æŠ½è±¡å‡ºæ¥ï¼ŒCoffeeç±»å’ŒTeaç±»ç»§æ‰¿è¿™ä¸ªæŠ½è±¡ç±»ï¼Œå†å„è‡ªå®ç°æŠ½è±¡çˆ¶ç±»ä¸Šçš„æ–¹æ³•ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071// åˆ›å»ºä¸€ä¸ªæŠ½è±¡çˆ¶ç±»æ¥è¡¨ç¤ºæ³¡ä¸€æ¯é¥®æ–™çš„æ•´ä¸ªè¿‡ç¨‹ã€‚// ä¸è®ºæ˜¯ Coffee,è¿˜æ˜¯ Tea,éƒ½è¢«æˆ‘ä»¬ç”¨Beverageæ¥è¡¨ç¤ºclass Beverage { boilWater() { console.log('æŠŠæ°´ç…®æ²¸'); }; brew() { throw new Error('å­ç±»å¿…é¡»é‡å†™ brew æ–¹æ³•'); }; pourInCup() { throw new Error('å­ç±»å¿…é¡»é‡å†™ pourInCup æ–¹æ³•'); }; addCondiments() { throw new Error('å­ç±»å¿…é¡»é‡å†™ addCondiments æ–¹æ³•'); }; init() { // æ¨¡æ¿æ–¹æ³• this.boilWater(); this.brew(); this.pourInCup(); this.addCondiments(); };}// åˆ›å»ºCoffeeç±»class Coffee extends Beverage { brew() { console.log('ç”¨æ²¸æ°´å†²æ³¡å’–å•¡'); }; pourInCup() { console.log('æŠŠå’–å•¡å€’è¿›æ¯å­'); }; addCondiments() { console.log('åŠ ç³–å’Œç‰›å¥¶'); };}let coffee = new Coffee();coffee.init();// æŠŠæ°´ç…®æ²¸// ç”¨æ²¸æ°´å†²æ³¡å’–å•¡// æŠŠå’–å•¡å€’è¿›æ¯å­// åŠ ç³–å’Œç‰›å¥¶// åˆ›å»ºTeaç±»class Tea extends Beverage { brew() { console.log('ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶'); }; pourInCup() { console.log('æŠŠèŒ¶å€’è¿›æ¯å­'); }; addCondiments() { console.log('åŠ æŸ æª¬'); };}let tea = new Tea();tea.init();// æŠŠæ°´ç…®æ²¸// ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶// æŠŠèŒ¶å€’è¿›æ¯å­// åŠ æŸ æª¬ ä¸Šé¢ä»£ç ä¸­ï¼ŒBeverageçˆ¶ç±»é‡Œçš„initæ–¹æ³•å³ä¸ºæ¨¡æ¿æ–¹æ³•ï¼Œinitå°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æ¶ï¼Œä½œä¸ºç®—æ³•çš„æ¨¡æ¿ï¼ŒæŒ‡å¯¼å­ç±»ä»¥ä½•ç§é¡ºåºå»æ‰§è¡Œå“ªäº›æ–¹æ³•ã€‚ å¥½è±ååŸåˆ™â€‹ å¥½è±åæ— ç–‘æ˜¯æ¼”å‘˜çš„å¤©å ‚ï¼Œä½†å¥½è±åä¹Ÿæœ‰å¾ˆå¤šæ‰¾ä¸åˆ°å·¥ä½œçš„æ–°äººæ¼”å‘˜ï¼Œè®¸å¤šæ–°äººæ¼”å‘˜åœ¨å¥½è±åæŠŠç®€å†é€’ç»™æ¼”è‰ºå…¬å¸ä¹‹åå°±åªæœ‰å›å®¶ç­‰å¾…ç”µè¯ã€‚æœ‰æ—¶å€™è¯¥æ¼”å‘˜ç­‰å¾—ä¸è€çƒ¦äº†ï¼Œç»™æ¼”è‰ºå…¬å¸æ‰“ç”µè¯è¯¢é—®æƒ…å†µï¼Œæ¼”è‰ºå…¬å¸å¾€å¾€è¿™æ ·å›ç­”ï¼šâ€œä¸è¦æ¥æ‰¾æˆ‘ï¼Œæˆ‘ä¼šç»™ä½ æ‰“ç”µè¯ã€‚â€ åœ¨è®¾è®¡ä¸­ï¼Œè¿™æ ·çš„è§„åˆ™å°±ç§°ä¸ºå¥½è±ååŸåˆ™ã€‚åœ¨è¿™ä¸€åŸåˆ™çš„æŒ‡å¯¼ä¸‹ï¼Œæˆ‘ä»¬å…è®¸åº•å±‚ç»„ä»¶å°†è‡ªå·±æŒ‚é’©åˆ°é«˜å±‚ç»„ä»¶ä¸­ï¼Œè€Œé«˜å±‚ç»„ä»¶ä¼šå†³å®šä»€ä¹ˆæ—¶å€™ã€ä»¥ä½•ç§æ–¹å¼å»ä½¿ç”¨è¿™äº›åº•å±‚ç»„ä»¶ï¼Œé«˜å±‚ç»„ä»¶å¯¹ å¾…åº•å±‚ç»„ä»¶çš„æ–¹å¼ï¼Œè·Ÿæ¼”è‰ºå…¬å¸å¯¹å¾…æ–°äººæ¼”å‘˜ä¸€æ ·ï¼Œéƒ½æ˜¯â€œåˆ«è°ƒç”¨æˆ‘ä»¬ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨ä½ â€ã€‚â€‹ æ¯”å¦‚å‘å¸ƒè®¢é˜…æ¨¡å¼å’Œå›è°ƒå‡½æ•° æ˜¯å¦çœŸçš„éœ€è¦ç»§æ‰¿åœ¨JavaScriptè¿™ç§çµæ´»çš„è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬æ˜¯å¦çœŸçš„éœ€è¦ä½¿ç”¨ç»§æ‰¿è¿™ç§é‡æ­¦å™¨å‘¢ã€‚åœ¨å¥½è±ååŸåˆ™çš„æŒ‡å¯¼ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é‡æ„ä¸Šé¢çš„ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546let Beverage = function (param) { let boilWater = function () { console.log('æŠŠæ°´ç…®æ²¸'); }; let brew = param.brew || function () { throw new Error('å¿…é¡»ä¼ é€’ brew æ–¹æ³•'); }; let pourInCup = param.pourInCup || function () { throw new Error('å¿…é¡»ä¼ é€’ pourInCup æ–¹æ³•'); }; let addCondiments = param.addCondiments || function () { throw new Error('å¿…é¡»ä¼ é€’ addCondiments æ–¹æ³•'); }; let F = function () {}; F.prototype.init = function () { boilWater(); brew(); pourInCup(); addCondiments(); }; return F;};let Coffee = Beverage({ brew() { console.log('ç”¨æ²¸æ°´å†²æ³¡å’–å•¡'); }, pourInCup() { console.log('æŠŠå’–å•¡å€’è¿›æ¯å­'); }, addCondiments() { console.log('åŠ ç³–å’Œç‰›å¥¶'); }});let Tea = Beverage({ brew() { console.log('ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶'); }, pourInCup() { console.log('æŠŠèŒ¶å€’è¿›æ¯å­'); }, addCondiments() { console.log('åŠ æŸ æª¬'); }}); æ€»ç»“â€‹ æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ˜¯ä¸€ç§å…¸å‹çš„é€šè¿‡å°è£…å˜åŒ–æé«˜ç³»ç»Ÿæ‰©å±•æ€§çš„è®¾è®¡æ¨¡å¼ã€‚åœ¨ä¼ ç»Ÿçš„é¢å‘å¯¹è±¡è¯­è¨€ä¸­ï¼Œä¸€ä¸ªè¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ç¨‹åºä¸­ï¼Œå­ç±»çš„æ–¹æ³•ç§ç±»å’Œæ‰§è¡Œé¡ºåºéƒ½æ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠè¿™éƒ¨åˆ†é€»è¾‘æŠ½è±¡åˆ°çˆ¶ç±»çš„æ¨¡æ¿æ–¹æ³•é‡Œé¢ã€‚è€Œå­ç±»çš„æ–¹æ³•å…·ä½“æ€ä¹ˆå®ç°åˆ™æ˜¯å¯å˜çš„ï¼Œäºæ˜¯æˆ‘ä»¬æŠŠè¿™éƒ¨åˆ†å˜åŒ–çš„é€»è¾‘å°è£…åˆ°å­ç±»ä¸­ã€‚é€šè¿‡å¢åŠ æ–°çš„å­ç±»ï¼Œæˆ‘ä»¬ä¾¿èƒ½ç»™ç³»ç»Ÿå¢åŠ æ–°çš„åŠŸèƒ½ï¼Œå¹¶ä¸éœ€è¦æ”¹åŠ¨æŠ½è±¡çˆ¶ç±»ä»¥åŠå…¶ä»–å­ç±»ï¼Œè¿™ä¹Ÿæ˜¯ç¬¦åˆå¼€æ”¾-å°é—­åŸåˆ™çš„ã€‚ å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹","link":"/2021/02/05/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/"},{"title":"ç»„åˆæ¨¡å¼","text":"ç»„åˆæ¨¡å¼å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ï¼Œä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ã€‚ é™¤äº†ç”¨æ¥è¡¨ç¤ºæ ‘å½¢ç»“æ„ä¹‹å¤–ï¼Œç»„åˆæ¨¡å¼çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯é€šè¿‡å¯¹è±¡çš„å¤šæ€æ€§è¡¨ç°ï¼Œä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ â€‹ åœ¨ç»„åˆæ¨¡å¼ä¸­ï¼Œè¯·æ±‚åœ¨æ ‘ä¸­ä¼ é€’çš„è¿‡ç¨‹æ€»æ˜¯éµå¾ªä¸€ç§é€»è¾‘ã€‚è¯·æ±‚ä»æ ‘æœ€é¡¶ç«¯çš„å¯¹è±¡å¾€ä¸‹ä¼ é€’ï¼Œå¦‚æœå½“å‰å¤„ç†è¯·æ±‚çš„å¯¹è±¡æ˜¯å¶å¯¹è±¡(æ™®é€šå­å‘½ä»¤)ï¼Œå¶å¯¹è±¡è‡ªèº«ä¼šå¯¹è¯·æ±‚ä½œå‡ºç›¸åº”çš„å¤„ç†ï¼Œå¦‚æœå½“å‰å¤„ç†è¯·æ±‚çš„å¯¹è±¡æ˜¯ç»„åˆå¯¹è±¡(å®å‘½ä»¤)ï¼Œ ç»„åˆå¯¹è±¡åˆ™ä¼šéå†å®ƒå±ä¸‹çš„å­èŠ‚ç‚¹ï¼Œå°†è¯·æ±‚ç»§ç»­ä¼ é€’ç»™è¿™äº›å­èŠ‚ç‚¹ã€‚ ç»„åˆæ¨¡å¼ä¸‹æ›´ä¸ºå¼ºå¤§çš„å®å‘½ä»¤â€‹ ç›®å‰çš„ä¸‡èƒ½é¥æ§å™¨ï¼ŒåŒ…å«äº†å…³é—¨ã€å¼€ç”µè„‘ã€ç™»å½• QQ è¿™ 3 ä¸ªå‘½ä»¤ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦ä¸€ä¸ªâ€œè¶…çº§ä¸‡èƒ½é¥æ§å™¨â€ï¼Œå¯ä»¥æ§åˆ¶å®¶é‡Œæ‰€æœ‰çš„ç”µå™¨ï¼Œè¿™ä¸ªé¥æ§å™¨æ‹¥æœ‰ä»¥ä¸‹åŠŸèƒ½ æ‰“å¼€ç©ºè°ƒ æ‰“å¼€ç”µè§†å’ŒéŸ³å“ å…³é—¨ã€å¼€ç”µè„‘ã€ç™»å½• QQ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465let MacroCommand = function () { return { commandsList: [], add: function (command) { this.commandsList.push(command); }, execute: function () { for (let i = 0, command; command = this.commandsList[i++];) { command.execute(); } } }};let openAcCommand = { execute: function () { console.log('æ‰“å¼€ç©ºè°ƒ'); }};// å®¶é‡Œçš„ç”µè§†å’ŒéŸ³å“æ˜¯è¿æ¥åœ¨ä¸€èµ·çš„ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ä¸€ä¸ªå®å‘½ä»¤æ¥ç»„åˆæ‰“å¼€ç”µè§†å’Œæ‰“å¼€éŸ³å“çš„å‘½ä»¤let openTvCommand = { execute: function () { console.log('æ‰“å¼€ç”µè§†'); }};let openSoundCommand = { execute: function () { console.log('æ‰“å¼€éŸ³å“'); }};let macroCommand1 = MacroCommand();macroCommand1.add(openTvCommand);macroCommand1.add(openSoundCommand);// å…³é—¨ã€æ‰“å¼€ç”µè„‘å’Œæ‰“ç™»å½• QQ çš„å‘½ä»¤let closeDoorCommand = { execute: function () { console.log('å…³é—¨'); }};let openPcCommand = { execute: function () { console.log('å¼€ç”µè„‘'); }};let openQQCommand = { execute: function () { console.log('ç™»å½• QQ'); }};let macroCommand2 = MacroCommand();macroCommand2.add(closeDoorCommand);macroCommand2.add(openPcCommand);macroCommand2.add(openQQCommand);// ç°åœ¨æŠŠæ‰€æœ‰çš„å‘½ä»¤ç»„åˆæˆä¸€ä¸ªâ€œè¶…çº§å‘½ä»¤â€let macroCommand = MacroCommand();macroCommand.add(openAcCommand);macroCommand.add(macroCommand1);macroCommand.add(macroCommand2);// æœ€åç»™é¥æ§å™¨ç»‘å®šâ€œè¶…çº§å‘½ä»¤â€let setCommand = (function (command) { document.getElementById('button').onclick = function () { command.execute(); }})(macroCommand); â€‹ ä¸ç®¡æ˜¯å®å‘½ä»¤å¯¹è±¡ï¼Œè¿˜æ˜¯å­å‘½ä»¤å¯¹è±¡ï¼Œéƒ½æœ‰ä¸€ä¸ªexecuteæ–¹æ³•è´Ÿè´£æ‰§è¡Œå‘½ä»¤ã€‚â€‹ è¿™åœ¨é™æ€ç±»å‹è¯­è¨€ä¸­å®ç°æ˜¾çš„å°¤ä¸ºä¾¿åˆ©ï¼Œæ¯”å¦‚åœ¨JAVAä¸­ï¼ŒCompositeç±»å’ŒLeafç±»éƒ½å¿…é¡»ç»§æ‰¿è‡ªä¸€ä¸ªCompenentæŠ½è±¡ç±»ï¼Œè¿™ä¸ªCompenentæŠ½è±¡å³è¡¨ç¤ºç»„åˆå¯¹è±¡ï¼Œåˆä»£è¡¨å¶å¯¹è±¡ï¼Œå®ƒä¹Ÿèƒ½ä¿è¯ä¸¤è€…å‡æœ‰executeæ–¹æ³•ï¼Œä»è€Œåšå‡ºåé¦ˆã€‚ â€‹ ä½†æ˜¯åœ¨JavaScriptè¿™ç§åŠ¨æ€è¯­è¨€ä¸­å®ç°ç»„åˆæ¨¡å¼ï¼Œç”±äºé¸­å­ç±»å‹ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦æœ‰ä¸€ä¸ªCompenentæŠ½è±¡ç±»ï¼Œä½†æ˜¯è¿™ä¹Ÿå¯¼è‡´äº†ä¸€å®šçš„ä¸¥è°¨æ€§ã€‚ é€æ˜æ€§å¸¦æ¥çš„å®‰å…¨é—®é¢˜æˆ‘ä»¬å¯ä»¥ç»™å¶å­èŠ‚ç‚¹ä¹Ÿå¢åŠ addæ–¹æ³•ï¼Œå¹¶åœ¨è°ƒç”¨çš„æ—¶å€™ï¼ŒæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸æ¥æé†’å®¢æˆ·ã€‚æ¯”å¦‚ä¸Šé¢çš„æ‰“å¼€ç”µè§†çš„å‘½ä»¤å¯¹è±¡ï¼š 12345678let openTvCommand = { execute: function () { console.log('æ‰“å¼€ç”µè§†'); }, add: function () { // åŒæ ·çš„æ·»åŠ addæ–¹æ³• throw new Error(&quot;å¶å¯¹è±¡ä¸èƒ½æ·»åŠ å­èŠ‚ç‚¹&quot;); }}; åº”ç”¨åœºæ™¯ â€” æ‰«ææ–‡ä»¶å¤¹â€‹ æ–‡ä»¶å¤¹å’Œæ–‡ä»¶ä¹‹é—´çš„å…³ç³»ï¼Œéå¸¸é€‚åˆç”¨ç»„åˆæ¨¡å¼æ¥æè¿°ã€‚æ–‡ä»¶å¤¹é‡Œæ—¢å¯ä»¥åŒ…å«æ–‡ä»¶ï¼Œåˆå¯ä»¥åŒ…å«å…¶ä»–æ–‡ä»¶å¤¹ï¼Œæœ€ç»ˆå¯èƒ½ç»„åˆæˆä¸€æ£µæ ‘ å½“ä½¿ç”¨ç”¨æ€æ¯’è½¯ä»¶æ‰«æè¯¥æ–‡ä»¶å¤¹æ—¶ï¼Œå¾€å¾€ä¸ä¼šå…³å¿ƒé‡Œé¢æœ‰å¤šå°‘æ–‡ä»¶å’Œå­æ–‡ä»¶å¤¹ï¼Œç»„åˆæ¨¡å¼ä½¿å¾—æˆ‘ä»¬åªéœ€è¦æ“ä½œæœ€å¤–å±‚çš„æ–‡ä»¶å¤¹è¿›è¡Œæ‰«æã€‚ æ³¨æ„ç»„åˆæ¨¡å¼ä¸æ˜¯çˆ¶å­å…³ç³»â€‹ ç»„åˆæ¨¡å¼æ˜¯ä¸€ç§HAS-Aï¼ˆèšåˆï¼‰çš„å…³ç³»ï¼Œè€Œä¸æ˜¯IS-Aï¼›Leafå¹¶ä¸æ˜¯Compositeçš„å­ç±»ã€‚ å¯¹å¶å¯¹è±¡æ“ä½œçš„ä¸€è‡´æ€§â€‹ ç»„åˆæ¨¡å¼é™¤äº†è¦æ±‚ç»„åˆå¯¹è±¡å’Œå¶å­å¯¹è±¡æ‹¥æœ‰ç›¸åŒçš„æ¥å£ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªå¿…è¦æ¡ä»¶ï¼Œå°±æ˜¯å¯¹ä¸€ç»„å¶å¯¹è±¡çš„æ“ä½œçš„ä¸€è‡´æ€§ã€‚ â€‹ æ¯”å¦‚å…¬å¸è¦ç»™å…¨ä½“å‘˜å·¥å‘å…ƒæ—¦çš„è¿‡èŠ‚è´¹1000å…ƒï¼Œè¿™ä¸ªåœºæ™¯å¯ä»¥è¿ç”¨ç»„åˆæ¨¡å¼ï¼Œä½†å¦‚æœå…¬å¸è¦ç»™ä»Šå¤©è¿‡ç”Ÿæ—¥çš„å‘˜å·¥å‘é€ä¸€å°ç”Ÿæ—¥ç¥ç¦çš„é‚®ä»¶ï¼Œç»„åˆæ¨¡å¼å°±åšä¸åˆ°äº†ï¼Œé™¤éå…ˆæŠŠä»Šå¤©è¿‡ç”Ÿæ—¥çš„å‘˜å·¥æŒ‘é€‰å‡ºæ¥ã€‚åªæœ‰ç”¨ä¸€è‡´çš„æ–¹å¼å¯¹å¾…åˆ—è¡¨ä¸­çš„æ¯ä¸€ä¸ªå¶å­å¯¹è±¡çš„æ—¶å€™ï¼Œæ‰é€‚åˆä½¿ç”¨ç»„åˆæ¨¡å¼ã€‚ åŒå‘æ˜ å°„å…³ç³»â€‹ å‘æ”¾è¿‡èŠ‚è´¹çš„é€šçŸ¥æ­¥éª¤æ˜¯ä»å…¬å¸åˆ°å„ä¸ªéƒ¨é—¨ï¼Œå†åˆ°å„ä¸ªå°ç»„ï¼Œæœ€ååˆ°æ¯ä¸ªå‘˜å·¥çš„é‚®ç®±é‡Œã€‚è¿™æœ¬èº«æ˜¯ä¸€ä¸ªç»„åˆæ¨¡å¼çš„å¥½ä¾‹å­ï¼Œä½†æŸäº›å‘˜å·¥å¯èƒ½éš¶å±äºå¤šä¸ªç»„ç»‡ï¼Œå¯¹è±¡ä¹‹é—´çš„å…³ç³»å¹¶ä¸æ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šçš„å±‚æ¬¡ç»“æ„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯ä¸é€‚åˆä½¿ç”¨ç»„åˆæ¨¡å¼çš„ï¼Œè¯¥å‘˜å·¥å¯èƒ½æ”¶åˆ°å¤šä»½è¿‡èŠ‚è´¹ã€‚ â€‹ è¿™ç§å¤åˆæƒ…å†µä¸‹æˆ‘ä»¬å¿…é¡»ç»™çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹å»ºç«‹åŒå‘æ˜ å°„å…³ç³»ï¼Œä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯ç»™å°ç»„å’Œå‘˜å·¥å¯¹è±¡éƒ½å¢åŠ é›†åˆæ¥ä¿å­˜å¯¹æ–¹çš„å¼•ç”¨ã€‚ä½†æ˜¯è¿™ç§ç›¸äº’é—´çš„å¼•ç”¨ç›¸å½“å¤æ‚ï¼Œè€Œä¸”å¯¹è±¡ä¹‹é—´äº§ç”Ÿäº†è¿‡å¤šçš„è€¦åˆæ€§ï¼Œä¿®æ”¹æˆ–è€…åˆ é™¤ä¸€ä¸ªå¯¹è±¡éƒ½å˜å¾—å›°éš¾ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥å¼•å…¥ä¸­ä»‹è€…æ¨¡å¼æ¥ç®¡ç†è¿™äº›å¯¹è±¡ã€‚ ç”¨èŒè´£é“¾æ¨¡å¼æé«˜ç»„åˆæ¨¡å¼æ€§èƒ½â€‹ åœ¨ç»„åˆæ¨¡å¼ä¸­ï¼Œå¦‚æœæ ‘çš„ç»“æ„æ¯”è¾ƒå¤æ‚ï¼ŒèŠ‚ç‚¹æ•°é‡å¾ˆå¤šï¼Œåœ¨éå†æ ‘çš„è¿‡ç¨‹ä¸­ï¼Œæ€§èƒ½æ–¹é¢ä¹Ÿè®¸è¡¨ç°çš„ä¸å¤Ÿç†æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©èŒè´£é“¾æ¨¡å¼é¿å…éå†æ•´æ£µæ ‘ã€‚èŒè´£é“¾æ¨¡å¼ä¸€èˆ¬éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å»è®¾ç½®é“¾æ¡ï¼Œä½†åœ¨ç»„åˆæ¨¡å¼ä¸­ï¼Œçˆ¶å¯¹è±¡å’Œå­å¯¹è±¡ä¹‹é—´å®é™…å½¢æˆäº†å¤©ç„¶çš„èŒè´£é“¾ã€‚è®©è¯·æ±‚é¡ºç€é“¾æ¡ä»çˆ¶å¯¹è±¡å¾€å­å¯¹è±¡ä¼ é€’ï¼Œæˆ–è€…æ˜¯åè¿‡æ¥ä»å­å¯¹è±¡å¾€çˆ¶å¯¹è±¡ä¼ é€’ï¼Œç›´åˆ°é‡åˆ°å¯ä»¥å¤„ç†è¯¥è¯·æ±‚çš„å¯¹è±¡ä½ç½®ã€‚ å¼•ç”¨çˆ¶å¯¹è±¡åœ¨ç»„åˆæ¨¡å¼ä¸­ä½¿ç”¨èŒè´£é“¾æ—¶ï¼Œæœ‰å¯èƒ½éœ€è¦è®©è¯·æ±‚ä»å­èŠ‚ç‚¹å¾€çˆ¶èŠ‚ç‚¹ä¸Šå†’æ³¡ä¼ é€’ åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå½“æˆ‘ä»¬åˆ é™¤æŸä¸ªæ–‡ä»¶å¤¹çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯ä»è¿™ä¸ªæ–‡ä»¶å¤¹æ‰€åœ¨çš„ä¸Šå±‚æ–‡ä»¶å¤¹ä¸­åˆ é™¤æ”¹æ–‡ä»¶çš„ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859class Folder { constructor(name) { this.name = name; this.parent = null; // å¢åŠ  this.parent å±æ€§ this.files = []; } add(file) { file.parent = this; // è®¾ç½®çˆ¶å¯¹è±¡ this.files.push(file); } scan() { console.log('å¼€å§‹æ‰«ææ–‡ä»¶å¤¹: ' + this.name); for (let i = 0, file, files = this.files; file = files[i++];) { file.scan(); } }; remove() { if (!this.parent) { // æ ¹èŠ‚ç‚¹æˆ–è€…æ ‘å¤–çš„æ¸¸ç¦»èŠ‚ç‚¹ return; } for (let files = this.parent.files, l = files.length - 1; l &gt;= 0; l--) { // ä»çˆ¶ç›®å½•ä¸‹æœç´¢åˆ é™¤å½“å‰æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ let file = files[l]; if (file === this) { files.splice(l, 1); } } };}class File { constructor(name) { this.name = name; this.parent = null; } add() { throw new Error('ä¸èƒ½æ·»åŠ åœ¨æ–‡ä»¶ä¸‹é¢'); } scan() { console.log('å¼€å§‹æ‰«ææ–‡ä»¶: ' + this.name); } remove() { if (!this.parent) { //æ ¹èŠ‚ç‚¹æˆ–è€…æ ‘å¤–çš„æ¸¸ç¦»èŠ‚ç‚¹ return; } for (let files = this.parent.files, l = files.length - 1; l &gt;= 0; l--) { let file = files[l]; if (file === this) { files.splice(l, 1); } } };} ä½•æ—¶ä½¿ç”¨ç»„åˆæ¨¡å¼ è¡¨ç¤ºå¯¹è±¡çš„éƒ¨åˆ†-æ•´ä½“å±‚æ¬¡ç»“æ„ã€‚ç»„åˆæ¨¡å¼å¯ä»¥æ–¹ä¾¿çš„æ„é€ ä¸€æ£µæ ‘æ¥è¡¨ç¤ºå¯¹è±¡çš„éƒ¨åˆ†-æ•´ä½“ç»“æ„ã€‚ç‰¹åˆ«æ˜¯æˆ‘ä»¬ä¸ç¡®å®šè¯¥æ ‘åˆ°åº•å­˜åœ¨å¤šå°‘å±‚æ¬¡çš„æ—¶å€™ ç”¨æˆ·å¸Œæœ›ä»¥ç»Ÿä¸€çš„æ–¹å¼å¯¹å¾…æ ‘ä¸­çš„æ‰€æœ‰å¯¹è±¡ ç¼ºç‚¹â€‹ ç»„åˆæ¨¡å¼å¹¶ä¸æ˜¯å®Œç¾çš„ï¼Œå®ƒå¯èƒ½ä¼šäº§ç”Ÿä¸€ä¸ªè¿™æ ·çš„ç³»ç»Ÿ:ç³»ç»Ÿä¸­çš„æ¯ä¸ªå¯¹è±¡çœ‹èµ·æ¥éƒ½ä¸å…¶ä»–å¯¹è±¡å·®ä¸å¤šã€‚å®ƒä»¬çš„åŒºåˆ«åªæœ‰åœ¨è¿è¡Œçš„æ—¶å€™ä¼šæ‰ä¼šæ˜¾ç°å‡ºæ¥ï¼Œè¿™ä¼šä½¿ä»£ç éš¾ä»¥ç†è§£ã€‚æ­¤å¤–,å¦‚æœé€šè¿‡ç»„åˆæ¨¡å¼åˆ›å»ºäº†å¤ªå¤šçš„å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™äº›å¯¹è±¡å¯èƒ½ä¼šè®©ç³»ç»Ÿè´Ÿæ‹…ä¸èµ·ã€‚ å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹","link":"/2021/02/04/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/"},{"title":"å‘½ä»¤æ¨¡å¼","text":"å°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿ä½ å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼›å¯¹è¯·æ±‚æ’é˜Ÿæˆ–è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒå¯æ’¤é”€çš„æ“ä½œ åº”ç”¨åœºæ™¯â€‹ æœ‰æ—¶å€™éœ€è¦å‘æŸäº›å¯¹è±¡å‘é€è¯·æ±‚ï¼Œä½†æ˜¯å¹¶ä¸çŸ¥é“è¯·æ±‚çš„æ¥æ”¶è€…æ˜¯è°ï¼Œä¹Ÿä¸çŸ¥é“è¢«è¯·æ±‚çš„æ“ä½œæ˜¯ä»€ä¹ˆã€‚æ­¤æ—¶å¸Œæœ›ç”¨ä¸€ç§æ¾è€¦åˆçš„æ–¹å¼æ¥è®¾è®¡ç¨‹åºï¼Œä½¿å¾—è¯·æ±‚å‘é€è€…å’Œè¯·æ±‚æ¥æ”¶è€…èƒ½å¤Ÿæ¶ˆé™¤å½¼æ­¤ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚ èœå•æ¡ˆä¾‹åœºæ™¯ å‡è®¾æˆ‘ä»¬æ­£åœ¨ç¼–å†™ä¸€ä¸ªç”¨æˆ·ç•Œé¢ç¨‹åºï¼Œè¯¥ç”¨æˆ·ç•Œé¢ä¸Šè‡³å°‘æœ‰æ•°åä¸ª Button æŒ‰é’®ã€‚å› ä¸ºé¡¹ç›®æ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬å†³å®šè®©æŸä¸ªç¨‹åºå‘˜è´Ÿè´£ç»˜åˆ¶è¿™äº›æŒ‰é’®ï¼Œè€Œå¦å¤–ä¸€äº›ç¨‹åºå‘˜åˆ™è´Ÿè´£ç¼–å†™ç‚¹å‡»æŒ‰é’®åçš„å…·ä½“è¡Œä¸ºï¼Œè¿™äº›è¡Œä¸ºéƒ½å°†è¢«å°è£…åœ¨å¯¹è±¡é‡Œã€‚ åœ¨å¤§å‹é¡¹ç›®å¼€å‘ä¸­ï¼Œè¿™æ˜¯å¾ˆæ­£å¸¸çš„åˆ†å·¥ã€‚å¯¹äºç»˜åˆ¶æŒ‰é’®çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œä»–å®Œå…¨ä¸çŸ¥é“æŸä¸ªæŒ‰é’®æœªæ¥å°†ç”¨æ¥åšä»€ä¹ˆï¼Œå¯èƒ½ç”¨æ¥åˆ·æ–°èœå•ç•Œé¢ï¼Œä¹Ÿå¯èƒ½ç”¨æ¥å¢åŠ ä¸€äº›å­èœå•ï¼Œä»–åªçŸ¥é“ç‚¹å‡»è¿™ä¸ª æŒ‰é’®ä¼šå‘ç”ŸæŸäº›äº‹æƒ…ã€‚é‚£ä¹ˆå½“å®Œæˆè¿™ä¸ªæŒ‰é’®çš„ç»˜åˆ¶ä¹‹åï¼Œåº”è¯¥å¦‚ä½•ç»™å®ƒç»‘å®šonclick äº‹ä»¶å‘¢? æˆ‘ä»¬å¾ˆå¿«å¯ä»¥æ‰¾åˆ°åœ¨è¿™é‡Œè¿ç”¨å‘½ä»¤æ¨¡å¼çš„ç†ç”±:ç‚¹å‡»äº†æŒ‰é’®ä¹‹åï¼Œå¿…é¡»å‘æŸäº›è´Ÿè´£å…·ä½“è¡Œä¸ºçš„å¯¹è±¡å‘é€è¯·æ±‚ï¼Œè¿™äº›å¯¹è±¡å°±æ˜¯è¯·æ±‚çš„æ¥æ”¶è€…ã€‚ä½†æ˜¯ç›®å‰å¹¶ä¸çŸ¥é“æ¥æ”¶è€…æ˜¯ä»€ä¹ˆå¯¹è±¡ï¼Œä¹Ÿä¸çŸ¥é“æ¥æ”¶è€…ç©¶ç«Ÿä¼šåšä»€ä¹ˆã€‚æ­¤æ—¶æˆ‘ä»¬éœ€è¦å€ŸåŠ©å‘½ä»¤å¯¹è±¡çš„å¸®åŠ©ï¼Œä»¥ä¾¿è§£å¼€æŒ‰é’®å’Œè´Ÿè´£å…·ä½“è¡Œä¸ºå¯¹è±¡ä¹‹é—´çš„è€¦åˆã€‚ ä»£ç å®ç°1234567891011121314let RefreshMenuBarCommand = function (receiver) { return { execute: function () { receiver.refresh(); } }};let setCommand = function (button, command) { button.onclick = function () { command.execute(); }};let refreshMenuBarCommand = RefreshMenuBarCommand(MenuBar);setCommand(button1, refreshMenuBarCommand); æ’¤é”€å’Œé‡åšå‘½ä»¤åœºæ™¯ å‘½ä»¤æ¨¡å¼çš„ä½œç”¨ä¸ä»…æ˜¯å°è£…è¿ç®—å—ï¼Œè€Œä¸”å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ç»™å‘½ä»¤å¯¹è±¡å¢åŠ æ’¤é”€æ“ä½œã€‚ç°åœ¨é¡µé¢ä¸Šæœ‰æ¸¸æˆéœ€è¦å¯¹å·²ç»è¿›è¡Œçš„æ“ä½œè¿›è¡Œå›æ”¾ 1234567891011121314151617181920212223242526272829303132333435363738394041424344let Ryu = { attack() { console.log(&quot;æ”»å‡»&quot;); }, defense() { console.log(&quot;é˜²å¾¡&quot;); }, jump() { console.log(&quot;è·³è·ƒ&quot;); }, crouch() { console.log(&quot;è¹²ä¸‹&quot;); },}let makeCommand = function (receiver, state) { return receiver[state];}let commands = { &quot;119&quot;: &quot;jump&quot;, // w &quot;115&quot;: &quot;crouch&quot;, // s &quot;97&quot;: &quot;defense&quot;, // a &quot;100&quot;: &quot;attack&quot;, // d}let commandStack = []; // ä¿å­˜å‘½ä»¤çš„å †æ ˆdocument.onkeypress = function (e) { let keyCode = e.keyCode; let command = makeCommand(Ryu, commands[keyCode]); if (command) { command(); commandStack.push(command); }}document.getElementById(&quot;replay&quot;).onclick = function () { // ç‚¹å‡»æ’­æ”¾å½•åƒ let command; while (command = commandStack.shift()) { // ä»å †æ ˆè·å–æ­¤å‰çš„å‘½ä»¤å¹¶æ‰§è¡Œ command(); }} ã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ä¹¦ä¸Šçš„è¿™ä¸ªä¾‹å­å†™çš„æ›´åƒæ˜¯ç­–ç•¥æ¨¡å¼ï¼Œä¹¦ä¸Šä¸ºäº†å’Œç­–ç•¥æ¨¡å¼åŒºåˆ†è¿˜æŠŠreceiver[state]()ç”¨ä¸€ä¸ªåŒ¿åå‡½æ•°ç»™åŒ…èµ·æ¥ï¼Œè¢«æˆ‘ç»™åˆ äº†ï¼Œä¸è¦ä¸ºäº†ç”¨è®¾è®¡æ¨¡å¼è€Œç”¨è®¾è®¡æ¨¡å¼ã€‚å…¶å®ç­–ç•¥æ¨¡å¼æ˜¯å¯¹ä¸€ç³»åˆ—ç®—æ³•çš„å°è£…ï¼Œä½¿ä»–ä»¬äº’ç›¸å¯æ›¿æ¢ï¼Œä½†å‘½ä»¤æ¨¡å¼æ˜¯å¯¹ä¸€ç³»åˆ—å‘½ä»¤å¯¹è±¡çš„å°è£…ï¼Œä½¿æ¥å—è€…å’Œå‘é€è€…è§£è€¦ã€‚ å®å‘½ä»¤â€‹ å®å‘½ä»¤æ˜¯ä¸€ç»„å‘½ä»¤çš„é›†åˆï¼Œé€šè¿‡æ‰§è¡Œå®å‘½ä»¤çš„æ–¹å¼ï¼Œå¯ä»¥ä¸€æ¬¡æ‰§è¡Œä¸€æ‰¹å‘½ä»¤ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå®¶é‡Œæœ‰ä¸€ä¸ªä¸‡èƒ½é¥æ§å™¨ï¼Œæ¯å¤©å›å®¶çš„æ—¶å€™ï¼Œåªè¦æŒ‰ä¸€ä¸ªç‰¹åˆ«çš„æŒ‰é’®ï¼Œå®ƒå°±ä¼šå¸®æˆ‘ä»¬å…³ä¸Šæˆ¿é—´é—¨ï¼Œé¡ºä¾¿æ‰“å¼€ç”µè„‘å¹¶ç™»å½• QQã€‚ 1234567891011121314151617181920212223242526272829303132333435let closeDoorCommand = { execute: function () { console.log('å…³é—¨'); }};let openPcCommand = { execute: function () { console.log('å¼€ç”µè„‘'); }};let openQQCommand = { execute: function () { console.log('ç™»å½• QQ'); }};let MacroCommand = function () { return { commandsList: [], add: function (command) { // ç»™å®å‘½ä»¤æ·»åŠ æŒ‡ä»¤ this.commandsList.push(command); }, execute: function () { // æ‰§è¡Œå®å‘½ä»¤ for (let i = 0, command; command = this.commandsList[i++];) { command.execute(); } } }};let macroCommand = MacroCommand();macroCommand.add(closeDoorCommand); macroCommand.add(openPcCommand);macroCommand.add(openQQCommand);macroCommand.execute(); æ™ºèƒ½å‘½ä»¤ä¸å‚»ç“œå‘½ä»¤â€‹ ä¸Šä¸€ä¸ªä¾‹å­çš„å‘½ä»¤æ²¡ç”¨åŒ…å«ä»»ä½•receiverçš„ä¿¡æ¯ï¼Œå®ƒæœ¬èº«å°±åŒ…æ½äº†æ‰§è¡Œè¯·æ±‚çš„è¡Œä¸ºï¼Œè¿™è·Ÿæˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„å‘½ä»¤å¯¹è±¡éƒ½åŒ…å«äº†ä¸€ä¸ªreceiveræ˜¯çŸ›ç›¾çš„ã€‚ â€‹ ä¸€èˆ¬æ¥è¯´ï¼Œå‘½ä»¤æ¨¡å¼éƒ½ä¼šåœ¨commandå¯¹è±¡ä¸­ä¿å­˜ä¸€ä¸ªæ¥å—è€…æ¥è´Ÿè´£çœŸæ­£æ‰§è¡Œå®¢æˆ·çš„è¯·æ±‚ï¼Œè¿™ç§æƒ…å†µä¸‹å‘½ä»¤å¯¹è±¡æ˜¯â€œå‚»ç“œå¼â€çš„ï¼Œå®ƒåªè´Ÿè´£æŠŠå®¢æˆ·çš„è¯·æ±‚è½¬äº¤ç»™æ¥å—è€…æ¥æ‰§è¡Œï¼Œè¿™ç§æ¨¡å¼çš„å¥½å¤„æ˜¯è¯·æ±‚çš„å‘èµ·è€…å’Œè¯·æ±‚çš„æ¥å—è€…ä¹‹é—´å°½å¯èƒ½çš„è§£è€¦ã€‚ â€‹ â€œèªæ˜â€çš„å‘½ä»¤å¯¹è±¡å¯ä»¥ç›´æ¥å®ç°è¯·æ±‚ï¼Œè¿™æ ·ä¸€æ¥å°±ä¸éœ€è¦æ¥æ”¶è€…çš„å­˜åœ¨ï¼Œå’Œç­–ç•¥æ¨¡å¼éå¸¸æ¥è¿‘ï¼Œä½†å‘½ä»¤æ¨¡å¼è§£å†³çš„é—®é¢˜æ›´å…·å‘æ•£æ€§ã€‚ â€‹ å‘½ä»¤æ¨¡å¼è¿˜å¯ä»¥å®Œæˆæ’¤é”€ã€æ’é˜Ÿç­‰åŠŸèƒ½ å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹","link":"/2021/02/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/"},{"title":"å‘å¸ƒ-è®¢é˜…æ¨¡å¼","text":"åˆå«è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå®ƒå®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å°†å¾—åˆ°é€šçŸ¥ åœ¨jsä¸­ï¼Œæœ‰ä¸€ç§å¾ˆç®€å•å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯DOMäº‹ä»¶ï¼ŒaddEventListenerå°±å¯ä»¥å®ç°è®¢é˜…domèŠ‚ç‚¹ä¸Šçš„äº‹ä»¶ï¼Œè§¦å‘äº‹ä»¶åå°±æ‰§è¡Œå›è°ƒ 1. è‡ªå®šä¹‰äº‹ä»¶å®ç°å‘å¸ƒè®¢é˜…çš„æ­¥éª¤ æŒ‡å®šå¥½å‘å¸ƒè€… ä¸ºå‘å¸ƒè€…æ·»åŠ ä¸€ä¸ªç¼“å­˜åˆ—è¡¨ï¼Œç”¨ä»¥å­˜æ”¾å›è°ƒå‡½æ•°ä»¥é€šçŸ¥è®¢é˜…è€… å‘å¸ƒæ¶ˆæ¯çš„æ—¶å€™ï¼Œå‘å¸ƒè€…ä¼šéå†è¿™ä¸ªç¼“å­˜åˆ—è¡¨ï¼Œä¾æ¬¡è§¦å‘è®¢é˜…è€…å›è°ƒå‡½æ•°ã€‚ ä¸‹é¢ç”¨ä»£ç å®ç°ä¸€ä¸‹å‘å¸ƒ-è®¢é˜…æ¨¡å¼ 123456789101112131415161718192021222324252627282930313233343536373839404142434445// è®¢é˜…è€…å›è°ƒå‡½æ•°interface Observers { [event: string]: Array&lt;Function&gt;}// å‘å¸ƒè€…let publisher = { observers: &lt;Observers&gt;{}, // å­˜æ”¾è®¢é˜…è€…å›è°ƒå‡½æ•° // å¢åŠ è®¢é˜…è€… add(event, fn) { if (!this.observers[event]) { this.observers[event] = []; } this.observers[event].push(fn); // æ·»åŠ è®¢é˜…è€…åˆ°ç¼“å­˜åˆ—è¡¨ }, // ç§»é™¤è®¢é˜…è€… remove(event, fn) { let fns = this.observers[event]; if (!fns) { // å¦‚æœè¯¥äº‹ä»¶æ²¡æœ‰è®¢é˜…è€…ï¼Œåˆ™è¿”å› return false; } if (!fn) { // å¦‚æœæ²¡æœ‰ä¼ å…¥è®¢é˜…è€…å›è°ƒå‡½æ•°ï¼Œåˆ™è¡¨ç¤ºå–æ¶ˆè¯¥äº‹ä»¶çš„æ‰€æœ‰è®¢é˜…è€… fns &amp;&amp; (fns.length = 0); } else { for (let l = fns.length - 1; l &gt;= 0; l--) { if (fns[l] === fn) { fns.splice(l, 1); } } } }, // å‘å¸ƒæ¶ˆæ¯ï¼Œé€šçŸ¥æ‰€æœ‰è®¢é˜…è€… trigger(event, ...args) { let fns = this.observers[event]; if (!fns || fns.length === 0) { // å¦‚æœæ²¡æœ‰è®¢é˜…è€…ï¼Œè¿”å›false return false; } for (let i = 0, fn; fn = fns[i++];) { fn.apply(this, args); // è§¦å‘è®¢é˜…è€…å›è°ƒå‡½æ•° } },} å¦‚æœè¦å®ç°ä¸€ä¸ªé€šç”¨çš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼ 12345let installEvent = function(obj) { for (let i in publisher) { obj[i] = publisher[i]; }} æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å°è¯•ä½¿ç”¨ä¸€ä¸‹ 123456789101112131415let salesOffices: any = {};installEvent(salesOffices);salesOffices.add('squareMeter88', function(price) { console.log('å°ç¾') console.log('ä»·æ ¼=' + price);})salesOffices.add('squareMeter100', function (price) { console.log('å°æ˜') console.log('ä»·æ ¼=' + price);})salesOffices.trigger('squareMeter88', 20000); // å°æ˜ 20000salesOffices.trigger('squareMeter100', 30000); // å°ç¾ 30000 ä½†æ˜¯è¿™æ ·salesOfficeså¯¹è±¡ä¾æ—§å…·æœ‰è€¦åˆåº¦ï¼Œè®¢é˜…è€…å¿…é¡»çŸ¥é“å‘å¸ƒè€…çš„åå­—ï¼Œæ‰èƒ½è®¢é˜…åˆ°äº‹ä»¶ï¼Œå¯ä»¥ä½¿ç”¨å…¨å±€çš„å‘å¸ƒè€…Eventå¯¹è±¡è¿›è¡Œå‘å¸ƒï¼Œå°±åƒvueä¸­çš„eventBusï¼Œè¿™æ ·åšè™½ç„¶å‡å°‘äº†è€¦åˆåº¦ï¼Œä½†æ˜¯æ¶ˆæ¯æ¥è‡ªå“ªä¸ªæ¨¡å—ï¼Œä»¥åŠä¼šæµå‘å“ªä¸ªæ¨¡å—éƒ½æ˜¯ä¸ç›´è§‚çš„ï¼Œå®¹æ˜“å¸¦æ¥ç»´æŠ¤æ€§ä¸Šçš„é—®é¢˜ï¼Œå¹¶ä¸”é€šè¿‡å…¨å±€çš„æ¥è®¢é˜…å‘å¸ƒæ¶ˆæ¯ï¼Œå®¹æ˜“é€ æˆå‘½åå†²çªã€‚ 2.å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„ä¸¤ç§æ¨¡å‹ æ¨æ¨¡å‹ï¼šå½“ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿåå°†é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…ï¼Œå¹¶æŠŠæ‰€æœ‰çš„æ–°æ•°æ®ä¼ ç»™ä»–ä»¬ æ‹‰æ¨¡å‹ï¼šå½“ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿåå°†é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…ï¼Œæ¯ä¸ªè®¢é˜…è€…å°†æ‹‰å–è‡ªå·±éœ€è¦çš„æ•°æ® å¯ä»¥è®©è®¢é˜…è€…æŒ‰éœ€è·å– ä½†æœ‰å¯èƒ½è®©å‘å¸ƒè€…å˜æˆä¸€ä¸ªâ€œé—¨æˆ·å¤§å¼€â€çš„å¯¹è±¡ï¼ŒåŒæ—¶å¢åŠ ä»£ç é‡å’Œå¤æ‚åº¦ å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹","link":"/2021/02/02/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%8F%91%E5%B8%83-%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F/"},{"title":"è¿­ä»£å™¨æ¨¡å¼","text":"æ˜¯æŒ‡æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸éœ€è¦æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚ jsæœ‰è®¸å¤šè¿­ä»£å™¨æ¨¡å¼å®ç°ï¼Œæ¯”å¦‚è¯´forEachï¼Œes6çš„yield 1. å†…éƒ¨è¿­ä»£å™¨å’Œå¤–éƒ¨è¿­ä»£å™¨1.1 å†…éƒ¨è¿­ä»£å™¨ å†…éƒ¨å®šä¹‰å¥½è¿­ä»£è§„åˆ™ï¼Œå¤–éƒ¨åªéœ€è¦ä¸€æ¬¡åˆå§‹è°ƒç”¨ æ¯”å¦‚è¯´jqueryçš„$.eachï¼Œä»¥åŠjsçš„for...of 1.2 å¤–éƒ¨è¿­ä»£å™¨ æ˜¾ç¤ºçš„è¯·æ±‚è¿­ä»£ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œè¿­ä»£æµç¨‹ç”±å¤–éƒ¨æ§åˆ¶ æ¯”å¦‚è¯´es6çš„è¿­ä»£å™¨yield 2. å®ç°ä¸€ä¸ª$.eachçš„è¿­ä»£å™¨å¯ä»¥éå†ç±»æ•°ç»„å¯¹è±¡ä»¥åŠå­—é¢é‡å¯¹è±¡ 12345678910111213141516171819202122232425262728function each(obj, callback) { let length, i = 0; // åˆ¤æ–­æ˜¯å¦ä¸ºç±»æ•°ç»„å¯¹è±¡ if (isArrayLike(obj)) { length = obj.length; for (; i &lt; length; i++) { // å¦‚æœå›è°ƒå‡½æ•°æ”¾å›falseï¼Œä¸­æ–­è¿­ä»£å™¨ if (callback.call(obj[i], i, obj[i]) === false) { break; } } } else { for (i in obj) { if (callback.call(obj[i], i, obj[i]) === false) { break; } } } return obj}let data = { 0: &quot;a&quot;, 1: &quot;b&quot;, length: 2 }each(data, (key, val) =&gt; { console.log(key, val); // 0 a // 1 b}); 3. æ‰‹åŠ¨å®ç°es6çš„ç®€æ˜“è¿­ä»£å™¨12345678910111213141516171819202122// å®šä¹‰ç”Ÿæˆå™¨å‡½æ•°ï¼Œå…¥å‚æ˜¯ä»»æ„é›†åˆfunction iteratorGenerator(list) { // idxè®°å½•å½“å‰è®¿é—®çš„ç´¢å¼• let idx = 0; // lenè®°å½•ä¼ å…¥é›†åˆçš„é•¿åº¦ const len = list.length; return { // è‡ªå®šä¹‰nextæ–¹æ³• next: function() { // å¦‚æœç´¢å¼•è¿˜æ²¡æœ‰è¶…å‡ºé›†åˆé•¿åº¦ï¼Œdone ä¸º false const done = idx &gt;= len; // å¦‚æœdoneä¸ºfalseï¼Œåˆ™å¯ä»¥ç»§ç»­å–å€¼ const value = !done ? list[idx++] : undefined; // å°†å½“å‰å€¼ä¸éå†æ˜¯å¦å®Œæ¯•ï¼ˆdoneï¼‰è¿”å› return { done: done, value: value } } }} å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ã€ŠJavaScript è®¾è®¡æ¨¡å¼æ ¸â¼¼åŸç†ä¸åº”â½¤å®è·µã€‹","link":"/2021/02/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/"},{"title":"ä»£ç†æ¨¡å¼","text":"ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—® ç‰¹ç‚¹å¦‚ä¸‹ ä»£ç†å¯¹è±¡å¯é¢„å…ˆå¤„ç†è¯·æ±‚ï¼Œå†å†³å®šæ˜¯å¦è½¬äº¤ç»™æœ¬ä½“ï¼› ä»£ç†å’Œæœ¬ä½“å¯¹å¤–æ˜¾ç¤ºæ¥å£ä¿æŒä¸€è‡´æ€§ ä»£ç†å¯¹è±¡ä»…å¯¹æœ¬ä½“åšä¸€æ¬¡åŒ…è£… 1. æ¨¡å¼ç»†åˆ† è™šæ‹Ÿä»£ç†ï¼ˆå°†å¼€é”€å¤§çš„è¿ç®—äº¤ç»™ä»£ç†ï¼Œå»¶è¿Ÿåˆ°éœ€è¦æ—¶æ‰§è¡Œï¼‰ ç¼“å­˜ä»£ç†ï¼ˆä¸ºå¼€é”€å¤§çš„è¿ç®—ç»“æœæä¾›ç¼“å­˜ï¼‰ ä¿æŠ¤ä»£ç†ï¼ˆç”¨äºå¯¹è±¡åº”è¯¥æœ‰ä¸åŒçš„è®¿é—®æƒé™ï¼‰ é˜²ç«å¢™ä»£ç†ï¼ˆæ§åˆ¶ç½‘ç»œèµ„æºçš„è®¿é—®ï¼‰ è¿œç¨‹ä»£ç†ï¼ˆä¸ºä¸€ä¸ªå¯¹è±¡åœ¨ä¸åŒçš„åœ°å€æ§ä»¶æä¾›å±€éƒ¨ä»£è¡¨ï¼‰ æ™ºèƒ½å¼•ç”¨ä»£ç†ï¼ˆè®¿é—®å¯¹è±¡æ‰§è¡Œä¸€äº›é™„åŠ æ“ä½œï¼‰ å†™æ—¶å¤åˆ¶ä»£ç†ï¼ˆå»¶è¿Ÿå¯¹è±¡å¤åˆ¶è¿‡ç¨‹ï¼Œå¯¹è±¡éœ€è¦çœŸæ­£ä¿®æ”¹æ—¶æ‰è¿›è¡Œï¼‰ 2. è™šæ‹Ÿä»£ç†å®ç°å›¾ç‰‡é¢„åŠ è½½åœ¨æ‰€éœ€å›¾ç‰‡æœªåŠ è½½å‰ï¼Œç”¨loadingå›¾ç‰‡å ä½ï¼Œç„¶åç”¨å¼‚æ­¥çš„æ–¹å¼åŠ è½½å›¾ç‰‡ï¼Œç­‰å›¾ç‰‡åŠ è½½å¥½äº†ï¼Œæ›¿æ¢æ‰loadingï¼Œä¸‹é¢å…ˆä¸ç”¨ä»£ç†æ¨¡å¼å®ç° 12345678910111213141516let MyImage = (function() { let imgNode = document.createElement('img'); document.body.appendChild(imgNode); let img = new Image; img.onload = function () { imgNode.src = img.src; // å›¾ç‰‡åŠ è½½å®Œæˆåæ›¿æ¢loading }; return { setSrc: function (src) { imgNode.src = &quot;file://loading.gif&quot;; // å…ˆæ˜¾ç¤ºloadingå›¾ç‰‡ img.src = src; // è™šæ‹Ÿdomç»“æ„åŠ è½½å›¾ç‰‡ } }}) è¿èƒŒäº†å•ä¸€èŒè´£åŸåˆ™ï¼Œåœ¨è¿™ç§é«˜è€¦åˆçš„æƒ…å†µä¸‹ï¼Œå¦‚æœä¸éœ€è¦loadingæ•ˆæœï¼Œé‚£ä¹ˆåªèƒ½åœ¨MyImageä¸‹åŠ¨åˆ€ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨è™šæ‹Ÿä»£ç†é‡æ„ä¸€ä¸‹è¿™æ®µä»£ç  123456789101112131415161718192021222324252627// åŠ è½½å›¾ç‰‡let myImage = (function () { let imgNode = document.createElement('img'); document.body.appendChild(imgNode); return { setSrc: function (src) { imgNode.src = src; } }})();// è™šæ‹Ÿä»£ç†let proxyImage = (function () { let img = new Image; img.onload = function () { myImage.setSrc(this.src); }; return { setSrc: function (src) { myImage.setSrc(&quot;file://loading.gif&quot;); img.src = src; } }})();proxyImage.setSrc( 'http://www.lll.com/photo/true.jpg' ); è¿™æ ·å°±è§£è€¦äº† 3. è™šæ‹Ÿä»£ç†åœ¨æƒ°æ€§åŠ è½½ä¸­çš„åº”ç”¨å®ç°ä¸€ä¸ªç­‰ç”¨æˆ·æŒ‰F2å”¤å‡ºæ§åˆ¶å°çš„æ—¶å€™ï¼Œå†å¼€å§‹åŠ è½½miniConsole.jsä»£ç ï¼Œå¹¶åœ¨åŠ è½½å®Œæˆåæ‰§è¡Œcacheä¸­çš„logå‡½æ•° 1234567891011121314151617181920212223242526272829let miniConsole = (function () { let cache = []; let handler = function (e) { if (e.keyCode === 113) { let script = document.createElement(&quot;script&quot;); script.onload = function () { for (let i = 0, fn; fn = cache[i++];) { fn(); } }; script.src = &quot;miniConsole.js&quot;; document.getElementsByClassName(&quot;head&quot;)[0].appendChild(script); document.body.removeEventListener(&quot;keydown&quot;, handler); // åªåŠ è½½ä¸€æ¬¡miniConsole.js } } document.body.addEventListener(&quot;keydown&quot;, handler, false); return { log: function () { let args = arguments; cache.push(function () { return miniConsole().log.apply(miniConsole().args); }) } }})();miniConsole.log(11); 4. ç¼“å­˜ä»£ç†è®¡ç®—ä¹˜ç§¯123456789101112131415161718192021let mult = function () { let a = 1; for (let i = 0; i &lt; arguments.length; i++) { a *= arguments[i]; } return a;}let proxyMult = (function () { let cache = {}; return function () { let args = Array.prototype.join.call(arguments, ','); if (args in cache) { return cache[args]; } return cache[args] = mult.apply(this, arguments); }})();proxyMult(1, 2, 3) // 6proxyMult(1, 2, 3) // ä¸ä¼šé‡å¤è®¡ç®— 5. ES6ä¸­çš„Proxy ES6 çš„ Proxyè¯­æ³•ï¼šlet proxyObj = new Proxy(target, handler); target: æœ¬ä½“ï¼Œè¦ä»£ç†çš„å¯¹è±¡ handler: è‡ªå®šä¹‰æ“ä½œæ–¹æ³•é›†åˆ proxyObj: è¿”å›çš„ä»£ç†å¯¹è±¡ï¼Œæ‹¥æœ‰æœ¬ä½“çš„æ–¹æ³•ï¼Œä¸è¿‡ä¼šè¢« handler é¢„å¤„ç† å¯ä»¥æ‹¦æˆªå¹¶æ§åˆ¶å¯¹å¯¹è±¡çš„è®¿é—®ï¼Œä¸‹é¢æ˜¯ç”¨Proxyå®ç°çš„ä»£ç†å·¥å‚ 1234567891011121314const getCacheProxy = (fn, cache = new Map()) =&gt; { return new Proxy(fn, { apply(target, context, args) { const argsString = args.join(','); if (cache.has(argsString)) { // å¦‚æœæœ‰ç¼“å­˜ï¼Œç›´æ¥è¿”å›ç¼“å­˜æ•°æ® console.log(`è¾“å‡º${args}çš„ç¼“å­˜ç»“æœ: ${cache.get(argsString)}`); return cache.get(argsString); } const result = fn(...args); cache.set(argsString, result); return result; } })} å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹https://segmentfault.com/a/1190000019574843","link":"/2021/01/31/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"},{"title":"ç­–ç•¥æ¨¡å¼","text":"å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼ŒæŠŠä»–ä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬äº’ç›¸å¯æ›¿æ¢ 1. åˆ›å»º1.1 åˆ©ç”¨å¯¹è±¡å°è£…å®ç°1234567891011121314151617// å°†ç®—æ³•çš„å®ç°ä¸ç®—æ³•çš„ä½¿ç”¨åˆ†ç¦»ï¼Œstrategiesæ˜¯ä¸€ä¸ªç­–ç•¥ç±»let strategies = { &quot;boss&quot;: function (salary) { return salary * 4; }, &quot;rookie&quot;: function (salary) { return salary * 3; }, &quot;liang&quot;: function (salary) { return salary * 2; }}// éœ€è¦è°ƒç”¨è®¡ç®—ç±»ï¼Œåªéœ€è¦æä¾›åå­—ï¼Œè§£å†³äº†if elseçš„é—®é¢˜let calculateBonus = function (level, salary) { return strategies[level](salary);} 1.2 åˆ©ç”¨ä¼ é€’å‡½æ•°å®ç°123456789101112131415function boss(salary) { return salary * 4;}function rookie(salary) { return salary * 3;}function liang (salary) { return salary * 2;}let calculateBonus2 = function (func, salary) { return func(salary);}console.log(calculateBonus2(rookie, 10000)); // 30000 2. ä¼˜ç‚¹ æœ‰æ•ˆé¿å…å¤šé‡æ¡ä»¶é€‰æ‹©è¯­å¥ å¥‘åˆäº†å¼€æ”¾å°é—­åŸåˆ™ï¼Œæ˜“äºæ‰©å±• ç­–ç•¥ç±»å°è£…çš„ç®—æ³•å¯å¤ç”¨ å‚è€ƒã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹","link":"/2021/01/30/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"},{"title":"å•ä¾‹æ¨¡å¼","text":"ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹æ¯”å¦‚vuexã€windowå¯¹è±¡ã€çº¿ç¨‹æ±  1. å®ç°å•ä¾‹æ¨¡å¼1.1 åŸºäºé—­åŒ…å®ç°12345678910111213141516171819202122function Singleton (name) { this.name = name;}Singleton.prototype.getName = function () { console.log(this.name);}Singleton.getInstance = (function () { let instance = null; return function (name) { if (!instance) { instance = new Singleton(name); } return instance; }})();let a = Singleton.getInstance('liang1');let b = Singleton.getInstance('liang2');console.log(a === b); // true 1.2 åˆ©ç”¨ä»£ç†æ¨¡å¼1234567891011121314let ProxySingleton = (function () { let instance; return function (name) { if (!instance) { instance = new Singleton(name); } return instance; }})();let c = new ProxySingleton('liang1');let d = new ProxySingleton('liang2');console.log(c === d); // true åˆ©ç”¨ä»£ç†æ¨¡å¼æ¥è§£è€¦ç®¡ç†å•ä¾‹çš„é€»è¾‘ 1.3 é€šç”¨çš„æƒ°æ€§å•ä¾‹123456function getSingle (fn) { let result; return function () { return result || (result = fn.apply(this, arguments)); }} åªéœ€è¦ç»™getSingleä¼ é€’ä¸€ä¸ªåˆ›å»ºå®ä¾‹çš„fnå°±èƒ½åˆ›å»ºå•ä¾‹æ¨¡å¼ 2. å¼¹çª—å®ä¾‹12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;body&gt;&lt;button id=&quot;btn&quot;&gt;æ‰“å¼€å¼¹çª—&lt;/button&gt;&lt;script&gt; // é€šç”¨çš„åˆ›å»ºæƒ°æ€§å•ä¾‹æ¨¡å¼ function getSingle(fn) { let result; return function () { return result || (result = fn.apply(this, arguments)); } } // åˆ›å»ºå¼¹çª—å¹¶æ·»åŠ åˆ°bodyä¸‹ï¼Œå¹¶ç”¨getSingleåˆ›å»ºå•ä¾‹æ¨¡å¼ let createDialog = getSingle(function () { let div = document.createElement('div'); div.className = &quot;message-box&quot;; div.innerHTML = ` &lt;div class=&quot;mask&quot;&gt;&lt;/div&gt; &lt;div class=&quot;dialog&quot;&gt; &lt;div class=&quot;dialog-bd&quot;&gt;è¿™æ˜¯ä¸€ä¸ªå¼¹çª—å“¦&lt;/div&gt; &lt;div class=&quot;dialog-ft&quot;&gt; &lt;a href=&quot;javascript:&quot; class=&quot;dialog-btn&quot;&gt;ç¡®å®š&lt;/a&gt; &lt;/div&gt; &lt;/div&gt; `.trim(); div.style.display = &quot;none&quot;; document.body.appendChild(div); return div; }) document.getElementById(&quot;btn&quot;).onclick = function () { let dialog = createDialog(); dialog.style.display = &quot;block&quot;; } // ä¸ºå¼¹çª—æŒ‰é’®ç»‘å®šå…³é—­äº‹ä»¶ document.addEventListener(&quot;click&quot;, function (event) { if (event.target.className === &quot;dialog-btn&quot;) { let dialog = createDialog(); dialog.style.display = &quot;none&quot;; } })&lt;/script&gt;&lt;/body&gt; getSingleå‡½æ•°é€šè¿‡å˜é‡resultä¿å­˜å¼¹çª—å®ä¾‹ï¼Œå¦‚æœå·²ç»å­˜åœ¨åˆ™ç›´æ¥è¿”å›è¯¥å®ä¾‹ï¼Œå¦åˆ™åˆ›å»ºå¼¹çª—å®ä¾‹ï¼Œä¿è¯äº†å¼¹çª—çš„å”¯ä¸€æ€§ å‚è€ƒã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®æˆ˜ã€‹","link":"/2021/01/28/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"},{"title":"æƒ°æ€§åŠ è½½å‡½æ•°","text":"åœºæ™¯å†™ä¸€ä¸ªå„æµè§ˆå™¨å…¼å®¹äº‹ä»¶ç»‘å®šå‡½æ•° 12345678let addEvent = function (elem, type, handler) { if (window.addEventListener) { return elem.addEventListener(type, handler, false); } if (window.attachEvent) { return elem.attachEvent('on' + type, handler); }} ç¼ºç‚¹ï¼šæ¯ä¸€æ¬¡è°ƒç”¨éƒ½å¿…é¡»æ‰§è¡Œä¸€æ¬¡ifåˆ¤æ–­ æ–¹æ¡ˆä¸€åœ¨è¯¥ä»£ç è¢«åŠ è½½æ—¶ï¼Œåˆ©ç”¨ç«‹å³æ‰§è¡Œå‡½æ•°åšä¸€æ¬¡åˆ¤æ–­ï¼Œç„¶åè¿”å›ç»™addEventæ­£ç¡®çš„äº‹ä»¶ç»‘å®šå‡½æ•° 123456789101112let addEvent = (function (){ if (window.addEventListener) { return function (elem, type, handler) { elem.addEventListener(type, handler, false); } } if (window.attachEvent) { return function (elem, type, handler) { elem.attachEvent('on' + type, handler); } }})() ç¼ºç‚¹ï¼šå¦‚æœaddEventç»‘å®šäº‹ä»¶å‡½æ•°ä¸€ç›´éƒ½æ²¡æœ‰è¢«è°ƒç”¨ï¼Œé‚£ä¹ˆå°±ç™½ç™½åšäº†ä¸€æ¬¡æµè§ˆå™¨å—…æ¢ æ–¹æ¡ˆäºŒï¼šæƒ°æ€§è½½å…¥å‡½æ•°1234567891011121314let addEvent = function(elem, type, handler) { if (window.addEventListener) { addEvent = function (elem, type, handler) { elem.addEventListener(type, handler, false); } } if (window.attachEvent) { addEvent = function (elem, type, handler) { elem.attachEvent('on' + type, handler); } } addEvent(elem, type, handler);} ç¼ºç‚¹ï¼šé¦–æ¬¡è°ƒç”¨è¾ƒæ…¢ å‚è€ƒã€ŠJavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹","link":"/2021/01/27/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%83%B0%E6%80%A7%E5%8A%A0%E8%BD%BD%E5%87%BD%E6%95%B0/"},{"title":"Leetcode459. é‡å¤çš„å­å­—ç¬¦ä¸²","text":"é¢˜ç›®é“¾æ¥: https://leetcode-cn.com/problems/repeated-substring-pattern/ ç»™å®šä¸€ä¸ªéç©ºçš„å­—ç¬¦ä¸²ï¼Œåˆ¤æ–­å®ƒæ˜¯å¦å¯ä»¥ç”±å®ƒçš„ä¸€ä¸ªå­ä¸²é‡å¤å¤šæ¬¡æ„æˆã€‚ç»™å®šçš„å­—ç¬¦ä¸²åªå«æœ‰å°å†™è‹±æ–‡å­—æ¯ï¼Œå¹¶ä¸”é•¿åº¦ä¸è¶…è¿‡10000ã€‚ ä¿ºæ„šè ¢çš„æš´åŠ›è§£æ³•12345678910var repeatedSubstringPattern = function(s) { for (let i = 1; i &lt;= s.length / 2 &amp;&amp; i &lt; 10000; i++) { let str = s.slice(0, i); let repeatNum = s.length / str.length; if (Number.isInteger(repeatNum) &amp;&amp; str.repeat(repeatNum) === s) { return true; } } return false}; æ–¹æ³•äºŒï¼šå­—ç¬¦ä¸²åŒ¹é… ç‰›å•Šï¼Œå®˜æ–¹é¢˜è§£çš„è¯æ˜æ–¹å¼æ²¡çœ‹æ‡‚ï¼Œä¹‹åæœ‰æ—¶é—´å›æ¥çœ‹çœ‹ ç®—æ³• ç”¨ä¸¤ä¸ªsé¦–å°¾ç›¸è¿å¾—åˆ°ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ss; å»æ‰ssçš„é¦–å°¾ä¸¤ä¸ªå­—ç¬¦ï¼› å¦‚æœåœ¨å‰©ä¸‹æ¥çš„å­—ç¬¦ä¸²ä¸­èƒ½æ‰¾åˆ°sé‚£ä¹ˆè¿”å›Trueï¼Œå¦åˆ™False 123var repeatedSubstringPattern = function(s) { return (s+s).slice(1, -1).indexOf(s) !== -1;}; è¯æ˜æ–¹å¼https://blog.csdn.net/qq_23997101/article/details/78804826 æ–¹æ³•ä¸‰ï¼šæ­£åˆ™è¡¨è¾¾å¼123var repeatedSubstringPattern = function(s) { return /^([a-z]+)\\1+$/.test(s)}; ä¸è§£é‡Šï¼Œè‰ã€‚","link":"/2021/01/23/Leetcode/Leetcode459-%E9%87%8D%E5%A4%8D%E7%9A%84%E5%AD%90%E5%AD%97%E7%AC%A6%E4%B8%B2/"},{"title":"å‡å°‘ä½¿ç”¨setInterval","text":"setIntervalå¾ˆå°‘ä½¿ç”¨åœ¨ç”Ÿæˆç¯å¢ƒä¸‹ï¼Œå› ä¸ºæœ‰å¦‚ä¸‹å‡ ä¸ªç¼ºç‚¹ ç¼ºç‚¹ä¸€ï¼šsetIntervalæ— è§†ä»£ç é”™è¯¯setIntervalæ‰§è¡Œçš„ä»£ç å³ä½¿ä»£ç æŠ¥é”™ï¼Œå®ƒè¿˜ä¼šæŒç»­ä¸æ–­ï¼ˆä¸ç®¡ä¸é¡¾ï¼‰åœ°è°ƒç”¨è¯¥ä»£ç  ç¼ºç‚¹äºŒï¼šsetIntervalæ— è§†ç½‘ç»œå»¶è¿Ÿå‡è®¾ä½ æ¯éš”ä¸€æ®µæ—¶é—´å°±é€šè¿‡Ajaxè½®è¯¢ä¸€æ¬¡æœåŠ¡å™¨ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æ–°æ•°æ®ï¼ˆæ³¨æ„ï¼šå¦‚æœä½ çœŸçš„è¿™ä¹ˆåšäº†ï¼Œé‚£ææ€•ä½ åšé”™äº†ï¼›å»ºè®®ä½¿ç”¨â€œè¡¥å¿æ€§è½®è¯¢â€ï¼ˆbackoff pollingï¼‰ï¼‰ã€‚è€Œç”±äºæŸäº›åŸå› ï¼ˆæœåŠ¡å™¨è¿‡è½½ã€ä¸´æ—¶æ–­ç½‘ã€æµé‡å‰§å¢ã€ç”¨æˆ·å¸¦å®½å—é™ï¼Œç­‰ç­‰ï¼‰ï¼Œä½ çš„è¯·æ±‚è¦èŠ±çš„æ—¶é—´è¿œæ¯”ä½ æƒ³è±¡çš„è¦é•¿ã€‚ä½†setIntervalä¸åœ¨ä¹ã€‚å®ƒä»ç„¶ä¼šæŒ‰å®šæ—¶æŒç»­ä¸æ–­åœ°è§¦å‘è¯·æ±‚ï¼Œæœ€ç»ˆä½ çš„å®¢æˆ·ç«¯ç½‘ç»œé˜Ÿåˆ—ä¼šå¡æ»¡Ajaxè°ƒç”¨ã€‚ ç¼ºç‚¹ä¸‰ï¼šsetIntervalä¸ä¿è¯æŒ‰æ—¶æ‰§è¡ŒåŸå› ä¸€ï¼šæ‰§è¡Œæ—¶é—´è¢«å‰é¢ä»»åŠ¡é˜»å¡setIntervalåªæ˜¯æŒ‰æ—¶æŠŠæ—¶é—´æ¨é€åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œå› ä¸ºjsæ˜¯å•çº¿ç¨‹ï¼Œæ‰€ä»¥å¦‚æœå‰é¢çš„ä»»åŠ¡è€—æ—¶è¾ƒä¹…ï¼Œé‚£ä¹ˆå®šæ—¶å™¨çš„æ‰§è¡Œæ—¶é—´å’Œæˆ‘ä»¬é¢„å®šçš„æ—¶é—´ä¸ä¸€è‡´ åŸå› äºŒï¼šæ¨é€è¢«å¿½ç•¥setIntervalåœ¨æ¨é€åˆ°ä»»åŠ¡é˜Ÿåˆ—å‰ï¼Œä¼šæ£€æŸ¥ä¸Šä¸€æ¬¡çš„ä»»åŠ¡æ˜¯å¦ä»åœ¨é˜Ÿåˆ—ä¸­ï¼Œå¦‚æœæœ‰åˆ™ä¸å¡«åŠ ï¼ŒsetTimeoutåˆ™ä¼šç›´æ¥æ·»åŠ  ç”¨setTimeoutæ¨¡æ‹ŸsetInterval12345678910function interval(func, wait) { let timer = null; function interfunc() { func.call(null); timer = setTimeout(interfunc, wait); }; timer = setTimeout(interfunc, wait); return timer;}","link":"/2021/01/22/Js/%E5%87%8F%E5%B0%91%E4%BD%BF%E7%94%A8setInterval/"},{"title":"CJSã€ESMã€UMDæ¨¡å—åŒ–æ ‡å‡†","text":"1. CommonJS node.jsçš„å®ç°ä¸­é‡‡ç”¨äº†CommonJSæ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶åœ¨å…¶åŸºç¡€ä¸Šè¿›è¡Œäº†ä¸€äº›è°ƒæ•´ ä½¿ç”¨æ–¹å¼ä½¿ç”¨requireå’Œexportsæˆ–è€…module.exportsè¿›è¡Œæ¨¡å—çš„å¯¼å…¥å¯¼å‡º 12345678910// node.jsä¸ºäº†ç®€åŒ–æ“ä½œï¼Œæœ‰var exports = module.exports// ä¸¤è€…ä¸€è‡´ï¼Œé‚£å°±è¯´æ˜ï¼Œæˆ‘å¯ä»¥ä½¿ç”¨ä»»æ„ä¸€æ–¹æ¥å¯¼å‡ºå†…éƒ¨æˆå‘˜console.log(exports === module.exports) // true// å¯¼å‡ºçš„å¯¹è±¡è¿‘ä¼¼äºæ­¤ç§å½¢å¼ï¼Œexportsç›¸å½“äºmodule.exportsçš„å¼•ç”¨// var module = {// exports: {// foo: 'bar',// }// } ç‰¹ç‚¹1.CJS æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„æ‹·è´ 2.ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œname.jsä¸­çš„ä½œç”¨åŸŸæ˜¯å½±å“ä¸åˆ°index.jsçš„ã€‚ 1234567// name.jslet name = 'name.js';// index.jslet name = 'index.js';require('./name');console.log(name); // index.js åŸå›  12345// å½“nodeåœ¨æ‰§è¡Œæ¨¡å—ä¸­çš„ä»£ç æ—¶ï¼Œå®ƒä¼šé¦–å…ˆåœ¨ä»£ç çš„æœ€é¡¶éƒ¨ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç function (exports, require, module, __filename, __dirname) {// åœ¨ä»£ç çš„æœ€åº•éƒ¨ï¼Œï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç }// æ‰€ä»¥å¯ä»¥ç†è§£ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å— 3.ä»¥åŒæ­¥çš„æ–¹å¼åŠ è½½æ¨¡å—ï¼Œæ¨¡å—åŠ è½½é¡ºåºå³åœ¨ä»£ç ä¸­çš„é¡ºåºï¼Œæ¯ä¸ªrequireè¯­å¥ä¼šçŸ­æš‚é˜»å¡ä»£ç çš„è¿è¡Œï¼ŒçŸ¥é“æ¨¡å—åŠ è½½å®Œæ¯•ã€‚ä¸è¿‡è¿™ä¸ªåŠ è½½ä¸æ˜¯é€šè¿‡ç½‘ç»œåŠ è½½ï¼Œè€Œæ˜¯ä»å†…å­˜æˆ–è€…æ–‡ä»¶ç³»ç»Ÿä¸­åŠ è½½ï¼Œæ‰€ä»¥è¿™ä¸ªè¿‡ç¨‹å¾ˆå¿«ã€‚ä¹Ÿå¯¼è‡´CJSä¸é€‚åˆæµè§ˆå™¨ 4.æœ‰ç¼“å­˜æœºåˆ¶ï¼Œå·²ç»è¢«å¼•å…¥è¿‡çš„æ¨¡å—ï¼Œä¸ä¼šå†ä¸€æ¬¡å¼•å…¥ 12345678910// ç”±ä½¿ç”¨æ–¹å¼å°èŠ‚å¯çŸ¥ï¼Œå…¶å®æ¨¡å—ä¼šæœ‰ä¸€ä¸ªmoduleå¯¹è±¡ï¼Œè€Œè¿™ä¸ªmoduleå¯¹è±¡ä¼šå­˜æ”¾æ¨¡å—çš„ä¿¡æ¯// å…¶ä¸­æœ‰ä¸€ä¸ªå±æ€§loadedç”¨äºè®°å½•è¯¥æ¨¡å—æ˜¯å¦è¢«åŠ è½½è¿‡ï¼Œé»˜è®¤ä¸ºfalseï¼Œç¬¬ä¸€æ¬¡åŠ è½½åè®¾ä¸ºtrueï¼Œä¹‹åå¦‚æœè¯¥å±æ€§ä¸ºtrueï¼Œåˆ™ä¸ä¼šå†æ¬¡æ‰§è¡Œæ”¹æ¨¡å—çš„ä»£ç // cache.jslet a = 1;console.log(a++);// index.jsrequire('./cache'); // è¾“å‡º1require('./cache'); // ç”±äºç¼“å­˜æœºåˆ¶ï¼Œæ— è¾“å‡º 5.å¾ªç¯å¼•ç”¨ä¸‹çš„è¡Œä¸º å°†ä¸Šæ–‡ç»ƒä¹ çš„b.jsæ–‡ä»¶ä¿®æ”¹æˆä¸‹é¢è¿™æ ·ï¼š 123456789const a = require('./a.js');console.log(a, 'bä¸­æ‹¿åˆ°çš„a');module.exports = { b1: '111', b2: '222', b3: '333', ba: a,}; a.jsæ–‡ä»¶å†…å®¹å¦‚ä¸‹: 12const b = require('./b.js');console.log(b, 'aä¸­æ‹¿åˆ°çš„b'); æ‰§è¡Œnode a.jsï¼Œæ‰“å°å‡º 12{} bä¸­æ‹¿åˆ°çš„a{ b1: '111', b2: '222', b3: '333', ba: {} } aä¸­æ‹¿åˆ°çš„b é¦–å…ˆæ‰§è¡Œa.jsï¼Œaä¸­å¼•ç”¨äº†bï¼Œæ‰€ä»¥bå¼€å§‹æ‰§è¡Œï¼Œbä¸­åˆå¼•ç”¨äº†aï¼Œæ­¤æ—¶aæ²¡æœ‰ä»»ä½•å¯¼å‡ºå†…å®¹ï¼Œæ‰€ä»¥bæ‹¿åˆ°çš„aæ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ã€‚ ä¿®æ”¹a.jsæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š 123456exports.a1 = '111';const b = require('./b.js');console.log(b, 'aä¸­æ‹¿åˆ°çš„b');exports.a2 = '222'; å¯ä»¥çœ‹è§åœ¨å¯¼å…¥bä¹‹å‰å…ˆå¯¼å‡ºäº†a1ï¼Œæ‰§è¡Œnode a.jsï¼Œæ‰“å°çš„å†…å®¹æ˜¯ï¼š 12{ a1: '111' } bä¸­æ‹¿åˆ°çš„a{ b1: '111', b2: '222', b3: '333', ba: { a1: '111' } } aä¸­æ‹¿åˆ°çš„b è¯´æ˜åœ¨bä¸­å¯¼å…¥açš„æ—¶å€™çš„æ‹¿åˆ°çš„æ˜¯é‚£ä¸ªæ—¶åˆ»aä¸­å·²ç»å¯¼å‡ºçš„å†…å®¹ï¼Œå¦‚æœæ²¡æœ‰å¯¼å‡ºï¼Œå°±ä¼šæ‹¿åˆ°ä¸€ä¸ªç©ºå¯¹è±¡ã€‚ exports æ˜¯åŠ¨æ€æ‰§è¡Œçš„ï¼Œå…·ä½“ require èƒ½è·å–åˆ°çš„å€¼ï¼Œå–å†³äºæ¨¡å—çš„è¿è¡Œæƒ…å†µ 2.AMD Asynchronous Module Definitionï¼ˆå¼‚æ­¥æ¨¡å—è§„èŒƒï¼‰ï¼Œæœ€è€çš„æ–¹å¼ä¹‹ä¸€ï¼Œä¸“ä¸ºæµè§ˆå™¨è€Œè®¾è®¡ï¼ŒRequireJSå®ç°äº†AMD API ä½¿ç”¨æ–¹å¼ç”¨defineæ–¹æ³•å®šä¹‰æ¨¡å—ï¼Œç”¨requireå¯¼å‡ºæ¨¡å— 12345678910111213define( 'æ¨¡å—å', ['ä¾èµ–æ•°ç»„']ï¼Œ function([ä¾èµ–æ•°ç»„]){ //å·¥å‚å‡½æ•° ... }); require(['jquery']ï¼Œ function($){ //å›è°ƒå‡½æ•° ... }); ç‰¹ç‚¹ å¯ä»¥å®šä¹‰å…·åæ¨¡å—ï¼Œä¹Ÿå¯ä»¥å®šä¹‰åŒ¿åæ¨¡å—ã€‚å…·åæ¨¡å—é€šè¿‡å¼€å‘è€…å®šä¹‰çš„åå­—åŠ è½½ï¼ŒåŒ¿åæ¨¡å—éšå¼çš„ä»¥æ–‡ä»¶ååŠ è½½ requireè°ƒç”¨ä¼šå‘é€ä¸€ä¸ªè¯·æ±‚æ¥ä¸‹è½½æ¨¡å— å¼‚æ­¥åŠ è½½ï¼Œåªæœ‰åœ¨å›è°ƒå‡½æ•°é‡Œæ‰èƒ½è·å–æ–°æ‹¿åˆ°çš„API å¯ä»¥åœ¨ä»£ç çš„ä»»ä½•åœ°æ–¹ä½¿ç”¨requireåŠ è½½å¦ä¸€ä¸ªæ¨¡å— 3. ESM ä¸CJSå’ŒAMDä¸åŒï¼Œes6çš„æ¨¡å—æ˜¯é™æ€çš„ï¼Œ ä½¿ç”¨æ–¹å¼ç”¨importå’Œimport()è¿›è¡Œå¯¼å…¥ï¼Œç”¨exportã€export defaultè¿›è¡Œå¯¼å‡º ç‰¹ç‚¹1.ES6 æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„å¼•ç”¨ 1234567891011// lib.jsexport let counter = 3;export function incCounter() { counter++;}// main.jsimport { counter, incCounter } from './lib';console.log(counter); // 3incCounter();console.log(counter); // 4 2.ä¼šåŠ¨æ€çš„ä»è¢«åŠ è½½çš„æ¨¡å—ä¸­å–å€¼ 12345678// m1.jsexport var foo = 'bar';setTimeout(() =&gt; foo = 'baz', 500);// m2.jsimport {foo} from './m1.js';console.log(foo); // barsetTimeout(() =&gt; console.log(foo), 500); // baz 3.å¯¼å…¥çš„æ¨¡å—å˜é‡æ˜¯åªè¯»çš„ï¼Œå¦‚æœä¿®æ”¹å°±ä¼šæŠ¥é”™ 1234567// lib.jsexport let obj = {};// main.jsimport { obj } from './lib';obj.prop = 123; // OKobj = {}; // TypeError 4.å¾ªç¯å¼•ç”¨ä¸‹çš„è¡Œä¸º 1234567891011// a.mjsimport {bar} from './b';console.log('a.mjs');console.log(bar);export let foo = 'foo';// b.mjsimport {foo} from './a';console.log('b.mjs');console.log(foo); // ReferenceError: foo is not definedexport let bar = 'bar'; æ‰§è¡Œa.mjsï¼Œåœ¨a.mjsä¸­å¼•æ“å‘ç°å®ƒåŠ è½½äº†b.mjsï¼Œå› æ­¤ä¼šä¼˜å…ˆæ‰§è¡Œb.mjsï¼Œåœ¨b.mjsä¸­å‘ç°å®ƒåˆåŠ è½½äº†a.mjsï¼Œå½¢æˆå¾ªç¯å¼•ç”¨ï¼Œå·²çŸ¥a.mjsè¾“å…¥äº†fooæ¥å£ï¼Œè¿™æ—¶ä¸ä¼šå»æ‰§è¡Œa.mjsï¼Œè€Œæ˜¯è®¤ä¸ºè¿™ä¸ªæ¥å£å·²ç»å­˜åœ¨äº†ï¼Œç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œæ‰§è¡Œåˆ°ç¬¬ä¸‰è¡Œconsole.log(foo)çš„æ—¶å€™ï¼Œæ‰å‘ç°è¿™ä¸ªæ¥å£æ ¹æœ¬æ²¡å®šä¹‰ï¼Œå› æ­¤æŠ¥é”™ã€‚ ä¸CJSä¸åŒçš„æ˜¯ï¼ŒESMå¯ä»¥åˆ©ç”¨å‡½æ•°æå‡æ¥è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œåœ¨b.mjsè¿è¡Œçš„æ—¶å€™ï¼Œå·²ç»æœ‰fooçš„å®šä¹‰äº† è®©æˆ‘ä»¬çœ‹å¦ä¸€ä¸ªä¾‹å­ 1234567891011// a.mjsexport let a_done = false;import { b_done } from './b';console.log('a.js: b.done = %j', b_done);console.log('a.jsæ‰§è¡Œå®Œæ¯•');// b.mjsimport { a_done } from './a';console.log('b.js: a.done = %j', a_done); // æ­¤å¤„æŠ¥é”™export let b_done = true;console.log('b.jsæ‰§è¡Œå®Œæ¯•'); æ‰§è¡Œa.mjsï¼Œå› ä¸ºimportå…·æœ‰æå‡æ•ˆæœï¼Œæ‰€ä»¥åœ¨b.mjsä¸­çš„ç¬¬äºŒè¡Œå°±ä¼šæŠ¥ReferenceError: Cannot access 'a_done' before initializationçš„é”™è¯¯ï¼ŒåŒæ ·çš„ä¾‹å­CJSç”±äºæ²¡æœ‰æå‡ï¼Œåˆ™å¯ä»¥è·å–åˆ°a_doneä¸ºfalse psï¼šbabelç¼–è¯‘è¿‡åä¸Šè¿°ä¾‹å­ä¸ä¼šæŠ¥é”™ 4.UMD UMDï¼šUniversal Module Definitionï¼ˆé€šç”¨æ¨¡å—è§„èŒƒï¼‰æ˜¯ç”±ç¤¾åŒºæƒ³å‡ºæ¥çš„ä¸€ç§æ•´åˆäº†CommonJSå’ŒAMDä¸¤ä¸ªæ¨¡å—å®šä¹‰è§„èŒƒçš„æ–¹æ³•ã€‚ UMDæ¨¡å—çš„é¡¶ç«¯é€šå¸¸éƒ½ä¼šæœ‰å¦‚ä¸‹çš„ä»£ç ï¼Œç”¨æ¥åˆ¤æ–­æ¨¡å—åŠ è½½å™¨ç¯å¢ƒã€‚ 1234567891011121314(function (root, factory) { if (typeof define === 'function' &amp;&amp; define.amd) { // AMD define(['jquery'], factory); } else if (typeof exports === 'object') { // CommonJS module.exports = factory(require('jquery')); } else { // å…¨å±€å˜é‡ root.returnExports = factory(root.jQuery); }}(this, function ($) { // ...})); å‚è€ƒã€Šæ·±å…¥æµ…å‡ºWebpackã€‹https://es6.ruanyifeng.com/#docs/module-loaderhttps://juejin.cn/post/6870141103958589454https://juejin.cn/post/6844903861166014478","link":"/2021/01/19/Js/CJS%E3%80%81ESM%E3%80%81UMD%E6%A8%A1%E5%9D%97%E5%8C%96%E6%A0%87%E5%87%86/"},{"title":"Leetcode239. æ»‘åŠ¨çª—å£æœ€å¤§å€¼","text":"é¢˜ç›®é“¾æ¥: https://leetcode-cn.com/problems/sliding-window-maximum/ä¸»è¦æ˜¯è®°å½•ä¸€ä¸‹åˆ†å—åšæ³•ï¼Œæ²¡æƒ³æ‡‚ä¸ºä»€ä¹ˆæ¯”åŒå‘å•è°ƒé˜Ÿåˆ—å¿«ï¼Œæƒ³æ‡‚äº†å›æ¥è¡¥å…… ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ numsï¼Œæœ‰ä¸€ä¸ªå¤§å°ä¸º k çš„æ»‘åŠ¨çª—å£ä»æ•°ç»„çš„æœ€å·¦ä¾§ç§»åŠ¨åˆ°æ•°ç»„çš„æœ€å³ä¾§ã€‚ä½ åªå¯ä»¥çœ‹åˆ°åœ¨æ»‘åŠ¨çª—å£å†…çš„ k ä¸ªæ•°å­—ã€‚æ»‘åŠ¨çª—å£æ¯æ¬¡åªå‘å³ç§»åŠ¨ä¸€ä½ã€‚ è¿”å›æ»‘åŠ¨çª—å£ä¸­çš„æœ€å¤§å€¼ã€‚ ç¤ºä¾‹ 1ï¼š 1234567891011è¾“å…¥ï¼šnums = [1,3,-1,-3,5,3,6,7], k = 3è¾“å‡ºï¼š[3,3,5,5,6,7]è§£é‡Šï¼šæ»‘åŠ¨çª—å£çš„ä½ç½® æœ€å¤§å€¼--------------- -----[1 3 -1] -3 5 3 6 7 3 1 [3 -1 -3] 5 3 6 7 3 1 3 [-1 -3 5] 3 6 7 5 1 3 -1 [-3 5 3] 6 7 5 1 3 -1 -3 [5 3 6] 7 6 1 3 -1 -3 5 [3 6 7] 7 ç¤ºä¾‹ 2ï¼š 12è¾“å…¥ï¼šnums = [1], k = 1è¾“å‡ºï¼š[1] ç¤ºä¾‹ 3ï¼š 12è¾“å…¥ï¼šnums = [1,-1], k = 1è¾“å‡ºï¼š[1,-1] ç¤ºä¾‹ 4ï¼š 12è¾“å…¥ï¼šnums = [9,11], k = 2è¾“å‡ºï¼š[11] ç¤ºä¾‹ 5ï¼š 12è¾“å…¥ï¼šnums = [4,-2], k = 2è¾“å‡ºï¼š[4] æç¤ºï¼š 1 &lt;= nums.length &lt;= 105 -104 &lt;= nums[i] &lt;= 104 1 &lt;= k &lt;= nums.length é¢˜è§£ä¸€ï¼šåŒç«¯å•è°ƒé˜Ÿåˆ—ç»´æŠ¤ä¸€ä¸ªåŒç«¯å•è°ƒé˜Ÿåˆ—ï¼Œé˜Ÿå°¾å­˜æœ€å¤§å€¼çš„ç´¢å¼•ï¼Œå¦‚æœå½“å‰éå†çš„æ•°æ¯”é˜Ÿå°¾å¤§ï¼Œåˆ™ä¸€ç›´å¼¹å‡ºç›´åˆ°é˜Ÿåˆ—é‡æ–°æ»¡è¶³å•è°ƒé˜Ÿåˆ—çš„æ€§è´¨ï¼Œåˆ™æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼ä¸ºé˜Ÿå°¾å…ƒç´ ï¼Œç„¶åå› ä¸ºéœ€è¦çš„åªæ˜¯å½“å‰çª—å£çš„æœ€å¤§å€¼ï¼Œæ‰€ä»¥æ¯æ¬¡å¾ªç¯éœ€è¦åˆ¤æ–­é˜Ÿå¤´æ˜¯ä¸æ˜¯åœ¨å½“å‰çª—å£ä¸Šï¼Œå¦‚æœä¸æ˜¯åˆ™å¼¹å‡ºé˜Ÿå¤´ 12345678910111213141516171819202122232425var maxSlidingWindow = function(nums, k) { if(nums == null || nums.length &lt; 2) return nums; // åŒå‘é˜Ÿåˆ— ä¿å­˜å½“å‰çª—å£æœ€å¤§å€¼çš„æ•°ç»„ä½ç½® ä¿è¯é˜Ÿåˆ—ä¸­æ•°ç»„ä½ç½®çš„æ•°å€¼æŒ‰ä»å¤§åˆ°å°æ’åº let queue = []; // ç»“æœæ•°ç»„ let result = []; // éå†numsæ•°ç»„ for(let i = 0; i &lt; nums.length; i++){ // ä¿è¯ä»å¤§åˆ°å° å¦‚æœå‰é¢æ•°å°åˆ™éœ€è¦ä¾æ¬¡å¼¹å‡ºï¼Œç›´è‡³æ»¡è¶³è¦æ±‚ while(queue.length !== 0 &amp;&amp; nums[queue[queue.length - 1]] &lt;= nums[i]){ queue.pop(); } // æ·»åŠ å½“å‰å€¼å¯¹åº”çš„æ•°ç»„ä¸‹æ ‡ queue.push(i); // åˆ¤æ–­å½“å‰é˜Ÿåˆ—ä¸­é˜Ÿé¦–çš„å€¼æ˜¯å¦æœ‰æ•ˆ if(queue[0] &lt;= i - k){ queue.shift(); } // å½“çª—å£é•¿åº¦ä¸ºkæ—¶ ä¿å­˜å½“å‰çª—å£ä¸­æœ€å¤§å€¼ if(i + 1 &gt;= k){ result[i+1-k] = nums[queue[0]]; } } return result;}; é¢˜è§£äºŒï¼šä¼˜å…ˆé˜Ÿåˆ—å’Œå•è°ƒé˜Ÿåˆ—åŸºæœ¬ä¸€ä¸ªé“ç†ï¼Œä¸è¿‡é”®æ˜¯ç´¢å¼•ï¼Œå€¼æ˜¯æ˜ å°„åˆ°æ­£å‘åŒºé—´çš„nums[i]ï¼Œä¼˜å…ˆé˜Ÿåˆ—çš„é˜Ÿå¤´æ˜¯æœ€å¤§å€¼ï¼Œå½“æœ€å¤§å€¼çš„ç´¢å¼•ä¸å±äºå½“å‰çš„æ»‘åŠ¨çª—å£æ—¶ï¼Œåˆ™å‡ºé˜Ÿã€‚ 1234567891011var maxSlidingWindow = function(nums, k) { let q = new MaxPriorityQueue, r = new Int16Array(nums.length - k + 1), i = -1 while (++i &lt; k) q.enqueue(i, nums[i] + 10001) r[0] = q.front().priority - 10001, i-- while (++i &lt; nums.length) { q.enqueue(i, nums[i] + 10001) while (q.front().element &lt;= i - k) q.dequeue() r[i - k + 1] = q.front().priority - 10001 } return r;}; é¢˜è§£ä¸‰ï¼šåˆ†å—å°†æ•°ç»„åˆ†æˆkå— æŒ‡é’ˆjâ†’ ç»Ÿè®¡æ¯å—å†…ä»å—å¼€å¤´åˆ°jæœ€å¤§å€¼æŒ‡é’ˆiâ† ç»Ÿè®¡æ¯å—å†…ä»å—ç»“å°¾åˆ°iæœ€å¤§å€¼æ»‘åŠ¨åŒºé—´[i, i + k - 1]æœ€å¤§å€¼ = æŸå—ç»“å°¾åˆ°iæœ€å¤§å€¼ ä¸ æŸå—å¼€å¤´åˆ°i + k - 1æœ€å¤§å€¼ å–å¤§ 12345678910var maxSlidingWindow = function(nums, k) { let n = nums.length, p = new Int16Array(n), s = new Int16Array(n), r = new Int16Array(n - k + 1), i = n, j = -1; while (i--) { p[++j] = j % k ? Math.max(p[j - 1], nums[j]) : nums[j] s[i] = i % k ? Math.max(s[i + 1], nums[i]) : nums[i] } while (i++ &lt; n - k) r[i] = Math.max(s[i], p[i + k - 1]) return r}; psï¼šç¦»è°±ï¼Œä¸ºä»€ä¹ˆè¿™ä¸ªæ¯”åŒç«¯é˜Ÿåˆ—è¦å¿«çš„","link":"/2021/01/04/Leetcode/Leetcode239-%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E6%9C%80%E5%A4%A7%E5%80%BC/"},{"title":"webstormè¯†åˆ«webpackåˆ«å","text":"webstormè¯†åˆ«webpackåˆ«å é‡è£…webstormå‘ç°ä¹‹å‰é…ç½®è¿‡çš„åˆ«åè¯†åˆ«æ— äº†ï¼Œè·³è½¬ä¹Ÿè·³è½¬ä¸äº†ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ ä½ æ˜¯å¦çƒ¦æ¼äºè®¾ç½®åˆ«ååï¼Œwebstormè­¦å‘Šå¹¶ä¸”æ— æ³•è·³è½¬çš„é—®é¢˜ æ­¥éª¤ é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶webstorm.config.js 1234567891011121314'use strict'const path = require('path')module.exports = { context: path.resolve(__dirname, './'), resolve: { extensions: ['.js', '.vue', '.json'], alias: { '@': path.resolve('src'), '@assets': path.resolve(__dirname, 'src/assets'), &quot;@components&quot;: path.resolve(&quot;src/components&quot;), } }} ç„¶åè¿›å…¥webstormè®¾ç½® ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„è¿›è¡Œè·³è½¬äº†","link":"/2020/12/16/%E7%BC%96%E8%AF%91%E5%99%A8/webstorm%E8%AF%86%E5%88%ABwebpack%E5%88%AB%E5%90%8D/"},{"title":"Webpack æ¨¡å—çƒ­æ›¿æ¢","text":"è®©ä»£ç åœ¨ç½‘é¡µä¸åˆ·æ–°çš„å‰æä¸‹å¾—åˆ°æœ€æ–°çš„æ”¹åŠ¨ï¼Œè¿™å°±æ˜¯Hot Module Replacementï¼ŒHMR 1. å¼€å¯HMRé…ç½®æ–‡ä»¶ 12345678910const webpack = require('webpack')module.exports = { plugins: [ new webpack.HotModuleReplacementPlugin() ], devServer: { hot: true, },} ç„¶ååœ¨åº”ç”¨çš„å…¥å£index.jsä¸‹è°ƒç”¨HMR APIï¼Œè¿™æ ·HMRå¯¹äºindex.jsåŠå…¶ä¾èµ–çš„æ‰€æœ‰æ¨¡å—éƒ½ä¼šç”Ÿæ•ˆ 1234// index.jsif (module.hot) { module.hot.accept();} 2. åŸç† åœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒä¸‹ï¼Œæµè§ˆå™¨æ˜¯æˆ‘ä»¬çš„å®¢æˆ·ç«¯ï¼Œwebpack-dev-serverï¼ˆWDSï¼‰ç›¸å½“äºæˆ‘ä»¬çš„æœåŠ¡ç«¯ï¼Œæ ¸å¿ƒå°±æ˜¯å®¢æˆ·ç«¯ä»æœåŠ¡ç«¯ï¼ˆWDSï¼‰æ‹‰å–æ›´æ–°åçš„èµ„æºï¼ˆHMRæ‹‰å–çš„ä¸æ˜¯æ•´ä¸ªèµ„æºæ–‡ä»¶ï¼Œè€Œæ˜¯chunk diffï¼Œå³chunkéœ€è¦æ›´æ–°çš„éƒ¨åˆ†ï¼‰ å®é™…ä¸ŠWDSä¸æµè§ˆå™¨ä¹‹é—´å»ºç«‹äº†ä¸€ä¸ªwebsorketï¼Œå½“æœ¬åœ°èµ„æºå‘ç”Ÿå˜åŒ–æ—¶WDSä¼šå‘æµè§ˆå™¨æ¨é€æ›´æ–°äº‹ä»¶ï¼Œå¹¶å¸¦ä¸Šè¿™æ¬¡æ„å»ºçš„hashï¼Œè®©å®¢æˆ·ç«¯ä¸ä¸Šä¸€æ¬¡èµ„æºè¿›è¡Œæ¯”å¯¹å¯ä»¥é˜²æ­¢å†—ä½™æ›´æ–°çš„å‡ºç°ã€‚ ç°åœ¨å®¢æˆ·ç«¯æ ¹æ®hashæ¯”å¯¹åçŸ¥é“æ–°çš„æ„å»ºç»“æ„å’Œå½“å‰çš„æœ‰äº†å·®åˆ«ï¼Œå°±ä¼šå‘WDSå‘èµ·ä¸€ä¸ªè¯·æ±‚æ¥è·å–æ›´æ”¹æ–‡ä»¶çš„åˆ—è¡¨ï¼Œé€šå¸¸è¿™ä¸ªè¯·æ±‚çš„åå­—ä¸º[hash].hot-update.json è¯¥è¿”å›ç»“æ„å‘Šè¯‰å®¢æˆ·ç«¯ï¼Œéœ€è¦æ›´æ–°çš„chunkä¸º18ï¼Œç‰ˆæœ¬ä¸ºï¼ˆæ„å»ºhashï¼‰2ef4d1d91c537e43ce76ã€‚è¿™æ ·å®¢æˆ·ç«¯å°±å¯ä»¥å†å€ŸåŠ©è¿™äº›ä¿¡æ¯ç»§ç»­å‘WDSè·å–è¯¥chunkçš„å¢é‡æ›´æ–°ã€‚ ç°åœ¨å®¢æˆ·ç«¯å·²ç»è·å–åˆ°chunkçš„æ›´æ–°ï¼Œç°åœ¨è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå®¢æˆ·ç«¯è·å–åˆ°è¿™äº›å¢é‡æ›´æ–°ä¹‹åå¦‚ä½•å¤„ç†ï¼Œè¿™å°±ä¸å±äºwebpackçš„å·¥ä½œäº†ï¼Œä½†æ˜¯HMRæä¾›äº†ç›¸å…³çš„apiã€‚å®˜æ–¹apiæ–‡æ¡£ï¼šhttps://www.webpackjs.com/api/hot-module-replacement/ å¯ä»¥çœ‹åˆ°HMRæ˜¯ä½¿ç”¨äº†webpackHotUpdateæ¥å¤„ç†çš„ï¼Œæ‰§è¡Œ webpackHotUpdate æ—¶å¦‚å‘ç°æ¨¡å—ä»£ç å®ç°äº† HMR æ¥å£ï¼Œå°±ä¼šæ‰§è¡Œç›¸åº”çš„å›è°ƒæˆ–è€…æ–¹æ³•ï¼Œä»è€Œè¾¾åˆ°åº”ç”¨æ›´æ–°æ—¶ï¼Œæ¨¡å—å¯ä»¥è‡ªè¡Œç®¡ç†è‡ªå·±æ‰€éœ€è¦é¢å¤–åšçš„å·¥ä½œã€‚ è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œwebpack å¦‚ä½•ä¿è¯ HMR æ¥å£ä¸­çš„å¼•ç”¨æ˜¯æœ€æ–°çš„æ¨¡å—ä»£ç ï¼Ÿæˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š 1234567891011import './index.css'import hello from './bar'hello()if (module.hot) { module.hot.accept('./bar', () =&gt; { // console.log('Accepting the updated bar module!') hello() })} ä»ä»£ç ä¸Šçœ‹ï¼Œhello éƒ½æ˜¯åŒä¸€ä¸ªï¼Œè¿™æ ·çš„è¯å¹¶æ²¡æœ‰åŠæ³•å¼•ç”¨æœ€æ–°çš„æ¨¡å—ä»£ç ï¼Œä½†æ˜¯æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸Šè¿°ä»£ç åœ¨ webpack æ„å»ºåçš„ç»“æœï¼š 12345678910if (true) { module.hot.accept(&quot;./src/bar.js&quot;, function(__WEBPACK_OUTDATED_DEPENDENCIES__) { /* harmony import */ __WEBPACK_IMPORTED_MODULE_1__bar__ = __webpack_require__(&quot;./src/bar.js&quot;); (() =&gt; { // console.log('Accepting the updated bar module!') Object(__WEBPACK_IMPORTED_MODULE_1__bar__[&quot;default&quot;])() })(__WEBPACK_OUTDATED_DEPENDENCIES__); })} å…¶ä»–ä»£ç æ¯”è¾ƒæ‚ï¼Œæˆ‘ä»¬é›†ä¸­çœ‹ module.hot çš„å¤„ç†éƒ¨åˆ†ã€‚è¿™é‡Œå¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬çš„ hello å·²ç»é‡æ–°ä½¿ç”¨ __webpack_require__ æ¥å¼•ç”¨äº†ï¼Œæ‰€ä»¥å¯ä»¥ç¡®ä¿å®ƒæ˜¯æœ€æ–°çš„æ¨¡å—ä»£ç ã€‚ å‚è€ƒã€ŠWebpackå®æˆ˜ã€‹æ˜é‡‘å°å†Œï¼šã€Šä½¿ç”¨ webpack å®šåˆ¶å‰ç«¯å¼€å‘ç¯å¢ƒã€‹","link":"/2020/12/11/Webpack/Webpack-%E6%A8%A1%E5%9D%97%E7%83%AD%E6%9B%BF%E6%8D%A2/"},{"title":"Webpack Tree Shaking","text":"ç”±Rollupæå‡ºï¼Œä¸ºäº†æ¶ˆé™¤æ— ç”¨çš„JavaScriptä»£ç è€Œè¢«å¼•å…¥çš„ï¼Œå¯¹äºesæ¨¡å—ä¾èµ–å…³ç³»ç¡®å®šçš„ï¼Œå°±å¯ä»¥è¿›è¡Œé™æ€åˆ†æï¼ŒCJSä¸å¯ä»¥ 1. ä½œç”¨å¯¹è±¡ ä¸ä¼šè¢«æ‰§è¡Œã€ä¸å¯åˆ°è¾¾çš„ä»£ç  ä»£ç æ‰§è¡Œçš„ç»“æœä¸ä¼šè¢«ç”¨åˆ° ä»£ç åªä¼šå½±å“æ­»å˜é‡ï¼ˆåªå†™ä¸è¯»ï¼‰ 2. ä½œç”¨æ–¹å¼ tree shaking åªä¼šå¯¹æ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„ä»£ç è¿›è¡Œæ³¨é‡Šæ ‡è®°ï¼Œç”±UglifyJSPluginæ¸…é™¤ webpack è´Ÿè´£å¯¹ä»£ç è¿›è¡Œæ ‡è®°ï¼ŒæŠŠimport&amp;exportæ ‡è®°ä¸º 3 ç±»ï¼š æ‰€æœ‰importæ ‡è®°ä¸º/* harmony import */ è¢«ä½¿ç”¨è¿‡çš„exportæ ‡è®°ä¸º/* harmony export ([type]) */ï¼Œå…¶ä¸­[type]å’Œ webpack å†…éƒ¨æœ‰å…³ï¼Œå¯èƒ½æ˜¯binding, immutableç­‰ç­‰ã€‚ æ²¡è¢«ä½¿ç”¨è¿‡çš„exportæ ‡è®°ä¸º/* unused harmony export [FuncName] */ï¼Œå…¶ä¸­ [FuncName]ä¸ºexportçš„æ–¹æ³•åç§° 3. ä¸ä¼šæ¸…é™¤ç±»å’ŒIIFEä¸‹é¢æ‘˜å–äº†rollupæ ¸å¿ƒè´¡çŒ®è€…çš„çš„ä¸€äº›å›ç­”ï¼š rollupåªå¤„ç†å‡½æ•°å’Œé¡¶å±‚çš„import/exportå˜é‡ï¼Œä¸èƒ½æŠŠæ²¡ç”¨åˆ°çš„ç±»çš„æ–¹æ³•æ¶ˆé™¤æ‰ javascriptåŠ¨æ€è¯­è¨€çš„ç‰¹æ€§ä½¿å¾—é™æ€åˆ†ææ¯”è¾ƒå›°éš¾ ä¸‹éƒ¨åˆ†çš„ä»£ç å°±æ˜¯å‰¯ä½œç”¨çš„ä¸€ä¸ªä¾‹å­ï¼Œå¦‚æœé™æ€åˆ†æçš„æ—¶å€™åˆ é™¤é‡Œrunæˆ–è€…jumpï¼Œç¨‹åºè¿è¡Œæ—¶å°±å¯èƒ½æŠ¥é”™ï¼Œé‚£å°±æœ¬æœ«å€’ç½®äº†ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯ä¼˜åŒ–ï¼Œè‚¯å®šä¸èƒ½å½±å“æ‰§è¡Œ ä¸‹é¢è¿™ç¯‡æ–‡ç« ä»‹ç»äº†Babelç¼–è¯‘ç±»æ–‡ä»¶å¯¼è‡´å‰¯ä½œç”¨ï¼Œä»¥åŠUglifyJsè´¡çŒ®è€…å¯¹å¤„ç†æœ‰å‰¯ä½œç”¨ä»£ç çš„æ€åº¦https://juejin.cn/post/6844903549290151949 (ä½ çš„Tree-Shakingå¹¶æ²¡ä»€ä¹ˆåµç”¨) 4. å¯¹äºIIFEè¿”å›çš„å‡½æ•°ï¼Œå¦‚æœæœªè¢«ä½¿ç”¨åˆ™ä¼šæ¸…é™¤12345678910111213141516171819//App.jsimport { cube } from './utils.js';console.log(cube(2));//utils.jsvar square = function(x) { console.log('square'); return x * x;}();function getSquare() { console.log('getSquare'); square();}export function cube(x) { console.log('cube'); return x * x * x;} ç»“æœ 123456789function(e, t, n) { &quot;use strict&quot;; n.r(t); console.log(&quot;square&quot;); // squareè¿™ä¸ªIIFEå†…éƒ¨çš„ä»£ç è¿˜åœ¨ console.log(function(e) { return console.log(&quot;cube&quot;), e * e * e // squareè¿™ä¸ªIIFEreturnçš„æ–¹æ³•å› ä¸ºgetSquareæœªè¢«è°ƒç”¨è€Œè¢«åˆ é™¤ }(2))} 5.Tree shakingç»“åˆç¬¬ä¸‰æ–¹åŒ…ä½¿ç”¨1234567891011//App.jsimport { getLast } from './utils.js';console.log(getLast('abcdefg'));//utils.jsimport _ from 'lodash'; // è¿™é‡Œçš„å¼•ç”¨æ–¹å¼ä¸åŒï¼Œä¼šé€ æˆbundleçš„ä¸åŒç»“æœexport function getLast(string) { console.log('getLast'); return _.last(string);} ç»“æœ 1234567891011import _ from 'lodash'; Asset Size bundle.js 70.5 KiBimport { last } from 'lodash'; Asset Sizebundle.js 70.5 KiBimport last from 'lodash/last'; // è¿™ç§å¼•ç”¨æ–¹å¼æ˜æ˜¾é™ä½äº†æ‰“åŒ…åçš„å¤§å° Asset Sizebundle.js 1.14 KiB 6. tree shakingç»“åˆç¬¬ä¸‰æ–¹åŒ…ä½¿ç”¨12345678910111213141516//App.jsimport { Add } from './utils'Add(1 + 2);//utils.jsimport { isArray } from 'lodash-es';export function array(array) { console.log('isArray'); return isArray(array);}export function Add(a, b) { console.log('Add'); return a + b} 1è¿™ä¸ª`array`å‡½æ•°æœªè¢«ä½¿ç”¨ï¼Œä½†æ˜¯lodash-esè¿™ä¸ªåŒ…çš„éƒ¨åˆ†ä»£ç è¿˜æ˜¯ä¼šè¢«buildåˆ°bundle.jsä¸­ å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ’ä»¶webpack-deep-scope-analysis-pluginè§£å†³ å‚è€ƒhttps://juejin.cn/post/6844903544756109319#heading-0https://juejin.cn/post/6844903774192926728https://juejin.cn/post/6844903687412776974#heading-8","link":"/2020/12/11/Webpack/Webpack-Tree-Shaking/"},{"title":"webpack loader","text":"å…³äºloaderçš„ä½œç”¨å’Œé…ç½®æ–¹æ³•ï¼Œåœ¨ åˆè¯†webpack è¿™ç¯‡æ–‡ç« ä¸­å·²ç»è®²è¿‡ï¼Œæœ¬ç¯‡æ–‡ç« ä¼šè®²å¸¸ç”¨çš„ä¸€äº›loaderï¼Œå¹¶è‡ªå·±å®ç°ä¸€ä¸ªloaderå‡½æ•°ã€‚ 1. è½¬ä¹‰es6å®‰è£…1npm i @babel/core babel-loader @babel/preset-env -D babel-loaderï¼šå®ƒæ˜¯ä½¿babelä¸webpackååŒå·¥ä½œçš„æ¨¡å— @babel/coreï¼šæ˜¯babelç¼–è¯‘å™¨çš„æ ¸å¿ƒæ¨¡å— @babel/preset-envï¼šå®˜æ–¹æ¨èçš„é¢„ç½®å™¨ï¼Œå¯æ ¹æ®ç”¨æˆ·è®¾ç½®çš„ç›®æ ‡ç¯å¢ƒè‡ªåŠ¨æ·»åŠ æ‰€éœ€çš„æ’ä»¶å’Œè¡¥ä¸æ¥ç¼–è¯‘es6ä»£ç  é…ç½®12345678910111213141516rules: [ { test: /\\.js$/, use: { loader: 'babel-loader', // é…ç½®é€‰é¡¹é‡Œçš„presets // åŒ…å«ES6è¿˜æœ‰ä¹‹åçš„ç‰ˆæœ¬å’Œé‚£äº›ä»…ä»…æ˜¯è‰æ¡ˆçš„å†…å®¹ options: { cacheDirectory: true, // å¯åŠ¨ç¼“å­˜æœºåˆ¶ï¼Œåœ¨é‡å¤æ‰“åŒ…æœªæ”¹å˜è¿‡çš„æ¨¡å—æ—¶é˜²æ­¢äºŒæ¬¡ç¼–è¯‘ï¼ŒåŠ å¿«æ‰“åŒ…é€Ÿåº¦ presets: ['@babel/preset-env'] } } include: /src/, // åªè½¬åŒ–srcç›®å½•ä¸‹çš„js exclude: /node_modules/ // æ’é™¤æ‰node_modulesï¼Œä¼˜åŒ–æ‰“åŒ…é€Ÿåº¦ }] 2. è½¬ä¹‰Tså®‰è£…1npm i ts-loader typescript é…ç½®12345rules: [ { test: /\\.ts$/, use: 'ts-loader',] ä¸å¯»å¸¸loaderä¸åŒçš„æ˜¯ï¼Œtsé…ç½®é¡¹æ˜¯åœ¨å·¥ç¨‹ç›®å½•ä¸‹çš„tsconfig.jsonä¸­ 3. html-loaderç”¨äºå°†HTMLæ–‡ä»¶è½¬åŒ–ä¸ºå­—ç¬¦ä¸²å¹¶è¿›è¡Œæ ¼å¼åŒ–ï¼Œè¿™ä½¿å¾—å¤–é¢å¯ä»¥æŠŠä¸€ä¸ªHTMLç‰‡æ®µé€šè¿‡jsåŠ è½½è¿›æ¥ã€‚ å®‰è£…1npm i html-loader é…ç½®12345rules: [ { test: /\\.html$/, use: 'html-loader',] 4. file-loaderç”¨äºæ‰“åŒ…æ–‡ä»¶ç±»å‹çš„èµ„æºï¼Œå¹¶è¿”å›å…¶publicPath å®‰è£…1npm i file-loader é…ç½®12345rules: [ { test: /\\.(jpe?g|png|gif)$/, use: 'file-loader',] 5. url-loaderå®‰è£…1npm i url-loader é…ç½®123456789101112rules: [ { test: /\\.(jpe?g|png|gif)$/, use: { loader: 'url-loader', options: { limit: 10240, // å¦‚æœå°äºè¯¥é…ç½®å¤§å°ï¼Œåˆ™è¿”å›æ–‡ä»¶çš„base64å½¢å¼ name: '[name].[ext]', publicPath: './assets-path/', // ä¼šè¦†ç›–webpacké…ç½®çš„publicPath }, },] 6. åŠ è½½æ ·å¼å®‰è£…1npm i style-loader css-loader less-loader -D é…ç½®12345678910rules: [ { test: /.less$/, use: [ 'style-loader', // å°†æ ·å¼é€šè¿‡&lt;style&gt;æ ‡ç­¾æ’å…¥åˆ°headä¸­ 'css-loader', // ç”¨äºåŠ è½½.cssæ–‡ä»¶ï¼Œå¹¶è½¬åŒ–æˆcommonjså¯¹è±¡ 'less-loader' // å°†lessè½¬åŒ–æˆcss ] },] 7. è‡ªå®šä¹‰loaderæˆ‘ä»¬å°†å®ç°ä¸€ä¸ªloaderï¼Œå®ƒä¼šä¸ºæ‰€æœ‰JSæ–‡ä»¶å¼€å¯ä¸¥æ ¼æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¼šåœ¨æ–‡ä»¶å¤´éƒ¨åŠ ä¸Šå¦‚ä¸‹ä»£ç  1'user strict' force-strict-loader.js 12345678910111213141516171819202122232425262728// æä¾›ä¸€äº›å¸®åŠ©å‡½æ•°ï¼Œè¿™é‡Œç”¨äºè·å–optionsä¸­çš„é…ç½®é¡¹var loaderUtils = require(&quot;loader-utils&quot;);var SourceNode = require('source-map').SourceNode;var SourceMapConsumer = require('source-map').SourceMapConsumer;module.exports = function (content, sourceMap) { var useStrictPrefix = '\\'use strict\\';\\n\\n'; // å¼€å¯ç¼“å­˜ï¼Œå¦‚æœæ–‡ä»¶è¾“å…¥å’Œå…¶ä¾èµ–æ²¡æœ‰å‘ç”Ÿå˜åŒ–æ—¶ï¼Œåº”è¯¥è®©loaderç›´æ¥ä½¿ç”¨ç¼“å­˜ï¼Œæé«˜webpackæ‰“åŒ…çš„é€Ÿåº¦ if (this.cacheable) { this.cacheable(); } // å¼€å¯source-mapå¯ä»¥ä¾¿äºå®é™…å¼€å‘è€…åœ¨æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹æºä»£ç  // å¦‚æœæ²¡æœ‰å¤„ç†ï¼Œæœ€ç»ˆæ— æ³•ç”Ÿæˆæ­£ç¡®çš„mapæ–‡ä»¶ï¼Œåœ¨dev toolä¸­å¯èƒ½çœ‹åˆ°é”™ä¹±çš„æºç  var options = loaderUtils.getOptions(this) || {}; // åªæœ‰åœ¨ä»é…ç½®ä¸­è·å–sourceMapæˆ–è€…ä»ä¸Šä¸€ä¸ªloaderä¸­ä¼ é€’ä¸‹æ¥æ‰ä¼šç»§ç»­å¤„ç† if (options.sourceMap &amp;&amp; sourceMap) { var currentReguest = loaderUtils.getCurrentRequest(this); var node = SourceNode.formStringWithSourceMap( content, new SourceMapConsumer(sourceMap) ); node.prepend(useStrictPrefix); var result = node.toStringWithSourceMap({ file: currentReguest}); var callback = this.async(); callback(null, result.code, result.map.toJSON()); } return useStrictPrefix + content;} ä¸Šé¢çš„æ’ä»¶æä¾›äº†source-mapçš„é…ç½®é€‰é¡¹ï¼Œsource-mapæ˜¯ä¸€ä¸ªä¿¡æ¯æ–‡ä»¶ï¼Œé‡Œé¢å‚¨å­˜ç€ä½ç½®ä¿¡æ¯ï¼Œåœ¨debugçš„æ—¶å€™å°±ä¼šæ˜¾ç¤ºåŸæ–‡ä»¶çš„ä¿¡æ¯å’Œä½ç½®ï¼Œè€Œä¸æ˜¯è½¬åŒ–åçš„ä¿¡æ¯ã€‚ ä½¿ç”¨æ–¹æ³• 123456use: { loader: 'force-strict-loader', options: { sourceMap: true, }} å‚è€ƒã€ŠWebpackå®æˆ˜å…¥é—¨ã€è¿›é˜¶ä¸è°ƒä¼˜ã€‹https://juejin.cn/post/6844903599080734728#heading-14http://www.ruanyifeng.com/blog/2013/01/javascript_source_map.html","link":"/2020/11/27/Webpack/webpack%20loader/"},{"title":"webpackæ–‡ä»¶æŒ‡çº¹","text":"æ‰“åŒ…åçš„æ–‡ä»¶åç¼€ï¼Œé€šå¸¸ç”¨äºåšç‰ˆæœ¬ç®¡ç†ï¼Œæ–‡ä»¶è¢«ä¿®æ”¹åæ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶æŒ‡çº¹ä¸åŒï¼Œæµè§ˆå™¨åªä¼šä¸‹è½½è¿™äº›ä¸åŒçš„æ–‡ä»¶ï¼Œæ²¡è¢«ä¿®æ”¹çš„æ–‡ä»¶ä»ç¼“å­˜è¯»å–ï¼ŒåŠ å¿«æµè§ˆé€Ÿåº¦ 1. ä¸‰ç§æ–‡ä»¶æŒ‡çº¹çš„ç­–ç•¥ æ–‡ä»¶æŒ‡çº¹ ç­–ç•¥ hash åªè¦æœ‰æ–‡ä»¶è¢«ä¿®æ”¹ï¼Œæ¯ä¸€æ¬¡æ„å»ºè¿‡ç¨‹ç”Ÿæˆå”¯ä¸€hashï¼Œæ‰€æœ‰æ–‡ä»¶å…±ç”¨ chunkhash åŸºäºchunkå†…å®¹ç”Ÿæˆï¼Œä¸åŒçš„entryä¼šç”Ÿæˆä¸åŒçš„chunkhashå€¼ contenthash æ ¹æ®æ–‡ä»¶å†…å®¹æ¥å®šä¹‰hashï¼Œæ–‡ä»¶å†…å®¹ä¸å˜ï¼Œåˆ™contenthashä¸å˜ chunkhashçš„é—®é¢˜ï¼šå¦‚æœåœ¨jsä¸­å¼•å…¥äº†styleæ–‡ä»¶ï¼Œä¹‹ååªä¿®æ”¹äº†styleæ–‡ä»¶ï¼Œä½†æ‰“åŒ…åjsçš„æ–‡ä»¶æŒ‡çº¹ä¹Ÿä¸€èµ·ä¿®æ”¹äº† 2. æ–‡ä»¶æŒ‡çº¹çš„è®¾ç½®2.1 jsçš„æ–‡ä»¶æŒ‡çº¹è®¾ç½® jsä½¿ç”¨chunkhashå‹çš„æ–‡ä»¶æŒ‡çº¹ 12345678910module.exports = { entry: { app: './src/app.js', search: './src/search.js' }, output: { filename: '[name][chunkhash:8].js', // å–chunkhashçš„å‰8ä½ path: __dirname + '/dist' }}; 2.2 cssçš„æ–‡ä»¶æŒ‡çº¹è®¾ç½®1234567891011121314151617module.exports = { entry: { app: './src/app.js', search: './src/search.js' }, output: { filename: '[name][chunkhash:8].js', path: __dirname + '/dist' }, plugins: [ // å¦‚æœä½¿ç”¨style-loaderè®¾ç½®è§£ææ ·å¼ï¼Œåšä¸åˆ°å„è‡ªç‹¬ç«‹çš„cssæ–‡ä»¶ // æ‰€ä»¥ä½¿ç”¨ MiniCssExtractPlugin æ’ä»¶æŠ½ç¦»å‡ºå„ä¸ªç‹¬ç«‹çš„cssæ–‡ä»¶ new MiniCssExtractPlugin({ filename: `[name][contenthash:8].css` }); ]}; 2.3 å›¾ç‰‡çš„æ–‡ä»¶æŒ‡çº¹123456789101112131415161718192021const path = require('path');module.exports = { entry: './src/index.js', output: { filename: 'bundle.js', path: path.resolve(__dirname, 'dist') }, module: { rules: [ { test: /\\.(png|svg|jpg|gif)$/, use: [{ loader: 'file-loaderâ€™, options: { name: 'img/[name][hash:8].[ext]' } }] } ] }};","link":"/2020/11/22/Webpack/webpack%E6%96%87%E4%BB%B6%E6%8C%87%E7%BA%B9/"},{"title":"åˆè¯†webpack","text":"1. å®‰è£…1npm install webpack webpack-cli --save-dev webpackæ˜¯æ ¸å¿ƒæ¨¡å—ï¼Œwebpack-cliåˆ™æ˜¯å‘½ä»¤è¡Œå·¥å…· ç„¶ååœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºwebpack.config.jsæ¥é…ç½®webpack 2. é…ç½®èµ„æºå…¥å£åœ¨é…ç½®å…¥å£çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯åšäº†ä¸¤ä»¶äº‹ï¼š ç¡®å®šå…¥å£æ¨¡å—çš„ä½ç½®ï¼Œå‘Šè¯‰webpackä»é‚£é‡Œå¼€å§‹æ‰“åŒ… å®šä¹‰chunk nameï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªå…¥å£ï¼Œé»˜è®¤chunk nameä¸ºâ€œmainâ€ï¼Œå¦‚æœä¸ºå¤šå…¥å£ï¼Œåˆ™éœ€è¦ä¸ºæ¯ä¸€ä¸ªå…¥å£å®šä¹‰chunk nameä½œä¸ºå…¶å”¯ä¸€æ ‡è¯† 2.1 context entryè·¯å¾„å‰ç¼€ 1234module.exports = { context: path.join(__dirname, './src'), // èµ„æºå…¥å£å‰ç¼€ï¼ˆä¸ºäº†è®©entryç¼–å†™çš„æ›´ç®€æ´ entry: './index.js', // string | object | array | function}; 2.2 entryæ”¯æŒå››ç§ç±»å‹çš„å€¼ å­—ç¬¦ä¸²ç±»å‹ ç›´æ¥ä¼ å…¥æ–‡ä»¶è·¯å¾„ï¼ˆç»å¯¹è·¯å¾„ | ç›¸å¯¹è·¯å¾„ï¼‰ æ•°ç»„ç±»å‹ ä½œç”¨æ˜¯å°†å¤šä¸ªèµ„æºé¢„å…ˆåˆå¹¶ 123module.exports = { entry: [&quot;babel-polyfill&quot;, &quot;./src/index.js&quot;], // æœ€åçš„æ–‡ä»¶ä½œä¸ºå…¥å£}; å¯¹è±¡ç±»å‹ æƒ³è¦å®šä¹‰å¤šå…¥å£ï¼Œåˆ™å¿…é¡»ä½¿ç”¨å¯¹è±¡çš„å½¢å¼ 12345678module.exports = { entry: { // chunk nameä¸ºindexï¼Œå…¥å£è·¯å¾„ä¸º./src/index.js index: [&quot;babel-polyfill&quot;, &quot;./src/index.js&quot;], // chunk nameä¸ºlib1ï¼Œå…¥å£è·¯å¾„ä¸º./src/lib.js lib1: './src/lib.js', }}; å‡½æ•°ç±»å‹ å¯ä»¥åŠ¨æ€è®¾ç½®æ–‡ä»¶è·¯å£ï¼Œç”šè‡³åŠ ä¸Šå¼‚æ­¥é€»è¾‘ 1234567module.exports = { entry: () =&gt; new Promise((resolve) =&gt; { setTimeout(() =&gt; { resolve('./src/index.js'); }, 1000) })}; 2.3 vender ä¸€èˆ¬æ˜¯æŠŠå·¥ç¨‹æ‰€ä½¿ç”¨çš„åº“ã€æ¡†æ¶ç­‰ç¬¬ä¸‰æ–¹æ¨¡å—é›†ä¸­æ‰“åŒ…è€Œäº§ç”Ÿçš„bundleï¼Œå¯ä»¥ä½¿ç”¨CommonsChunkPluginå°†appä¸vendorè¿™ä¸¤ä¸ªchunkä¸­çš„å…¬å…±æ¨¡å—æå–å¤„ç†ï¼Œä½¿app.jsäº§ç”Ÿçš„bundleå°†åªåŒ…å«ä¸šåŠ¡æ¨¡å—ã€‚ 123456module.exports = { entry: { app: './src/app.js', vendor: ['vue'], }}; 3. é…ç½®èµ„æºå‡ºå£3.1 filenameä½œç”¨æ˜¯æ§åˆ¶è¾“å‡ºèµ„æºçš„æ–‡ä»¶åï¼Œä¹Ÿå¯ä»¥ä¸ºç›¸å¯¹è·¯å¾„ å’Œ æ¨¡æ¿å˜é‡ï¼ˆç”¨äºæ§åˆ¶å®¢æˆ·ç«¯ç¼“å­˜ï¼Œä¸‹ä¸€ç¯‡åšå®¢å°†ä¼šè®²æ–‡ä»¶æŒ‡çº¹ï¼‰ 123456module.exports = { entry: './src/app.js', output: { filename: &quot;bundle.js&quot; }}; 3.2 pathå¯ä»¥æŒ‡å®šèµ„æºè¾“å‡ºçš„ä½ç½®ï¼Œè¦æ±‚å€¼å¿…é¡»ä¸ºç»å¯¹è·¯å¾„ 1234567module.exports = { entry: './src/app.js', output: { filename: &quot;bundle.js&quot;, path: path.join(__dirname, 'dist'), }}; 3.3 publicPathpathç”¨æ¥æŒ‡å®šèµ„æºè¾“å‡ºä½ç½®ï¼Œè€ŒpublicPathç”¨æ¥æŒ‡å®šèµ„æºè¯·æ±‚ä½ç½® 123// å‡è®¾å½“å‰åœ°å€ä¸º https://example.com/app/index.html// å¼‚æ­¥åŠ è½½çš„èµ„æºåä¸º 0.chunk.jspublicPath: &quot;./js&quot; // å®é™…è·¯å¾„ https://example.com/app/js/0.chunk.js 4. loaderwebpack å¼€ç®±å³ç”¨åªæ”¯æŒ JS å’Œ JSON ä¸¤ç§æ–‡ä»¶ç±»å‹ï¼Œé€šè¿‡ Loader å»æ”¯æŒå…¶å®ƒæ–‡ä»¶ç±»å‹å¹¶ä¸”æŠŠå®ƒä»¬è½¬åŒ–æˆæœ‰æ•ˆçš„æ¨¡å—ï¼Œå¹¶ä¸”å¯ä»¥æ·»åŠ åˆ°ä¾èµ–å›¾ä¸­ã€‚ 12345678910111213141516module.exports = { // ... module: { rules: [{ enforce: normal // pre: åœ¨æ‰€æœ‰loaderä¹‹å‰è°ƒç”¨ | normal | post: åœ¨æ‰€æœ‰loaderä¹‹åè°ƒç”¨ test: /\\.css$/, // å¯ä»¥æ¥å—æ­£åˆ™è¡¨è¾¾å¼æˆ–è€…æ­£åˆ™æ•°ç»„ use: ['css-loader', 'less-loader'], // å¯ä»¥æ¥æ”¶ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«åŒ¹é…é¡¹æ‰€ä½¿ç”¨loaderï¼Œä»å³å‘å·¦å¤„ç† exclude: /src\\/lib/, // æ’é™¤ç›®å½• include: /src/, // åŒ…å«ç›®å½•ï¼Œexcludeå’ŒincludeåŒæ—¶å­˜åœ¨æ—¶-excludeä¼˜å…ˆçº§æ›´é«˜ issuer: { // ä¸Šé¢æ˜¯å¯¹è¢«åŠ è½½è€…çš„é…ç½®ï¼Œè¿™æ˜¯åŠ è½½è€…çš„é…ç½® test: /\\.js$/, // è¯¥é…ç½®çš„æ„æ€ä¸ºåªæœ‰ /src/pagesç›®å½•ä¸‹çš„jså¯ä»¥å¼•ç”¨css include: /src/pages/, } }] }}; 5.pluginså¯¹webpack loaderçš„æ‰©å±•ï¼Œä½œç”¨äºæ„å»ºçš„æ•´ä¸ªè¿‡ç¨‹ 123plugins: [ new HtmlWebpackPlugin({template: './src/index.html'})] 6. mode é€‰é¡¹ æè¿° development è®¾ç½®process.env.NODE_ENVçš„å€¼ä¸ºdevelopmentå¼€å¯NamedChunksPluginå’ŒNamedModulesPlugin production è®¾ç½®process.env.NODE_ENVçš„å€¼ä¸ºproductionå¼€å¯FlagDependencyUsagePluginï¼ŒFlagInc ludedChunksPluginï¼Œ ModuleConcatenationPluginï¼ŒNoEmitOnErrorsPluginï¼ŒOccurrenceOrderPluginï¼Œ SideEffectsFlagPluginå’ŒTerserPlugin none ä¸å¼€å¯ä»»ä½•ä¼˜åŒ–é€‰é¡¹","link":"/2020/11/22/Webpack/%E5%88%9D%E8%AF%86webpack/"},{"title":"Jestè‡ªåŠ¨åŒ–æµ‹è¯•å…¥é—¨","text":"1. ç¯å¢ƒæ­å»º1npm install --save-dev jest ç„¶ååœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œæ§åˆ¶å°æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå°±ä¼šåˆå§‹åŒ–jesté…ç½® jest.config.js 1npx jest --init ç”Ÿæˆä»£ç è¦†ç›–ç‡ 1npx jest --coverage 2.ç®€å•æµ‹è¯•é¦–å…ˆæœ‰ä¸¤ä¸ªæ–‡ä»¶ liang.js 123456789101112function foo(money) { return money &gt; 10000 ? 'æœ‰é’±å“©' : 'éš¾å—';}function bar(money) { return money &gt; 1000 ? 'åƒå¤§é¤' : 'åƒç©ºæ°”';}module.exports = { foo, bar} liang.test.js 12345678910const { foo, bar } = require('./liang');test('fooæ–¹æ³•-5000', () =&gt; { // toBe ~= === expect(foo(5000)).toBe('éš¾å—')})test('baræ–¹æ³•-2000', () =&gt; { expect(bar(2000)).toBe('åƒå¤§é¤')}) æŠŠå¾…æµ‹è¯•å‡½æ•°åŒ…åœ¨expectä¸­ï¼Œç”¨åŒ¹é…å™¨ï¼ˆè¿™é‡Œæ˜¯toBeï¼‰è¿›è¡Œæ£€æŸ¥è¾“å‡º ç„¶ååœ¨package.jsonä¸­æ·»åŠ è¿è¡ŒæŒ‡ä»¤ 12345{ &quot;scripts&quot;: { &quot;test&quot;: &quot;jest&quot; // æƒ³è¦æœ‰ç›‘è§†åŠŸèƒ½å°±åŠ ä¸Š --watchAll }} ç„¶ånpm run testå°±èƒ½è¿è¡Œæˆ‘ä»¬ç¬¬ä¸€ä¸ªjestæµ‹è¯•äº† 3.å¸¸ç”¨åŒ¹é…å™¨ åŒ¹é…å™¨ åŠŸèƒ½ toBe === toEqual é€’å½’æ¯”è¾ƒå¯¹è±¡æ‰€æœ‰å±æ€§çš„å€¼ï¼ˆæ·±åº¦ç›¸ç­‰ï¼‰ toBeNull åªåŒ¹é… null toBeUndefined åªåŒ¹é… undefined toBeDefined ä¸ä¸ºundefined toBeTruthy åŒ¹é…ä»»ä½• if è¯­å¥ä¸ºçœŸ toBeFalsy åŒ¹é…ä»»ä½• if è¯­å¥ä¸ºå‡ å¯ä»¥åœ¨ä¸Šè¿°åŒ¹é…å™¨å‰åŠ ä¸ªnotè¡¨ç¤ºå–åï¼Œæ¯”å¦‚.not.toBeè¡¨ç¤ºä¸ä¸¥æ ¼ç­‰äº æœ‰å…³åŒ¹é…å™¨çš„å®Œæ•´åˆ—è¡¨ï¼Œè¯·æŸ¥é˜… å‚è€ƒæ–‡æ¡£ 4. æµ‹è¯•å¼‚æ­¥æ–¹æ³•4.1 å¼•å…¥æ–‡ä»¶fetchData.js 12345import axios from 'axios'export function fetchData () { return axios.get('http://localhost:3000/');} fetchData.test.js 123456789import { fetchData } from './fetchData'test('fetchData æ–¹æ³•æµ‹è¯•1', () =&gt; { fetchData().then(response =&gt; { expect(response.data).toEqual({ success: true, }) })}) æ— è®ºæ€ä¹ˆæ ·éƒ½ä¼šæµ‹è¯•æˆåŠŸï¼Œå› ä¸ºjestæµ‹è¯•ä¸€æ—¦æ‰§è¡Œåˆ°æœ«å°¾å°±ä¼šå®Œæˆæ‰€ä»¥é—®é¢˜å†ä¸ä¸€æ—¦fetchDataæ‰§è¡Œç»“æŸï¼Œæ­¤æµ‹è¯•å°±åœ¨æ²¡ç”¨è°ƒç”¨å›è°ƒå‡½æ•°å‰ç»“æŸ 4.2 è§£å†³æ–¹æ³•12345678test('fetchData æ–¹æ³•æµ‹è¯•2', (done) =&gt; { fetchData().then(response =&gt; { expect(response.data).toEqual({ success: true, }) done(); // Jestä¼šç­‰ done å›è°ƒå‡½æ•°æ‰§è¡Œç»“æŸåï¼Œç»“æŸæµ‹è¯•ï¼Œæ‰€ä»¥ä¼š })}) 4.3 exportæ•°é‡æ–­è¨€ä¸‹é¢ä¸€æ®µä»£ç çš„åŠŸèƒ½ï¼šæ£€æŸ¥æ¥å£æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨å°±æµ‹è¯•æˆåŠŸ 1234567test('fetchData catchæ–¹æ³•æµ‹è¯•', () =&gt; { expect.assertions(1) // æ–­è¨€ï¼Œå¿…é¡»æ‰§è¡Œä¸€æ¬¡exportï¼Œå¦‚æœä¸æ‰§è¡Œåˆ™æŠ¥é”™ // å¦‚æœä¸åŠ æ–­è¨€ï¼Œé‚£ä¹ˆå¦‚æœæ²¡æœ‰é”™è¯¯è¢«catchåˆ°ï¼Œåˆ™æµ‹è¯•ä¸ä¼šè¢«æ‰§è¡Œï¼Œæ˜¾ç¤ºä¸å‡ºæŠ¥é”™ fetchData().catch(err =&gt; { expect(err.toString().indexOf('404') &gt; -1).toBe(true); })}) 4.4 asyncå’Œawaitçš„æµ‹è¯•æ–¹æ³•å¦‚æœæ˜¯ç”¨awaitè¿›è¡Œæµ‹è¯•çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨exportçš„resolveså’Œrejects 1234567test('fetchData asyncæ–¹æ³•', async () =&gt; { await expect(fetchData()).resolves.toMatchObject({ data: { success: true, } })}) 5. é’©å­å‡½æ•°5.1 åŠŸèƒ½æè¿°åƒvue-routerçš„å¯¼èˆªå®ˆå«ä¸€æ ·çš„ï¼Œjestä¹Ÿæœ‰å››ä¸ªé’©å­å‡½æ•° é’©å­å‡½æ•° åŠŸèƒ½ beforeAll åœ¨æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ä¹‹å‰æ‰§è¡Œ afterAll åœ¨æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ä¹‹åæ‰§è¡Œ beforeEach åœ¨æ¯ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ä¹‹å‰æ‰§è¡Œ afterEach åœ¨æ¯ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ä¹‹åæ‰§è¡Œ 5.2 ä½œç”¨åŸŸé»˜è®¤æƒ…å†µä¸‹before å’Œ after çš„å—å¯ä»¥åº”ç”¨åˆ°æ–‡ä»¶ä¸­çš„æ¯ä¸ªæµ‹è¯•ï¼Œå¯ä»¥ä½¿ç”¨describeå£°æ˜ä¸€ä¸ªä½œç”¨åŸŸï¼Œè¿™äº›é’©å­å‡½æ•°åœ¨describeå£°æ˜ çš„ä½œç”¨åŸŸå†…è°ƒç”¨ï¼Œåˆ™åªä¼šä½œç”¨åœ¨è¯¥ä½œç”¨åŸŸå†…ã€‚ 123456789101112131415161718192021222324import { foo, bar } from '../simpleDemo/liang'beforeAll(() =&gt; { console.log(&quot;æˆ‘æ˜¯åœ¨å¤–é¢çš„beforeAll&quot;)})beforeEach(() =&gt; { console.log(&quot;æˆ‘æ˜¯åœ¨å¤–é¢çš„beforeEach&quot;)})describe('describe inner', () =&gt; { beforeAll(() =&gt; { console.log(&quot;æˆ‘æ˜¯åœ¨é‡Œé¢çš„beforeAll&quot;) }) test('fooæ–¹æ³•-5000', () =&gt; { // toBe ~= === expect(foo(5000)).toBe('éš¾å—') }) test('baræ–¹æ³•-2000', () =&gt; { expect(bar(2000)).toBe('åƒå¤§é¤') })}) 5.3 é’©å­å‡½æ•°çš„ä½œç”¨è§„åˆ™ç”±ä¸Šé¢æˆªå›¾çš„æ‰§è¡Œé¡ºåºï¼Œå¯ä»¥å¼•å‡ºä»¥ä¸‹ä¸‰æ¡è§„åˆ™ é’©å­å‡½æ•°åœ¨çˆ¶çº§åˆ†ç»„å¯ä½œç”¨äºå­é›† é’©å­å‡½æ•°åŒçº§åˆ†ç»„ä½œç”¨åŸŸäº’ä¸å¹²æ‰°ï¼Œå„èµ·ä½œç”¨ å…ˆæ‰§è¡Œå¤–éƒ¨çš„é’©å­å‡½æ•°ï¼Œå†æ‰§è¡Œå†…éƒ¨çš„é’©å­å‡½æ•°","link":"/2020/11/17/%E6%B5%8B%E8%AF%95/Jest%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95%E5%85%A5%E9%97%A8/"},{"title":"æ·±æ‹·è´ã€æµ…æ‹·è´","text":"1. åŒºåˆ« æµ…æ‹·è´ï¼šå¤åˆ¶åŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹ æ·±æ‹·è´ï¼šå¼•ç”¨ç±»å‹æ‰€æŒ‡å‘çš„å†…å­˜ç©ºé—´ä¹Ÿå®Œå…¨æ‹·è´ 2. æµ…æ‹·è´çš„å®ç°æ–¹å¼2.1 Object.assign(target, â€¦sources)æŠŠå¯¹è±¡çš„å¯æšä¸¾å±æ€§æ‹·è´ç»™ç›®æ ‡å¯¹è±¡ 2.2 å±•å¼€è¿ç®—ç¬¦â€¦ä¸Object.assignç›¸åŒ 2.3 Array.prototype.concat()2.4 Array.prototype.slice()3. æ·±æ‹·è´çš„å®ç°æ–¹å¼3.1.JSON.parse(JSON.stringify())12let arr = [1, 3, { username: 'liangliang' }];JSON.parse(JSON.stringify(arr)); // æ·±æ‹·è´ï¼Œä¼šä¸ºå¯¹è±¡å¼€è¾Ÿæ–°çš„æ ˆç©ºé—´ ä¼˜ç‚¹ å¯ä»¥è§£å†³å¯¹è±¡å†…éƒ¨å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼ŒJSON.stringifyå†…éƒ¨åšäº†å¾ªç¯å¼•ç”¨çš„æ£€æµ‹ ç¼ºç‚¹ ä¼šæŠ›å¼ƒå¯¹è±¡çš„constructorï¼Œæ— è®ºåŸæœ¬çš„æ„é€ å‡½æ•°æ˜¯ä»€ä¹ˆï¼Œåœ¨æ­¤ä¹‹åéƒ½ä¼šå˜æˆObject ä½†æ˜¯è¿™æ ·å¯¹æ­£åˆ™è¡¨è¾¾å¼å¤„ç†åä¼šå˜æˆç©ºå¯¹è±¡ï¼Œæ•°ç»„æˆ–è€…å¯¹è±¡ä¸­çš„å‡½æ•°å˜ä¸ºnull 3.2 jQuery.extend1jQuery.extend( [deep], target, object1 [, objectN ] ) 3.3 MessageChannel [2021.3.2]12345678910111213function deepCopy(obj) { return new Promise((resolve) =&gt; { const {port1, port2} = new MessageChannel(); port2.onmessage = ev =&gt; resolve(ev.data); port1.postMessage(obj); });}deepCopy(obj).then((copy) =&gt; { // è¯·è®°ä½`MessageChannel`æ˜¯å¼‚æ­¥çš„è¿™ä¸ªå‰æï¼ let copyObj = copy; console.log(copyObj, obj) console.log(copyObj == obj)}); å¯ä»¥æ‹·è´undefinedå’Œå¾ªç¯å¼•ç”¨çš„å¯¹è±¡ï¼Œä½†æ˜¯æœ‰å‡½æ•°çš„å¯¹è±¡è¿˜æ˜¯æŠ¥é”™ å‚è€ƒhttps://juejin.im/post/6844904197595332622https://github.com/mqyqingfeng/Blog/issues/33ï¼ˆå†…å«jQueryçš„å®ç°ï¼‰https://segmentfault.com/a/1190000016672263ï¼ˆå†…å«å¾ªç¯æ·±æ‹·è´ï¼‰","link":"/2020/10/31/Js/%E6%B7%B1%E6%8B%B7%E8%B4%9D%E3%80%81%E6%B5%85%E6%8B%B7%E8%B4%9D/"},{"title":"åœ£æ¯å¸ƒå±€ã€åŒé£ç¿¼å¸ƒå±€","text":"1. é—®é¢˜åœºæ™¯ä¸‰åˆ—å¸ƒå±€ä¸­ï¼Œå¦‚æœæƒ³è¦å°†ä¸»è¦å†…å®¹mainä¼˜å…ˆåŠ è½½ä¼˜åŒ–ï¼Œåˆ™DOMå¦‚ä¸‹æ‰€ç¤º 12345&lt;div class=&quot;g-container&quot;&gt; &lt;div class=&quot;g-main&quot;&gt;æˆ‘æ˜¯ä¸»åˆ—&lt;/div&gt; &lt;div class=&quot;g-left&quot;&gt;æˆ‘æ˜¯å·¦åˆ—&lt;/div&gt; &lt;div class=&quot;g-right&quot;&gt;æˆ‘æ˜¯å³åˆ—&lt;/div&gt;&lt;/div&gt; ä½†åˆæƒ³å°†ä¸»è¦å†…å®¹åœ¨ä¸­é—´ä½ç½®æ˜¾ç¤ºï¼Œä¾¿æœ‰å¦‚ä¸‹css 123456789101112131415161718192021222324252627.g-container { float: left; width: 100%; &amp; &gt; div { width: 190px; min-height: 30px; }}.g-container .g-main { float: left; width: 100%; background: #cc6630;}.g-left { float: left; margin-left: -100%; background: #f00;}.g-right { float: left; margin-left: -190px; background: #00f;} ä¸‹é¢é€è¡Œåˆ†æä¸€ä¸‹ï¼šç¬¬1è¡Œï¼šgrid-s5m0e5 æ˜¯ä¸€ä¸ªå¸ƒå±€æ¡†çš„åç§°ï¼Œæˆ‘ä»¬ä¸ºå…¶å®šä¹‰äº†å®½åº¦100%ï¼ˆåœ¨IE6ä¸€ä¸å®šä¹‰100%æ—¶ï¼Œæœ‰ç‚¹å°é—®é¢˜ï¼Œäº²ä»¬è‡ªå·±å¯ä»¥ä¸€è¯•ï¼‰ ç¬¬2è¡Œï¼šcol-main ã€ä¸»åˆ—ã€‘ï¼šæµ®åŠ¨å·¦ä¾§ï¼Œå®½åº¦100%ï¼ˆå®½åº¦å…¨è®©å®ƒç»™å äº†ï¼Œå·¦å³ä¸¤ä¾§çš„å±‚è¯¥æ€ä¹ˆåŠï¼Ÿï¼‰ ç¬¬3è¡Œï¼šcol-sub ã€å­åˆ—ã€‘ï¼šæµ®åŠ¨å·¦ä¾§ï¼Œå®½åº¦190ï¼Œå·¦è¾¹ç•Œä¸º-100%ï¼ˆæ­¤å¤„æ˜¯å…³é”®ï¼šæµ®åŠ¨æƒ…å†µä¸‹ï¼Œè´Ÿè¾¹ç•Œå€¼ä¼šå¯¼è‡´DIVä¸Šç§»ï¼Œè€Œä½¿ç”¨-100%å¯ä»¥ç¡®å®å®ƒç§»åŠ¨åˆ°æœ€å·¦ä¾§ã€‚ï¼‰ ç¬¬4è¡Œï¼šcol-extra ã€é™„åŠ åˆ—ã€‘ï¼šå·¦æµ®åŠ¨ï¼Œå®½åº¦190ï¼Œå·¦è¾¹ç•Œä¸º-190pxï¼ˆé“ç†åŒä¸Šï¼Œæ³¨æ„çš„æ˜¯ï¼Œè´Ÿå·¦è¾¹ç•Œä¸€å®šè¦å¤§äºæˆ–ç­‰äºè¯¥DIVçš„å®½åº¦ï¼Œæ‰èƒ½é åˆ°ä¸Šä¸€è¡Œå»ï¼‰ è®©æˆ‘ä»¬çœ‹çœ‹æ•ˆæœ ä½†è¿™æ ·å¸ƒå±€åå‘ç°ä¸»åˆ—ä¸­çš„æ–‡å­—ä¸è§äº†ï¼Œç»è¿‡DOMåˆ†æå‘ç°ï¼ŒåŸæ¥æ˜¯è¢«col-subæŒ¡ä½äº†ï¼Œé‚£ä¹ˆå¦‚ä½•ç»™mainæ­£ç¡®çš„å®šä½å‘¢ã€‚ 1.åœ£æ¯å¸ƒå±€(margin+position) å·¦å³ä¸¤åˆ—é€šè¿‡margin-leftä¸leftå’Œrightå‡†ç¡®å®šä½ï¼Œä¸­é—´åˆ—ç”¨width:100%æ’‘å¼€åœ£æ¯å¸ƒå±€çš„å…³é”®ç‚¹çˆ¶å…ƒç´ éœ€è¦è®¾ç½®paddingmargin-leftå–å€¼ä¸ºç™¾åˆ†æ¯”æ—¶ï¼Œæ˜¯ä»¥å…¶çˆ¶å…ƒç´ çš„å®½åº¦ä¸ºåŸºå‡†çš„ 12345678910111213141516171819202122232425262728293031.g-container { position: relative; padding: 0 190px; &amp; &gt; div { float: left; min-height: 30px; }}.g-main { position: relative; width: 100%; background: #cc6630;}.g-left { position: relative; width: 190px; margin-left: -100%; left: -190px; background: #ffcc00;}.g-right { position: relative; width: 190px; margin-left: -190px; right: -190px; background: pink;} 2. åœ£æ¯å¸ƒå±€(flex) åˆ©ç”¨flexçš„orderå±æ€§è°ƒæ•´ä½ç½® 12345678910111213141516171819202122232425262728.g-container { width: 100%; display: flex; flex-direction: row; flex-wrap: nowrap; &amp; &gt; div { min-height: 30px; }}.g-main { order: 2; flex: auto 1 0; background: #cc6630;}.g-left { order: 1; flex: 200px 0 0; background: #ffcc00;}.g-right { order: 3; flex: 200px 0 0; background: pink;} è¿™ç§å†™æ³•æ›´åŠ ç®€æ´ï¼Œä½†æ˜¯å…¼å®¹æ€§ä¸å¤ªå¥½ 3.åŒé£ç¿¼å¸ƒå±€(margin) åˆ©ç”¨margin-leftå±æ€§å°†å·¦å³ä¸¤åˆ—æ”¾ç½®åˆ°å‡†ç¡®çš„ä½ç½®ï¼Œé€šè¿‡æ§åˆ¶ mainåˆ— çš„marginç©ºå‡ºå·¦å³ä¸¤åˆ— ä¸‹é¢æ˜¯æ·˜å®çš„åšæ³•ï¼š 1ã€DOMç»“æ„çš„æ”¹å˜ï¼šåœ¨.col-mainä¸‹å†æ¬¡æ·»åŠ ä¸€ä¸ª .main-wrap 2ã€åˆ©ç”¨CSSè°ƒæ•´.main-wrapçš„ä½ç½®ã€‚ã€è¿™é‡Œå¾ˆç®€å•ï¼Œå°±æ˜¯æŠŠå·¦å³è¢«æŒ¡ä½çš„éƒ¨åˆ†ï¼Œè®¾ç½®ä¸ºmain-wrapçš„å·¦ å³è¾¹ç•Œå³å¯ã€‘ 123456789&lt;div class=&quot;g-container&quot;&gt; &lt;div class=&quot;g-main&quot;&gt; &lt;div class=&quot;main-wrap&quot;&gt; æˆ‘æ˜¯ä¸»åˆ—ï¼Œå‡ºæ¥å§ï¼ &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;g-left&quot;&gt;æˆ‘æ˜¯å·¦åˆ—&lt;/div&gt; &lt;div class=&quot;g-right&quot;&gt;æˆ‘æ˜¯å³åˆ—&lt;/div&gt;&lt;/div&gt; 12345678910111213141516171819202122232425262728293031.g-container { float: left; width: 100%; &amp; &gt; div { float: left; width: 190px; min-height: 30px; }}.g-container .g-main { width: 100%; background: #cc6630; .main-wrap { margin-left: 200px; /*ä¸g-leftäº§ç”Ÿ10åƒç´ è·ç¦»*/ margin-right: 200px; /*ä¸g-rightäº§ç”Ÿ10åƒç´ è·ç¦»*/ background: #0f0; }}.g-left { margin-left: -100%; background: #f00;}.g-right { margin-left: -190px; background: #00f;} æœ€ç»ˆæ•ˆæœ ä¼˜ç‚¹ å®ç°äº†å†…å®¹ä¸å¸ƒå±€çš„åˆ†ç¦»ï¼Œå³Ericæåˆ°çš„Any-Order Columns. mainéƒ¨åˆ†æ˜¯è‡ªé€‚åº”å®½åº¦çš„ï¼Œå¾ˆå®¹æ˜“åœ¨å®šå®½å¸ƒå±€å’Œæµä½“å¸ƒå±€ä¸­åˆ‡æ¢ã€‚ ä»»ä½•ä¸€æ éƒ½å¯ä»¥æ˜¯æœ€é«˜æ ï¼Œä¸ä¼šå‡ºé—®é¢˜ã€‚ éœ€è¦çš„hackéå¸¸å°‘ï¼ˆå°±ä¸€ä¸ªé’ˆå¯¹ie6çš„æ¸…é™¤æµ®åŠ¨hack:_zoom: 1;ï¼‰ åœ¨æµè§ˆå™¨ä¸Šçš„å…¼å®¹æ€§éå¸¸å¥½ï¼ŒIE5.5ä»¥ä¸Šéƒ½æ”¯æŒã€‚ ä¸è¶³ mainéœ€è¦æ·»åŠ ä¸€ä¸ªé¢å¤–çš„åŒ…è£¹å±‚ã€‚","link":"/2020/10/30/Css/%E5%9C%A3%E6%9D%AF%E5%B8%83%E5%B1%80%E3%80%81%E5%8F%8C%E9%A3%9E%E7%BF%BC%E5%B8%83%E5%B1%80/"},{"title":"cssé¢„å¤„ç†å™¨ï¼šLess","text":"1.æ³¨é‡Š ä»¥ // å¼€å¤´çš„æ³¨é‡Šï¼Œä¸ä¼šè¢«ç¼–è¯‘åˆ°cssæ–‡ä»¶ä¸­ ä»¥ /**/ åŒ…è£¹çš„æ³¨é‡Šä¼šè¢«ç¼–è¯‘åˆ°cssæ–‡ä»¶ä¸­ 2.å˜é‡2.1æ™®é€šå˜é‡lessä¸­ä½¿ç”¨@å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œå†ä»¥@å¼€å¤´è°ƒç”¨ 12345@zero: 0;* { margin: @zero; padding: @zero;} 2.2å˜é‡ä½œä¸ºé€‰æ‹©å™¨ã€å±æ€§åæˆ–è€…urlä½¿ç”¨@{selector/property/url}è°ƒç”¨ 12345678@selector: wrap;@url: &quot;../img/1.jpg&quot;;@w: width;@{selector}{ @{w}: 100px; background: url(&quot;@{url}&quot;);} 2.3å˜é‡çš„å»¶è¿ŸåŠ è½½ lessä¸­çš„åŠ è½½æ˜¯æœ‰å»¶è¿Ÿçš„ å®ƒä¼šåœ¨å½“å‰ä½œç”¨åŸŸæ ·å¼æœªåŠ è½½ä¹‹å‰å…ˆåŠ è½½å˜é‡ï¼Œè€Œä¸”æ˜¯ç”±å†…è€Œå¤–ï¼Œå…ˆå¯»æ‰¾ä½œç”¨åŸŸå†…çš„å˜é‡ï¼Œå¦‚æœæ²¡æœ‰å†å¯»æ‰¾ä½œç”¨åŸŸå¤–çš„å˜é‡ lessæœºåˆ¶æ˜¯å…ˆåŠ è½½å®Œå£°æ˜å˜é‡å†èµ‹å€¼åˆ°æ ·å¼ä¸­å» 12345678910@var: 0;.class {@var: 1; .brass { @var: 2; three: @var; //3 @var: 3; } one: @var; //1} 3.åµŒå¥—è§„åˆ™123456789#list{ list-style: none; a{ float: left; /*&amp;ä»£è¡¨çˆ¶çº§*/ &amp;:hover{color: red;} } span{float: right;}} &amp;çš„ä½¿ç”¨ï¼ˆ&amp;ä»£è¡¨çˆ¶çº§ï¼‰å¦‚æœæƒ³å†™ä¸²è”é€‰æ‹©å™¨ï¼Œè€Œä¸æ˜¯å†™åä»£é€‰æ‹©å™¨ï¼Œå°±å¯ä»¥ç”¨åˆ°&amp;äº†.è¿™ç‚¹å¯¹ä¼ªç±»å°¤å…¶æœ‰ç”¨å¦‚ :hover å’Œ :focus 4.æ··åˆ æ··åˆå°±æ˜¯ä¸€ç§å°†ä¸€ç³»åˆ—å±æ€§ä»ä¸€ä¸ªè§„åˆ™é›†å¼•å…¥ï¼ˆâ€œæ··åˆâ€ï¼‰åˆ°å¦ä¸€ä¸ªè§„åˆ™é›†çš„æ–¹å¼ã€‚ 4.1æ™®é€šæ··åˆä¼šå°†æ··åˆå†…å®¹è¾“å‡ºåˆ°cssæ–‡ä»¶ä¸­ 12345678.font_hn{ color: red; font-family: microsoft yahei, &quot;é»‘ä½“&quot;, Arial, Simsun, &quot;Arial Unicode MS&quot;, Mingliu, Helvetica;}h1{ font-size: 28px; .font_hn;} 4.2ä¸å¸¦è¾“å‡ºçš„æ··åˆ åŠ ()åå°±ä¸ä¼šåœ¨cssä¸­è¾“å‡ºæ··åˆå†…å®¹äº† ï¼Œå³è¾“å‡ºçš„cssæ–‡ä»¶ä¸­æ— font_hn 12345678.font_hn(){ color: red; font-family: microsoft yahei, &quot;é»‘ä½“&quot;, Arial, Simsun, &quot;Arial Unicode MS&quot;, Mingliu, Helvetica;}h1{ font-size: 28px; .font_hn;} 4.3å¸¦å‚æ•°çš„æ··åˆç±»ä¼¼å‡½æ•°çš„è°ƒç”¨æ–¹å¼ï¼Œå‚æ•°åå¼€å¤´ä¸º@ 1234567891011121314151617181920212223.border(@color){ border: 1px solid @color;}h1{ &amp;:hover{ .border(green); }}h2{ &amp;:hover{ .border(#000); }}å…¶cssæ–‡ä»¶ä¸ºï¼šh1:hover { border: 1px solid #008000; border: 21px #008000 #ff0000;}h2:hover { border: 1px solid #000000; border: 21px #000000 #ff0000;} 4.4å¸¦å‚æ•°ä¸”æœ‰é»˜è®¤å€¼çš„æ··åˆä½¿ç”¨ : ä¸ºå‚æ•°æ·»åŠ é»˜è®¤å€¼ï¼Œ æœ‰äº†é»˜è®¤å€¼ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨è®¾ç½®å±æ€§å€¼ä¹Ÿèƒ½è¢«è°ƒç”¨ 1234567891011121314151617181920212223.border_you(@color:red){ border: 1px solid @color; }h1{ &amp;:hover{ .border_you(); }}h2{ &amp;:hover{ .border_you(yellow); }}å…¶ç¼–è¯‘åçš„cssæ–‡ä»¶å¦‚ä¸‹ï¼š/*å¸¦å‚æ•°å¹¶ä¸”æœ‰é»˜è®¤å€¼çš„æ··åˆ*/h1:hover { border: 1px solid #ff0000;}h2:hover { border: 1px solid #ffff00;} 4.5å‘½åå‚æ•°ï¼ˆä¼ å®å‚æ—¶å¯ä»¥æŒ‡å®šå€¼ç»™çš„æ˜¯å“ªä¸ªå‚æ•°ï¼‰ å¼•ç”¨mixinæ—¶å¯ä»¥é€šè¿‡å‚æ•°åç§°è€Œä¸æ˜¯å‚æ•°çš„ä½ç½®æ¥ä¸ºmixinæä¾›å‚æ•°å€¼ã€‚ä»»ä½•å‚æ•°éƒ½ä»¥ç”¨è¿‡å®ƒçš„åç§°æ¥ä½¿ç”¨ï¼Œè¿™æ ·å°±ä¸å¿…æŒ‰ç…§ä»»æ„ç‰¹å®šçš„é¡ºåºæ¥ä½¿ç”¨å‚æ•° 123456789101112131415161718192021222324.mixin(@color: black; @margin: 10px; @padding: 20px) { color: @color; margin: @margin; padding: @padding;}.class1 { .mixin(@margin: 20px; @color: #33acfe);}.class2 { .mixin(#efca44; @padding: 40px);}å…¶ç¼–è¯‘åçš„cssæ–‡ä»¶å¦‚ä¸‹:.class1 { color: #33acfe; margin: 20px; padding: 20px;}.class2 { color: #efca44; margin: 10px; padding: 40px;} 4.6åŒ¹é…æ¨¡å¼ æ ¹æ®ä¼ å…¥çš„å‚æ•°æ¥æ”¹å˜æ··åˆçš„é»˜è®¤å‘ˆç° 123456789101112131415161718192021222324252627282930.border(all,@w: 5px){ border-radius: @w;}.border(t_l,@w:5px){ border-top-left-radius: @w;}.border(t_r,@w:5px){ border-top-right-radius: @w;}.border(b-l,@w:5px){ border-bottom-left-radius: @w;}.border(b-r,@w:5px){ border-bottom-right-radius: @w;}footer{ .border(t_l,10px); .border(b-r,10px); background: #33acfe;}å…¶ç¼–è¯‘åçš„cssæ–‡ä»¶å¦‚ä¸‹ï¼šfooter { border: 21px t_l 10px; border-top-left-radius: 10px; border: 21px b-r 10px; border-bottom-right-radius: 10px; background: #33acfe;} 4.7@argumentså˜é‡ @argumentsä»£è¡¨æ‰€æœ‰çš„å¯å˜å‚æ•° æ³¨æ„äº‹é¡¹ï¼š @argumentsä»£è¡¨æ‰€æœ‰å¯å˜å‚æ•°ï¼Œå‚æ•°çš„å…ˆåé¡ºåºå°±æ˜¯ä½ çš„ï¼ˆï¼‰æ‹¬å·å†…çš„å‚æ•°çš„å…ˆåé¡ºåº åœ¨ä½¿ç”¨çš„èµ‹å€¼ï¼Œå€¼çš„ä½ç½®å’Œä¸ªæ•°ä¹Ÿæ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œåªæœ‰ä¸€ä¸ªå€¼ï¼ŒæŠŠå€¼èµ‹å€¼ç»™ç¬¬ä¸€ä¸ªï¼Œä¸¤ä¸ªå€¼ï¼Œèµ‹å€¼ç»™ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªï¼Œä¸‰ä¸ªå€¼èµ‹å€¼ç»™ç¬¬ä¸‰ä¸ªâ€¦â€¦ä»¥æ­¤ç±»æ¨ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯å‡å¦‚æˆ‘æƒ³ç»™ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªèµ‹å€¼ï¼Œä½ ä¸èƒ½å†™ï¼ˆå€¼1ï¼Œï¼Œå€¼3ï¼‰ï¼Œå¿…é¡»æŠŠåŸæ¥çš„é»˜è®¤å€¼å†™ä¸Šå»ï¼ 1234567891011.border(@x:solid,@c:red){ border: 21px @arguments;}.div1{ .border(solid);}å…¶ç¼–è¯‘åçš„cssæ–‡ä»¶ä¸ºï¼š.div1 { border: 21px solid #ff0000;} 4.8æ··åˆçš„è¿”å›å€¼12345678910111213141516.average(@x, @y) { @average: ((@x + @y) / 2); @he: (@x + @y);}div { .average(16px, 50px); padding: @average; margin: @he;}å…¶ç¼–è¯‘åçš„cssæ–‡ä»¶å¦‚ä¸‹ï¼šdiv { padding: 33px; margin: 66px;} 5.è¿ç®—5.1æ•°å€¼è¿ç®— åªéœ€è¦åœ¨å…¶ä¸­çš„ä¸€ä¸ªæ•°å€¼ä¸ŠåŠ ä¸Šå•ä½ï¼Œå…¶ä»–å•ä½ç”±lessè‡ªåŠ¨åŠ ä¸Š 1234.wp{ width: 450px + 450; height: 400 + 400px;} 5.2é¢œè‰²è¿ç®— Lessåœ¨è¿ç®—æ—¶ï¼Œå…ˆå°†é¢œè‰²å€¼è½¬æ¢ä¸ºrgbæ¨¡å¼ï¼Œç„¶åå†è½¬æ¢ä¸º16è¿›åˆ¶çš„é¢œè‰²å€¼å¹¶ä¸”è¿”å› 1234.content{ Background:#000000 + 21; }Cssæ–‡ä»¶ç¼–è¯‘ç»“æœ.content{ background:#212121; } 6.å‡½æ•°6.1RGBå‡½æ•°1234.bgcolor{ background:rgb(0,133,0); }Cssç»“æœï¼š.bgcolor{ background:#008500; } 6.2Convertå‡½æ•°1234body{ width:convert(20cm,px); } Cssæ–‡ä»¶å¦‚ä¸‹:body{ width:755.90551181px; } 7.å‘½åç©ºé—´å¤šäººåä½œæ—¶ï¼Œé¿å…é€‰æ‹©å™¨é‡åé—®é¢˜ï¼Œå¼•å…¥å‘½åç©ºé—´çš„æ¦‚å¿µï¼Œä»¥#å¼€å¤´ä»£è¡¨å‘½åç©ºé—´ï¼Œ#namespace&gt;.selectorå³å¯è°ƒç”¨ 1234567891011121314151617181920212223242526272829303132#mynamespace() { background: #ffffff; .a{ &amp;:hover{ color: #ff6600; } .b{ background: #ff0000; } }}.bgcolor{ #mynamespace&gt;.a;}.bgcolor2{ #mynamespace&gt;.a&gt;.b;}ç¼–è¯‘åcssæ–‡ä»¶.bgcolor { color: #888888;}.bgcolor:hover { color: #ff6600;}.bgcolor .b { background: #ff0000;}.bgcolor2 { background: #ff0000;} 8.é¿å…ç¼–è¯‘å°†è¦é¿å…ç¼–è¯‘çš„å€¼ç”¨ â€œâ€ åŒ…è£¹èµ·æ¥ï¼Œå¹¶åœ¨å‰é¢åŠ ~ 1234567.class { filter: ~&quot;ms:alwaysHasItsOwnSyntax.For.Stuff()&quot;;}Cssæ–‡ä»¶å¦‚ä¸‹:.class { filter: ms:alwaysHasItsOwnSyntax.For.Stuff();} 9.ç»§æ‰¿(extent)æ€§èƒ½æ¯”æ··åˆé«˜ç»§æ‰¿ä¸æ”¯æŒå¸¦å‚æ•°ï¼Œçµæ´»åº¦æ¯”æ··åˆä½ ä»–å°†æ‰€æ”¾ç½®å®ƒçš„é€‰æ‹©å™¨ä¸åŒ¹é…å¼•ç”¨çš„é€‰æ‹©å™¨è¿›è¡Œåˆå¹¶ã€‚ 12345678910111213141516171819a { // a æ‰€æ”¾ç½®å®ƒçš„é€‰æ‹©å™¨ background-color: #fff; &amp;:extend(.b); // .båŒ¹é…å¼•ç”¨çš„é€‰æ‹©å™¨ border-bottom: 2px;}.b { font-weight: 700; color: yellow;}ç¼–è¯‘åcssæ–‡ä»¶a { background-color: #fff; border-bottom: 2px;}.b, a { font-weight: 700; color: yellow;} è¿˜å¯ä»¥åœ¨é€‰æ‹©å™¨ååŠ  :extend(.selector, .selector å¯é€‰å€¼all)è¡¨ç¤ºç»§æ‰¿ï¼Œåœ¨æ‹¬å·å†…ç”¨é€—å·åˆ†éš”å¤šä¸ªç»§æ‰¿å…ƒç´ ï¼Œè‹¥æœ‰allå¯é€‰å€¼ï¼Œhoverç­‰ä¼ªç±»ä¹Ÿä¼šç»§æ‰¿ 10.æ¡ä»¶è¡¨è¾¾å¼123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869å½“æˆ‘ä»¬æƒ³æ ¹æ®è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…ï¼Œè€Œéæ ¹æ®å€¼å’Œå‚æ•°åŒ¹é…æ—¶ï¼Œå¯¼å¼•å°±æ˜¾å¾—éå¸¸æœ‰ç”¨ã€‚å¦‚æœä½ å¯¹å‡½æ•°å¼ç¼–ç¨‹éå¸¸ç†Ÿæ‚‰ï¼Œé‚£ä¹ˆä½ å¾ˆå¯èƒ½å·²ç»ä½¿ç”¨è¿‡å¯¼å¼•ã€‚ä¸ºäº†å°½å¯èƒ½åœ°ä¿ç•™CSSçš„å¯å£°æ˜æ€§ï¼ŒLESSé€šè¿‡å¯¼å¼•æ··åˆè€Œéif/elseè¯­å¥æ¥å®ç°æ¡ä»¶åˆ¤æ–­ï¼Œå› ä¸ºå‰è€…å·²åœ¨@media queryç‰¹æ€§ä¸­è¢«å®šä¹‰ã€‚ä»¥æ­¤ä¾‹åšä¸ºå¼€å§‹ï¼š.mixin (@a) when (lightness(@a) &gt;= 50%) { background-color: black;}.mixin (@a) when (lightness(@a) &lt; 50%) { background-color: white;}.mixin (@a) { color: @a;}whenå…³é”®å­—ç”¨ä»¥å®šä¹‰ä¸€ä¸ªå¯¼å¼•åºåˆ—(æ­¤ä¾‹åªæœ‰ä¸€ä¸ªå¯¼å¼•)ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¿è¡Œä¸‹åˆ—ä»£ç ï¼š.class1 { .mixin(#ddd) }.class2 { .mixin(#555) }å°±ä¼šå¾—åˆ°ï¼š.class1 { background-color: black; color: #ddd;}.class2 { background-color: white; color: #555;}å¯¼å¼•ä¸­å¯ç”¨çš„å…¨éƒ¨æ¯”è¾ƒè¿ç®—æœ‰ï¼š &gt; &gt;= = =&lt; &lt;ã€‚æ­¤å¤–ï¼Œå…³é”®å­—trueåªè¡¨ç¤ºå¸ƒå°”çœŸå€¼ï¼Œä¸‹é¢ä¸¤ä¸ªæ··åˆæ˜¯ç›¸åŒçš„ï¼š.truth (@a) when (@a) { ... }.truth (@a) when (@a = true) { ... }é™¤å»å…³é”®å­—trueä»¥å¤–çš„å€¼éƒ½è¢«è§†ç¤ºå¸ƒå°”å‡ï¼š.class { .truth(40); // Will not match any of the above definitions.}å¯¼å¼•åºåˆ—ä½¿ç”¨é€—å·â€˜,â€™â€”åˆ†å‰²ï¼Œå½“ä¸”ä»…å½“æ‰€æœ‰æ¡ä»¶éƒ½ç¬¦åˆæ—¶ï¼Œæ‰ä¼šè¢«è§†ä¸ºåŒ¹é…æˆåŠŸã€‚.mixin (@a) when (@a &gt; 10), (@a &lt; -10) { ... }å¯¼å¼•å¯ä»¥æ— å‚æ•°ï¼Œä¹Ÿå¯ä»¥å¯¹å‚æ•°è¿›è¡Œæ¯”è¾ƒè¿ç®—ï¼š@media: mobile;.mixin (@a) when (@media = mobile) { ... }.mixin (@a) when (@media = desktop) { ... }.max (@a, @b) when (@a &gt; @b) { width: @a }.max (@a, @b) when (@a &lt; @b) { width: @b }æœ€åï¼Œå¦‚æœæƒ³åŸºäºå€¼çš„ç±»å‹è¿›è¡ŒåŒ¹é…ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨is*å‡½å¼ï¼š.mixin (@a, @b: 0) when (isnumber(@b)) { ... }.mixin (@a, @b: black) when (iscolor(@b)) { ... }ä¸‹é¢å°±æ˜¯å¸¸è§çš„æ£€æµ‹å‡½å¼ï¼š iscolor isnumber isstring iskeyword isurlå¦‚æœä½ æƒ³åˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯çº¯æ•°å­—ï¼Œè¿˜æ˜¯æŸä¸ªå•ä½é‡ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ—å‡½å¼ï¼š ispixel ispercentage isemæœ€åå†è¡¥å……ä¸€ç‚¹ï¼Œåœ¨å¯¼å¼•åºåˆ—ä¸­å¯ä»¥ä½¿ç”¨andå…³é”®å­—å®ç°ä¸æ¡ä»¶ï¼š.mixin (@a) when (isnumber(@a)) and (@a &gt; 0) { ... }ä½¿ç”¨notå…³é”®å­—å®ç°æˆ–æ¡ä»¶.mixin (@b) when not (@b &gt; 0) { ... }","link":"/2020/10/30/Css/css%E9%A2%84%E5%A4%84%E7%90%86%E5%99%A8%EF%BC%9ALess/"},{"title":"é‡ç»˜ä¸å›æµ","text":"å›æµ æŒ‡æ”¹å˜å‡ ä½•å±æ€§çš„æ¸²æŸ“ é‡ç»˜ æŒ‡æ”¹å˜å¤–è§‚å±æ€§è€Œä¸å½±å“å‡ ä½•å±æ€§çš„æ¸²æŸ“ å±æ€§åˆ†ç±» å‡ ä½•å±æ€§ï¼šåŒ…æ‹¬å¸ƒå±€ã€å°ºå¯¸ç­‰å¯ç”¨æ•°å­¦å‡ ä½•è¡¡é‡çš„å±æ€§ å¸ƒå±€ï¼šdisplayã€floatã€positionã€listã€tableã€flexã€columnsã€gridç­‰ å°ºå¯¸ï¼šmarginã€paddingã€borderã€widthã€heightç­‰ å¤–è§‚å±æ€§ï¼šåŒ…æ‹¬ç•Œé¢ã€æ–‡å­—ç­‰å¯ç”¨çŠ¶æ€å‘é‡æè¿°çš„å±æ€§ ç•Œé¢ï¼šappearanceã€outlineã€backgroundã€maskã€box-shadowã€box-reflectã€filterã€opacityã€clipç­‰ æ–‡å­—ï¼štextã€fontã€wordç­‰ PSï¼šæ¨èä¸€ä¸ªå±æ€§æ¸²æŸ“çŠ¶æ€å¯è§†åŒ–çš„ç½‘ç«™CssTriggersï¼Œå¯æŸ¥çœ‹æ¯ä¸ªå±æ€§åœ¨æ¸²æŸ“æ—¶äº§ç”Ÿçš„å½±å“ã€‚ æµè§ˆå™¨çš„æ¸²æŸ“è¿‡ç¨‹![Snipaste_2020-10-03_17-43-05](D:\\OneDrive - mail2.gdut.edu.cn\\typora_img\\é‡ç»˜ä¸å›æµ\\Snipaste_2020-10-03_17-43-05.png) åœ¨é¡µé¢åŠ è½½æ—¶ï¼Œæµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹å¦‚ä¸‹ï¼š è§£æHTMLï¼Œç”ŸæˆDOMæ ‘ï¼Œè§£æCSSï¼Œç”ŸæˆCSSOMæ ‘ å°†DOMæ ‘å’ŒCSSOMæ ‘ç»“åˆï¼Œç”Ÿæˆæ¸²æŸ“æ ‘(Render Tree) Layout(å›æµ):æ ¹æ®ç”Ÿæˆçš„æ¸²æŸ“æ ‘ï¼Œè¿›è¡Œå›æµ(Layout)ï¼Œå¾—åˆ°èŠ‚ç‚¹çš„å‡ ä½•ä¿¡æ¯ï¼ˆä½ç½®ï¼Œå¤§å°ï¼‰ Painting(é‡ç»˜):æ ¹æ®æ¸²æŸ“æ ‘ä»¥åŠå›æµå¾—åˆ°çš„å‡ ä½•ä¿¡æ¯ï¼Œå¾—åˆ°èŠ‚ç‚¹çš„ç»å¯¹åƒç´  Display:å°†åƒç´ å‘é€ç»™GPUï¼Œå±•ç¤ºåœ¨é¡µé¢ä¸Šã€‚ï¼ˆè¿™ä¸€æ­¥å…¶å®è¿˜æœ‰å¾ˆå¤šå†…å®¹ï¼Œæ¯”å¦‚ä¼šåœ¨GPUå°†å¤šä¸ªåˆæˆå±‚åˆå¹¶ä¸ºåŒä¸€ä¸ªå±‚ï¼Œå¹¶å±•ç¤ºåœ¨é¡µé¢ä¸­ã€‚è€Œcss3ç¡¬ä»¶åŠ é€Ÿçš„åŸç†åˆ™æ˜¯æ–°å»ºåˆæˆå±‚ï¼‰ ä¸ºäº†æ„å»ºæ¸²æŸ“æ ‘ï¼Œæµè§ˆå™¨ä¸»è¦å®Œæˆäº†ä»¥ä¸‹å·¥ä½œï¼š ä»DOMæ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹éå†æ¯ä¸ªå¯è§èŠ‚ç‚¹ã€‚ å¯¹äºæ¯ä¸ªå¯è§çš„èŠ‚ç‚¹ï¼Œæ‰¾åˆ°CSSOMæ ‘ä¸­å¯¹åº”çš„è§„åˆ™ï¼Œå¹¶åº”ç”¨å®ƒä»¬ã€‚ æ ¹æ®æ¯ä¸ªå¯è§èŠ‚ç‚¹ä»¥åŠå…¶å¯¹åº”çš„æ ·å¼ï¼Œç»„åˆç”Ÿæˆæ¸²æŸ“æ ‘ã€‚ æ¸²æŸ“æ ‘ä¸­åªä¼šåŒ…å«å¯è§èŠ‚ç‚¹ã€‚ä¸å¯è§èŠ‚ç‚¹åŒ…æ‹¬ï¼š ä¸€äº›ä¸ä¼šæ¸²æŸ“è¾“å‡ºçš„èŠ‚ç‚¹ï¼Œæ¯”å¦‚scriptã€metaã€linkç­‰ã€‚ ä¸€äº›é€šè¿‡cssè¿›è¡Œéšè—çš„èŠ‚ç‚¹ã€‚å¦‚display:noneã€‚ æ³¨æ„ï¼Œåˆ©ç”¨visibilityå’Œopacityéšè—çš„èŠ‚ç‚¹ï¼Œè¿˜æ˜¯ä¼šæ˜¾ç¤ºåœ¨æ¸²æŸ“æ ‘ä¸Šçš„ã€‚ ç”±äºæµè§ˆå™¨ä½¿ç”¨æµå¼å¸ƒå±€ï¼Œå¯¹Render Treeçš„è®¡ç®—é€šå¸¸åªéœ€è¦éå†ä¸€æ¬¡å°±å¯ä»¥å®Œæˆï¼Œä½†tableåŠå…¶å†…éƒ¨å…ƒç´ é™¤å¤–ï¼Œä»–ä»¬å¯èƒ½éœ€è¦å¤šæ¬¡è®¡ç®— å¯è§ï¼Œå¦‚æœè§¦å‘å›æµé‚£ä¹ˆå¿…ç„¶ä¼šè§¦å‘é‡ç»˜ æµè§ˆå™¨å¦‚ä½•å¤„ç†æ¯å¥JSæ“ä½œéƒ½å»å›æµé‡ç»˜çš„è¯ï¼Œæµè§ˆå™¨å¯èƒ½å°±ä¼šå—ä¸äº†ã€‚ æµè§ˆå™¨ä¼šç»´æŠ¤1ä¸ªé˜Ÿåˆ—ï¼ŒæŠŠæ‰€æœ‰ä¼šå¼•èµ·å›æµã€é‡ç»˜çš„æ“ä½œæ”¾å…¥è¿™ä¸ªé˜Ÿåˆ—ï¼Œç­‰é˜Ÿåˆ—ä¸­çš„æ“ä½œåˆ°äº†ä¸€å®šçš„æ•°é‡æˆ–è€…åˆ°äº†ä¸€å®šçš„æ—¶é—´é—´éš”ï¼Œæµè§ˆå™¨å°±ä¼šflushé˜Ÿåˆ—ï¼Œè¿›è¡Œä¸€ä¸ªæ‰¹å¤„ç†ã€‚è¿™æ ·å°±ä¼šè®©å¤šæ¬¡çš„å›æµã€é‡ç»˜å˜æˆä¸€æ¬¡å›æµé‡ç»˜ã€‚ è™½ç„¶æœ‰äº†æµè§ˆå™¨çš„ä¼˜åŒ–ï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬å†™çš„ä¸€äº›ä»£ç å¯èƒ½ä¼šå¼ºåˆ¶æµè§ˆå™¨æå‰flushé˜Ÿåˆ—ï¼Œè¿™æ ·æµè§ˆå™¨çš„ä¼˜åŒ–å¯èƒ½å°±èµ·ä¸åˆ°ä½œç”¨äº†ã€‚å½“ä½ è¯·æ±‚å‘æµè§ˆå™¨è¯·æ±‚ä¸€äº› styleä¿¡æ¯çš„æ—¶å€™ï¼Œå°±ä¼šè®©æµè§ˆå™¨flushé˜Ÿåˆ—ï¼š offsetTop, offsetLeft, offsetWidth, offsetHeight scrollTop/Left/Width/Height clientTop/Left/Width/Height width,height è¯·æ±‚äº†getComputedStyle(), æˆ–è€… IEçš„ currentStyle å½“ä½ è¯·æ±‚ä¸Šé¢çš„ä¸€äº›å±æ€§çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¸ºäº†ç»™ä½ æœ€ç²¾ç¡®çš„å€¼ï¼Œéœ€è¦flushé˜Ÿåˆ—ï¼Œå› ä¸ºé˜Ÿåˆ—ä¸­å¯èƒ½ä¼šæœ‰å½±å“åˆ°è¿™äº›å€¼çš„æ“ä½œã€‚å³ä½¿ä½ è·å–å…ƒç´ çš„å¸ƒå±€å’Œæ ·å¼ä¿¡æ¯è·Ÿæœ€è¿‘å‘ç”Ÿæˆ–æ”¹å˜çš„å¸ƒå±€ä¿¡æ¯æ— å…³ï¼Œæµè§ˆå™¨éƒ½ä¼šå¼ºè¡Œåˆ·æ–°æ¸²æŸ“é˜Ÿåˆ—ã€‚å¼•æ“ä¼šé‡æ–°æ¸²æŸ“æ¥ç¡®ä¿è·å–çš„å€¼ æ˜¯å®æ—¶çš„ åˆ©ç”¨åˆæˆå±‚æ€§èƒ½ä¼˜åŒ–ï¼šComposite å¯ä»¥åˆ©ç”¨chromeå¼€å‘è€…å·¥å…·çš„LayersæŸ¥çœ‹åˆæˆå±‚ æå‡ä¸ºåˆæˆå±‚ç®€å•è¯´æ¥æœ‰ä»¥ä¸‹å‡ ç‚¹å¥½å¤„ï¼š åˆæˆå±‚çš„ä½å›¾ï¼Œä¼šäº¤ç”± GPU åˆæˆï¼Œæ¯” CPU å¤„ç†è¦å¿« å½“éœ€è¦ repaint æ—¶ï¼Œåªéœ€è¦ repaint æœ¬èº«ï¼Œä¸ä¼šå½±å“åˆ°å…¶ä»–çš„å±‚ å¯¹äº transform å’Œ opacity æ•ˆæœï¼Œä¸ä¼šè§¦å‘ layout å’Œ paint æå‡åˆæˆå±‚çš„æœ€å¥½æ–¹å¼æ˜¯ä½¿ç”¨ CSS çš„ will-change å±æ€§ã€‚è€Œ will-change è®¾ç½®ä¸º opacityã€transformã€topã€leftã€bottomã€right å¯ä»¥å°†å…ƒç´ æå‡ä¸ºåˆæˆå±‚ã€‚ 12345678#target { will-change: transform; //å…¼å®¹æ€§ä¸å¥½}//å¯¹äºé‚£äº›ç›®å‰è¿˜ä¸æ”¯æŒ will-change å±æ€§çš„æµè§ˆå™¨//ç›®å‰å¸¸ç”¨çš„æ˜¯ä½¿ç”¨ä¸€ä¸ª 3D transform å±æ€§æ¥å¼ºåˆ¶æå‡ä¸ºåˆæˆå±‚#target { transform: translateZ(0);} å±‚åˆæˆçš„è¿‡ç¨‹ä¼šäº§ç”Ÿå†…å­˜æ¶ˆè€—ï¼Œæ‰€ä»¥ä¸è¦ç›²ç›®å¼€å¯å±‚åˆæˆ å‚è€ƒhttps://juejin.im/post/6844904161868251149https://juejin.im/post/6844903859719143437#heading-1","link":"/2020/10/04/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E9%87%8D%E7%BB%98%E4%B8%8E%E5%9B%9E%E6%B5%81/"},{"title":"é˜²æŠ–å’ŒèŠ‚æµ","text":"ä¸Šå›¾æ˜¯å¯¹é¼ æ ‡è¿›è¡Œç›‘å¬ï¼Œäº‹ä»¶æ‰§è¡Œçš„å¾ˆé¢‘ç¹ï¼Œå¦‚æœæ‰§è¡Œçš„äº‹ä»¶æ˜¯å¯¹æ¥å£çš„è¯·æ±‚ï¼Œé‚£ä¹ˆä¼šåœ¨çŸ­æ—¶é—´å†…å‘èµ·å¤§é‡é‡å¤è¯·æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é˜²æŠ–æˆ–è€…èŠ‚æµè¿›è¡Œè§£å†³ã€‚ é˜²æŠ– é˜²æŠ–å³ä¸ºäº‹ä»¶è§¦å‘nç§’åæ‰æ‰§è¡Œäº‹ä»¶ï¼Œå¦‚æœåœ¨nç§’å†…åˆè§¦å‘äº‹ä»¶åˆ™é‡æ–°è®¡æ—¶ 1. æ‰‹å†™ç‰ˆ123456789function debounce(func, wait) { let timer = null; return () =&gt; { clearTimeout(timer); timer = setTimeout(()=&gt; { func.apply(this, arguments) }, wait); }} ç§»åŠ¨å®Œnç§’åæ‰æ‰§è¡Œäº‹ä»¶ 2. å¯ç«‹å³æ‰§è¡Œç‰ˆè§¦å‘äº‹ä»¶ç«‹å³æ‰§è¡Œï¼Œåœæ­¢nç§’åæ‰å¯ä»¥é‡æ–°è§¦å‘ 1234567891011121314151617181920function debounce(func, wait, immediate = true) { let timer; return () =&gt; { if (timer) clearTimeout(timer); if (immediate) { // å¦‚æœå·²ç»æ‰§è¡Œè¿‡ï¼Œä¸å†æ‰§è¡Œ var callNow = !timer; timer = setTimeout(() =&gt; { timer = null; }, wait) if (callNow) func.apply(this, arguments); } else { timer = setTimeout(() =&gt; { func.apply(this, arguments); }, wait); } }} èŠ‚æµ èŠ‚æµå³ä¸ºè¿ç»­è§¦å‘äº‹ä»¶ä½†æ˜¯åœ¨nç§’ä¸­åªæ‰§è¡Œä¸€æ¬¡å‡½æ•° 1. æ—¶é—´æˆ³ç‰ˆ1234567891011function throttle(func, wait) { var previous = 0; return () =&gt; { var now = new Date(); if (now - previous &gt; wait) { func.apply(this, arguments); previous = now; } }} å½“é¼ æ ‡ç§»å…¥çš„æ—¶å€™ï¼Œäº‹ä»¶ç«‹åˆ»æ‰§è¡Œï¼Œæ¯è¿‡1sä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœåœ¨2.2såœæ­¢è§¦å‘ï¼Œä¹‹åä¸ä¼šå†æ‰§è¡Œäº‹ä»¶ã€‚ 2. å®šæ—¶å™¨ç‰ˆ12345678910111213function throttle(func, wait) { var timeout; var previous = 0; return () =&gt; { if (!timeout) { timeout = setTimeout(() =&gt; { timeout = null; func.apply(this, arguments) }, wait) } }} å¯ä»¥çœ‹åˆ°ä½¿ç”¨å®šæ—¶å™¨ç‰ˆæœ¬çš„èŠ‚æµå‡½æ•°ï¼Œé¼ æ ‡ç§»å…¥å¹¶ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œæ­¤åæ¯ç§»åŠ¨1ç§’æ‰§è¡Œä¸€æ¬¡å‡½æ•°ï¼Œåœ¨3.2ç§’å·¦å³ç§»å‡ºé¼ æ ‡ï¼Œä½†æ˜¯ä»ä¼šåœ¨4ç§’æ—¶æ‰§è¡Œå‡½æ•° å‚è€ƒhttps://github.com/mqyqingfeng/Blog/issues/22https://github.com/mqyqingfeng/Blog/issues/26","link":"/2020/09/29/Js/%E9%98%B2%E6%8A%96%E5%92%8C%E8%8A%82%E6%B5%81/"},{"title":"Typescriptè¯­æ³•ç¯‡","text":"1.typescriptçš„åŸå§‹ç±»å‹ boolean number string voidï¼ˆåªæœ‰nullå’Œundefinedå¯ä»¥èµ‹ç»™voidï¼‰ undefined å’Œ nullï¼ˆæ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹ï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹åªèƒ½èµ‹å€¼ç»™å¯¹åº”çš„ç±»å‹æˆ–è€…anyï¼‰ symbol bigint 2.Typescript ä¸­å…¶ä»–å¸¸è§ç±»å‹ anyï¼ˆä¸ºä»»æ„ç±»å‹ï¼‰ å˜é‡å¦‚æœåœ¨å£°æ˜çš„æ—¶å€™ï¼ŒæœªæŒ‡å®šå…¶ç±»å‹æˆ–è€…åˆå§‹åŒ–ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«è¯†åˆ«ä¸ºanyç±»å‹ unknown è¾ƒanyç±»å‹æ›´å®‰å…¨s è¯¥ç±»å‹å˜é‡è¢«ç¡®å®šä¸ºæŸä¸€ç±»å‹å‰ï¼Œä¸èƒ½è¿›è¡Œä»»ä½•æ“ä½œ 123456let value: unknown; value.foo.bar; // ERRORvalue(); // ERRORnew value(); // ERRORvalue[0][1]; // ERROR never æ°¸ä¸å­˜åœ¨å€¼çš„ç±»å‹ æ˜¯ä»»ä½•ç±»å‹çš„å­ç±»å‹ï¼Œå¯ä»¥èµ‹å€¼ç»™ä»»ä½•ç±»å‹ æ²¡æœ‰ç±»å‹æ˜¯ never çš„å­ç±»å‹ï¼Œä»»æ„ç±»å‹éƒ½ä¸èƒ½èµ‹å€¼ç»™neverç±»å‹ï¼ˆåŒ…æ‹¬anyï¼‰ å¸¸ç”¨åœ¨ æŠ›å‡ºå¼‚å¸¸çš„å‡½æ•° å’Œ ç©ºæ•°ç»„ä¸”æ°¸è¿œä¸ºç©ºæ•°ç»„ æ•°ç»„ç±»å‹(array) 1234// æœ‰ä¸¤ç§å®šä¹‰æ–¹å¼const list: Array&lt;number&gt; = [1, 2, 3] // æ³›å‹const list: number[] = [1, 2, 3] å…ƒç»„(tuple) å·²çŸ¥å…ƒç´ æ•°é‡åŠç±»å‹çš„æ•°ç»„1let x: [string, number]; // ä¸¤ä¸ªå…ƒç´ ï¼Œç±»å‹é¡ºåºä¹Ÿä¸èƒ½å˜ tså…è®¸å…ƒç»„ä½¿ç”¨æ•°ç»„çš„pushæ–¹æ³•ï¼Œä½†æˆ‘ä»¬è®¿é—®æ–°åŠ å…¥çš„å…ƒç´ æ—¶ä¼šæŠ¥é”™ 1234const tuple: [string, number] = ['a', 1];tuple.push(2); // okconsole.log(tuple); // [&quot;a&quot;, 1, 2] -&gt; æ­£å¸¸æ‰“å°å‡ºæ¥console.log(tuple[2]); // Tuple type '[string, number]' of length '2' has no element at index '2' object 3.æšä¸¾ç±»å‹123456enum Direction { Up, // 0 Down = 2, // 2 Left, // 3 Right, // 4} ä¸å¸¦åˆå§‹åŒ–çš„æšä¸¾ è¦ä¹ˆæ”¾åœ¨ç¬¬ä¸€ä¸ªä½ç½®ï¼Œ è¦ä¹ˆåœ¨è¢«æ•°å­—å¸¸é‡æˆ–å…¶å®ƒå¸¸é‡åˆå§‹åŒ–çš„æšä¸¾åé¢ï¼Œå¦åˆ™ä¼šæŠ¥é”™ 3.1 æšä¸¾çš„æœ¬è´¨æšä¸¾ç±»å‹è¢«ç¼–è¯‘ä¸º JavaScriptçš„å½¢å¼å¦‚ä¸‹æ‰€ç¤ºï¼Œæ˜¯å…·æœ‰åŒå‘æ˜ å°„çš„ç‰¹æ€§ï¼ˆå­—ç¬¦ä¸²ç±»å‹é™¤å¤–ï¼‰ 1234567var Direction;(function (Direction) { Direction[Direction[&quot;Up&quot;] = 0] = &quot;Up&quot;; Direction[Direction[&quot;Down&quot;] = 2] = &quot;Down&quot;; Direction[Direction[&quot;Left&quot;] = 3] = &quot;Left&quot;; Direction[Direction[&quot;Right&quot;] = 4] = &quot;Right&quot;;})(Direction || (Direction = {})); 3.2 constå£°æ˜çš„æšä¸¾1const a = Direction.Up; ä¼šè¢«ç¼–è¯‘ä¸º 1var a = 0; 3.2 è”åˆæšä¸¾ä¸æšä¸¾æˆå‘˜çš„ç±»å‹å¦‚æœæšä¸¾æˆå‘˜å‡æœ‰å­—é¢é‡ç±»å‹ç»„æˆï¼Œé‚£ä¹ˆæšä¸¾çš„æ¯ä¸ªæˆå‘˜å’Œæšä¸¾å€¼æœ¬èº«éƒ½å¯ä»¥ä½œä¸ºç±»å‹æ¥ä½¿ç”¨ ä»»ä½•å­—ç¬¦ä¸²å­—é¢é‡ï¼ˆä¾‹å¦‚ï¼š &quot;foo&quot;ï¼Œ &quot;bar&quot;ï¼Œ &quot;baz&quot;ï¼‰ ä»»ä½•æ•°å­—å­—é¢é‡ï¼ˆä¾‹å¦‚ï¼š 1, 100ï¼‰ åº”ç”¨äº†ä¸€å…ƒ -ç¬¦å·çš„æ•°å­—å­—é¢é‡ï¼ˆä¾‹å¦‚ï¼š -1, -100ï¼‰ 123456789declare let a: Directionenum Animal { Dog, Cat}a = Direction.Up // oka = Animal.Dog // ä¸èƒ½å°†ç±»å‹â€œAnimal.Dogâ€åˆ†é…ç»™ç±»å‹â€œDirectionâ€ 3.3 æšä¸¾åˆå¹¶å¦‚æœåŸºäºä¹‹å‰çš„Directionå†å®šä¹‰äº†ä¸€ä¸ªæšä¸¾ç±»å‹çš„Directionï¼Œä¼šåˆå¹¶æˆä¸€æ•´ä¸ª 123enum Direction { Center = 1} 5.æ¥å£(interface)5.1 å±æ€§ä¿®é¥°ç¬¦12345interface User { name: string age?: number readonly isMale: boolean} ?ï¼šå¯é€‰å±æ€§ readonlyï¼šåªè¯»å±æ€§ 5.2 å±æ€§æ£€æŸ¥ä¸‹é¢è¿™ä¸ªç¨‹åºå·²ç»æ­£ç¡®åœ°ç±»å‹åŒ–äº†ï¼Œå› ä¸ºwidthå±æ€§æ˜¯å…¼å®¹çš„ï¼Œä¸å­˜åœ¨colorå±æ€§ï¼Œè€Œä¸”é¢å¤–çš„colourå±æ€§æ˜¯æ— æ„ä¹‰çš„ 1234567891011interface Config { color?: string; width?: number;}function createSquare(config: Config): { color: string; area: number } { // ...}// error: 'colour' not expected in type 'Config'let mySquare = createSquare({ colour: &quot;red&quot;, width: 100 }); æ³¨æ„æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°æ˜¯ colourï¼Œå¹¶ä¸æ˜¯ color å®˜æ–¹æ–‡æ¡£ç»™äº†ä¸‰ç§æ–¹å¼ç»•è¿‡è¿™ç§æ£€æŸ¥ ç¬¬ä¸€ç§ä½¿ç”¨ç±»å‹æ–­è¨€ï¼š 1let mySquare = createSquare({ colour: &quot;red&quot;, width: 100 } as Config); ç¬¬äºŒç§æ·»åŠ å­—ç¬¦ä¸²ç´¢å¼•ç­¾åï¼š 12345interface Config { color?: string; width?: number; [propName: string]: any;} è¿™æ ·Configå¯ä»¥æœ‰ä»»æ„æ•°é‡çš„å±æ€§ï¼Œå¹¶ä¸”åªè¦ä¸æ˜¯widthæˆ–colorï¼Œé‚£ä¹ˆå°±æ— æ‰€è°“ä»–ä»¬çš„ç±»å‹æ˜¯ä»€ä¹ˆäº†ã€‚ ç¬¬ä¸‰ç§å°†å­—é¢é‡èµ‹å€¼ç»™å¦å¤–ä¸€ä¸ªå˜é‡ï¼š 12let options: any = { widdth: 5 };let mySquare = CalculateAreas(options); 5.3 å¯ç´¢å¼•ç±»å‹â€‹ TypeScriptæ”¯æŒä¸¤ç§ç´¢å¼•ç­¾åï¼šå­—ç¬¦ä¸²å’Œæ•°å­—ã€‚ å¯ä»¥åŒæ—¶ä½¿ç”¨ä¸¤ç§ç±»å‹çš„ç´¢å¼•ï¼Œä½†æ˜¯æ•°å­—ç´¢å¼•çš„è¿”å›å€¼å¿…é¡»æ˜¯å­—ç¬¦ä¸²ç´¢å¼•è¿”å›å€¼ç±»å‹çš„å­ç±»å‹ã€‚ è¿™æ˜¯å› ä¸ºå½“ä½¿ç”¨ numberæ¥ç´¢å¼•æ—¶ï¼ŒJavaScriptä¼šå°†å®ƒè½¬æ¢æˆstringç„¶åå†å»ç´¢å¼•å¯¹è±¡ã€‚ ä¹Ÿå°±æ˜¯è¯´ç”¨ 100ï¼ˆä¸€ä¸ªnumberï¼‰å»ç´¢å¼•ç­‰åŒäºä½¿ç”¨&quot;100&quot;ï¼ˆä¸€ä¸ªstringï¼‰å»ç´¢å¼•ï¼Œå› æ­¤ä¸¤è€…éœ€è¦ä¿æŒä¸€è‡´ã€‚ 123456789101112class Animal { name: string;}class Dog extends Animal { breed: string;}// é”™è¯¯ï¼šä½¿ç”¨æ•°å€¼å‹çš„å­—ç¬¦ä¸²ç´¢å¼•ï¼Œæœ‰æ—¶ä¼šå¾—åˆ°å®Œå…¨ä¸åŒçš„Animal!interface NotOkay { [x: number]: Animal; [x: string]: Dog;} ç´¢å¼•ç±»å‹æŸ¥è¯¢æ“ä½œç¬¦keyofï¼Œå³ç´¢å¼•ç±»å‹æŸ¥è¯¢æ“ä½œç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ keyof ä½œç”¨äºæ³›å‹Tä¸Šæ¥è·å–æ³›å‹Tä¸Šçš„æ‰€æœ‰ public å±æ€§åæ„æˆè”åˆç±»å‹ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæœ‰ä¸€ä¸ªImagesç±»ï¼ŒåŒ…å«srcå’Œaltä¸¤ä¸ªpublicå±æ€§ï¼Œæˆ‘ä»¬ç”¨keyofå–å±æ€§åï¼š 1234567class Images { public src: string = 'https://www.google.com.hk/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png' public alt: string = 'è°·æ­Œ' public width: number = 500}type propsNames = keyof Images æ•ˆæœå¦‚ä¸‹ï¼š![2019-06-26-06-17-29](D:\\OneDrive - mail2.gdut.edu.cn\\typora_img\\Typescriptè¯­æ³•ç¯‡\\16dbb13efd03fd86)keyof æ­£æ˜¯èµ‹äºˆäº†å¼€å‘è€…æŸ¥è¯¢ç´¢å¼•ç±»å‹çš„èƒ½åŠ›ã€‚ æ˜ å°„ç±»å‹æ˜ å°„ç±»å‹çš„è¯­æ³•æ˜¯[K in Keys]å¦‚æœæˆ‘ä»¬è¦æŠŠæ‰€æœ‰çš„å±æ€§æˆå‘˜å˜ä¸ºå¯é€‰ç±»å‹ï¼Œé‚£ä¹ˆéœ€è¦T[K]å–å‡ºç›¸åº”çš„å±æ€§å€¼ï¼Œæœ€åæˆ‘ä»¬é‡æ–°ç”Ÿæˆä¸€ä¸ªå¯é€‰çš„æ–°ç±»å‹{ [K in keyof T]?: T[K] }ã€‚ ç”¨ç±»å‹åˆ«åè¡¨ç¤ºå°±æ˜¯ï¼š 1type partial&lt;T&gt; = { [K in keyof T]?: T[K] } 5.4 ç»§æ‰¿æ¥å£123interface VIPUser extends User { broadcast: () =&gt; void} VIPUserå…·æœ‰Useræ‰€æœ‰çš„å±æ€§ 6.ç±»(Class)6.1æŠ½è±¡ç±» é€šå¸¸ä½œä¸ºæ´¾ç”Ÿç±»çš„åŸºç±»ä½¿ç”¨ï¼Œä¸æ¥å£ä¸åŒçš„æ˜¯æŠ½è±¡ç±»å¯ä»¥åŒ…å«æˆå‘˜çš„å®ç° ä¸‹é¢å®šä¹‰äº†ä¸€ä¸ªAnimalæŠ½è±¡ç±» 123456abstract class Animal { abstract makeSound(): void; move(): void { console.log('roaming the earch...'); }} å¦‚æœç›´æ¥å®ä¾‹åŒ–AnimalæŠ½è±¡ç±»åˆ™ä¼šæŠ¥é”™ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºå­ç±»ç»§æ‰¿åŸºç±»ï¼Œç„¶åå®ä¾‹åŒ–å­ç±» 1234567891011class Cat extends Animal { makeSound() { console.log('miao miao') }}const cat = new Cat()cat.makeSound() // miao miaocat.move() // roaming the earch... 6.2 è®¿é—®é™å®šç¬¦ public ç±»çš„æˆå‘˜é»˜è®¤ä¸ºpublic å¯è¢«å¤–éƒ¨è®¿é—® private åªèƒ½ç±»å†…éƒ¨è®¿é—® protected åªèƒ½è¢«ç±»çš„å†…éƒ¨ä»¥åŠç±»çš„å­ç±»è®¿é—® 6.3 å­˜å–å™¨å±æ€§å…·æœ‰getå’Œsetä¿®é¥°ç¬¦ï¼Œåªå¸¦æœ‰getä¸å¸¦æœ‰setçš„å­˜å–å™¨è‡ªåŠ¨è¢«æ¨æ–­ä¸ºreadonly 7. å‡½æ•°(Function)7.1 å‡½æ•°ç±»å‹åœ¨å°æ‹¬å·åé¢å£°æ˜è¿”å›å€¼ç±»å‹ 123function add(x: number, y: number): number { return x + y;} ç”¨æ¥å£å®šä¹‰å‡½æ•°çš„å½¢çŠ¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨æ¥å£çš„æ–¹å¼æ¥å®šä¹‰ä¸€ä¸ªå‡½æ•°éœ€è¦ç¬¦åˆçš„å½¢çŠ¶ï¼š 12345678interface SearchFunc { (source: string, subString: string): boolean;}let mySearch: SearchFunc;mySearch = function(source: string, subString: string) { return source.search(subString) !== -1;} é‡‡ç”¨å‡½æ•°è¡¨è¾¾å¼|æ¥å£å®šä¹‰å‡½æ•°çš„æ–¹å¼æ—¶ï¼Œå¯¹ç­‰å·å·¦ä¾§è¿›è¡Œç±»å‹é™åˆ¶ï¼Œå¯ä»¥ä¿è¯ä»¥åå¯¹å‡½æ•°åèµ‹å€¼æ—¶ä¿è¯å‚æ•°ä¸ªæ•°ã€å‚æ•°ç±»å‹ã€è¿”å›å€¼ç±»å‹ä¸å˜ã€‚ 7.2 å¯é€‰å‚æ•°åˆ©ç”¨?æˆ–åˆ™é»˜è®¤å€¼è®¾ç½®å¯é€‰å‚æ•°ï¼Œï¼Ÿå¯é€‰å‚æ•°å¿…é¡»æ”¾æœ€åï¼Œé»˜è®¤å€¼æ²¡å¿…è¦æ”¾æœ€åï¼Œä½†æ˜¯ä¸æ”¾æœ€åå¿…é¡»ä½¿ç”¨undefinedæ˜¾å¼è·å–é»˜è®¤å€¼ 123function add(x: number, y?: number): number { return x + y;} 7.3 å‰©ä½™å‚æ•°å‰©ä½™å‚æ•°ä¸JavaScriptç§çš„è¯­æ³•ç±»ä¼¼ï¼Œéœ€è¦ç”¨...æ¥è¡¨ç¤ºå‰©ä½™å‚æ•°ï¼Œè€Œå‰©ä½™å‚æ•°reståˆ™æ˜¯ä¸€ä¸ªç”±numberç»„æˆçš„æ•°ç»„ï¼Œåœ¨æœ¬å‡½æ•°ä¸­ç”¨ reduce è¿›è¡Œäº†ç´¯åŠ æ±‚å’Œã€‚ 1const add = (a: number, ...rest: number[]) =&gt; rest.reduce(((a, b) =&gt; a + b), a) 7.4 thiså‚æ•°å¦‚æœç›´æ¥ä½¿ç”¨thisè¿›è¡Œä¸€äº›æ“ä½œ,typescriptä¼šè¿›è¡ŒæŠ¥é”™ï¼Œå¯ä»¥æä¾›ä¸€ä¸ªæ˜¾å¼çš„thiså‚æ•°,è¯¥å‚æ•°æ˜¯å‡çš„,ä½†æ˜¯å¯ä»¥ä½¿é‡ç”¨å˜å¾—æ¸…æ™° 12345678910111213interface Deck { suits: string[]; createCardPicker(this: Deck): () =&gt; string[];}let deck: Deck = { suits: [&quot;hearts&quot;, &quot;spades&quot;, &quot;clubs&quot;, &quot;diamonds&quot;], // æ³¨æ„:è¿™ä¸ªå‡½æ•°ç°åœ¨æ˜¾å¼åœ°æŒ‡å®šå®ƒçš„è¢«è°ƒç”¨è€…å¿…é¡»æ˜¯Deckç±»å‹ createCardPicker: function(this: Deck) { return () =&gt; { return this.suits; } }} 7.5 é‡è½½(Overload)å‡½æ•°æ ¹æ®ä¼ å…¥ä¸åŒçš„å‚æ•°è€Œè¿”å›ä¸åŒç±»å‹çš„æ•°æ®æŸ¥æ‰¾é‡è½½åˆ—è¡¨ï¼Œå°è¯•ä½¿ç”¨ç¬¬ä¸€ä¸ªé‡è½½å®šä¹‰ã€‚ å¦‚æœåŒ¹é…çš„è¯å°±ä½¿ç”¨è¿™ä¸ª ä¸‹é¢çš„assignedåªèƒ½ä¼ é€’1ã€2ã€4ä¸ªå‚æ•°,ç”¨é‡è½½å¯ä»¥å¾ˆå¥½çš„å¯¹ä¸åŒçš„å‚æ•°åˆ—è¡¨è¿›è¡Œæ£€æµ‹ 123456789101112131415161718192021222324252627282930// é‡è½½interface Direction { top: number, bottom?: number, left?: number, right?: number}function assigned(all: number): Directionfunction assigned(topAndBottom: number, leftAndRight: number): Directionfunction assigned(top: number, right: number, bottom: number, left: number): Directionfunction assigned (a: number, b?: number, c?: number, d?: number) { if (b === undefined &amp;&amp; c === undefined &amp;&amp; d === undefined) { b = c = d = a } else if (c === undefined &amp;&amp; d === undefined) { c = a d = b } return { top: a, right: b, bottom: c, left: d }}assigned(1)assigned(1,2)assigned(1,2,3) // æŠ¥é”™assigned(1,2,3,4) 8. æ³›å‹(generic)ä¸‹å›¾Tä¸ºä¸€ç§ç±»å‹å˜é‡ï¼Œç”¨äºè¡¨ç¤ºä¸€ç§ç±»å‹è€Œä¸æ˜¯å€¼ï¼Œæˆ‘ä»¬ç»™identityæ·»åŠ äº†ç±»å‹å˜é‡Tã€‚ Tå¸®åŠ©æˆ‘ä»¬æ•è·ç”¨æˆ·ä¼ å…¥çš„ç±»å‹ï¼ˆæ¯”å¦‚ï¼šnumberï¼‰ã€‚ä¹‹åæˆ‘ä»¬å†æ¬¡ä½¿ç”¨äº†Tå½“åšè¿”å›å€¼ç±»å‹ï¼Œç°åœ¨æˆ‘ä»¬çŸ¥é“identityçš„å‚æ•°ç±»å‹å’Œæ”¾å›ç½®ç±»å‹æ˜¯ç›¸åŒçš„äº†ã€‚ 123function identity&lt;T&gt;(arg: T): T { return arg;} 8.1 æ³›å‹æ¥å£ä¸‹å›¾çš„Tä¸ºæ•´ä¸ªæ¥å£çš„ä¸€ä¸ªå‚æ•°ï¼Œè€Œå†ä½¿ç”¨GenericIdentityFnæ—¶ï¼Œè¿˜å¾—ä¼ å…¥ä¸€ä¸ªç±»å‹å‚æ•°æ¥æŒ‡å®šæ³›å‹ç±»å‹ï¼ˆè¿™é‡Œæ˜¯ï¼šnumberï¼‰ 123456789interface GenericIdentityFn&lt;T&gt; { (arg: T): T;}function identity&lt;T&gt;(arg: T): T { return arg;}let myIdentity: GenericIdentityFn&lt;number&gt; = identity; 8.2 æ³›å‹ç±»ä¸æ¥å£ä¸€æ ·ï¼Œç›´æ¥æŠŠæ³›å‹ç±»å‹æ”¾åœ¨ç±»åé¢ 123456class GenericNumber&lt;T&gt; { zeroValue: T; add: (x: T, y: T) =&gt; T;}let myGenericNumber = new GenericNumber&lt;number&gt;(); 8.3 æ³›å‹çº¦æŸä¸‹é¢ä¾‹å­æƒ³è¦è®¿é—®arg.lengthå±æ€§ï¼Œä½†æ˜¯æ˜¯ç¼–è¯‘å™¨å¹¶ä¸èƒ½è¯æ˜æ¯ç§ç±»å‹éƒ½æœ‰lengthå±æ€§ï¼Œæ‰€ä»¥å°±æŠ¥é”™äº† 1234function loggingIdentity&lt;T&gt;(arg: T): T { console.log(arg.length); // Error: T doesn't have .length return arg;} æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªæ¥å£æ¥æè¿°çº¦æŸæ¡ä»¶ï¼Œç„¶åéœ€è¦ä¼ å…¥ç¬¦åˆçº¦æŸç±»å‹çš„å€¼ï¼Œå¿…é¡»åŒ…å«å¿…é¡»çš„å±æ€§ 1234567891011interface Lengthwise { length: number;}function loggingIdentity&lt;T extends Lengthwise&gt;(arg: T): T { console.log(arg.length); // Now we know it has a .length property, so no more error return arg;}loggingIdentity(3); // Error, number doesn't have a .length propertyloggingIdentity({length: 10, value: 3}); // right 8.4 å¤šé‡ç±»å‹è¿›è¡Œæ³›å‹çº¦æŸç”¨äº¤å‰ç±»å‹&amp;è¿›è¡Œå¤šé‡çº¦æŸ 12345678910111213141516interface FirstInterface { doSomething(): number}interface SecondInterface { doSomethingElse(): string}class Demo&lt;T extends FirstInterface &amp; SecondInterface&gt; { private genericProperty: T useT() { this.genericProperty.doSomething() // right this.genericProperty.doSomethingElse() // right }} 8.5 æ³›å‹é‡Œä½¿ç”¨ç±»ç±»å‹æˆ‘ä»¬å‡è®¾éœ€è¦å£°æ˜ä¸€ä¸ªæ³›å‹æ‹¥æœ‰æ„é€ å‡½æ•°ï¼Œæ¯”å¦‚ï¼š 123function create&lt;T&gt;(type: T): T { return new type() // This expression is not constructable.} ä½†æ˜¯è¿™æ ·ä¼šæŠ¥é”™ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰å£°æ˜Tæ˜¯æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦æ˜¾å¼çš„ç”¨newæ¥å£°æ˜è¿™ä¸ªæ³›å‹Tæ˜¯æ„é€ å‡½æ•° 123function create&lt;T&gt;(type: {new(): T}): T { return new type();} å‚æ•°typeçš„ç±»å‹{new(): T}å°±è¡¨ç¤ºæ­¤æ³›å‹Tæ˜¯å¯è¢«æ„é€ çš„ï¼Œåœ¨è¢«å®ä¾‹åŒ–åçš„ç±»å‹æ˜¯æ³›å‹T ä¸€ä¸ªæ›´é«˜çº§çš„ä¾‹å­ï¼Œä½¿ç”¨åŸå‹å±æ€§æ¨æ–­å¹¶çº¦æŸæ„é€ å‡½æ•°ä¸ç±»å®ä¾‹çš„å…³ç³»ã€‚ 1234567891011121314151617181920212223242526class BeeKeeper { hasMask: boolean;}class ZooKeeper { nametag: string;}class Animal { numLegs: number;}class Bee extends Animal { keeper: BeeKeeper;}class Lion extends Animal { keeper: ZooKeeper;}function createInstance&lt;A extends Animal&gt;(c: new () =&gt; A): A { return new c();}createInstance(Lion).keeper.nametag; // typechecks!createInstance(Bee).keeper.hasMask; // typechecks! 9. ç±»å‹å…¼å®¹æ€§Tsç»“æ„åŒ–ç±»å‹ç³»ç»Ÿçš„åŸºæœ¬è§„åˆ™æ˜¯ï¼Œå¦‚æœxè¦å…¼å®¹yï¼Œé‚£ä¹ˆyè‡³å°‘å…·æœ‰ä¸xç›¸åŒçš„å±æ€§ï¼Œç¼–è¯‘å™¨ä¼šæ£€æŸ¥xä¸­çš„æ¯ä¸ªå±æ€§ï¼Œçœ‹æ˜¯å¦èƒ½åœ¨yä¸­ä¹Ÿæ‰¾åˆ°å¯¹åº”å±æ€§ 10. é«˜çº§ç±»å‹10.1 äº¤å‰ç±»å‹ç”¨&amp;å¯ä»¥å°†å¤šä¸ªç±»å‹åˆå¹¶ä¸ºä¸€ä¸ªç±»å‹ 10.2 è”åˆç±»å‹ç”¨|è¡¨ç¤ºä¸€ä¸ªå€¼å¯ä¸ºå‡ ç§ç±»å‹ä¹‹ä¸€ 12345678function formatCommandline(command: string[] | string) { let line = ''; if (typeof command === 'string') { line = command.trim(); } else { line = command.join(' ').trim(); }} 10.3 ç±»å‹åˆ«åtypeè™½ç„¶çœ‹èµ·æ¥å’Œinterfaceä¸€æ ·ï¼Œä½†æ˜¯å¯ä»¥ç”¨åœ¨åŸå§‹ç±»å‹ã€è”åˆç±»å‹ã€å…ƒç»„ç­‰éœ€è¦æ‰‹å†™çš„ç±»å‹ï¼Œç±»å‹åˆ«åä¹Ÿå¯ä»¥æ˜¯æ³›å‹ 12345type some = boolean | stringconst b: some = true // okconst c: some = 'hello' // okconst d: some = 123 // ä¸èƒ½å°†ç±»å‹â€œ123â€åˆ†é…ç»™ç±»å‹â€œsomeâ€ ç±»å‹åˆ«åå’Œæ¥å£çš„åŒºåˆ« ç±»å‹åˆ«åä¸èƒ½è¢«extendså’Œimplementsï¼ˆè‡ªå·±ä¹Ÿä¸èƒ½extendså’Œimplementså…¶å®ƒç±»å‹ï¼‰ interface å¯ä»¥å®ç°æ¥å£åˆå¹¶å£°æ˜ 10.4 æ¡ä»¶ç±»å‹1T extends U ? X : Y ä¸Šé¢çš„ä»£ç å¯ä»¥ç†è§£ä¸º: è‹¥ T èƒ½å¤Ÿèµ‹å€¼ç»™ Uï¼Œé‚£ä¹ˆç±»å‹æ˜¯ Xï¼Œå¦åˆ™ä¸º Y,æœ‰ç‚¹ç±»ä¼¼äºJavaScriptä¸­çš„ä¸‰å…ƒæ¡ä»¶è¿ç®—ç¬¦ 11. ç±»å‹ä¿æŠ¤å’Œç±»å‹æ–­è¨€11.1 ï¼ ç±»å‹æ£€æŸ¥å™¨è®¤ä¸º nullä¸ undefinedå¯ä»¥èµ‹å€¼ç»™ä»»ä½•ç±»å‹ å¯ä»¥ä½¿ç”¨--strictNullChecksæ¥ä½¿å˜é‡ä¸è‡ªåŠ¨çš„åŒ…å«nullæˆ– undefinedï¼Œä½†æ˜¯å¼€å¯åå¯é€‰å‚æ•°ä¼šè¢«è‡ªåŠ¨åœ°åŠ ä¸Š| undefinedã€‚ å¦‚æœç¼–è¯‘å™¨ä¸èƒ½å¤Ÿå»é™¤ nullæˆ– undefinedï¼Œä½ å¯ä»¥ä½¿ç”¨ç±»å‹æ–­è¨€æ‰‹åŠ¨å»é™¤ã€‚ è¯­æ³•æ˜¯æ·»åŠ !åç¼€ï¼š identifier!ä» identifierçš„ç±»å‹é‡Œå»é™¤äº† nullå’Œ undefined 123456789101112131415function broken(name: string | null): string { function postfix(epithet: string) { return name.charAt(0) + '. the ' + epithet; // error, 'name' is possibly null } name = name || &quot;Bob&quot;; return postfix(&quot;great&quot;);}function fixed(name: string | null): string { function postfix(epithet: string) { return name!.charAt(0) + '. the ' + epithet; // ok } name = name || &quot;Bob&quot;; return postfix(&quot;great&quot;);} 11.2 isè¿›è¡Œç±»å‹ä¿æŠ¤isä¹‹åçš„ç±»å‹å¿…é¡»æ˜¯å‚æ•°ç±»å‹ä¸­çš„ä¸€ä¸ªï¼Œåœ¨åç»­è°ƒç”¨æ”¹å‚æ•°æ—¶ï¼Œtsä¼šå°†å˜é‡ç¼©å‡ä¸ºé‚£ä¸ªå…·ä½“çš„ç±»å‹ 123456789101112function isString(test: any): test is string{ return typeof test === 'string';}function example(foo: number | string){ if(isString(foo)){ console.log('it is a string' + foo); // å¦‚æœä¸Šé¢æ²¡å†™test is stringï¼Œfoo.lengthå°†ä¼šæŠ¥é”™ console.log(foo.length); // string function }}example('hello world'); å‚è€ƒhttps://www.tslang.cn/docs/handbookhttps://ts.xcatliu.com/basics/type-of-function.html","link":"/2020/09/25/Ts/Typescript%E8%AF%AD%E6%B3%95%E7%AF%87/"},{"title":"å­¦ä¹ cssçš„ç½‘ç«™","text":"codepenï¼šhttps://codepen.io/csså¸¸è§å¸ƒå±€ï¼šhttps://csslayout.io/patterns/å¸¸è§åŠ è½½åŠ¨ç”»ï¼šhttps://tobiasahlin.com/spinkit/å¸¸è§cssæ•ˆæœï¼šhttps://emilkowalski.github.io/css-effects-snippets/cssçµæ„Ÿï¼šhttps://chokcoco.github.io/CSS-Inspiration/#/è‡ªå®šä¹‰cssç»„ä»¶ï¼šhttps://animista.net/","link":"/2020/09/20/Css/%E5%AD%A6%E4%B9%A0css%E7%9A%84%E7%BD%91%E7%AB%99/"},{"title":"EventBusçš„ä¸€ç§ä½¿ç”¨åœºæ™¯","text":"æ‰€è°“äº‹ä»¶æ€»çº¿ï¼Œå°±æ˜¯å®ä¾‹åŒ–Vueå¯¹è±¡ï¼Œåœ¨è¯¥å®ä¾‹ä¸Šé€šè¿‡$onç»‘å®šäº‹ä»¶ã€$emitè§¦å‘äº‹ä»¶ã€$offè§£ç»‘äº‹ä»¶ï¼Œè¿›è¡Œç»„ä»¶é€šä¿¡ã€‚ ä¸€ã€ä½¿ç”¨å®ä¾‹åŒ–Vueå¯¹è±¡ï¼Œå¹¶æŒ‚è½½åˆ°Vue.prototype 1Vue.prototype.$bus = new Vue(); äºŒã€åœºæ™¯ åœ¨å¤šä¸ªé¡µé¢å¤ç”¨ä¸€ä¸ªç»„ä»¶æ—¶ï¼Œæ¯ä¸ªé¡µé¢éœ€è¦æœ‰ç‚¹å‡»æŒ‰é’®åï¼Œè§¦å‘ä¸åŒçš„äº‹ä»¶ å½“ç„¶å¯ä»¥ç›‘å¬è·¯ç”±è¿›è¡Œåˆ¤æ–­è°ƒç”¨ä¸åŒçš„å‡½æ•°ï¼Œä½†æ˜¯è¿™æ ·ä¼šåœ¨ä¸€ä¸ªç»„ä»¶å†…å†™ä¸Šå¾ˆå¤šå…¶ä»–ç»„ä»¶åº”è¯¥è§¦å‘çš„äº‹ä»¶ã€‚ æˆ‘ä»¬åˆ©ç”¨EventBuså¯ä»¥åšåˆ°ç»„ä»¶é—´çš„è§£è€¦ ä¸‰ã€ä½¿ç”¨æ–¹æ³•1.æˆ‘ä»¬åœ¨å„ä¸ªé¡µé¢ä¸Šå†™å¥½äº‹ä»¶è§¦å‘åè°ƒç”¨çš„å‡½æ•°ï¼Œç„¶ååœ¨mountedï¼ˆå¦‚æœç”¨keep-aliveåˆ™æ˜¯åœ¨activatedï¼Œå¦åˆ™åªæŒ‚è½½ä¸€æ¬¡ï¼‰this.$bus.$onä¸Šç»‘å®šè¯¥äº‹ä»¶ï¼Œåœ¨beforeDestoryï¼ˆå¦‚æœç”¨keep-aliveåˆ™æ˜¯åœ¨deactivedï¼Œå¦åˆ™æ— æ³•è§£ç»‘äº‹ä»¶ï¼‰ä¸Šç”¨this.$bus.$offè§£ç»‘äº‹ä»¶ã€‚ 1234567891011mounted() { this.$bus.$on(&quot;save&quot;, this.save);}beforeDestory() { this.$bus.$off(&quot;save&quot;, this.save);}save() { console.log(&quot;æˆ‘æ²¡æœ‰å†™åœ¨å¤ç”¨ç»„ä»¶ä¸Šå“¦ï¼&quot;)} 2.ç„¶ååœ¨å¤ç”¨çš„ç»„ä»¶ä¸Šè§¦å‘äº‹ä»¶ 1this.$bus.$emit('save'); ä¹Ÿç®—æ˜¯ç¬¬ä¸€æ¬¡å°è¯•ä½¿ç”¨EventBusæŠŠï¼Œå¾ˆå¥½çš„é™ä½äº†ç»„ä»¶é—´çš„è€¦åˆåº¦","link":"/2020/09/17/%E5%89%8D%E7%AB%AF%E5%AE%9E%E6%88%98%E6%8A%80%E5%B7%A7/EventBus%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF/"},{"title":"å¯¹äºç‚¹æ­Œå°æ€»ç»“vuexæŒä¹…åŒ–å¤„ç†çš„è¡¥å……","text":"é’ˆå¯¹åˆ·æ–°æ—¶vuexæ•°æ®ä¸¢å¤±ï¼Œä½¿ç”¨äº†vuex-persistedstateå¯¹vuexè¿›è¡ŒæŒä¹…åŒ–å¤„ç†å®˜æ–¹githubï¼šhttps://github.com/robinvdvleuten/vuex-persistedstate æœ¬æ–‡ä¸»è¦æ˜¯å¯¹å®˜ç½‘ä¸å¤Ÿè¯¦ç»†çš„æ¡ˆä¾‹è¿›è¡Œè¡¥å……ï¼Œå®˜ç½‘åªè®²äº†å¯¹vuexå®Œå…¨å­˜å‚¨å’Œå¯¹vuexæ¨¡å—çš„å®Œå…¨å­˜å‚¨ã€‚ä½†æ˜¯æˆ‘æƒ³å¯¹æŸä¸€æ¨¡å—å†…éƒ¨ä¸€äº›å˜é‡è¿›è¡Œå­˜å‚¨ï¼Œè°·æ­Œäº†å¥½å¤šéƒ½æ²¡æ‰¾åˆ°å†™æ³•ï¼Œè‡ªå·±è¯•å‡ºæ¥äº†ã€‚ é¦–å…ˆå¼•å…¥vuex-persistedstate 1import createPersistedState from &quot;vuex-persistedstate&quot;; åˆ©ç”¨å®˜ç½‘ç»™çš„reducerå‡å°‘æŒä¹…åŒ–çš„æ•°æ® 1234567891011121314151617181920const store = new Vuex.Store({ state, getters, mutations, actions, modules: { projectDetail }, // @ts-ignore plugins: [createPersistedState({ reducer(val) { return { staffId: val.staffId, projectDetail: { curPjId: val.projectDetail.curPjId, } } } })]}) å¯ä»¥çœ‹åˆ°è¯¥vuexç»“æ„å…·æœ‰projectDetailæ¨¡å—ï¼Œæˆ‘æƒ³å¯¹è¯¥æ¨¡å—å†…çš„curPjIdè¿›è¡Œå•ç‹¬å­˜å‚¨ï¼Œåœ¨reduceræ”¾å›çš„å¯¹è±¡çš„é”®è®¾ä¸ºæ¨¡å—åï¼Œé‡Œé¢å†™ç€æƒ³è¦æŒä¹…åŒ–çš„å˜é‡ï¼Œå°±å¯ä»¥äº†ã€‚ ä¼šåœ¨localstorageå­˜å‚¨ä¸ºå¦‚ä¸‹æ‰€ç¤º","link":"/2020/09/16/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/%E5%AF%B9%E4%BA%8E%E7%82%B9%E6%AD%8C%E5%8F%B0%E6%80%BB%E7%BB%93vuex%E6%8C%81%E4%B9%85%E5%8C%96%E5%A4%84%E7%90%86%E7%9A%84%E8%A1%A5%E5%85%85/"},{"title":"elementçš„è¡¨å•éªŒè¯æ•ˆæœæ›¿æ¢","text":"åœ¨åšé¡¹ç›®çš„æ—¶å€™çœ‹åˆ°äº†è¿™ä¸ªéœ€æ±‚ï¼Œéœ€è¦ç”¨å›¾ç‰‡æ›¿æ¢é»˜è®¤çš„æ–‡å­—æ˜¾ç¤º f12å¯ä»¥çœ‹åˆ°å‡ºé”™äº†çš„è¡¨å•é¡¹ä¼šåœ¨div.el-form-item__contentä¸‹æœ‰ä¸ªdiv.el-form-item__error äºæ˜¯å°±å¯¹div.el-form-item__errorè¿›è¡Œæ“ä½œ 12345678910111213141516171819202122232425/deep/ .el-form-item__content { display: flex; // ä½¿é”™è¯¯ä¿¡æ¯æ˜¾ç¤ºåœ¨åŒä¸€è¡Œ margin-right: 20px; // ä¿®æ”¹é”™è¯¯æ˜¾ç¤º /deep/ .el-form-item__error { position: relative; top: 0; right: 0; font-size: 0; // æŠŠé»˜è®¤æ–‡å­—å–æ¶ˆ // ç”¨ä¼ªå…ƒç´ æ’å…¥èƒŒæ™¯å›¾ç‰‡ &amp;:after { content: &quot;&quot;; display: block; width: 20px; height: 20px; position: absolute; right: -10px; top: 10px; background: url(&quot;~@/assets/img/error.png&quot;) 0 0 no-repeat; background-size: 20px 20px; } }}","link":"/2020/09/15/%E5%89%8D%E7%AB%AF%E5%AE%9E%E6%88%98%E6%8A%80%E5%B7%A7/element%E7%9A%84%E8%A1%A8%E5%8D%95%E9%AA%8C%E8%AF%81%E6%95%88%E6%9E%9C%E6%9B%BF%E6%8D%A2/"},{"title":"å¾®ä¿¡ç½‘é¡µæˆæƒ","text":"ç…§ç€å®˜æ–¹æ•™ç¨‹è®¾ç½®å¥½JSæ¥å£å®‰å…¨åŸŸåå¹¶ä¸”æŠŠæ–‡ä»¶æ”¾åˆ°æœåŠ¡å™¨å é¦–å…ˆéœ€è¦å¼•å…¥weixin-js-sdk ç„¶ååˆ›å»ºä¸€ä¸ªæ–‡ä»¶ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172export default function weixinShare() { return axios .get(`${base.BASE_URL}/share`, { params: { url: location.href.split(&quot;#&quot;)[0] }, }) .then((res) =&gt; { const { data: { code, data }, } = res; if (code === 200) { wx.config({ // è·å–å¾®ä¿¡æ¥å£çš„æƒé™ appId: appId, // å¿…å¡«ï¼Œä¼ä¸šå·çš„å”¯ä¸€æ ‡è¯†ï¼Œæ­¤å¤„å¡«å†™ä¼ä¸šå·corpid timestamp: data.timestamp, // å¿…å¡«ï¼Œç”Ÿæˆç­¾åçš„æ—¶é—´æˆ³ nonceStr: data.nonceStr, // å¿…å¡«ï¼Œç”Ÿæˆç­¾åçš„éšæœºä¸² signature: data.signature, // å¿…å¡«ï¼Œç­¾åï¼Œè§é™„å½•1 jsApiList: [ &quot;updateAppMessageShareData&quot;, &quot;onMenuShareTimeline&quot;, &quot;onMenuShareAppMessage&quot;, ], // å¿…å¡«ï¼Œéœ€è¦ä½¿ç”¨çš„JSæ¥å£åˆ—è¡¨ï¼Œæ‰€æœ‰JSæ¥å£åˆ—è¡¨è§é™„å½•2 }); let imgUrl = &quot;imgUrl&quot;; let title = &quot;title&quot;; let desc = &quot;&quot;; axios.get(`${base.BASE_URL}/random_link`).then((res) =&gt; { const { data: { data, code }, } = res; if (code === 200) { if (data.linkImage) { imgUrl = data.linkImage; } if (data.linkTittle) { title = data.linkTittle; } if (data.linkContent) { desc = data.linkContent } } //éœ€åœ¨ç”¨æˆ·å¯èƒ½ç‚¹å‡»åˆ†äº«æŒ‰é’®å‰å°±å…ˆè°ƒç”¨ wx.ready(function() { // åˆ†äº«ç»™æœ‹å‹ åŠ åˆ†äº«åˆ°QQ wx.updateAppMessageShareData({ title: title, // åˆ†äº«æ ‡é¢˜ï¼Œï¼ˆå¿…å¡«ï¼Œå¦åˆ™å¤±æ•ˆï¼‰ desc: desc, // åˆ†äº«æè¿° link: link, // åˆ†äº«é“¾æ¥ï¼Œè¯¥é“¾æ¥åŸŸåæˆ–è·¯å¾„å¿…é¡»ä¸å½“å‰é¡µé¢å¯¹åº”çš„å…¬ä¼—å·JSå®‰å…¨åŸŸåä¸€è‡´ imgUrl: imgUrl, // åˆ†äº«å›¾æ ‡ï¼ˆå¿…å¡«ï¼Œå¦åˆ™å¤±æ•ˆï¼‰ success: function() { console.log(&quot;success&quot;); }, fail: function(err) { console.log(JSON.stringify(err)); }, }); // åˆ†äº«åˆ°æœ‹å‹åœˆ wx.onMenuShareTimeline({ title: data.linkTittle, // åˆ†äº«æ ‡é¢˜ link: link, // åˆ†äº«é“¾æ¥ï¼Œè¯¥é“¾æ¥åŸŸåæˆ–è·¯å¾„å¿…é¡»ä¸å½“å‰é¡µé¢å¯¹åº”çš„å…¬ä¼—å·JSå®‰å…¨åŸŸåä¸€è‡´ imgUrl: imgUrl, // åˆ†äº«å›¾æ ‡ success: function() { console.log(&quot;success&quot;); }, fail: function(err) { console.log(JSON.stringify(err)); }, }); }); }); } });} 12345678beforeEnter(to, from, next) { weixinShare().then(() =&gt; { next(); }).catch(res=&gt;{ console.log('res: ', res); next(); });} ç„¶ååœ¨è¿›å…¥é¡µé¢å‰è°ƒç”¨è¯¥æ¥å£","link":"/2020/08/18/%E5%BE%AE%E4%BF%A1%E7%BD%91%E9%A1%B5/%E5%BE%AE%E4%BF%A1%E7%BD%91%E9%A1%B5%E6%8E%88%E6%9D%83/"},{"title":"ç‚¹æ­Œå°é¡¹ç›®æ€»ç»“","text":"1. imgæ ‡ç­¾srcä¸ºç©ºçš„å¼‚å¸¸æ ·å¼æ ¹æ®ç”¨æˆ·æ€§åˆ«æ¥æ˜¾ç¤ºä¸åŒçš„å›¾æ ‡ï¼Œä½†æ˜¯å¦‚æœè·å–å¤±è´¥ï¼Œå¯¼è‡´imgçš„srcä¸ºç©ºä»è€Œæ˜¾ç¤ºå¼‚å¸¸å¤„ç† 12345// è§£å†³srcä¸ºç©ºçš„å¼‚å¸¸æ ·å¼img[src=&quot;&quot;],img:not([src]) { opacity: 0;} 2.Safariç¢°åˆ°çš„é—®é¢˜2.1 ä¼ªç±»activeå¤±æ•ˆåœ¨æŒ‰é’®å…ƒç´ æˆ–body/htmlä¸Šç»‘å®šä¸€ä¸ªtouchstartäº‹ä»¶æ‰èƒ½æ¿€æ´»:activeçŠ¶æ€ 1document.body.addEventListener('touchstart', function () {}); 2.2 inputå’Œtextareaæœ‰ä¸Šå†…é˜´å½±1-webkit-appearance: none; 3.ç§»åŠ¨ç«¯å¸ƒå±€ 1234567&lt;div class=&quot;page&quot;&gt; &lt;div class=&quot;header&quot;&gt;header&lt;/div&gt; &lt;div class=&quot;content&quot;&gt; &lt;div&gt;1&lt;/div&gt;&lt;div&gt;2&lt;/div&gt;&lt;div&gt;3&lt;/div&gt;&lt;div&gt;4&lt;/div&gt;&lt;div&gt;5&lt;/div&gt;&lt;div&gt;6&lt;/div&gt;&lt;div&gt;7&lt;/div&gt;&lt;div&gt;8&lt;/div&gt;&lt;div&gt;9&lt;/div&gt;&lt;div&gt;10&lt;/div&gt;&lt;div&gt;11&lt;/div&gt;&lt;div&gt;12&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;footer&quot;&gt;footer&lt;/div&gt;&lt;/div&gt; 1234567891011121314151617181920212223242526.page { // æ•´ä½“flexç«–å¼å¸ƒå±€ display: flex; flex-direction: column; height: 100vh; overflow: hidden;}.content { // å†…å®¹å®¹å™¨ flex: 1; overflow-y: scroll; -webkit-overflow-scrolling: touch; // ç§»åŠ¨å›å¼¹ &amp;::-webkit-scrollbar { display: none; } div { // å…·ä½“å†…å®¹ margin: 10px 0; height: 50px; background-color: #999; }}.footer { height: 60px;} 4. textareaæŠŠiconå›¾ç‰‡æ˜¾ç¤ºåœ¨è¾“å…¥å‰ 1234567textarea { text-indent: 23px; &amp;::placeholder { text-indent: 23px; }} åˆ©ç”¨text-indentæ¥ä½¿è¾“å…¥å…‰æ ‡åç½®ï¼Œç„¶åå›¾ç‰‡ç”¨å®šä½è®¾ç½®åœ¨æŒ‡å®šä½ç½® 5. ioså¼¹é”®ç›˜ ä¸Šç§»å¸ƒå±€ä¸”ä¸æ¢å¤1&lt;input @blur.prevent=&quot;checkValue&quot; type=&quot;text&quot; /&gt; 12345678910111213141516checkValue () { inputBlur() this.$emit('checkValue')}inputBlur() { let u = navigator.userAgent; let isIOS = !!u.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/); if (isIOS) { setTimeout(() =&gt; { const scrollHeight = document.documentElement.scrollTop || document.body.scrollTop || 0; window.scrollTo(0, Math.max(scrollHeight - 1, 0)); }, 200); }} 6.æ»‘å—æ ·å¼ 1&lt;input type=&quot;checkbox&quot; class=&quot;slide-btn&quot;/&gt; 12345678910111213141516171819202122232425262728293031.slide-btn { position: relative; -webkit-appearance: none; width: 50px; height: 23px; border: 1px solid #e9e9e9; border-radius: 30px; outline: none;}.slide-btn:before { content: &quot;&quot;; position: absolute; top: 50%; transform: translateY(-50%); left: 1px; width: 18px; height: 18px; border-radius: 50%; background: #e9ddd8; transition: all 0.2s linear;}.slide-btn:checked { background: #fff4f0; border: 1px solid #fff4f0;}.slide-btn:checked:before { left: 29px; background-color: #ff935f; transition: all 0.2s linear;} 7. èƒŒæ™¯é¢œè‰²å’ŒèƒŒæ™¯å›¾ç‰‡åŒæ—¶è®¾ç½®å‰é¢çš„èƒŒæ™¯ä¼šå åœ¨ä¹‹åçš„èƒŒæ™¯ä¹‹ä¸Šï¼Œæ‰€ä»¥èƒŒæ™¯è‰²é€šå¸¸éƒ½å®šä¹‰åœ¨æœ€åä¸€ç»„ä¸Šï¼Œé¿å…èƒŒæ™¯è‰²å°†å›¾åƒç›–ä½ 8. æ–‡å­—è¶…å‡ºå¤„ç†8.1 ä¸€è¡Œè¶…å‡ºçœç•¥123white-space: nowrap; // ä¸æ¢è¡Œoverflow: hidden;text-overflow: ellipsis; // çœç•¥å· è§¦å‘text-overflowéœ€è¦ overflowä¸ºévisible æ˜¾å¼æˆ–éšå¼å®šä¹‰widthå€¼ white-spaceä¸ºénowrapå€¼ 8.2 æœ€å¤šä¸¤è¡Œï¼Œè¶…å‡ºåˆ©ç”¨å±•å¼€æ”¶èµ·å…¼å®¹æ€§ä¸å¤ªå¥½ 12345678910111213.show2line { display: -webkit-box; overflow: hidden; -webkit-line-clamp: 2; /* é™åˆ¶åœ¨ä¸€ä¸ªå—å…ƒç´ æ˜¾ç¤ºçš„æ–‡æœ¬çš„è¡Œæ•° */ -webkit-box-orient: vertical; /* å‚ç›´æ’åˆ— */ text-overflow: ellipsis;}.showAll { display: block; overflow: auto; height: auto;} 9. éƒ¨åˆ†æœºå‹è®¾ç½®é€æ˜åº¦0.xä¼šå®Œå…¨é€æ˜10. åˆ·æ–°ä¼šå¯¼è‡´vuexä¸¢å¤±ä¸€æ®µæ—¶é—´ç›®å‰çš„è§£å†³æ–¹æ¡ˆæ˜¯å­˜localstorageæˆ–è€…ä»router.queryè·å–ï¼Œè¿˜çœ‹åˆ°æœ‰ç”¨vuex-persistedstateã€‚","link":"/2020/08/18/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/%E7%82%B9%E6%AD%8C%E5%8F%B0%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/"},{"title":"jsä¸­çš„å˜é‡å£°æ˜","text":"ä¸€ã€ es5å’Œes6ä¸­å˜é‡å£°æ˜çš„åŒºåˆ« å˜é‡æå‡ å—çº§ä½œç”¨åŸŸ é‡å¤å£°æ˜ var ä¼š æ—  èƒ½ letã€const ä¸ä¼š æœ‰ ä¸èƒ½ äºŒã€å„ç§å˜é‡å£°æ˜çš„ç‰¹ç‚¹1. varå½“varè¢«ä½œç”¨äºå…¨å±€ä½œç”¨åŸŸæ—¶ï¼Œä»–ä¼šæŠŠå˜é‡ä½œä¸ºå…¨å±€å¯¹è±¡ï¼ˆæµè§ˆå™¨ç¯å¢ƒä¸­çš„windowå¯¹è±¡ï¼‰çš„å±æ€§ ç”±äºæ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼Œæ‰€ä»¥ä»»ä½•ä½ç½®çš„å˜é‡çš„å£°æ˜åœ¨jså¼•æ“æ‰«æä»£ç çš„æ—¶å€™ï¼Œå°†å…¶æå‡è‡³æ‰€åœ¨ä½œç”¨åŸŸçš„é¡¶éƒ¨ 123456789function getValue(condition) { if (condition) { var value = &quot;blue&quot;; return value; } else { // æ­¤å¤„å¯è®¿é—®å˜é‡valueï¼Œå…¶å€¼ä¸ºundefined return null; }} è¢«jså¼•æ“è§£ææˆå¦‚ä¸‹æ‰€ç¤º 1234567891011function getValue(condition) { var value; // valueçš„ç”Ÿå‘½æå‡åˆ°æ‰€åœ¨ä½œç”¨åŸŸçš„é¡¶éƒ¨ if (condition) { value = &quot;blue&quot;; return value; } else { // æ­¤å¤„å¯è®¿é—®å˜é‡valueï¼Œå…¶å€¼ä¸ºundefined return null; }} 2. let/constçš„å…±åŒç‰¹ç‚¹2.1 å…·æœ‰å—çº§ä½œç”¨åŸŸå­˜åœ¨äº å‡½æ•°å†…éƒ¨ å—ä¸­ï¼ˆå­—ç¬¦ { å’Œ } ä¹‹é—´çš„åŒºåŸŸï¼‰ å¾ªç¯ä¸­çš„å—çº§ä½œç”¨åŸŸç»‘å®švarå£°æ˜ä½¿å¾—å˜é‡åˆ°å¾ªç¯å¤–ä»èƒ½è®¿é—® 1234567891011var funcs = [];for (var i = 0; i &lt; 10; i++) { funcs.push(function() { console.log(i); });}funcs.forEach(function(func) { func(); // è¾“å‡º10æ¬¡æ•°å­—10}); ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ç«‹å³æ‰§è¡Œå‡½æ•°ï¼ˆIIFEï¼‰ï¼Œä¸ºæ¥å—çš„æ¯ä¸€ä¸ªå‚æ•°iéƒ½åˆ›å»ºäº†ä¸€ä¸ªå‰¯æœ¬å¹¶å‚¨å­˜ä¸ºå˜é‡value 12345678// å¾ªç¯ä¿®æ”¹æˆfor (var i = 0; i &lt; 10; i++) { funcs.push((function(value) { return function() { console.log(value); } }(i)));} è€Œåœ¨es6ä¸­çš„letç®€åŒ–äº†è¿™ä¸ªè¿‡ç¨‹ï¼Œæ¯æ¬¡è¿­ä»£å¾ªç¯éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°å˜é‡ï¼Œå¹¶ä»¥ä¹‹å‰è¿­ä»£ä¸­åŒåå˜é‡çš„å€¼å°†å…¶åˆå§‹åŒ– ç‰¹åˆ«çš„å¦‚æœåœ¨forå¾ªç¯ä¸­ç”¨constæ›¿æ¢äº†letï¼Œåˆ™constå£°æ˜çš„å˜é‡ä¸èƒ½åœ¨åç»­çš„å¾ªç¯ä¸­è¢«ä¿®æ”¹ï¼Œè€Œåœ¨for-inæˆ–for-ofå¾ªç¯ä¸­ä½¿ç”¨constæ—¶çš„è¡Œä¸ºä¸ä½¿ç”¨letä¸€è‡´ï¼Œå› ä¸ºæ¯æ¬¡è¿­ä»£æ˜¯åˆ›å»ºä¸€ä¸ªæ–°ç»‘å®š 2.2 ç¦æ­¢é‡å¤å£°æ˜â€‹ ä¼šæŠ¥ Identifier â€˜å˜é‡â€™ has already been declared çš„é”™ 2.3 æš‚æ—¶æ€§æ­»åŒºï¼ˆTemporal Dead Zoneï¼‰jså¼•æ“åœ¨æ‰«æä»£ç çš„æ—¶å€™å‘ç°letæˆ–è€…constå£°æ˜çš„å˜é‡ï¼Œä¼šå°†ä»–æ”¾åˆ°TDZï¼Œè®¿é—®TDZä¸­çš„å˜é‡ä¼šè§¦å‘è¿è¡Œæ—¶é”™è¯¯ï¼Œåªæœ‰æ‰§è¡Œè¿‡å˜é‡å£°æ˜è¯­å¥åï¼Œæ‰ä¼šæŠŠå˜é‡ä»TDZä¸­ç§»é™¤ ç”±äºå—çº§ä½œç”¨åŸŸï¼Œæ‰€ä»¥åœ¨å£°æ˜çš„å˜é‡çš„ä½œç”¨åŸŸå¤–ä½¿ç”¨åˆ™ä¸ä¼šæŠ¥é”™ 12345console.log(typeof value); // undefinedif (condition) { let value = &quot;blue&quot;;} ä¸‰ã€å‡½æ•°å£°æ˜123456789101112// å‡½æ•°è¡¨è¾¾å¼var f = function() { console.log(1); }// ç›´æ¥å£°æ˜function f (){ console.log(2);}// å¦‚æœä¸¤ç§å£°æ˜æ–¹å¼å£°æ˜åŒä¸€ä¸ªå‡½æ•°åï¼Œæœ€ç»ˆæ‰§è¡Œçš„æ˜¯ å‡½æ•°è¡¨è¾¾å¼f(); // 1 ç¬¬ä¸€ç§æ–¹å¼ï¼šå‡½æ•°åªèƒ½åœ¨å£°æ˜ä¹‹åè°ƒç”¨ï¼Œå› ä¸ºè¿™ç§å‡½æ•°å£°æ˜æ˜¯åœ¨å‡½æ•°è¿è¡Œçš„é˜¶æ®µæ‰èµ‹å€¼ç»™å˜é‡ f çš„ ç¬¬äºŒç§æ–¹å¼ï¼šå‡½æ•°å¯ä»¥åœ¨å£°æ˜å‡½æ•°çš„ä½œç”¨åŸŸå†…ä»»ä¸€åœ°æ–¹è°ƒç”¨ã€‚å› ä¸ºè¿™ç§æ–¹å¼ï¼Œæ˜¯åœ¨å‡½æ•°è§£æé˜¶æ®µèµ‹å€¼ç»™æ ‡è¯†ç¬¦ f . å‡½æ•°å£°æ˜æå‡ä¼˜å…ˆäºå˜é‡æå‡ï¼Œä¸”ä¸ä¼šè¢«å˜é‡å£°æ˜è¦†ç›–ï¼Œä½†æ˜¯ä¼šè¢«å˜é‡èµ‹å€¼è¦†ç›– 123456console.log(foo); // [Function: foo]function foo(){ console.log(&quot;å‡½æ•°å˜é‡&quot;);}var foo = &quot;å˜é‡&quot;;console.log(typeof foo) //string ä¸‹é¢æ¥çœ‹ä¸€æ®µä»£ç  123456789{ function test(a) { console.log(typeof test); // function test = a; // 1 } test(1); console.log(typeof test); // number}console.log(typeof test); // function ç”±äºå‡½æ•°æå‡ï¼Œä¼šæå‡åˆ°å—çº§ä½œç”¨åŸŸå¤–ï¼Œæ‰€ä»¥è¾“å‡ºå¤–å±‚çš„testçš„ç±»å‹ä¸ºfunctionï¼Œç”±äºå—çº§ä½œç”¨åŸŸï¼Œå˜é‡é‡å†™åªèƒ½åœ¨å—å†…ç”Ÿæ•ˆ 2021.2.10 å—çº§ä½œç”¨åŸŸä»¥åŠTDZçš„æ–°ç†è§£ä»£ç æ‰§è¡Œçš„ç¬¬ä¸€æ­¥æ˜¯ç¼–è¯‘å¹¶åˆ›å»ºæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œvarå£°æ˜çš„å˜é‡åœ¨å˜é‡ç¯å¢ƒä¸­ï¼Œletå’Œconståœ¨è¯æ³•ç¯å¢ƒä¸­ï¼Œè¯æ³•ç¯å¢ƒå…¶å® æ˜¯ç»´æŠ¤äº†ä¸€ä¸ªå°å‹æ ˆç»“æ„ï¼Œæ ˆåº•æ˜¯æœ€å¤–å±‚çš„å˜é‡ ç¬¬äºŒæ­¥å†æ‰§è¡Œä»£ç ï¼Œå½“ä½œç”¨åŸŸæ‰§è¡Œå®Œæˆåï¼Œè¯¥ä½œç”¨åŸŸçš„ä¿¡æ¯å°±ä¼šä»è¯æ³•ç¯å¢ƒä¸­å¼¹å‡ºã€‚ è€Œå˜é‡ç»å†äº† åˆ›å»ºã€åˆå§‹åŒ–ã€èµ‹å€¼ï¼Œåˆ›å»ºå’Œåˆå§‹åŒ–æ˜¯åœ¨ç¼–è¯‘é˜¶æ®µå®Œæˆçš„ï¼Œå˜é‡å°±ä¼šæ”¾ç½®åˆ°å¯¹åº”çš„ç¯å¢ƒï¼Œä½†æ˜¯åˆå§‹åŒ–è¦çœ‹å˜é‡çš„å£°æ˜æ–¹å¼ã€‚ varçš„åˆ›å»ºå’Œåˆå§‹åŒ–è¢«æå‡ï¼Œèµ‹å€¼ä¸ä¼šè¢«æå‡ letã€constçš„åˆ›å»ºè¢«æå‡ï¼Œåˆå§‹åŒ–å’Œèµ‹å€¼ä¸ä¼šè¢«æå‡ functionçš„åˆ›å»ºã€åˆå§‹åŒ–å’Œèµ‹å€¼å‡ä¼šè¢«æå‡ æˆ‘ä»¬çœ‹å¦‚ä¸‹çš„ä»£ç  12345let myname = 'liang1'{ console.log(myname) let myname = 'liang2' // åœ¨è¯¥å—ä¸Šéƒ¨å½¢æˆäº†æš‚æ—¶æ€§æ­»åŒº} ä»£ç å‡ºç°é”™è¯¯ReferenceError: Cannot access 'myname' before initializationï¼Œå› ä¸ºåœ¨å—å†…è®¿é—®mynameçš„æ—¶å€™ï¼Œåœ¨è¯æ³•ç¯å¢ƒå†…å·²ç»æœ‰è¯¥å—å†…åˆ›å»ºçš„mynameå˜é‡ï¼Œåœ¨åˆå§‹åŒ–å‰è®¿é—®å°±æŠ¥é”™äº†ã€‚ å‚è€ƒæ–‡ç« https://zhuanlan.zhihu.com/p/126237126https://www.cnblogs.com/miacara94/p/9173843.htmlã€Šæ·±å…¥ç†è§£ES6ã€‹ ç¬¬ä¸€ç§æ–¹å¼ï¼šå‡½æ•°åªèƒ½åœ¨å£°æ˜ä¹‹åè°ƒç”¨ï¼Œå› ä¸ºè¿™ç§å‡½æ•°å£°æ˜æ˜¯åœ¨å‡½æ•°è¿è¡Œçš„é˜¶æ®µæ‰èµ‹å€¼ç»™å˜é‡ f çš„ ç¬¬äºŒç§æ–¹å¼ï¼šå‡½æ•°å¯ä»¥åœ¨å£°æ˜å‡½æ•°çš„ä½œç”¨åŸŸå†…ä»»ä¸€åœ°æ–¹è°ƒç”¨ã€‚å› ä¸ºè¿™ç§æ–¹å¼ï¼Œæ˜¯åœ¨å‡½æ•°è§£æé˜¶æ®µèµ‹å€¼ç»™æ ‡è¯†ç¬¦ f . å‡½æ•°å£°æ˜æå‡ä¼˜å…ˆäºå˜é‡æå‡ï¼Œä¸”ä¸ä¼šè¢«å˜é‡å£°æ˜è¦†ç›–ï¼Œä½†æ˜¯ä¼šè¢«å˜é‡èµ‹å€¼è¦†ç›– 123456console.log(foo); // [Function: foo]function foo(){ console.log(&quot;å‡½æ•°å˜é‡&quot;);}var foo = &quot;å˜é‡&quot;;console.log(typeof foo) //string ä¸‹é¢æ¥çœ‹ä¸€æ®µä»£ç  12345678{ function test(a) { test = a; // 1 } test(1); console.log(typeof test); // number}console.log(typeof test); // function ç”±äºå‡½æ•°æå‡ï¼Œä¼šæå‡åˆ°å—çº§ä½œç”¨åŸŸå¤–ï¼Œæ‰€ä»¥è¾“å‡ºå¤–å±‚çš„testçš„ç±»å‹ä¸ºfunctionï¼Œç”±äºå—çº§ä½œç”¨åŸŸï¼Œå˜é‡é‡å†™åªèƒ½åœ¨å—å†…ç”Ÿæ•ˆ å‚è€ƒæ–‡ç« https://zhuanlan.zhihu.com/p/126237126https://www.cnblogs.com/miacara94/p/9173843.htmlã€Šæ·±å…¥ç†è§£ES6ã€‹","link":"/2020/07/31/Js/js%E4%B8%AD%E7%9A%84%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E/"},{"title":"äº‹ä»¶ Event","text":"äº‹ä»¶æ˜¯æ‚¨åœ¨ç¼–ç¨‹æ—¶ç³»ç»Ÿå†…å‘ç”Ÿçš„åŠ¨ä½œæˆ–è€…å‘ç”Ÿçš„äº‹æƒ…â€”â€”ç³»ç»Ÿä¼šåœ¨äº‹ä»¶å‡ºç°çš„æ—¶å€™è§¦å‘æŸç§ä¿¡å·å¹¶ä¸”ä¼šæä¾›ä¸€ä¸ªè‡ªåŠ¨åŠ è½½æŸç§åŠ¨ä½œï¼Œåˆ—ä¸¾ä¸€äº›å¯èƒ½å‘ç”Ÿçš„äº‹ä»¶ã€‚ ç”¨æˆ·åœ¨æŸä¸ªå…ƒç´ ä¸Šç‚¹å‡»é¼ æ ‡æˆ–æ‚¬åœå…‰æ ‡ã€‚ ç”¨æˆ·åœ¨é”®ç›˜ä¸­æŒ‰ä¸‹æŸä¸ªæŒ‰é”®ã€‚ ç”¨æˆ·è°ƒæ•´æµè§ˆå™¨çš„å¤§å°æˆ–è€…å…³é—­æµè§ˆå™¨çª—å£ã€‚ ä¸€ä¸ªç½‘é¡µåœæ­¢åŠ è½½ã€‚ æäº¤è¡¨å•ã€‚ æ’­æ”¾ã€æš‚åœã€å…³é—­è§†é¢‘ã€‚ å‘ç”Ÿé”™è¯¯ã€‚ 1.äº‹ä»¶å¤„ç†å™¨å¯ä»¥ä¸ºæ¯ä¸€ä¸ªäº‹ä»¶ç»‘å®šä¸€ä¸ªäº‹ä»¶å¤„ç†å™¨(äº‹ä»¶ç›‘å¬å™¨)ï¼Œç”¨ä»¥äº‹ä»¶è¢«æ¿€å‘æ—¶åšå‡ºçš„å›åº”ï¼Œæœ‰ä¸‰ç§äº‹ä»¶å¤„ç†å™¨ã€‚ 1.1 äº‹ä»¶å¤„ç†å™¨å±æ€§ï¼ˆDOM0çº§ï¼‰12var btn = document.querySelector('button');btn.onclick = function(event){alert('Hello world');}; è¯¥å‡½æ•°åœ¨å®šä¹‰æ—¶ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ª event å½¢å¼çš„å‚æ•°ï¼Œè¯¥æ–¹å¼çš„é—®é¢˜åœ¨äºä¸€æ¬¡åªèƒ½ç»‘å®šä¸€ä¸ªã€‚ é™¤äº†onclickè¿˜æœ‰ä¸€äº›å¸¸è§çš„äº‹ä»¶å¤„ç†å™¨å±æ€§ äº‹ä»¶å¤„ç†å™¨å±æ€§ å¤‡æ³¨ btn.onfocus å½“å‰å…ƒç´ è·å¾—é”®ç›˜ç„¦ç‚¹æ—¶ä¼šè§¦å‘focusäº‹ä»¶ btn.onblur å½“ä¸€ä¸ªå…ƒç´ å¤±å»ç„¦ç‚¹æ—¶ä¼šè§¦å‘bluräº‹ä»¶ btn.ondblclick å½“å‰å…ƒç´ ä¸ŠåŒå‡»é¼ æ ‡å·¦é”®ä¼šè§¦å‘dblclickäº‹ä»¶ window.onkeypress å½“ç”¨æˆ·åœ¨é”®ç›˜ä¸ŠæŒ‰ä¸‹ä»»æ„é”®æ—¶ï¼Œåº”å½“ä¼šè§¦å‘ keypress äº‹ä»¶ window.onkeydown å½“ç”¨æˆ·æŒ‰ä¸‹é”®ç›˜ä¸Šçš„æŒ‰é”®æ—¶ä¼šè§¦å‘keydownäº‹ä»¶ window.onkeyup åœ¨å½“å‰å…ƒç´ ä¸Šé‡Šæ”¾é”®ç›˜æŒ‰é”®æ—¶ä¼šè§¦å‘keyupäº‹ä»¶ btn.onmouseover å½“é¼ æ ‡ç§»åŠ¨åˆ°ä¸€ä¸ªå…ƒç´ ä¸Šæ—¶,ä¼šåœ¨è¿™ä¸ªå…ƒç´ ä¸Šè§¦å‘mouseoveräº‹ä»¶ btn.onmouseout å½“é¼ æ ‡ç¦»å¼€ä¸€ä¸ªå…ƒç´ æ—¶,ä¼šåœ¨è¿™ä¸ªå…ƒç´ ä¸Šè§¦å‘mouseoutäº‹ä»¶ 1.2 è¡Œå†…äº‹ä»¶å¤„ç†å™¨ - è¯·å‹¿ä½¿ç”¨1&lt;button onclick=&quot;alert('Hello World');&quot;&gt;Press me&lt;/button&gt; æˆ‘ä»¬åº”è¯¥é¿å…ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚å› ä¸ºå®ƒä¼šä½¿æ ‡è®°æ•°é‡å˜å¤§ï¼Œè€Œå¯è¯»æ€§å´è¾ƒå·®ã€‚ å†…å®¹/ç»“æ„ å’Œ è¡Œä¸ºä¹‹é—´æ²¡æœ‰å¾ˆå¥½çš„åˆ†ç¦»ï¼Œä½¿å¾—åœ¨å¤„ç†bugæ—¶éå¸¸å›°éš¾ã€‚ 1.3 addEventListener()ï¼ˆDOM2çº§ï¼‰12var btn = document.querySelector('button');btn.addEventListener('click', function(){alert('Hello world');}, false); addEventListener()å‚æ•° å‚æ•°å ä¼ å…¥å‚æ•° type è¡¨ç¤ºç›‘å¬äº‹ä»¶ç±»å‹çš„å­—ç¬¦ä¸²ã€‚ listener å®ç°äº†Eventæ¥å£çš„å¯¹è±¡æˆ–è€…å‡½æ•° options å¯é€‰ ä¸€ä¸ªæŒ‡å®šæœ‰å…³ listenerå±æ€§çš„å¯é€‰å‚æ•°å¯¹è±¡ useCapture å¯é€‰ Booleanï¼Œé»˜è®¤ä¸ºfalseï¼Œåœ¨äº‹ä»¶å†’æ³¡é˜¶æ®µè°ƒç”¨äº‹ä»¶å¤„ç†ç¨‹åºï¼Œåä¹‹ä¸ºæ•è· addEventListener()è¿”å›å€¼undefined åœ¨DOM2çº§å¯ä»¥ç»™åŒä¸€ä¸ªç›‘å¬å™¨æ³¨å†Œå¤šä¸ªå¤„ç†å™¨ï¼Œè€ŒDOM0çº§ä¸èƒ½å®ç°è¿™ä¸€ç‚¹ï¼š 12myElement.onclick = functionA;myElement.onclick = functionB; ç¬¬äºŒè¡Œä¼šè¦†ç›–ç¬¬ä¸€è¡Œï¼Œä½†æ˜¯ä¸‹é¢è¿™ç§æ–¹å¼å°±ä¼šæ­£å¸¸å·¥ä½œäº†ï¼š 12myElement.addEventListener('click', functionA);myElement.addEventListener('click', functionB); å½“å…ƒç´ è¢«ç‚¹å‡»æ—¶ä¸¤ä¸ªå‡½æ•°éƒ½ä¼šå·¥ä½œ æ³¨æ„ï¼šé€šè¿‡addEventListener()æ·»åŠ çš„äº‹ä»¶å¤„ç†ç¨‹åºåªèƒ½ç”¨removeEventListener()æ¥ç§»é™¤ï¼Œå¹¶ä¸”ç§»é™¤æ—¶ä¼ å…¥çš„å‚æ•°å¿…é¡»ä¸æ·»åŠ æ—¶ä¼ å…¥çš„å‚æ•°ä¸€æ ·ã€‚ 1.4 IEäº‹ä»¶å¤„ç†å™¨IEç”¨äº†attachEvent()ï¼ŒdetachEvent()ï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œäº‹ä»¶åç§°ã€äº‹ä»¶å¤„ç†ç¨‹åºï¼Œé€šè¿‡ attachEvent() æ·»åŠ çš„äº‹ä»¶å¤„ç†ç¨‹åºéƒ½ä¼šè¢«æ·»åŠ åˆ°å†’æ³¡é˜¶æ®µ,æ‰€ä»¥å¹³æ—¶ä¸ºäº†å…¼å®¹æ›´å¤šçš„æµè§ˆå™¨æœ€å¥½å°†äº‹ä»¶æ·»åŠ åˆ°äº‹ä»¶å†’æ³¡é˜¶æ®µ,IE8åŠä»¥å‰åªæ”¯æŒäº‹ä»¶å†’æ³¡; ä¾‹å­ï¼š 12345var btn = document.getElementById('btn');var handlers = function(){ console.log(this === window); //true,æ³¨æ„attachEvent()æ·»åŠ çš„äº‹ä»¶å¤„ç†ç¨‹åºè¿è¡Œåœ¨å…¨å±€ä½œç”¨åŸŸä¸­;};btn.attachEvent('onclick', handlers); è·¨æµè§ˆå™¨äº‹ä»¶å¤„ç†ç¨‹åº12345678910111213141516171819202122//åˆ›å»ºçš„æ–¹æ³•æ˜¯addHandlers(),removeHandlers(),è¿™ä¸¤ä¸ªæ–¹æ³•å±äºä¸€ä¸ªå«EventUtilçš„å¯¹è±¡;ä½†æ˜¯è¿™ä¸ªæ²¡æœ‰è€ƒè™‘åˆ°IEä¸­ä½œç”¨åŸŸçš„é—®é¢˜ï¼Œä¸è¿‡å°±æ·»åŠ å’Œç§»é™¤äº‹ä»¶è¿˜æ˜¯è¶³å¤Ÿçš„ã€‚ var EventUtil = { addHandlers: function (element, type, handlers) { if (element.addEventListener) { element.addEventListener(type, handlers, false); } else if (element.attachEvent) { element.attachEvent(on + type, handlers); } else { element['on' + type] = handlers; } }, removeHandlers: function (element, type, handlers) { if (element.removeEventListener) { element.removeEventListener(type, handlers, false); } else if (element.detachEvent) { element.detachEvent(on + type, handlers); } else { element['on' + type] = null; } }}; ä¾‹å­ï¼š 123456var btn = document.getElementById('btn');var handlers = function() { console.log('123')};EventUtil.addHandlers(btn, 'click', handlers);EventUtil.removeHandlers(btn, 'click', handlers); åœ¨åŒä¸€ä¸ªå¯¹è±¡ä¸Šæ³¨å†Œäº‹ä»¶ï¼Œå¹¶ä¸ä¸€å®šæŒ‰ç…§æ³¨å†Œé¡ºåºæ‰§è¡Œï¼Œå†’æ³¡æˆ–æ•è·æ¨¡å¼ä¼šå½±å“å…¶è¢«è§¦å‘çš„é¡ºåº 2.äº‹ä»¶å†’æ³¡åŠæ•è·å½“ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿåœ¨å…·æœ‰çˆ¶å…ƒç´ çš„å…ƒç´ ä¸Šï¼Œç°ä»£æµè§ˆå™¨è¿è¡Œä¸¤ä¸ªä¸åŒçš„é˜¶æ®µâ€”â€”æ•è·é˜¶æ®µå’Œå†’æ³¡é˜¶æ®µã€‚ 2.1æ•è·é˜¶æ®µ æµè§ˆå™¨æ£€æŸ¥å…ƒç´ çš„æœ€å¤–å±‚ç¥–å…ˆ&lt;html&gt;ï¼Œæ˜¯å¦åœ¨æ•è·é˜¶æ®µä¸­æ³¨å†Œäº†ä¸€ä¸ªonclickäº‹ä»¶å¤„ç†ç¨‹åºï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿è¡Œå®ƒã€‚ ç„¶åï¼Œå®ƒç§»åŠ¨åˆ°&lt;html&gt;ä¸­å•å‡»å…ƒç´ çš„ä¸‹ä¸€ä¸ªç¥–å…ˆå…ƒç´ ï¼Œå¹¶æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œç„¶åæ˜¯å•å‡»å…ƒç´ å†ä¸‹ä¸€ä¸ªç¥–å…ˆå…ƒç´ ï¼Œä¾æ­¤ç±»æ¨ï¼Œç›´åˆ°åˆ°è¾¾å®é™…ç‚¹å‡»çš„å…ƒç´ ã€‚ 2.2å†’æ³¡é˜¶æ®µ æµè§ˆå™¨æ£€æŸ¥å®é™…ç‚¹å‡»çš„å…ƒç´ æ˜¯å¦åœ¨å†’æ³¡é˜¶æ®µä¸­æ³¨å†Œäº†ä¸€ä¸ªonclickäº‹ä»¶å¤„ç†ç¨‹åºï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿è¡Œå®ƒ ç„¶åå®ƒç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªç›´æ¥çš„ç¥–å…ˆå…ƒç´ ï¼Œå¹¶åšåŒæ ·çš„äº‹æƒ…ï¼Œç„¶åæ˜¯ä¸‹ä¸€ä¸ªï¼Œç­‰ç­‰ï¼Œç›´åˆ°å®ƒåˆ°è¾¾&lt;html&gt;å…ƒç´ ã€‚ 2.3ç”¨stopPropagation()ä¿®å¤é—®é¢˜å½“åœ¨äº‹ä»¶å¯¹è±¡ä¸Šè°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œå®ƒåªä¼šè®©å½“å‰äº‹ä»¶å¤„ç†ç¨‹åºè¿è¡Œï¼Œä½†äº‹ä»¶ä¸ä¼šåœ¨å†’æ³¡é“¾ä¸Šè¿›ä¸€æ­¥æ‰©å¤§ï¼Œå› æ­¤å°†ä¸ä¼šæœ‰æ›´å¤šäº‹ä»¶å¤„ç†å™¨è¢«è¿è¡Œ(ä¸ä¼šå‘ä¸Šå†’æ³¡)ã€‚ 3.äº‹ä»¶å¯¹è±¡ eventeventï¼Œevtæˆ–ç®€å•çš„eã€‚ è¿™è¢«ç§°ä¸ºäº‹ä»¶å¯¹è±¡ï¼Œå®ƒè¢«è‡ªåŠ¨ä¼ é€’ç»™äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œä»¥æä¾›é¢å¤–çš„åŠŸèƒ½å’Œä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š 123456function bgChange(e) { var rndCol = 'rgb(' + random(255) + ',' + random(255) + ',' + random(255) + ')'; e.target.style.backgroundColor = rndCol; console.log(e);} btn.addEventListener('click', bgChange); äº‹ä»¶å¯¹è±¡ e çš„targetå±æ€§å§‹ç»ˆæ˜¯äº‹ä»¶åˆšåˆšå‘ç”Ÿçš„å…ƒç´ çš„å¼•ç”¨ã€‚ è·¨æµè§ˆå™¨çš„äº‹ä»¶å¯¹è±¡è™½ç„¶DOMå’ŒIEä¸­å¯¹è±¡ä¸åŒï¼Œä½†æ˜¯ä¸¤è€…eventä¸­çš„å…¨éƒ¨ä¿¡æ¯å’Œæ–¹æ³•éƒ½æ˜¯ç±»ä¼¼çš„åªæ˜¯å®ç°æ–¹å¼ä¸åŒï¼Œå¯ä»¥ç”¨å‰é¢æåˆ°è¿‡çš„EventUtilå¯¹è±¡æ¥æ±‚åŒå­˜å¼‚ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546var EventUtil = { addHandler: function (element, type, handler) { if (element.addEventListener) { element.addEventListener(type, handler, false); } else if (element.attachEvent) { element.attachEvent(on + type, handler); } else { element['on' + type] = handler; } }, getEvent: function (event) { return event ? event : window.event; }, getTarget: function (event) { return event.target || event.srcElement; }, preventDefault: function (event) { if (event.preventDefault) { event.preventDefault(); } else { event.returnValue = false; } }, stopPropagation: function (event) { if (event.stopPropagation) { event.stopPropagation(); } else { event.cancelBubble = true; } }, removeHandler: function (element, type, handler) { if (element.removeEventListener) { element.removeEventListener(type, handler, false); } else if (element.detachEvent) { element.detachEvent(on + type, handler); } else { element['on' + type] = null } }}; 4.äº‹ä»¶å§”æ‰˜4.1 é—®é¢˜åˆç°ç»™100ä¸ªæŒ‰é’®ç»‘å®šäº‹ä»¶ï¼Œä¼ ç»Ÿçš„åšæ³•å°±æ˜¯ï¼šé€šè¿‡DOMæ“ä½œè·å–æ¯ä¸€ä¸ªæŒ‰é’®å…ƒç´ åˆ†åˆ«ç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°ã€‚ ä½†åœ¨JavaScriptä¸­ï¼Œæ·»åŠ åˆ°é¡µé¢ä¸Šçš„äº‹ä»¶å¤„ç†ç¨‹åºæ•°é‡å°†ç›´æ¥å…³ç³»åˆ°é¡µé¢çš„æ•´ä½“è¿è¡Œæ€§èƒ½ï¼Œå› ä¸ºéœ€è¦ä¸æ–­çš„ä¸domèŠ‚ç‚¹è¿›è¡Œäº¤äº’ï¼Œè®¿é—®domçš„æ¬¡æ•°è¶Šå¤šï¼Œå¼•èµ·æµè§ˆå™¨é‡ç»˜ä¸é‡æ’çš„æ¬¡æ•°ä¹Ÿå°±è¶Šå¤šï¼Œå°±ä¼šå»¶é•¿æ•´ä¸ªé¡µé¢çš„äº¤äº’å°±ç»ªæ—¶é—´ã€‚ è€Œæ¯ä¸€ä¸ªå‡½æ•°éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥éƒ½ä¼šå ç”¨å†…å­˜ï¼Œå†…å­˜å ç”¨çš„è¶Šå¤šæ€§èƒ½æ¯‹åº¸ç½®ç–‘çš„ä¼šå˜å¾—è¶Šå·®ã€‚ 4.2 è§£å†³æ–¹æ¡ˆâ€”â€”äº‹ä»¶å§”æ‰˜äº‹ä»¶å§”æ‰˜å°±æ˜¯åˆ©ç”¨äº‹ä»¶å†’æ³¡ï¼Œå³ï¼šåˆ©ç”¨å†’æ³¡æœºåˆ¶å°†ä¸€ç±»äº‹ä»¶è§¦å‘å°½å¯èƒ½é«˜çš„å§”æ‰˜ç»™å…¶çˆ¶èŠ‚ç‚¹æˆ–ç¥–å…ˆèŠ‚ç‚¹æ¥è§¦å‘äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè¿™æ ·åªéœ€è¦å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè®¿é—®ä¸€æ¬¡DOMå¯¹è±¡ï¼Œå‡å°‘äº†å†…å­˜çš„å ç”¨ä»¥åŠè®¿é—®DOMå…ƒç´ çš„æ—¶é—´ï¼Œé™ä½äº†æ€§èƒ½çš„æ¶ˆè€—ã€‚ ä¾‹å­ï¼šç‚¹å‡»æŸä¸€ä¸ª Li æ ‡ç­¾æ—¶ï¼Œå°† Li çš„èƒŒæ™¯è‰²æ˜¾ç¤ºåœ¨ P æ ‡ç­¾å†…ï¼Œå¹¶å°† P æ ‡ç­¾ä¸­çš„æ–‡å­—é¢œè‰²è®¾ç½®æˆ Li çš„èƒŒæ™¯è‰²ï¼Œä¸‹é¢æ˜¯html 123456789101112&lt;ul class=&quot;palette&quot;&gt; &lt;li style=&quot;background-color:crimson&quot;&gt;&lt;/li&gt; &lt;li style=&quot;background-color:bisque&quot;&gt;&lt;/li&gt; &lt;li style=&quot;background-color:blueviolet&quot;&gt;&lt;/li&gt; &lt;li style=&quot;background-color:coral&quot;&gt;&lt;/li&gt; &lt;li style=&quot;background-color:chartreuse&quot;&gt;&lt;/li&gt; &lt;li style=&quot;background-color:darkolivegreen&quot;&gt;&lt;/li&gt; &lt;li style=&quot;background-color:cyan&quot;&gt;&lt;/li&gt; &lt;li style=&quot;background-color:#194738&quot;&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;color-picker&quot;&gt;&lt;/p&gt; å®ç°æ–¹æ³• 1234567891011const list = document.querySelector(&quot;.palette&quot;);list.onclick = function(e) { e = e || window.event; const t = e.target || e.srcElement; const p = document.getElementsByClassName('color-picker')[0]; if (t.nodeName.toLowerCase() === 'li') { p.innerHTML = t.style.backgroundColor; p.style.color = t.style.backgroundColor; }} é€‚åˆäº‹ä»¶å§”æ‰˜çš„äº‹ä»¶æœ‰ï¼šclickï¼Œmousedownï¼Œmouseupï¼Œkeydownï¼Œkeyupï¼Œkeypressã€‚ å‚è€ƒæ–‡ç« https://www.cnblogs.com/lazychen/p/5664788.html","link":"/2020/07/31/Js/%E4%BA%8B%E4%BB%B6-Event/"},{"title":"å®šä½ä¸å±‚çº§","text":"1. å®šä½ position1.1 é™æ€å®šä½ staticæ¯ä¸ªå…ƒç´ çš„é»˜è®¤å€¼ï¼Œå°†å…ƒç´ æ”¾å…¥å®ƒåœ¨æ–‡æ¡£å¸ƒå±€æµä¸­çš„æ­£å¸¸ä½ç½®ã€‚ 1.2 ç›¸å¯¹å®šä½ relativeå¼€å¯å®šä½åï¼Œå¯ä»¥ä½¿ç”¨topã€rightã€bottomï¼Œleftå››ä¸ªå±æ€§è®¾ç½®åç§»é‡ã€‚é€‰æ‹©ä¸€ä¸ªå‚ç›´æ–¹å‘å’Œç«–ç›´æ–¹å‘ä¸Šçš„åç§»é‡å³å¯ä¸ºä¸€ä¸ªå…ƒç´ å®šä½ã€‚ è¦ç‚¹ ç›¸å¯¹å®šä½çš„å…ƒç´ ä¸ä¼šè„±ç¦»æ–‡æ¡£æµ å¼€å¯ç›¸å¯¹å®šä½åï¼Œå¦‚æœä¸è®¾ç½®åç§»é‡ï¼Œå…ƒç´ ä¸ä¼šå‘ç”Ÿä»»ä½•å˜åŒ– ç›¸å¯¹å®šä½æ˜¯ç›¸å¯¹äºå…ƒç´ åœ¨æ–‡æ¡£æµä¸­åŸæ¥çš„ä½ç½®è¿›è¡Œå®šä½ ç›¸å¯¹å®šä½ä¼šä½¿å…ƒç´ æå‡ä¸€ä¸ªå±‚çº§ ç›¸å¯¹å®šä½ä¸ä¼šæ”¹å˜å…ƒç´ çš„æ€§è´¨ 1.3 ç»å¯¹å®šä½ absoluteå®šä½æ–¹å¼åŒä¸Š è¦ç‚¹ ç»å¯¹å®šä½çš„å…ƒç´ ä¼šè„±ç¦»æ–‡æ¡£æµ å¼€å¯ç»å¯¹å®šä½åï¼Œå¦‚æœä¸è®¾ç½®åç§»é‡ï¼Œå…ƒç´ ä¸ä¼šå‘ç”Ÿä»»ä½•å˜åŒ– ç»å¯¹å®šä½æ˜¯ç›¸å¯¹äºç¦»ä»–æœ€è¿‘çš„å¼€å¯äº†å®šä½çš„ç¥–å…ˆå…ƒç´ è¿›è¡Œå®šä½çš„ï¼ˆä¸€èˆ¬æƒ…å†µï¼Œå¼€å¯äº†å­å…ƒç´ çš„ç»å¯¹å®šä½éƒ½ä¼šåŒæ—¶å¼€å¯çˆ¶å…ƒç´ çš„ç›¸å¯¹å®šä½ï¼‰ - å¦‚æœæ‰€æœ‰çš„ç¥–å…ˆå…ƒç´ éƒ½æ²¡æœ‰å¼€å¯å®šä½ï¼Œåˆ™ä¼šç›¸å¯¹äºæµè§ˆå™¨çª—å£è¿›è¡Œå®šä½ ç»å¯¹å®šä½ä¼šä½¿å…ƒç´ æå‡ä¸€ä¸ªå±‚çº§ ç»å¯¹å®šä½ä¼šæ”¹å˜å…ƒç´ çš„æ€§è´¨ - å†…è”å…ƒç´ å˜å—å…ƒç´  - å—å…ƒç´ çš„å®½åº¦å’Œé«˜åº¦é»˜è®¤éƒ½è¢«å†…å®¹æ’‘å¼€ 1.4 å›ºå®šå®šä½ fixedâ€‹ å®šä½æ–¹å¼åŒä¸Š è¦ç‚¹å›ºå®šå®šä½ä¹Ÿæ˜¯ä¸€ç§ç»å¯¹å®šä½ï¼Œå¤§éƒ¨åˆ†ç‰¹ç‚¹ä¸ç»å¯¹å®šä½ä¸€è‡´ï¼Œä¸åŒçš„æ˜¯ å›ºå®šå®šä½æ°¸è¿œéƒ½ä¼šç›¸å¯¹äºæµè§ˆå™¨çª—å£è¿›è¡Œå®šä½ å›ºå®šå®šä½ä¼šå›ºå®šåœ¨æµè§ˆå™¨çª—å£æŸä¸ªä½ç½®ï¼Œä¸ä¼šéšæ»šåŠ¨æ¡æ»šåŠ¨ IE6ä¸æ”¯æŒå›ºå®šå®šä½ 2.å±‚çº§ z-indexè¦ç‚¹ å¦‚æœå®šä½å…ƒç´ çš„å±‚çº§æ˜¯ä¸€æ ·ï¼Œåˆ™ä¸‹è¾¹çš„å…ƒç´ ä¼šç›–ä½ä¸Šè¾¹çš„ å±‚çº§è¶Šé«˜ï¼Œè¶Šä¼˜å…ˆæ˜¾ç¤º å¯¹äºæ²¡æœ‰å¼€å¯å®šä½çš„å…ƒç´ ä¸èƒ½ä½¿ç”¨z-index å®šä½çš„å…ƒç´ éƒ½å…·æœ‰z-indexä¸ºautoï¼Œå®é™…ä¸Šä¸º0","link":"/2020/07/31/Css/%E5%AE%9A%E4%BD%8D%E4%B8%8E%E5%B1%82%E7%BA%A7/"},{"title":"æµ®åŠ¨ä¸BFC","text":"1. æµ®åŠ¨çš„å·¥ä½œåŸç†æµ®åŠ¨ä¼šè„±ç¦»æ­£å¸¸çš„æ–‡æ¡£æµï¼Œå¹¶å¸é™„åˆ°å…¶çˆ¶å®¹å™¨å·¦è¾¹ï¼Œæ­£å¸¸å¸ƒå±€ä¸­ä½äºæµ®åŠ¨å…ƒç´ ä¸‹çš„å†…å®¹ä¼šå›´ç»•ç€æµ®åŠ¨å…ƒç´  2.å¯é€‰å€¼ å€¼ æ•ˆæœ none é»˜è®¤å€¼ï¼Œå…ƒç´ é»˜è®¤åœ¨æ–‡æ¡£æµä¸­æ’åˆ— left å…ƒç´ ä¼šç«‹å³è„±ç¦»æ–‡æ¡£æµï¼Œå‘é¡µé¢çš„å·¦ä¾§æµ®åŠ¨ right å…ƒç´ ä¼šç«‹å³è„±ç¦»æ–‡æ¡£æµï¼Œå‘é¡µé¢çš„å³ä¾§æµ®åŠ¨ 3.æµ®åŠ¨çš„è§„åˆ™å†…è”å…ƒç´ å˜å—å…ƒç´ å½“ä¸ºä¸€ä¸ªå…ƒç´ è®¾ç½®æµ®åŠ¨ä»¥åï¼ˆfloatå±æ€§æ˜¯ä¸€ä¸ªénoneçš„å€¼ï¼‰ï¼Œå…ƒç´ ä¼šç«‹å³è„±ç¦»æ–‡æ¡£æµï¼Œå…ƒç´ è„±ç¦»æ–‡æ¡£æµä»¥åï¼Œå®ƒä¸‹è¾¹çš„å…ƒç´ ä¼šç«‹å³å‘ä¸Šç§»åŠ¨ï¼Œå…ƒç´ æµ®åŠ¨ä»¥åï¼Œä¼šå°½é‡å‘é¡µé¢çš„å·¦ä¸Šæˆ–è¿™æ˜¯å³ä¸Šæ¼‚æµ®ï¼Œç›´åˆ°é‡åˆ°çˆ¶å…ƒç´ çš„è¾¹æ¡†æˆ–è€…å…¶ä»–çš„æµ®åŠ¨å…ƒç´ å¦‚æœæµ®åŠ¨å…ƒç´ ä¸Šè¾¹æ˜¯ä¸€ä¸ªæ²¡æœ‰æµ®åŠ¨çš„å—å…ƒç´ ï¼Œåˆ™æµ®åŠ¨å…ƒç´ ä¸ä¼šè¶…è¿‡å—å…ƒç´ ï¼Œæµ®åŠ¨çš„å…ƒç´ ä¸ä¼šè¶…è¿‡ä»–ä¸Šè¾¹çš„å…„å¼Ÿå…ƒç´ ï¼Œæœ€å¤šæœ€å¤šä¸€è¾¹é½ã€‚ 4.æµ®åŠ¨çš„åŒ…è£¹æ€§æŒ‡çš„æ˜¯å…ƒç´ å°ºå¯¸åˆšå¥½å®¹çº³å†…å®¹, è¡¨ç°å¾—å°±åƒdiaplay:inline-block ä¸€æ ·å…·æœ‰åŒ…è£¹æ€§çš„å…¶ä»–å±æ€§: 123display:inline-blockposition:absolute/fixed/stickyoverflow:hidden/scroll 5. æµ®åŠ¨çš„ç ´åæ€§ä¼šä½¿çˆ¶å…ƒç´ é«˜åº¦å¡Œé™·â€”â€”ä¸ºäº†å®ç°æ–‡å­—ç¯ç»•æ•ˆæœ å…·æœ‰ç ´åæ€§çš„å…¶ä»–å±æ€§: 12display:noneposition:absolute/fixed/sticky 6.æ¸…é™¤æµ®åŠ¨ clearæ¸…é™¤æ‰å…¶ä»–å…ƒç´ æµ®åŠ¨å¯¹å½“å‰å…ƒç´ äº§ç”Ÿçš„å½±å“ å¯é€‰å€¼ å€¼ æ•ˆæœ none é»˜è®¤å€¼ï¼Œä¸æ¸…é™¤æµ®åŠ¨ left æ¸…é™¤å·¦ä¾§æµ®åŠ¨å…ƒç´ å¯¹å½“å‰å…ƒç´ çš„å½±å“ right æ¸…é™¤å³ä¾§æµ®åŠ¨å…ƒç´ å¯¹å½“å‰å…ƒç´ çš„å½±å“ both æ¸…é™¤ä¸¤ä¾§æµ®åŠ¨å…ƒç´ å¯¹å½“å‰å…ƒç´ çš„å½±å“ 7.è§£å†³é«˜åº¦å¡Œé™·7.1 BFCæ ¹æ®W3Cçš„æ ‡å‡†ï¼Œåœ¨é¡µé¢ä¸­å…ƒç´ éƒ½ä¸€ä¸ªéšå«çš„å±æ€§å«åšå—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡(Block Formatting Context)ï¼Œæ˜¯å—ç›’å­çš„å¸ƒå±€è¿‡ç¨‹å‘ç”Ÿçš„åŒºåŸŸï¼Œä¹Ÿæ˜¯æµ®åŠ¨å…ƒç´ ä¸å…¶ä»–å…ƒç´ äº¤äº’çš„åŒºåŸŸï¼Œå¯ä»¥è®¾ç½®æ‰“å¼€æˆ–è€…å…³é—­ï¼Œé»˜è®¤æ˜¯ä¸ºå…³é—­çš„ã€‚ BFCæ‰“å¼€æ–¹å¼ è®¾ç½®çˆ¶å…ƒç´ å…ƒç´ æµ®åŠ¨ - ä½¿ç”¨è¿™ç§æ–¹å¼å¼€å¯ï¼Œè™½ç„¶å¯ä»¥æ’‘å¼€çˆ¶å…ƒç´ ï¼Œä½†æ˜¯ä¼šå¯¼è‡´çˆ¶å…ƒç´ çš„å®½åº¦ä¸¢å¤±ã€‚ - è€Œä¸”ä½¿ç”¨è¿™ç§æ–¹å¼ä¹Ÿä¼šå¯¼è‡´ä¸‹è¾¹çš„å…ƒç´ ä¸Šç§»ï¼Œä¸èƒ½è§£å†³é—®é¢˜ã€‚ è®¾ç½®å…ƒç´ ç»å¯¹å®šä½ è®¾ç½®å…ƒç´ ä¸ºflex-boxï¼Œgrid æˆ– display: table-cell / table-caption / inline-block - å¯ä»¥è§£å†³é—®é¢˜ï¼Œä½†æ˜¯ä¼šå¯¼è‡´å®½åº¦ä¸¢å¤±ï¼Œä¸æ¨èä½¿ç”¨è¿™ç§æ–¹å¼ å°†å…ƒç´ çš„overflowè®¾ç½®ä¸ºä¸€ä¸ªévisibleçš„å€¼ - æ­¤ä¸ºå‰¯ä½œç”¨æœ€å°çš„æ–¹å¼ BFCç‰¹æ€§ åˆ›å»ºäº†BFCçš„å…ƒç´ ä¸­ï¼Œå­æµ®åŠ¨å…ƒç´ ä¹Ÿä¼šå‚ä¸é«˜åº¦è®¡ç®—ï¼Œå³çˆ¶å…ƒç´ çš„å‚ç›´å¤–è¾¹è·ä¸ä¼šå’Œå­å…ƒç´ é‡å ã€‚ å¼€å¯BFCçš„å…ƒç´ æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å®¹å™¨ï¼Œå­å…ƒç´ ä¸ä¼šå½±å“å¤–é¢çš„å…ƒç´ ï¼Œåä¹‹äº¦ç„¶â€”â€”å¯ä»¥è§£å†³å¤–è¾¹è·åˆå¹¶çš„é—®é¢˜ å¼€å¯BFCçš„å…ƒç´  å¼€å¯BFCçš„å…ƒç´ å¯ä»¥åŒ…å«æµ®åŠ¨çš„å­å…ƒç´  ç”±æ­¤å¾—åˆ°è§£å†³é«˜åº¦å¡Œé™·çš„ç¬¬ä¸€ç§æ–¹æ³• 1overflow: hidden; IE6åŠä»¥ä¸‹çš„æµè§ˆå™¨ä¸­å¹¶ä¸æ”¯æŒBFCï¼Œæ‰€ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼ä¸èƒ½å…¼å®¹IE6ã€‚ åœ¨IE6ä¸­è™½ç„¶æ²¡æœ‰BFCï¼Œä½†æ˜¯å…·æœ‰å¦ä¸€ä¸ªéšå«çš„å±æ€§å«åšhasLayoutï¼Œè¯¥å±æ€§çš„ä½œç”¨å’ŒBFCç±»ä¼¼ï¼Œæ‰€åœ¨IE6æµè§ˆå™¨å¯ä»¥é€šè¿‡å¼€hasLayoutæ¥è§£å†³è¯¥é—®é¢˜å¼€å¯æ–¹å¼å¾ˆå¤šï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨ä¸€ç§å‰¯ä½œç”¨æœ€å°çš„ï¼šzoom: 1; æœ€åå¾—åˆ°ä»¥ä¸‹å½¢å¼ 123overflow: hidden;/* zoomè¡¨ç¤ºæ”¾å¤§çš„æ„æ€ï¼Œåªåœ¨IEä¸­æ”¯æŒ */zoom: 1; 7.2 ç”¨ç©ºç™½å…ƒç´ è®¾ç½®clear:bothå¯ä»¥ç›´æ¥åœ¨é«˜åº¦å¡Œé™·çš„çˆ¶å…ƒç´ çš„æœ€åï¼Œæ·»åŠ ä¸€ä¸ªç©ºç™½çš„divï¼Œç”±äºè¿™ä¸ªdivå¹¶æ²¡æœ‰æµ®åŠ¨ï¼Œæ‰€ä»¥ä»–æ˜¯å¯ä»¥æ’‘å¼€çˆ¶å…ƒç´ çš„é«˜åº¦çš„ï¼Œç„¶ååœ¨å¯¹å…¶è¿›è¡Œæ¸…é™¤æµ®åŠ¨ï¼Œè¿™æ ·å¯ä»¥é€šè¿‡è¿™ä¸ªç©ºç™½çš„divæ¥æ’‘å¼€çˆ¶å…ƒç´ çš„é«˜åº¦ï¼ŒåŸºæœ¬æ²¡æœ‰å‰¯ä½œç”¨ã€‚ 123.clear { clear: both;} 1234&lt;div class=&quot;box1&quot;&gt; &lt;div class=&quot;box&quot;&gt;&lt;/div&gt; &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;&lt;/div&gt; è™½ç„¶å¯ä»¥è§£å†³é—®é¢˜ï¼Œä½†ä¼šåœ¨æ–‡æ¡£ä¸­æ·»åŠ å¤šä½™çš„ç»“æ„ï¼Œä¸ç¬¦åˆç»“æ„ä¸è¡¨ç°åˆ†ç¦»çš„æ€æƒ³ã€‚ 7.3 éšå¼å…ƒç´ ç”±7.2çš„æ–¹æ³•å¯ä»¥æƒ³åˆ°ç”¨csså®ç°çš„æ–¹æ³• 123456789101112.clearfix:after { /* æ·»åŠ ä¸€ä¸ªå†…å®¹ */ content: &quot;&quot;; /* è½¬æ¢ä¸ºä¸€ä¸ªå—å…ƒç´  */ display: block; /* æ¸…é™¤ä¸¤ä¾§çš„æµ®åŠ¨ */ clear: both;}/* å…¼å®¹IE6 */.clearfix { zoom:1;} å‚è€ƒæ–‡ç« http://ife.baidu.com/note/detail/id/959","link":"/2020/07/31/Css/%E6%B5%AE%E5%8A%A8%E4%B8%8EBFC/"},{"title":"Javaçš„å­—ç¬¦ä¸²æ“ä½œ","text":"ä¸€ã€æ¯”è¾ƒ è¯­è¨€ æ“ä½œ å½¢å¼ æœºåˆ¶ çº¿ç¨‹å®‰å…¨æ€§ c/c++ char* å­—ç¬¦æŒ‡é’ˆ é€šè¿‡æ‰‹åŠ¨ä¿®æ”¹æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ç©ºé—´ä¿®æ”¹å­—ç¬¦ä¸² æœªçŸ¥ c/c++ String å®¹å™¨ç±» å†…éƒ¨ä½¿ç”¨charæ•°ç»„å­˜å‚¨å­—ç¬¦ï¼Œä½†å†…å­˜ç®¡ç†ï¼Œåˆ†é…å’Œnullç»ˆæ­¢éƒ½ç”±å­—ç¬¦ä¸²ç±»æœ¬èº«æ¥å¤„ç† å¹¶å‘çš„è¯»æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ Java String 1. String a = â€œaâ€ï¼Œæ˜¯ä»¥å­—é¢å¸¸é‡çš„å½¢å¼å‚¨å­˜åœ¨å¸¸é‡æ± ä¸­2. new String(â€œaâ€) åˆ›å»ºçš„ä»¥å¯¹è±¡çš„å½¢å¼å­˜æ”¾åœ¨å †ä¸­ å¯¹Stringå¯¹è±¡çš„ä»»ä½•æ”¹å˜éƒ½ä¸å½±å“åˆ°åŸå¯¹è±¡ï¼Œç›¸å…³çš„ä»»ä½•changeæ“ä½œéƒ½ä¼šç”Ÿæˆæ–°çš„å¯¹è±¡ å®‰å…¨ Java StringBuilder å¯¹è±¡ æ‰€æœ‰æ“ä½œéƒ½åœ¨åŸæœ‰çš„å¯¹è±¡ä¸Šè¿›è¡Œ ä¸å®‰å…¨ Java StringBuffer å¯¹è±¡ æ‰€æœ‰æ“ä½œéƒ½åœ¨åŸæœ‰çš„å¯¹è±¡ä¸Šè¿›è¡Œ å®‰å…¨ äºŒã€æ€§èƒ½æµ‹è¯•æµ‹è¯•ä»£ç 1234567891011121314151617181920212223242526272829303132333435363738394041public class Main { private static int NUM = 100000; public static void main(String[] args) { System.out.println(NUM + &quot;:&quot;); testString(); testStringBuffer(); testStringBuilder(); } private static void testString() { long start = System.currentTimeMillis(); String str = &quot;&quot;; for (int i = 0; i &lt; NUM; i++) { str += i; } long end = System.currentTimeMillis(); System.out.println(&quot;String:&quot; + (end - start) + &quot;ms&quot;); } private static void testStringBuffer() { long start = System.currentTimeMillis(); StringBuffer str = new StringBuffer(); for (int i = 0; i &lt; NUM; i++) { str.append(i); } long end = System.currentTimeMillis(); System.out.println(&quot;StringBuffer:&quot; + (end - start) + &quot;ms&quot;); } private static void testStringBuilder() { long start = System.currentTimeMillis(); StringBuilder str = new StringBuilder(); for (int i = 0; i &lt; NUM; i++) { str.append(i); } long end = System.currentTimeMillis(); System.out.println(&quot;StringBuilder:&quot; + (end - start) + &quot;ms&quot;); }} æµ‹è¯•ç»“æœ1234100000:String: 2907msStringBuffer: 9msStringBuilder: 5ms åœ¨è¯¥æµ‹è¯•ä¸­Stringåœ¨å­—ç¬¦ä¸²æ‹¼æ¥ä¸Šæ˜æ˜¾ä½äºå…¶ä»–ä¸¤è€…ï¼Œä¹Ÿè¯´æ˜äº†Stringæ¯æ¬¡æ‹¼æ¥å­—ç¬¦ä¸²éƒ½è¦æ–°å»ºå¯¹è±¡çš„æ—¶é—´æ¶ˆè€—å¾ˆå¤§ï¼Œè€ŒStringBufferåŠ äº†synchronizedæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåœ¨æ•ˆç‡ä¸Šä¸å¦‚StringBuilderï¼Œç¬¦åˆäº†é¢„æœŸã€‚ ä¸‰ã€javaæ­£åˆ™è¡¨è¾¾å¼ä»£ç 1234567891011121314151617181920212223242526272829303132public static void main(String[] args) { // é‚®æ”¿ç¼–ç  String postal_code = &quot;[1-9]\\\\d{5}&quot;; // åŒºå·-åº§æœºå·ç  String landline = &quot;\\\\d{3}-\\\\d{8}|\\\\d{4}-\\\\d{7}&quot;; // æ‰‹æœºå·ç  String phone = &quot;1[345678]\\\\d{9}&quot;; // æµ‹è¯•å­—ç¬¦ä¸² String text = &quot;513215 13411156663 010-88888888&quot;; Pattern r = Pattern.compile(postal_code); Matcher m = r.matcher(text); System.out.println(&quot;é‚®æ”¿ç¼–ç ï¼š&quot;); if (m.find()) { System.out.println(m.group()); } r = Pattern.compile(landline); m = r.matcher(text); System.out.println(&quot;åŒºå·-åº§æœºå·ç ï¼š&quot;); if (m.find()) { System.out.println(m.group()); } r = Pattern.compile(phone); m = r.matcher(text); System.out.println(&quot;æ‰‹æœºå·ç ï¼š&quot;); if (m.find()) { System.out.println(m.group()); }} ç»“æœ123456é‚®æ”¿ç¼–ç ï¼š513215åŒºå·-åº§æœºå·ç ï¼š010-88888888æ‰‹æœºå·ç ï¼š13411156663 å‚è€ƒèµ„æ–™æ¢ç§˜Javaä¸­çš„Stringã€StringBuilderä»¥åŠStringBufferC++ string class and its applicationshttps://www.runoob.com/java/java-regular-expressions.html","link":"/2020/07/31/Java/Java%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C/"},{"title":"å››åˆ™è¿ç®—ç”Ÿæˆå‘½ä»¤è¡Œç¨‹åº (Python)","text":"Githubé¡¹ç›®åœ°å€ï¼šGithub Pagesç»“å¯¹é¡¹ç›®æˆå‘˜ï¼šå¼ é¹ 3118004985 éƒ‘é“ 3118004988 ä¸€ã€é¡¹ç›®éœ€æ±‚åˆ†æ äºŒã€åŠŸèƒ½å®ç° ä¸‰ã€ä»£ç å®ç°oråŠŸèƒ½è¯´æ˜â˜… GUIåŠŸèƒ½æ‰©å±•è¯´æ˜ ğŸˆ é‡‡ç”¨äº†å¤šçº¿ç¨‹çš„ç•Œé¢ï¼Œä»»ä½•æ“ä½œä¸ä¼šé˜»å¡å…¶ä»–æ“ä½œï¼Œä¾‹å¦‚ï¼šå¯ä»¥åœ¨ç”Ÿæˆç­”æ¡ˆçš„åŒæ—¶æ‰¹æ”¹ä½œä¸š å¾—ç›Šäºä¸Šé¢çš„è®¾è®¡ï¼Œå¯ä»¥åŒæ—¶ç”Ÿæˆå¤šä¸ªè¡¨è¾¾å¼æ–‡ä»¶ï¼Œå­˜å‚¨å½¢å¼å¦‚ä¸‹æ‰€ç¤º å¯¹äºé”™è¯¯çš„è¾“å…¥ï¼Œä¼šæœ‰æç¤ºï¼Œå¦‚ä¸‹æ‰€ç¤º å¯¹äºæ–‡ä»¶é€‰æ‹©åï¼Œç‚¹å‡»æ‰¹æ”¹ï¼Œå¯¹äºæ–‡ä»¶çš„æ ¼å¼æœ‰é”™è¯¯æ£€æŸ¥ é€šè¿‡åç¼€è¡¨è¾¾å¼çš„è®¡ç®—è¿‡ç¨‹ï¼Œç¡®ä¿ç”Ÿæˆè¡¨è¾¾å¼æ»¡è¶³é¢˜ç›®æ‰€æœ‰è¦æ±‚ï¼Œé¿å…é‡å¤çš„è¡¨è¾¾å¼ç”Ÿæˆ (è¯¦å‚ä¸‹æ–‡ â€˜åˆ¤æ–­é‡å¤çš„æ€è·¯â€™ )â˜… å¤šçº¿ç¨‹ï¼ˆé˜²æ­¢I/Oé˜»å¡ï¼‰ğŸˆ åˆ›å»ºç”Ÿäº§è€…çº¿ç¨‹, ä¼ å‚è¿›é˜Ÿåˆ— â€˜queueâ€™ producer = multiprocessing.Process(target=self.expression_generator, args=(queue,)) åˆ›å»ºæ¶ˆè´¹è€…è¿›ç¨‹, ä¼ å‚è¿›é˜Ÿåˆ— â€˜queueâ€™ consumer = multiprocessing.Process(target=self.io_operation, args=(queue,)) ç”Ÿäº§è€…â€”â€”å¾ªç¯ç”Ÿæˆè¡¨è¾¾å¼ åŠå…¶ç­”æ¡ˆ æ„å»ºéšæœºè¡¨è¾¾å¼ ä»¥åŠç”Ÿæˆå…¶ç­”æ¡ˆ â€˜ Arithmetic(self.domain).create_arithmetic() â€˜ ç”Ÿæˆå…¶è¡¨è¾¾å¼å¯¹åº”ç­”æ¡ˆ â€˜ Calculate(expression).cal_expression() â€˜ å°†ç”Ÿæˆåç¼€è¡¨è¾¾å¼è¿‡ç¨‹ä¸­æ¯æ¬¡çš„ç»“æœ ä»¥åŠæ“ä½œç¬¦é›†åˆ ä¿å­˜åˆ° å­—å…¸ (â€˜ self.no_repeat_dict â€˜ ) ä¸­, ä»è€Œç¡®ä¿ç”Ÿæˆç­‰å¼ä¸ç›¸åŒ (å³ 3+2+1 ä¸ 1+2+3 ä¸ç›¸ç­‰, ï¼–Ã—8 ä¸ 8Ã—6 ç›¸ç­‰) ç”Ÿæˆå®Œæˆå, æŠŠè¡¨è¾¾å¼ ä»¥åŠ ç­”æ¡ˆæ·»åŠ åˆ°é˜Ÿåˆ— queue ä¸­ æ¶ˆè´¹è€…â€”â€”å¾ªç¯ç”Ÿæˆè¡¨è¾¾å¼ åŠå…¶ç­”æ¡ˆ é€šè¿‡æ­»å¾ªç¯ä¸æ–­è·å–é˜Ÿåˆ—å†…å®¹, è‹¥é˜Ÿåˆ—ä¼ å‡º â€˜Noneâ€™ ä¿¡å·, æ¶ˆè´¹è€…è¿›ç¨‹åœæ­¢ è§£æä»é˜Ÿåˆ—è·å–çš„å†…å®¹, å¹¶å°†å¤šæ¬¡è·å–çš„è¡¨è¾¾å¼ä»¥åŠç­”æ¡ˆä¿å­˜åˆ° ç¼“å†²åŒº(Buffer) ä¸­, æœ‰é™æ¬¡æ•°åå¼€å§‹å†™å…¥æ–‡ä»¶ å¹¶ é”€æ¯ç¼“å†²åŒºå†…å®¹ â˜… åˆ¤æ–­é‡å¤çš„æ€è·¯ ğŸˆ ç”±äºè€ƒè™‘åˆ°é¢˜ç›®è¯´1+2+3ï¼Œ2+1+3ç›¸ç­‰ï¼Œ1+2+3å’Œ3+2+1æ˜¯ä¸ç›¸ç­‰çš„ï¼Œæˆ‘ä¸€å¼€å§‹æ˜¯ä»å­—ç¬¦ä¸²çš„å¤„ç†è€ƒè™‘ï¼Œä½†æ˜¯å¤æ‚åº¦æœ‰ç‚¹é«˜ã€‚ æ‰€ä»¥æ¢äº†ä¸€ä¸ªè§’åº¦è€ƒè™‘ï¼Œä»è¿ç®—é¡ºåºå…¥æ‰‹ï¼Œå°±æƒ³åˆ°ç”¨åç¼€è¡¨è¾¾å¼è¿›è¡Œå»é‡ï¼Œå¹¶ä¸”è¿™æ ·ä¹Ÿä¸ç”¨è€ƒè™‘æ‹¬å·ï¼Œç¬¦åˆé¢˜ç›®æ‰€è¯´çš„ï¼ˆ1+2)+3å’Œ1+2+3ç›¸ç­‰ å…·ä½“å°±æ˜¯å­˜å‚¨æ¯ä¸€æ¬¡è¿ç®—å‡ºæ¥çš„ç»“æœï¼Œç„¶åè¿›è¡Œä¸€ä¸€æ¯”è¾ƒ ä¾‹å¦‚ï¼ˆè¿™é‡Œä¸¾çš„æ˜¯æ¯”è¾ƒç®€å•çš„ä¾‹å­ï¼‰ï¼š 1+2+3ï¼Œå‹å…¥çš„æ•°å­—ï¼š[3, 6]; 3+2+1ï¼Œå‹å…¥çš„æ•°å­—ï¼š[5ï¼Œ6]ï¼Œæ‰€æœ‰ä¸¤ä¸ªåˆ¤æ–­ä¸ºä¸ç›¸ç­‰ ä½†æ˜¯è¿™æ ·ä¼šå‡ºç°1+3å’Œ2+2åˆ¤æ–­ä¸ºé‡å¤çš„æƒ…å†µï¼Œæ‰€ä»¥æ·»åŠ ä¸¤ä¸ªæ•°ç»„â€”â€”[æ“ä½œæ•°]ï¼Œ[è¿ç®—ç¬¦]ï¼Œä½œä¸ºæ¯”è¾ƒçš„ä¾æ® å†æ¥è€ƒè™‘æ•ˆç‡ï¼Œç”¨å­—å…¸çš„æ•°æ®ç»“æ„ï¼Œä»¥ç­”æ¡ˆä¸ºé”®ï¼Œå…¶ä»–ä¸‰ä¸ªæ¯”è¾ƒæ ‡å¿—ä½œä¸ºå€¼ï¼Œåªåœ¨ç­”æ¡ˆç›¸ç­‰çš„æƒ…å†µä¸‹åˆ¤é‡ é™„ï¼šæœ€ç»ˆé€‰å®šäº†æ·»åŠ åç¼€è®¡ç®—çš„å»é‡æ¨¡å¼ï¼Œå°±æ˜¯ä¸ºäº†é¿å… (1Ã·1)+3 å’Œ 1+(3Ã·1) è¿™ç§ä¸ä¸ºé‡å¤è¡¨è¾¾å¼çš„æƒ…å†µï¼Œä½†æ˜¯æ•ˆç‡ç¡®å®æ¯”åªåˆ¤æ–­ï¼ˆæ“ä½œæ•°ã€è¿ç®—ç¬¦ï¼‰çš„æ¨¡å¼ä½äº† â€”â€”åˆ›å»ºæ•°æ®ç»“æ„12345678# ç”¨ç­”æ¡ˆä½œä¸ºç´¢å¼•æ„å»ºçš„å­—å…¸ï¼Œ{ &quot;1'2/2&quot;: [ [[å‹å…¥çš„æ•°å­—], [æ“ä½œæ•°], [è¿ç®—ç¬¦]], [[å‹å…¥çš„æ•°å­—], [æ“ä½œæ•°], [è¿ç®—ç¬¦]], ... ]} 1234567891011121314# é€šè¿‡æ¯”è¾ƒä¸Šè¿°å­—å…¸, ç¡®è®¤æ–°è¡¨è¾¾å¼æ˜¯å¦å·²ç»åœ¨ä¸Šè¿°å­—å…¸ä¸­def judge_repeat(self, answer, test_sign): for expression_sign in self.no_repeat_dict[answer]: # è®°å½•ç›¸åŒçš„ä¸ªæ•° same_num = 0 for i in range(3): if collections.Counter(expression_sign[i]) == collections.Counter(test_sign[i]): same_num += 1 # å¦‚æœä¸­é—´ç»“æœã€æ“ä½œæ•°ã€è¿ç®—ç¬¦å‡ç›¸ç­‰ï¼Œåˆ™ä¸ºé‡å¤ if same_num == 3: return False return True â˜… ç”Ÿæˆè¡¨è¾¾å¼æ€è·¯ ğŸˆ12# è¡¨è¾¾å¼åˆ—è¡¨å½¢å¼['10', 'Ã·', '(', '8/9', 'Ã·', '51', ')'] éšæœºç”Ÿæˆæ“ä½œæ•°åˆ—è¡¨ï¼Œè¿ç®—ç¬¦åˆ—è¡¨ æ ¹æ®ä»¥ä¸Šä¸¤ä¸ªåˆ—è¡¨æ„å»ºæ— æ‹¬å·è¡¨è¾¾å¼ æ ¹æ®è¿ç®—ç¬¦ä¸ªæ•°ï¼Œéšæœºç”Ÿæˆæ‹¬å·ä¸ªæ•°ï¼Œæœ€å¤§ä¸ªæ•°ä¸ºï¼ˆ 1-&gt;0, 2-&gt;1, 3-&gt;2 ï¼‰ å†éšæœºæ‹¬å·ä½ç½®ï¼Œç»´æŠ¤æ“ä½œæ•°ä½ç½®åˆ—è¡¨ï¼Œæ’å…¥æ‹¬å· 1234567891011121314151617181920212223242526# ç”Ÿæˆè¡¨è¾¾å¼def create_arithmetic(self): # ç”Ÿæˆéšæœºæ“ä½œæ•°ã€è¿ç®—ç¬¦åˆ—è¡¨ self.create_operand_list() self.create_operator_list() i = 0 # æ„å»ºè¡¨è¾¾å¼åˆ—è¡¨ self.expression_split.append(self.operand_list[i]) self.expression_split.append(self.operator_list[i]) i += 1 while i &lt; len(self.operator_list): self.expression_split.append(self.operand_list[i]) self.expression_split.append(self.operator_list[i]) i += 1 self.expression_split.append(self.operand_list[i]) # æ’å…¥æ‹¬å· if self.operator_num != 1: bracket_num = random.randint(1, self.operator_num - 1) self.insert_bracket(bracket_num) # åˆ é™¤æ— ç”¨æ‹¬å· self.del_useless_bracket() return [self.expression_split, self.operand_list, self.operator_list] â˜… è®¡ç®—æ€è·¯ï¼ˆåç¼€è¡¨è¾¾å¼ï¼‰ ğŸˆç”Ÿæˆåç¼€è¡¨è¾¾å¼ è®¾ç½®ä¸¤ä¸ªæ ˆï¼Œä¸€ä¸ªç”¨ä»¥å­˜å‚¨è¿ç®—ç¬¦ï¼Œä¸€ä¸ªç”¨ä»¥å­˜å‚¨åç¼€è¡¨è¾¾å¼ å¾ªç¯éå†è¡¨è¾¾å¼åˆ—è¡¨ï¼Œå¦‚æœæ˜¯æ“ä½œæ•°ï¼Œåˆ™åŠ å…¥åç¼€æ ˆ å¦åˆ™å¦‚æœæ˜¯è¿ç®—ç¬¦åˆ™è¿›å…¥ä»¥ä¸‹åˆ¤æ–­ å¦‚æœè¿ç®—ç¬¦æ ˆä¸ºç©ºï¼Œæˆ–è€…æ ˆé¡¶ä¸º ( ï¼Œåˆ™å‹å…¥è¿ç®—ç¬¦æ ˆ å¦åˆ™å¦‚æœå½“å‰è¿ç®—ç¬¦å¤§äºæ ˆé¡¶è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ï¼Œåˆ™å‹å…¥è¿ç®—ç¬¦æ ˆ å¦åˆ™å¼¹æ ˆå¹¶å‹å…¥åç¼€æ ˆç›´åˆ°ä¼˜å…ˆçº§å¤§äºæ ˆé¡¶æˆ–ç©ºæ ˆ å¦åˆ™å¦‚æœé‡åˆ°æ‹¬å·åˆ™è¿›å…¥ä»¥ä¸‹åˆ¤æ–­ è‹¥ä¸º ( ç›´æ¥å‹å…¥è¿ç®—ç¬¦æ ˆ å¦åˆ™å¼¹æ ˆå¹¶å‹å…¥åç¼€æ ˆç›´åˆ°é‡åˆ° ( å°†è¿ç®—ç¬¦æ ˆå‰©ä½™çš„å…ƒç´ å‹å…¥åç¼€æ ˆ è®¡ç®—åç¼€è¡¨è¾¾å¼ ç”¨ä¸€ä¸ªæ ˆï¼ˆcalculate_stackï¼‰ä½œä¸ºè®¡ç®—ä¸­ä»‹ å¾ªç¯éå†åç¼€è¡¨è¾¾å¼ï¼Œè‹¥ä¸ºæ•°å­—å‹å…¥ calculate_stack å¦åˆ™ä» calculate_stack å¼¹å‡ºä¸¤ä¸ªæ•°å­—ï¼Œåˆ†åˆ«åŒ–ä¸ºåˆ†æ•°ç±»ï¼Œè¿›è¡Œè®¡ç®—ï¼Œç»“æœå‹å…¥ calculate_stack é‡å¤ 2-3ï¼Œè‹¥æœŸé—´è¿ç®—ç»“æœå‡ºç°è´Ÿæ•°ï¼Œæˆ–é™¤æ•°ä¸º0ï¼Œåˆ™è¿”å›false ç›´è‡³åç¼€è¡¨è¾¾å¼éå†å®Œæˆï¼Œè¿”å› calculate_stack çš„æ ˆé¡¶ ä»£ç  ğŸˆ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133class Calculate(object): def __init__(self, expression): self.expression = expression # åˆ†æ•°åŠ æ³• a1/b1 + a2/b2 = (a1b2 + a2b1)/b1b2 @staticmethod def fraction_add(fra1, fra2): molecular = fra1.molecular * fra2.denominator + fra2.molecular * fra1.denominator denominator = fra1.denominator * fra2.denominator return Fraction(molecular, denominator) # åˆ†æ•°å‡æ³• a1/b1 - a2/b2 = (a1b2 - a2b1)/b1b2 @staticmethod def fraction_minus(fra1, fra2): molecular = fra1.molecular * fra2.denominator - fra2.molecular * fra1.denominator denominator = fra1.denominator * fra2.denominator return Fraction(molecular, denominator) # åˆ†æ•°ä¹˜æ³• a1/b1 * a2/b2 = a1a2/b1b2 @staticmethod def fraction_multiply(fra1, fra2): molecular = fra1.molecular * fra2.molecular denominator = fra1.denominator * fra2.denominator return Fraction(molecular, denominator) # åˆ†æ•°é™¤æ³• a1/b1 Ã· a2/b2 = a1b2/a2b1 @staticmethod def fraction_divide(fra1, fra2): molecular = fra1.molecular * fra2.denominator denominator = fra1.denominator * fra2.molecular return Fraction(molecular, denominator) # åŸºæœ¬è¿ç®—é€‰æ‹©å™¨ def operate(self, num1, num2, operater): if not isinstance(num1, Fraction): num1 = Fraction(num1) if not isinstance(num2, Fraction): num2 = Fraction(num2) # è®¡ç®—ç»“æœ if operater == '+': return self.fraction_add(num1, num2) if operater == '-': return self.fraction_minus(num1, num2) if operater == 'Ã—': return self.fraction_multiply(num1, num2) if operater == 'Ã·': return self.fraction_divide(num1, num2) # è½¬æˆé€†æ³¢å…° def generate_postfix_expression(self): # è¿ç®—ç¬¦æ ˆ operator_stack = [] # åç¼€æ ˆ postfix_stack = [] for element in self.expression: # å¦‚æœæ˜¯æ“ä½œæ•°åˆ™æ·»åŠ  if element not in operators: postfix_stack.append(element) # å¦‚æœæ˜¯è¿ç®—ç¬¦åˆ™æŒ‰ä¼˜å…ˆçº§ elif element in operator.values(): # è¿ç®—ç¬¦æ ˆä¸ºç©ºï¼Œæˆ–è€…æ ˆé¡¶ä¸º(ï¼Œåˆ™å‹æ ˆ if not operator_stack or operator_stack[-1] == '(': operator_stack.append(element) # è‹¥å½“å‰è¿ç®—ç¬¦ä¼˜å…ˆçº§å¤§äºè¿ç®—ç¬¦æ ˆé¡¶ï¼Œåˆ™å‹æ ˆ elif priority[element] &gt;= priority[operator_stack[-1]]: operator_stack.append(element) # å¦åˆ™å¼¹æ ˆå¹¶å‹å…¥åç¼€é˜Ÿåˆ—ç›´åˆ°ä¼˜å…ˆçº§å¤§äºæ ˆé¡¶æˆ–ç©ºæ ˆ else: while operator_stack and priority[element] &lt; priority[operator_stack[-1]]: postfix_stack.append(operator_stack.pop()) operator_stack.append(element) # å¦‚æœé‡åˆ°æ‹¬å· else: # è‹¥ä¸ºå·¦æ‹¬å·ç›´æ¥å‹å…¥è¿ç®—ç¬¦æ ˆ if element == '(': operator_stack.append(element) # å¦åˆ™å¼¹æ ˆå¹¶å‹å…¥åç¼€é˜Ÿåˆ—ç›´åˆ°é‡åˆ°å·¦æ‹¬å· else: while operator_stack[-1] != '(': postfix_stack.append(operator_stack.pop()) operator_stack.pop() while operator_stack: postfix_stack.append(operator_stack.pop()) return postfix_stack # è®¡ç®—è¡¨è¾¾å¼(è¿ç®—è¿‡ç¨‹å‡ºç°è´Ÿæ•°ï¼Œæˆ–è€…é™¤æ•°ä¸º0ï¼Œè¿”å›Falseï¼Œå¦åˆ™è¿”å›Fractionç±») def cal_expression(self): # ç”Ÿæˆåç¼€è¡¨è¾¾å¼ expressions_result = self.generate_postfix_expression() # å­˜å‚¨é˜¶æ®µæ€§ç»“æœ stage_results = [] # ä½¿ç”¨listä½œä¸ºæ ˆæ¥è®¡ç®— calculate_stack = [] # åç¼€éå† for element in expressions_result: # è‹¥æ˜¯æ•°å­—åˆ™å…¥æ ˆ, æ“ä½œç¬¦åˆ™å°†æ ˆé¡¶ä¸¤ä¸ªå…ƒç´ å‡ºæ ˆ if element not in operators: calculate_stack.append(element) else: # æ“ä½œæ•° num1 = calculate_stack.pop() # æ“ä½œæ•° num2 = calculate_stack.pop() # é™¤æ•°ä¸èƒ½ä¸º0 if num1 == &quot;0&quot; and element == 'Ã·': return [False, []] # ç»“æœ result = self.operate(num2, num1, element) if result.denominator == 0 or '-' in result.to_string(): return [False, []] stage_results.append(result.to_string()) # ç»“æœå…¥æ ˆ calculate_stack.append(result) # è¿”å›ç»“æœ return [calculate_stack[0], stage_results] å››ã€å®é™…æµ‹è¯• é€šè¿‡å‘½ä»¤è¡Œæ§åˆ¶python ArithmeticCLMode.py [args|args][args]â”œâ”€ -h â€“help # è¾“å‡ºå¸®åŠ©ä¿¡æ¯â”œâ”€ -n # æŒ‡å®šç”Ÿæˆè¡¨è¾¾å¼æ•°é‡ï¼Œé»˜è®¤100â”œâ”€ -r # æŒ‡å®šç”Ÿæˆè¡¨è¾¾å¼å„ä¸ªæ•°å­—çš„å–å€¼èŒƒå›´ï¼Œé»˜è®¤100â”œâ”€ -a # éœ€å’Œ-eå‚æ•°å…±åŒä½¿ç”¨è¿›è¡Œæ‰¹æ”¹ï¼ŒæŒ‡å®šç­”æ¡ˆæ–‡ä»¶â”œâ”€ -e # éœ€å’Œ-aå‚æ•°å…±åŒä½¿ç”¨è¿›è¡Œæ‰¹æ”¹ï¼ŒæŒ‡å®šç»ƒä¹ æ–‡ä»¶â””â”€ -g # å¼€å¯GUI é€šè¿‡guiæ§åˆ¶ python ArithmeticGMode.py æ‰§è¡Œä»£ç 1python ArithmeticCLMode.py -n 100 -r 100 12# å°†ä¸Šè¿°æ‰§è¡Œç”Ÿæˆçš„ Exercise.txt ä¸­çš„1~10é¢˜çš„ç­”æ¡ˆæ”¹ä¸ºé”™è¯¯ æ‰§è¡Œpython ArithmeticCLMode.py -e ./docs/Exercise.txt -a ./docs/Answer.txt äº”ã€æ•ˆèƒ½åˆ†æ ç”±Pycharmæµ‹è¯•è¾“å‡ºæ€§èƒ½æµ‹è¯• ç¨‹åºè€—æ—¶åœ¨å¤šçº¿ç¨‹ä¸­çš„ ç”Ÿæˆè¡¨è¾¾å¼åŠè®¡ç®—, ä»¥åŠI/Oæ“ä½œ åœ¨å€¼åŸŸ1000çš„æƒ…å†µä¸‹å„ç”Ÿæˆä¸åŒæ•°é‡çº§å››åˆ™è¿ç®—çš„è€—æ—¶æµ‹è¯• å…­ã€PSPè¡¨æ ¼ ğŸš© PSP2.1 Personal Software Process Stages é¢„ä¼°è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰ å®é™…è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰ Planning è®¡åˆ’ 30 10 Â· Estimate Â· ä¼°è®¡è¿™ä¸ªä»»åŠ¡éœ€è¦å¤šå°‘æ—¶é—´ 30 10 Development å¼€å‘ 1055 1480 Â· Analysis Â· éœ€æ±‚åˆ†æ (åŒ…æ‹¬å­¦ä¹ æ–°æŠ€æœ¯) 120 335 Â· Design Spec Â· ç”Ÿæˆè®¾è®¡æ–‡æ¡£ 60 35 Â· Design Review Â· è®¾è®¡å¤å®¡ (å’ŒåŒäº‹å®¡æ ¸è®¾è®¡æ–‡æ¡£) 5 5 Â· Coding Standard Â· ä»£ç è§„èŒƒ (ä¸ºç›®å‰çš„å¼€å‘åˆ¶å®šåˆé€‚çš„è§„èŒƒ) 10 5 Â· Design Â· å…·ä½“è®¾è®¡ 200 120 Â· Coding Â· å…·ä½“ç¼–ç  600 580 Â· Code Review Â· ä»£ç å¤å®¡ 30 120 Â· Test Â· æµ‹è¯•ï¼ˆè‡ªæˆ‘æµ‹è¯•ï¼Œä¿®æ”¹ä»£ç ï¼Œæäº¤ä¿®æ”¹ï¼‰ 30 150 Reporting æŠ¥å‘Š 85 130 Â· Test Report Â· æµ‹è¯•æŠ¥å‘Š 60 30 Â· Size Measurement Â· è®¡ç®—å·¥ä½œé‡ 10 10 Â· Postmortem &amp; Process Improvement Plan Â· äº‹åæ€»ç»“, å¹¶æå‡ºè¿‡ç¨‹æ”¹è¿›è®¡åˆ’ 15 90 åˆè®¡ 1170 1620 ä¸ƒã€æ€»ç»“ ğŸš€ ä¼˜ç‚¹ï¼š åœ¨æ­¤æ¬¡é¡¹ç›®åˆä½œä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ â€œNotionâ€ è¿™ä¸€ä¸ªè½¯ä»¶å®Œæˆè®¾è®¡æˆ‘ä»¬çš„ å¼€å‘æµç¨‹ã€å·¥ä½œåˆ†é…ä»¥åŠæˆ‘ä»¬çš„ä»£ç è§„èŒƒçš„è®¾è®¡ã€‚æˆ‘ä»¬å°†éœ€æ±‚åˆ—å‡ºï¼Œæ ¹æ®éš¾åº¦ä¸åŒä»è€Œå®‰æ’å¼€å‘æµç¨‹ï¼Œæ¯ä¸ªäººæ ¹æ®è‡ªå·±èƒ½åŠ›ç‰¹å‡ºç‚¹ä¸åŒè€Œå»åšä¸åŒçš„éœ€æ±‚ï¼Œå†é€šè¿‡äº¤æµçº¦å®šæˆ‘ä»¬æ¯ä¸ªäººçš„æ¥å£ã€‚ç®€åŒ–å¼€å‘æµç¨‹ã€‚ äº¤æµå’Œé…åˆéƒ½æŒºé¡ºç•…çš„ ä¸è¶³ï¼š å¼€å‘ä¸­å„ä¸ªæ¨¡å—çš„ä¾èµ–å…³ç³»åœ¨å¼€å‘ä»»åŠ¡ä¸­æ²¡æœ‰å¤„ç†æ¸…æ¥šï¼Œå¯¼è‡´åŒæ–¹éƒ½æœ‰ç©ºçª—æœŸ äº’è¯„ â¤ğŸ’›ğŸ’™ To éƒ‘é“èƒ½åŠ›å¼ºï¼Œæ•ˆç‡é«˜ï¼Œéå¸¸ç§¯æä¸»åŠ¨ã€‚èƒ½æ ¹æ®è‡ªå·±æ—¥å¸¸ä½¿ç”¨çš„å·¥å…·æé«˜æ•ˆç‡ï¼Œåœ¨å®é™…å¼€å‘ä¸­æœ‰æ˜ç¡®çš„å¼€å‘æµç¨‹æ€è·¯ï¼Œå¼€å‘è¿‡ç¨‹ä¸­æœ‰éƒ¨åˆ†å‡½æ•°ä»£ç æ³¨é‡Šæ€è·¯ä¸æ¸…ã€‚ To å¼ é¹é…åˆå’Œäº¤æµèƒ½åŠ›å¼ºï¼Œæ•ˆç‡é«˜ï¼Œèƒ½ä¸»åŠ¨æ½æ¥ä»»åŠ¡ï¼Œæ€ç»´æŒºå¥½çš„ï¼Œä½†æ¯”è¾ƒè¢«åŠ¨","link":"/2020/07/29/%E5%A4%A7%E5%AD%A6%E8%AF%BE%E7%A8%8B/%E5%9B%9B%E5%88%99%E8%BF%90%E7%AE%97%E7%94%9F%E6%88%90%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%A8%8B%E5%BA%8F-Python/"},{"title":"WordCount (Python)","text":"WordCount (Python)Githubé¡¹ç›®åœ°å€ï¼šhttps://github.com/w1036933220/WordCount ä¸€ã€è§£é¢˜æ€è·¯ æŠŠé¡¹ç›®éœ€æ±‚ç†æ¸…æ¥šï¼Œç”»ä¸€ä¸ªæ€ç»´å¯¼å›¾ è€ƒè™‘å„éƒ¨åˆ†åŠŸèƒ½æ‰€éœ€è¦çš„å¤§æ¦‚å®ç°æ€è·¯ ç„¶åå®Œæˆäº†è®¡ç®—æ–‡ä»¶å±æ€§çš„ç®—æ³•éƒ¨åˆ† å†å›å¤´æƒ³å¯¹æŒ‡ä»¤çš„è§£æé—®é¢˜ï¼Œé¡ºå¸¦æ·»åŠ äº†é€’å½’å¤„ç†å¤šä¸ªæ–‡ä»¶çš„åŠŸèƒ½ æŸ¥pythonçš„osåº“æ–‡æ¡£ï¼Œæœ€åå†³å®šç”¨os.walkè¯»å–å½“å‰æ–‡ä»¶å¤¹å†…çš„æ‰€æœ‰æ–‡ä»¶å¤¹å’Œæ–‡ä»¶ï¼Œæ›¿æ¢æ‰è¾“å…¥çš„*å’Œ?é€šé…ç¬¦ï¼Œå†è¿›è¡ŒåŒ¹é… ä¸‰ã€è®¾è®¡å®ç°è¿‡ç¨‹åŠä»£ç è¯´æ˜ main.pyï¼ˆå…¥å£æ–‡ä»¶ï¼‰ 123456from utils.utils import *if __name__ == '__main__': command = input(&quot;è¯·è¾“å…¥å‘½ä»¤(wc.exe [parameter] {file_name}):\\n&quot;)parse_command(command) orders.py å­˜æ”¾æŒ‡ä»¤é›†ï¼Œå’Œè¾“å‡ºå„ç±»æ•°æ®çš„å‡½æ•° 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253from utils.count import *from views.main_view import *import tkinter as tk# è¾“å‡ºå­—ç¬¦æ•°def print_char_num(text): print(&quot;å­—ç¬¦æ•°ï¼š&quot; + str(FileProperties(text).count_char_num()))# è¾“å‡ºå•è¯æ•°def print_word_num(text): print(&quot;è¯æ•°ï¼š&quot; + str(FileProperties(text).count_word_num()))# è¾“å‡ºè¡Œæ•°def print_line_num(text): print(&quot;è¡Œæ•°ï¼š&quot; + str(FileProperties(text).count_line_num()))# è¾“å‡ºä»£ç è¡Œ/ç©ºè¡Œ/æ³¨é‡Šè¡Œdef print_code_property(text): file_properties = FileProperties(text) print(&quot;ç©ºè¡Œï¼š&quot; + str(file_properties.count_null_line_num())) print(&quot;æ³¨é‡Šè¡Œï¼š&quot; + str(file_properties.count_annotation_line_num())) print(&quot;ä»£ç è¡Œï¼š&quot; + str(file_properties.count_code_line_num()))# è°ƒå‡ºå›¾å½¢ç•Œé¢def draw_view(): root = MainView(tk.Tk())def print_error(): print(&quot;æŒ‡ä»¤è¾“å…¥é”™è¯¯&quot;)# å•æŒ‡ä»¤å‘½ä»¤é›†orders = { '-c': print_char_num, '-w': print_word_num, &quot;-l&quot;: print_line_num, &quot;-a&quot;: print_code_property, &quot;-s&quot;: print_error, &quot;-x&quot;: draw_view} utils.py æ”¾ç½®è§£ææŒ‡ä»¤ã€è¯»å–æ–‡ä»¶ã€æ¨¡ç³Šæœç´ çš„å‡½æ•° 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576import osfrom utils.orders import *# descriptionï¼šparse command# paramï¼šorder input# returnï¼š[order, [file_list]] / FALSEdef parse_command(command): command = command.strip().split(&quot; &quot;) # æŒ‡ä»¤è‹¥ä¸ºç©ºæˆ–è€…èµ·å§‹ä¸ä¸ºwc.exeåˆ™æŠ¥é”™ if command == [] or command[0] != &quot;wc.exe&quot;: print(&quot;æŒ‡ä»¤è¾“å…¥é”™è¯¯&quot;) # æ‰“å¼€å›¾å½¢ç•Œé¢çš„æŒ‡ä»¤(ä¸€çº§æŒ‡ä»¤) if &quot;-x&quot; in command: orders.get(&quot;-x&quot;) elif len(command) &gt; 2: order = command[-2] file_name = command[-1] file_list = get_file_list(file_name) # é€’å½’è°ƒç”¨çš„æŒ‡ä»¤ if &quot;-s&quot; in command: if file_list: for file in file_list: print(file + &quot;:&quot;) text = read_file(file) orders.get(order)(text) else: print(file_list[0] + &quot;:&quot;) text = read_file(file_name) orders.get(order)(text) else: print(&quot;æŒ‡ä»¤è¾“å…¥é”™è¯¯&quot;)# è¯»å–ç›®å½•ä¸‹ç¬¦åˆæ¡ä»¶çš„æ–‡ä»¶ådef get_file_list(file_name): # æœ€ç»ˆæ„å»ºçš„æ–‡ä»¶åˆ—è¡¨ file_list = [] # åŒ¹é…åˆ°çš„æ–‡ä»¶å¤¹åˆ—è¡¨ã€éœ€äºŒæ¬¡å¤„ç† dir_list = [] file_name = file_name.replace(&quot;?&quot;, &quot;\\\\S&quot;).replace(&quot;*&quot;, &quot;\\\\S+&quot;) file_name += &quot;$&quot; for root, dirs, files in os.walk(&quot;.&quot;, topdown=False): for name in files: if re.match(file_name, name): file_list.append(os.path.join(root, name)) for name in dirs: if re.match(file_name, name): dir_list.append(os.path.join(os.getcwd() + os.sep, name)) # å¦‚æœæ–‡ä»¶å¤¹éç©ºï¼Œåˆ™ç»§ç»­æ”¶é›† if dir_list: for item in dir_list: all_file = os.listdir(item) for file in all_file: # æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ file_path = item + os.sep + file if os.path.isfile(file_path): file_list.append(file_path) print(file_list) return file_list# descriptionï¼šread files# paramï¼šfile_list# returnï¼šfile contentdef read_file(file): with open(file, 'r') as f: return f.readlines() count.py å­˜æ”¾è®¡ç®—æ–‡ä»¶å±æ€§çš„ç±» 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273import reclass FileProperties(object): def __init__(self, file_text): self.file_text = file_text # å­—ç¬¦æ•° self.char_num = 0 # å•è¯æ•° self.word_num = 0 # è¡Œæ•° self.line_num = len(file_text) # ç©ºè¡Œ self.null_line_num = 0 # ä»£ç è¡Œ self.code_line_num = 0 # æ³¨é‡Šè¡Œæ•° self.annotation_line_num = 0 # è®¡ç®—å­—ç¬¦æ•° def count_char_num(self): for line in self.file_text: self.char_num += len(line.strip()) return self.char_num # è®¡ç®—å•è¯æ•° def count_word_num(self): for line in self.file_text: # æ­£åˆ™åŒ¹é…ä¸€è¡Œä¸­çš„æ‰€æœ‰å•è¯ï¼Œå¹¶è®¡ç®—å•è¯æ•° self.word_num += len(re.findall(r'[a-zA-Z0-9]+[\\-\\']?[a-zA-Z]*', line)) return self.word_num # è®¡ç®—è¡Œæ•° def count_line_num(self): return self.line_num # è®¡ç®—ç©ºè¡Œæ•° def count_null_line_num(self): for line in self.file_text: # åªæœ‰ä¸è¶…è¿‡ä¸€ä¸ªå¯æ˜¾ç¤ºçš„å­—ç¬¦ if len(re.findall(r'\\S', line)) &lt;= 1: self.null_line_num += 1 return self.null_line_num # è®¡ç®—ä»£ç è¡Œ def count_code_line_num(self): return self.line_num - self.null_line_num - self.annotation_line_num # è®¡ç®—æ³¨é‡Šè¡Œ def count_annotation_line_num(self): flag = 0 for line in self.file_text: line = line.strip() # åŒ¹é…ä¸æ˜¯ä»£ç è¡Œä¸”æœ‰// if re.match(r'^\\S?\\s*?\\/\\/', line): self.annotation_line_num += 1 # åŒ¹é…ä¸æ˜¯ä»£ç è¡Œä¸”æœ‰/* elif re.match(r'^\\S?\\s*?\\/\\*', line): flag = 1 self.annotation_line_num += 1 if line.endswith('*/'): flag = 0 elif flag == 1: self.annotation_line_num += 1 elif &quot;*/&quot; in line: self.annotation_line_num += 1 flag = 0 return self.annotation_line_num 5.main_view.py(æ–°å¢) 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152import tkinter as tkfrom tkinter import ttkimport tkinter.filedialogfrom utils.utils import *from utils.count import *class MainView(object): def __init__(self, window): self.window = window self.window.title(&quot;è¿™æ˜¯èˆ¹æ–°çš„ç‰ˆæœ¬ï¼&quot;) self.window.geometry(&quot;540x290&quot;) self.data_tree = ttk.Treeview(self.window, show=&quot;headings&quot;) self.creat_view() def creat_view(self): # é€‰æ‹©æ–‡ä»¶æŒ‰é’® btn = tk.Button(self.window, text=&quot;é€‰æ‹©æ–‡ä»¶&quot;, command=self.file_choose).place(x=240, y=247) # æ–‡ä»¶æ•°æ®æ˜¾ç¤ºè¡¨æ ¼ self.data_tree.place(x=8, y=8) # å®šä¹‰åˆ— self.data_tree[&quot;columns&quot;] = (&quot;æ–‡ä»¶å&quot;, &quot;å­—ç¬¦æ•°&quot;, &quot;å•è¯æ•°&quot;, &quot;è¡Œæ•°&quot;, &quot;ç©ºè¡Œæ•°&quot;, &quot;ä»£ç è¡Œæ•°&quot;, &quot;æ³¨é‡Šè¡Œæ•°&quot;) # è®¾ç½®åˆ—å±æ€§ï¼Œåˆ—ä¸æ˜¾ç¤º self.data_tree.column(&quot;æ–‡ä»¶å&quot;, width=100) self.data_tree.column(&quot;å­—ç¬¦æ•°&quot;, width=70) self.data_tree.column(&quot;å•è¯æ•°&quot;, width=70) self.data_tree.column(&quot;è¡Œæ•°&quot;, width=70) self.data_tree.column(&quot;ç©ºè¡Œæ•°&quot;, width=70) self.data_tree.column(&quot;ä»£ç è¡Œæ•°&quot;, width=70) self.data_tree.column(&quot;æ³¨é‡Šè¡Œæ•°&quot;, width=70) # è®¾ç½®è¡¨å¤´ self.data_tree.heading(&quot;æ–‡ä»¶å&quot;, text=&quot;æ–‡ä»¶å&quot;) self.data_tree.heading(&quot;å­—ç¬¦æ•°&quot;, text=&quot;å­—ç¬¦æ•°&quot;) self.data_tree.heading(&quot;å•è¯æ•°&quot;, text=&quot;å•è¯æ•°&quot;) self.data_tree.heading(&quot;è¡Œæ•°&quot;, text=&quot;è¡Œæ•°&quot;) self.data_tree.heading(&quot;ç©ºè¡Œæ•°&quot;, text=&quot;ç©ºè¡Œæ•°&quot;) self.data_tree.heading(&quot;ä»£ç è¡Œæ•°&quot;, text=&quot;ä»£ç è¡Œæ•°&quot;) self.data_tree.heading(&quot;æ³¨é‡Šè¡Œæ•°&quot;, text=&quot;æ³¨é‡Šè¡Œæ•°&quot;) self.window.mainloop() def file_choose(self): file_list = tk.filedialog.askopenfilenames() for index, file in enumerate(file_list): text = read_file(file) [char_num, word_num, line_num, null_line_num, code_line_num, annotation_line_num] = FileProperties(text).all_count() file = file.split(&quot;/&quot;)[-1] self.data_tree.insert('', index, values=(file, char_num, word_num, line_num, null_line_num, code_line_num, annotation_line_num)) äº”ã€PSPè¡¨æ ¼ PSP2.1 Personal Software Process Stages é¢„ä¼°è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰ å®é™…è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰ Planning è®¡åˆ’ 10 8 Â· Estimate Â· ä¼°è®¡è¿™ä¸ªä»»åŠ¡éœ€è¦å¤šå°‘æ—¶é—´ 10 8 Development å¼€å‘ 460 610 Â· Analysis Â· éœ€æ±‚åˆ†æ (åŒ…æ‹¬å­¦ä¹ æ–°æŠ€æœ¯) 120 200 Â· Design Spec Â· ç”Ÿæˆè®¾è®¡æ–‡æ¡£ 90 60 Â· Design Review Â· è®¾è®¡å¤å®¡ (å’ŒåŒäº‹å®¡æ ¸è®¾è®¡æ–‡æ¡£) 5 5 Â· Coding Standard Â· ä»£ç è§„èŒƒ (ä¸ºç›®å‰çš„å¼€å‘åˆ¶å®šåˆé€‚çš„è§„èŒƒ) 5 0 Â· Design Â· å…·ä½“è®¾è®¡ 120 100 Â· Coding Â· å…·ä½“ç¼–ç  90 200 Â· Code Review Â· ä»£ç å¤å®¡ 10 30 Â· Test Â· æµ‹è¯•ï¼ˆè‡ªæˆ‘æµ‹è¯•ï¼Œä¿®æ”¹ä»£ç ï¼Œæäº¤ä¿®æ”¹ï¼‰ 20 15 Reporting æŠ¥å‘Š 30 32 Â· Test Report Â· æµ‹è¯•æŠ¥å‘Š 10 12 Â· Size Measurement Â· è®¡ç®—å·¥ä½œé‡ 10 5 Â· Postmortem &amp; Process Improvement Plan Â· äº‹åæ€»ç»“, å¹¶æå‡ºè¿‡ç¨‹æ”¹è¿›è®¡åˆ’ 10 8 åˆè®¡ 355 630 å…­ã€æµ‹è¯•è¿è¡Œ å›¾å½¢ç•Œé¢æµ‹è¯•ï¼ˆæ–°å¢ï¼‰ ä¸ƒã€æ€»ç»“ å¤ªä¹…æ²¡å†™pythonäº†ï¼Œå‘ç°å±…ç„¶æ²¡æœ‰switchè¿™ä¸ªè¯­å¥ï¼Œç™¾åº¦æŸ¥åˆ°äº†è¡¨é©±åŠ¨è¿™ä¸ªä¸œè¥¿ ç”¨æ—¶ä¸é¢„è®¡çš„å‡ºå…¥æœ‰ç‚¹å¤§ è¾“å…¥éªŒè¯å¤„ç†æ²¡æœ‰åšå®Œå…¨ï¼Œå›¾å½¢ç•Œé¢æ²¡æ—¶é—´åšäº†ï¼ˆè¿‡äº†å¤§åŠå¹´é—å¿˜ç‡ç¡®å®é«˜ï¼‰ å†™çš„æ—¶å€™å‘ç°pythonæœ‰äº›é—®é¢˜ä¸çŸ¥é“æ˜¯bugè¿˜æ˜¯ä»€ä¹ˆ 1234567orders = { '-c': print_char_num, '-w': print_word_num, &quot;-l&quot;: print_line_num, &quot;-a&quot;: print_code_property, &quot;-s&quot;: print_error,} è¿™æ˜¯æˆ‘çš„æŒ‡ä»¤é›†ï¼Œå¦‚æœæŠŠä»–å†™æˆåƒjs 12345orders = { '-c': function () { // æŸäº›æ“ä½œ },} pythonä¸ç®¡ä¼šä¸ä¼šç”¨åˆ°è¿™ä¸ªæŒ‡ä»¤é›†ï¼Œéƒ½ä¼šæŠŠå­—å…¸ä¸­çš„å€¼æ‰§è¡Œä¸€éï¼Œæ‰€ä»¥åªèƒ½æ”¾å‡½æ•°åï¼Œjså°±ä¸ä¼š","link":"/2020/07/28/%E5%A4%A7%E5%AD%A6%E8%AF%BE%E7%A8%8B/WordCount-Python/"},{"title":"ä»¿ç½‘æ˜“äº‘éŸ³ä¹çš„å¯¹è¯æ°”æ³¡æ¡†","text":"ä¸»è¦å°±æ˜¯å¯¹è¯æ¡†å°ä¸‰è§’çš„å®ç°ï¼Œæ•ˆæœå¦‚ä¸‹ ä¸»è¦éš¾ç‚¹å°±æ˜¯ä¸‰è§’å½¢çš„å®ç°ï¼Œæœ‰ä¸¤ç§æ€è·¯ï¼Œä¸€ç§æ˜¯åˆ©ç”¨borderï¼Œç½‘æ˜“äº‘éŸ³ä¹æ˜¯ç”¨ä¸¤ä¸ª â—† å±‚å æ˜¾ç¤ºè¾¹æ¡†çš„ï¼Œä¸‹é¢æ˜¯æ ¸å¿ƒä»£ç  html12345678&lt;div class=&quot;comment&quot;&gt; &lt;span class=&quot;darr&quot;&gt; &lt;i class=&quot;bd&quot;&gt;â—†&lt;/i&gt; &lt;i class=&quot;bg&quot;&gt;â—†&lt;/i&gt; &lt;/span&gt; &lt;a href=&quot;#&quot;&gt;liang&lt;/a&gt; ï¼š&lt;span&gt;å˜¤å˜¤å˜¤å‘€å‘€å‘€å‘€å‘€å‘€æ™•æ™•æ™•æ™•&lt;/span&gt;&lt;/div&gt; css123456789101112131415161718192021222324252627282930313233.comment { position: relative; width: 200px; padding: 10px 15px; background-color: #f4f4f4; text-align: left; border: 1px solid #dedede;}.darr { position: absolute; top: -7px; left: 20px; font-size: 15px; line-height: 14px;}i { font-style: normal; position: absolute; top: 0; left: 0;}.bg { color: #f4f4f4; top: 1px;}// è¾¹æ¡†.bd { color: #dedede;}","link":"/2020/07/17/%E5%89%8D%E7%AB%AF%E5%AE%9E%E6%88%98%E6%8A%80%E5%B7%A7/%E4%BB%BF%E7%BD%91%E6%98%93%E4%BA%91%E9%9F%B3%E4%B9%90%E7%9A%84%E5%AF%B9%E8%AF%9D%E6%B0%94%E6%B3%A1%E6%A1%86/"}],"tags":[{"name":"Java","slug":"Java","link":"/tags/Java/"},{"name":"Less","slug":"Less","link":"/tags/Less/"},{"name":"CSS","slug":"CSS","link":"/tags/CSS/"},{"name":"æŠ€å·§","slug":"æŠ€å·§","link":"/tags/%E6%8A%80%E5%B7%A7/"},{"name":"js","slug":"js","link":"/tags/js/"},{"name":"leetcode","slug":"leetcode","link":"/tags/leetcode/"},{"name":"React","slug":"React","link":"/tags/React/"},{"name":"ts","slug":"ts","link":"/tags/ts/"},{"name":"Webpack","slug":"Webpack","link":"/tags/Webpack/"},{"name":"vue","slug":"vue","link":"/tags/vue/"},{"name":"å‰ç«¯æ€§èƒ½ä¼˜åŒ–","slug":"å‰ç«¯æ€§èƒ½ä¼˜åŒ–","link":"/tags/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"},{"name":"node.js","slug":"node-js","link":"/tags/node-js/"},{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","link":"/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"},{"name":"è½¯ä»¶å·¥ç¨‹","slug":"è½¯ä»¶å·¥ç¨‹","link":"/tags/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/"},{"name":"ç¼–è¯‘å™¨é…ç½®","slug":"ç¼–è¯‘å™¨é…ç½®","link":"/tags/%E7%BC%96%E8%AF%91%E5%99%A8%E9%85%8D%E7%BD%AE/"},{"name":"egg.js","slug":"egg-js","link":"/tags/egg-js/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","link":"/tags/%E7%AE%97%E6%B3%95/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","link":"/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"},{"name":"å¾®ä¿¡ç½‘é¡µ","slug":"å¾®ä¿¡ç½‘é¡µ","link":"/tags/%E5%BE%AE%E4%BF%A1%E7%BD%91%E9%A1%B5/"},{"name":"é¡¹ç›®æ€»ç»“","slug":"é¡¹ç›®æ€»ç»“","link":"/tags/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/"}],"categories":[{"name":"å¤§å­¦è¯¾ç¨‹","slug":"å¤§å­¦è¯¾ç¨‹","link":"/categories/%E5%A4%A7%E5%AD%A6%E8%AF%BE%E7%A8%8B/"},{"name":"å‰ç«¯","slug":"å‰ç«¯","link":"/categories/%E5%89%8D%E7%AB%AF/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","link":"/categories/%E7%AE%97%E6%B3%95/"},{"name":"æºç è§£è¯»","slug":"å‰ç«¯/æºç è§£è¯»","link":"/categories/%E5%89%8D%E7%AB%AF/%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/"},{"name":"åç«¯","slug":"åç«¯","link":"/categories/%E5%90%8E%E7%AB%AF/"},{"name":"æºç è§£è¯»","slug":"åç«¯/æºç è§£è¯»","link":"/categories/%E5%90%8E%E7%AB%AF/%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/"},{"name":"æµ‹è¯•","slug":"æµ‹è¯•","link":"/categories/%E6%B5%8B%E8%AF%95/"},{"name":"ç¼–è¯‘å™¨é…ç½®","slug":"ç¼–è¯‘å™¨é…ç½®","link":"/categories/%E7%BC%96%E8%AF%91%E5%99%A8%E9%85%8D%E7%BD%AE/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","link":"/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"},{"name":"æºç è§£è¯»","slug":"æºç è§£è¯»","link":"/categories/%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/"}]}